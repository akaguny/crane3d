var b4w="object"===typeof b4w?b4w:function(a){var p={};a.module=p;var d={};a.cleanup=function(a,c){var n=p[a];n&&(n.qi=null);d[c||"__b4w_default"]=null};a.register=function(a,c){p[a]||(p[a]=c)};a.require=function(a,c){if(!p[a])throw Error('Module "'+a+'" not found');c=c||"__b4w_default";d[c]||(d[c]=function(a){return function(b){var c=p[b];if(!c)throw Error('Module "'+b+'" not found');c.qi||(c.qi={});c.qi[a]||(c.qi[a]={},c(c.qi[a],d[a]));return c.qi[a]}}(c));return d[c](a)};a.module_check=function(a){return p[a]?
!0:!1};a.get_namespace=function(a){for(var c in d)if(d[c]==a)return c;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});"object"==typeof module&&module.nq&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function p(){var a=d,b=a.getDate(),b=10>b?"0"+String(b):String(b),g=a.getMonth()+1,g=10>g?"0"+String(g):String(g),q=String(a.getFullYear()),l=a.getHours(),l=10>l?"0"+String(l):String(l),t=a.getMinutes(),t=10>t?"0"+String(t):String(t),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return b+"."+g+"."+q+" "+l+":"+t+":"+a}var d=new Date(2016,1,26,15,8,43),b=[16,2];a.version=function(){return b};a.version_str=function(){for(var a="",d=0;d<b.length;d++)a=1==d?a+(10>b[d]?
"0"+b[d]:b[d]):a+b[d],d!=b.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return d};a.date_str=p;a.timestamp=function(){var a=p(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.nq&&b4w.module.__version(exports);b4w.module.__config=function(a,p){function d(){return b4w.module_check(a.Dc.Gm)}function b(){for(var b=a.Dc,d=null,l=document.getElementsByTagName("script"),t=0;t<l.length;t++){for(var e=l[t].src,n=0;n<b.Sv.length;n++)if(0<=e.indexOf(b.Sv[n])){d=e;break}if(null!==d)break}d||(c.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);b=d.indexOf("?");0<=b&&(d=d.substring(0,b));return d.substring(0,d.lastIndexOf("/")+1)}var c=p("__print"),
n=p("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.OB=n.za(a.context);a.p={alpha_sort:!0,alpha_sort_threshold:.1,Ih:[5,7],me:1E4,console_verbose:!1,do_not_load_resources:!1,Go:!1,Ou:1.5,tD:10,background_color:[0,0,0,0],Fh:.01,canvas_resolution_factor:1,Uj:3,allow_cors:!1,tq:!1,um:!0,show_hud_debug_info:!1,BK:!0,Cj:!0,stereo:"NONE",use_browser_distortion_cor:!0,El:!0,Fc:!0,Xc:!0,Ei:!0,Vi:!0,Em:!0,Jh:!0,yi:!0,antialiasing:!0,smaa:!1,
wireframe_debug:!1,Dy:!1,Ki:!0,ul:!0,cc:!0,Zn:!0,water_dynamic:!0,shore_smoothing:!0,Dj:!0,wb:1024,jg:512,jy:!0,precision:"highp",quality:a.P_HIGH,tm:!0,LF:!1,px:!1,fq:!1,ry:!1,gg:!1,gq:!1,lu:!1,Pq:!1,Jp:!1,bM:!1,Jl:!1,allow_hidpi:!1,gyro_use:!1,Lu:!1,pr:!1,enable_selectable:!0,enable_outlining:!0,tf:!0,gw:128,Nq:!1,tF:!1,hr:[0,0],Ok:!1,Qw:!0,bp:!1,url_params:null,Gc:!0,Cc:4,fx:!1,ax:!1,media_auto_activation:!0,fw:4,Fn:!1,zt:!1};a.KC=n.za(a.p);a.Yg={fn:-1,Pu:!1,uh:1};a.controls={IF:1/120};a.Ae={dir:"ASSETS=../../assets/",
CF:15,Ir:!0,nr:!1,aq:!1};a.RA=n.za(a.Ae);a.Dc={shaders_dir:"",oH:"include/",XL:"postprocessing/",Gm:"built_in_data",Sv:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js USER_DEFINED_MODULE".split(" "),bx:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.o={enabled:!0,me:60,Vl:"",Ap:!1,ping:!1,$l:!0};a.UF=n.za(a.o);a.Aj={ln:1024,Hk:384,ru:32,DC:128,CC:256,Gw:.25,bG:.5,aG:1};a.CG=n.za(a.Aj);a.H={Xs:!0,Kn:!1,Ht:!1,cu:!1,Cu:!1};a.nH=n.za(a.H);a.Kb={outlining_overview_mode:!1,
Af:[1,.4,.05],tj:.2,uj:3.8,vj:1};a.bq={enabled:!1,OH:"COPY",NH:0,rH:"COLOR"};a.HC=n.za(a.bq);a.NA=function(){var b=a.p,c=a.o,d=a.Aj;switch(b.quality){case a.P_ULTRA:b.Cj=!0;b.shore_smoothing=!0;b.Xc=!0;b.Ei=!0;b.Vi=!0;b.Em=!0;b.El=!0;b.Fc=!0;b.Ki=!0;b.ul=!0;b.cc=!0;b.Zn=!0;d.ln=2048;b.Uj=3;b.um=!0;b.Go=!1;b.precision="highp";b.water_dynamic=!0;b.Dj=!0;b.antialiasing=!0;b.smaa=!1;b.yi=!0;b.Jh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.tf=!0;b.Cc=16;c.me=120;break;case a.P_HIGH:b.Cj=!0;b.shore_smoothing=
!0;b.Xc=!0;b.Ei=!0;b.Vi=!0;b.Em=!0;b.El=!0;b.Fc=!0;b.Ki=!0;b.ul=!0;b.cc=!0;b.Zn=!0;d.ln=1024;b.Uj=3;b.um=!0;b.Go=!1;b.precision="highp";b.water_dynamic=!0;b.Dj=!0;b.antialiasing=!0;b.smaa=!1;b.yi=!0;b.Jh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.tf=!0;b.Cc=4;c.me=60;break;case a.P_LOW:b.Cj=!1,b.shore_smoothing=!1,b.Xc=!1,b.Ei=!1,b.Vi=!1,b.Em=!1,b.El=!1,b.Fc=!1,b.Ki=!1,b.ul=!1,b.cc=!1,b.Zn=!1,d.ln=512,b.Uj=2,b.um=!1,b.Go=!0,b.precision="mediump",b.water_dynamic=!1,b.Dj=!1,b.antialiasing=!1,b.smaa=
!1,b.yi=!1,b.Jh=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.tf=!1,b.Cc=1,c.me=60}};a.set=function(b,d){switch(b){case "allow_cors":a.p.allow_cors=d;break;case "allow_hidpi":a.p.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.p.alpha_sort=d;break;case "alpha_sort_threshold":a.p.alpha_sort_threshold=d;break;case "anaglyph_use":c.$C();a.p.stereo=d?"ANAGLYPH":a.p.stereo;break;case "animation_framerate":a.Yg.fn=d;break;case "antialiasing":a.p.antialiasing=d;break;case "assets_dds_available":a.Ae.aq=
d;break;case "assets_min50_available":a.Ae.nr=d;break;case "audio":a.H.Xs=d;break;case "background_color":a.p.background_color=d;break;case "built_in_module_name":a.Dc.Gm=d;break;case "canvas_resolution_factor":a.p.canvas_resolution_factor=d;break;case "console_verbose":a.p.console_verbose=d;break;case "do_not_load_resources":a.p.do_not_load_resources=d;break;case "gyro_use":a.p.gyro_use=d;break;case "stereo":a.p.stereo=d;break;case "use_browser_distortion_cor":a.p.use_browser_distortion_cor=d;case "media_auto_activation":a.p.media_auto_activation=
d;break;case "physics_enabled":a.o.enabled=d;break;case "physics_uranium_path":a.o.Vl=d;break;case "physics_calc_fps":a.o.Ap=d;break;case "physics_use_workers":a.o.$l=d;break;case "precision":a.p.precision=d;break;case "quality":a.p.quality=d;break;case "sfx_mix_mode":a.H.Kn=d;break;case "shaders_dir":a.Dc.shaders_dir=d;break;case "show_hud_debug_info":a.p.show_hud_debug_info=d;break;case "smaa":a.p.smaa=d;break;case "smaa_search_texture_path":a.Dc.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.Dc.smaa_area_texture_path=
d;break;case "wireframe_debug":a.p.wireframe_debug=d;break;case "enable_selectable":a.p.enable_selectable=d;break;case "enable_outlining":a.p.enable_outlining=d;break;case "outlining_overview_mode":a.Kb.outlining_overview_mode=d;break;case "glow_materials":a.p.tf=d;break;case "url_params":a.p.url_params=d;break;default:c.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.p.allow_cors;case "allow_hidpi":return a.p.allow_hidpi;case "alpha":return a.context.alpha;
case "alpha_sort":return a.p.alpha_sort;case "alpha_sort_threshold":return a.p.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.p.stereo;case "animation_framerate":return a.Yg.fn;case "antialiasing":return a.p.antialiasing;case "assets_dds_available":return a.Ae.aq;case "assets_min50_available":return a.Ae.nr;case "audio":return a.H.Xs;case "background_color":return a.p.background_color;case "built_in_module_name":return a.Dc.Gm;case "canvas_resolution_factor":return a.p.canvas_resolution_factor;
case "console_verbose":return a.p.console_verbose;case "do_not_load_resources":return a.p.do_not_load_resources;case "gyro_use":return a.p.gyro_use;case "is_mobile_device":return a.p.gg;case "stereo":return a.p.stereo;case "use_browser_distortion_cor":return a.p.use_browser_distortion_cor;case "media_auto_activation":return a.p.media_auto_activation;case "physics_enabled":return a.o.enabled;case "physics_uranium_path":return a.o.Vl;case "physics_calc_fps":return a.o.Ap;case "physics_use_workers":return a.o.$l;
case "precision":return a.p.precision;case "quality":return a.p.quality;case "sfx_mix_mode":return a.H.Kn;case "shaders_dir":return a.Dc.shaders_dir;case "show_hud_debug_info":return a.p.show_hud_debug_info;case "smaa":return a.p.smaa;case "smaa_search_texture_path":return a.Dc.smaa_search_texture_path;case "smaa_area_texture_path":return a.Dc.smaa_area_texture_path;case "wireframe_debug":return a.p.wireframe_debug;case "enable_selectable":return a.p.enable_selectable;case "enable_outlining":return a.p.enable_outlining;
case "outlining_overview_mode":return a.Kb.outlining_overview_mode;case "glow_materials":return a.p.tf;case "url_params":return a.p.url_params;default:c.error("Unknown config property: "+b)}};a.reset=function(){a.context=n.za(a.OB);a.p=n.za(a.KC);a.Ae=n.za(a.RA);a.o=n.za(a.UF);a.Aj=n.za(a.CG);a.H=n.za(a.nH);a.bq=n.za(a.HC)};a.IE=d;a.ZG=function(){var c=a.Dc,n=a.o;d()||""!=c.shaders_dir||(c.shaders_dir=b()+"../shaders/");if(d())c.smaa_search_texture_path="smaa_search_texture.png",c.smaa_area_texture_path=
"smaa_area_texture.png";else if(""==c.smaa_search_texture_path||""==c.smaa_area_texture_path){var l=b()+c.bx;c.smaa_search_texture_path=c.smaa_search_texture_path||l+"smaa_search_texture.png";c.smaa_area_texture_path=c.smaa_area_texture_path||l+"smaa_area_texture.png"}n.enabled&&""==n.Vl&&(l=b()+c.bx,n.Vl=l+"uranium.js")};a.get_std_assets_path=function(){return a.Ae.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,p){function d(a,f){var h=document.createElement("div"),r=h.style;r.position="absolute";r.backgroundColor="black";r.borderRadius="20px 20px 20px 0px";r.boxShadow="0px 0px 10px rgb(180, 180, 200)";r.opacity=1;r.padding="8px 12px";r.lineHeight="15px";r.visibility="hidden";r.fontSize="12px";var d=e.get_container();d.appendChild(h);var m=H.get_meta_tags(a);if(m)var u=m.title||a.name,k=m.description;else u=a.name,k="";var B=document.createElement("span"),G=B.style;B.innerHTML=
u;G.fontWeight="bold";G.fontSize="12px";G.lineHeight="15px";G.color="#fff";G.fontFamily="Arial";n(B);h.appendChild(B);if(k){var m=document.createElement("div"),M=m.style;M.position="absolute";M.bottom="0px";M.left="0px";M.backgroundColor="#000";M.borderRadius="20px 20px 20px 0px";M.boxShadow="0px 0px 10px rgb(180, 180, 200)";M.visibility="hidden";M.padding="8px 12px";M.overflow="hidden";M.lineHeight="15px";M.fontSize="12px";M.zIndex="2";h.appendChild(m);var u=document.createElement("span"),F=u.style;
u.innerHTML=k;F.fontSize="12px";F.fontFamily="Arial";F.fontWeight="bold";F.lineHeight="15px";F.color="#fff";F.visibility="hidden";m.appendChild(u);var g=!1,l=!1;d.addEventListener("mousedown",function(a){if(!(g||l||y))if(a.target!=B&&a.target!=h||"hidden"!=M.visibility||1!=r.opacity)"visible"==M.visibility&&(r.visibility="visible",G.visibility="visible",M.visibility="hidden",F.visibility="hidden");else{r.visibility="hidden";G.visibility="hidden";M.visibility="visible";g=l=!0;a=h.offsetWidth-24;var d=
h.offsetHeight-16,x=Math.min(f,b(k)),m=c(k,x);m==d&&(M.height=m+"px");x!=a?z.animate(a,x,200,function(a){a==x&&("visible"==M.visibility&&(F.visibility="visible"),g=!1);M.width=a+"px"}):g=!1;m!=d?z.animate(d,m,200,function(a){a==m&&("visible"==M.visibility&&(F.visibility="visible"),l=!1);M.height=a+"px"}):l=!1;l||g||(F.visibility="visible")}},!1)}return h}function b(a){var b=document.createElement("div"),f=document.createElement("span"),h=b.style;f.innerHTML=a;f.style.fontSize="12px";f.style.fontFamily=
"Arial";f.style.fontWeight="bold";f.style.color="#fff";f.style.visibility="hidden";h.lineHeight="15px";b.appendChild(f);h.position="absolute";h.visibility="hidden";h.fontSize="12px";h.display="inline-block";h.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function c(a,b){var f=document.createElement("div"),h=document.createElement("span"),c=f.style;h.innerHTML=a;h.style.fontSize="12px";h.style.fontFamily="Arial";h.style.fontWeight="bold";h.style.color=
"#fff";h.style.visibility="hidden";c.lineHeight="15px";f.appendChild(h);c.position="absolute";c.visibility="hidden";c.fontSize="12px";c.display="inline-block";c.width=b+"px";c.lineHeight="15px";document.body.appendChild(f);h=f.offsetHeight;document.body.removeChild(f);return h}function n(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";
a.style.cursor="default"}function g(){for(var a=0,b=0;b<C.length;b++)C[b].Bi&&a++;v=new Float32Array(3*a)}function q(a,b){return b.depth-a.depth}var l=p("__batch"),t=p("__camera"),e=p("__container"),H=p("__objects"),k=p("__print"),r=p("__renderer"),u=p("__scenes"),z=p("__time"),D=p("__tsr");p("__util");p("__config");var y=!1,C=[],v=new Float32Array(0),f=new Uint8Array(16),m=new Float32Array(2),h=new Float32Array(3);a.append=function(a){var b;a:{for(b=0;b<C.length;b++)if(C[b].obj==a){b=!0;break a}b=
!1}if(!b){b=a.anchor.Bi&&Boolean(u.X(u.Ti(),"ANCHOR_VISIBILITY"));b={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Zg:"out",Bi:b,element:null,lj:null,pA:a.anchor.DF,vm:0,fp:0,$m:a.anchor.$m};switch(b.type){case "ANNOTATION":b.element=d(a,b.pA);b.vm=b.element.offsetHeight;b.fp=b.element.offsetWidth;break;case "ELEMENT":b.element=document.getElementById(a.anchor.$m),b.element?(b.vm=b.element.offsetHeight,b.fp=b.element.offsetWidth):(k.warn("Anchor HTML element was not found, making it generic"),b.type="GENERIC")}C.push(b);
g()}};a.remove=function(a){for(var b=0;b<C.length;b++){var f=C[b];if(f.obj==a){"ANNOTATION"==f.type&&(a=f,e.get_container().removeChild(a.element));C.splice(b,1);g();break}}};a.update=function(){for(var a=0,b=C.length;b--;){var f=C[b];if(f.Bi){var c=D.get_trans_view(f.obj.g.i);v.set(c,3*a++)}var r;r=f;var c=h,d=u.Qi(u.Ti());r=D.get_trans_view(r.obj.g.i);r=c=t.project_point(d,r,c);c=r[0];d=r[1];r=r[2];if(c!=f.x||d!=f.y||r!=f.depth){switch(f.type){case "ANNOTATION":var m=f.element;m.style.left=Math.floor(c)+
"px";m.style.top=Math.floor(d-f.vm)+"px";break;case "ELEMENT":var m=f.element,e=m.getBoundingClientRect();m.style.cssText+="left:"+Math.floor(c-e.width/2)+"px;top:"+Math.floor(d-e.height/2)+"px;"}f.x=c;f.y=d;f.depth=r;f.lj&&f.lj(c,d,f.Zg,f.obj,m)}}C.sort(q);for(b=0;b<C.length;b++)f=C[b],"GENERIC"!=f.type&&(f.element.style.zIndex=b);0<a&&(a=u.X(u.Ti(),"ANCHOR_VISIBILITY").s[0].I,l.bI(a,v))};a.iy=function(){for(var a=e.get_container(),b=C.length;b--;){var h=C[b],c=h.obj,d=h.x,k=h.y,g=h.depth,g=0>d||
0>k||0>g||1<g||u.is_hidden(c)||d>=a.clientWidth||k>=a.clientHeight?"out":"visible";if(h.Bi&&"out"!=g){var g=h,l=u.X(u.Ti(),"ANCHOR_VISIBILITY").j,B=e.Fp(g.x,g.y,m,l);r.Vw(l.je,B[0],l.height-B[1],2,2,f);g=1020==f[0]+f[4]+f[8]+f[12]?"visible":"out"==g.Zg||0==f[0]+f[4]+f[8]+f[12]?"covered":g.Zg}if(g!=h.Zg){switch(h.type){case "ANNOTATION":case "ELEMENT":var G=h.element;if(!G)break;"out"==g?(G.style.visibility="hidden",G.children.length&&(G.children[0].style.visibility="hidden"),"ANNOTATION"==h.type&&
1<G.children.length&&(l=G.children[1],l.style.visibility="hidden",l.children.length&&(l.children[0].style.visibility="hidden"))):"visible"==g?(G.style.visibility="visible",G.children.length&&(G.children[0].style.visibility="visible"),G.style.opacity=1):(G.style.visibility="visible",G.style.opacity=.1,G.children.length&&(G.children[0].style.visibility="visible"),"ANNOTATION"==h.type&&1<G.children.length&&(l=G.children[1],l.style.visibility="hidden",l.children.length&&(l.children[0].style.visibility=
"hidden")))}h.Zg=g;h.lj&&h.lj(d,k,h.Zg,c,G)}}};a.attach_move_cb=function(a,b){for(var f=0;f<C.length;f++)C[f].obj==a&&(C[f].lj=b)};a.detach_move_cb=function(a){for(var b=0;b<C.length;b++)C[b].obj==a&&(C[b].lj=null)};a.cleanup=function(){for(var a=0;a<C.length;a++){var b=C[a];"ANNOTATION"==b.type&&e.get_container().removeChild(b.element)}C.length=0};a.is_anchor=function(a){for(var b=0;b<C.length;b++)if(C[b].obj==a)return!0;return!1};a.get_element_id=function(a){for(var b=0;b<C.length;b++)if(C[b].obj==
a)return C[b].$m;return!1};a.pause=function(){y=!0};a.resume=function(){y=!1};a.VF=function(a,b){for(var f=-1,h=0;h<C.length;h++){var c=C[h],r=Math.round(c.fp),d=Math.round(c.vm),m=c.x,c=c.y;if(C[h].Zg=a>=m&&a<=m+r&&b<c&&b>=c-d?!0:!1)if(0>f)var B=C[h].depth,f=h;else C[h].depth<B&&(f=h,B=C[h].depth)}return 0>f?null:C[f].obj}};b4w.module.__armature=function(a,p){function d(a){a=a.g;for(var b=a.mo,c=a.hw,r=0;r<b.length;r++){for(var d=b[r],e=c[r],f=0;f<e.length;f+=2)for(var m=e[f],h=e[f+1],x=0;4>x;x++)d.Qc[m+x]=a.Qc[h+x],d.ud[m+x]=a.ud[h+x],d.Yc[m+x]=a.Yc[h+x],d.Dd[m+x]=a.Dd[h+x];d.Qd=a.Qd}}function b(a,c,r,d){var k=a.Ks,g=a.Gg,f=a.Sl,m=a.Br;m?(m=m.Sl,c?n.multiply(m,k,f):(c=e,n.invert(m,c),n.multiply(c,f,k))):c?n.copy(k,f):n.copy(f,k);k=t;n.invert(g,k);n.multiply(f,k,k);g=a.Vf;r[4*g]=k[0];r[4*g+1]=k[1];r[4*g+2]=k[2];r[4*
g+3]=k[3];d[4*g]=k[4];d[4*g+1]=k[5];d[4*g+2]=k[6];d[4*g+3]=k[7];a=a.Au;for(g=0;g<a.length;g++)f=a[g],f.ib||b(f,!0,r,d)}var c=p("__util"),n=p("__tsr"),g=p("__quat"),q=p("__mat4"),l=p("__vec3"),t=n.create(),e=n.create(),H=new Float32Array(4),k=new Float32Array(4),r=new Float32Array(4);a.Ig=function(a,b){for(var r=a.data.bones,d=a.pose.bones,e={},k=0;k<d.length;k++){var f=d[k],m=f.bone,h=m.name,x=e[h]={Vf:0,sy:-1,Br:null,Au:[],Jm:[],ib:null,Rl:n.create(),Ks:n.create(),Gg:n.create(),Sl:n.create(),zo:n.create(),
Ls:n.create(),Ao:!1,Qx:new Float32Array(3)},h=new Float32Array(m.matrix_local),g=new Float32Array(16);q.invert(h,g);var f=new Float32Array(f.matrix_basis),P=x.Qx;l.subtract(m.tail_local,m.head_local,P);c.aJ(P,g,P);n.from_mat4(h,x.Gg);n.from_mat4(f,x.zo);n.copy(x.Gg,x.Sl)}for(k=0;k<r.length;k++){h=r[k].name;f=c.keysearch("name",h,d);x=e[h];m=f.parent_recursive;x.Jm.push(x);for(g=0;g<m.length;g++)f=m[g],f=f.name,f=e[f],x.Jm.push(f);m.length?(f=m[0],f=f.name,f=e[f],x.Br=f,n.invert(f.Gg,t),n.multiply(t,
x.Gg,x.Rl),f.Au.push(x)):n.copy(x.Gg,x.Rl);x.Vf=k;x.name=h;n.multiply(x.Rl,x.zo,x.Ks)}b.g.Jd=e};a.get_bone_tsr=function(a,b,c,d,l){var v=a.g,f=v.Qd;b=v.Jd[b];var m=b.Vf;a=b.Gg;var h=v.Yc,x=v.Dd,L=v.Qc,v=v.ud,P=h[4*m+1],A=h[4*m+2],w=h[4*m+3],I=x[4*m+1],q=x[4*m+2],O=x[4*m+3];H[0]=(1-f)*h[4*m]+f*x[4*m];H[1]=(1-f)*P+f*I;H[2]=(1-f)*A+f*q;H[3]=(1-f)*w+f*O;k[0]=L[4*m];k[1]=L[4*m+1];k[2]=L[4*m+2];k[3]=L[4*m+3];r[0]=v[4*m];r[1]=v[4*m+1];r[2]=v[4*m+2];r[3]=v[4*m+3];g.slerp(k,r,f,k);f=t;n.set_transcale(H,f);
n.set_quat(k,f);c?(c=e,n.translate(a,b.Qx,c),n.multiply(f,c,f)):n.multiply(f,a,f);if(d){if(d=b.Br)c=e,n.invert(d.Sl,c),n.multiply(c,f,f);d=e;n.invert(b.Rl,d);n.multiply(d,f,f)}n.copy(f,l)};a.set_bone_tsr=function(a,c,r,e){var k=a.g;c=k.Jd[c];var g=k.Yc,f=k.Qc;e?n.multiply(c.Rl,r,c.Ks):n.copy(r,c.Sl);b(c,e,g,f);k.Qd=0;d(a)};a.CI=d;a.iI=b;a.uk=function(a,b){return b in a.g.Jd}};b4w.module.__boundings=function(a,p){function d(a,b){for(var c=a[0],d=a[1],e=a[2],k=a[0],g=a[1],f=a[2],m=3;m<a.length;m+=3)var h=a[m],x=a[m+1],L=a[m+2],c=Math.max(c,h),d=Math.max(d,x),e=Math.max(e,L),k=Math.min(k,h),g=Math.min(g,x),f=Math.min(f,L);b.max_x=c;b.max_y=d;b.max_z=e;b.min_x=k;b.min_y=g;b.min_z=f;return b}function b(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,e=a.max_z,k=a.min_x,g=a.min_y,f=a.min_z;b[0]=k;b[1]=g;b[2]=f;b[3]=c;b[4]=g;b[5]=f;b[6]=c;b[7]=d;b[8]=f;b[9]=k;b[10]=
d;b[11]=f;b[12]=k;b[13]=g;b[14]=e;b[15]=c;b[16]=g;b[17]=e;b[18]=c;b[19]=d;b[20]=e;b[21]=k;b[22]=d;b[23]=e;return b}function c(){return{Be:new Float32Array(3),Ce:new Float32Array(3),De:new Float32Array(3),K:new Float32Array([0,0,0])}}function n(a,b,c){l.add(b,c,a.K);l.scale(a.K,.5,a.K);a.Pa=l.distance(a.K,b);return a}var g=p("__tsr"),q=p("__util"),l=p("__vec3"),t=new Float32Array(24),e=new Float32Array(3),H=new Float32Array(3),k=new Float32Array(3);a.Om=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;
b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.jK=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.$c=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.Gu=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,k=a.min_y,g=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,k);a.min_z=Math.min(b.min_z,g)};
a.ZA=d;a.wp=function(c,e,k){k||(k=a.$c());c=b(c,t);g.transform_vectors(c,e,c);return d(c,k)};a.fD=b;a.ZL=function(b,c,d){d||(d=a.$c());var e=c.min_x,k=c.max_x,g=c.min_y,l=c.max_y,f=c.min_z;c=c.max_z;if(e>=b.max_x||k<=b.min_x||g>=b.max_y||l<=b.min_y||f>=b.max_z||c<=b.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(b.min_x,e);d.max_x=Math.min(b.max_x,k);d.min_y=Math.max(b.min_y,g);d.max_y=Math.min(b.max_y,l);d.min_z=Math.max(b.min_z,f);d.max_z=Math.min(b.max_z,
c);return d};a.eM=function(b,c,d){d||(d=a.$c());var e=b.max_x-b.min_x,k=b.max_y-b.min_y,g=b.max_z-b.min_z;d.min_x=b.min_x-.5*(c-1)*e;d.max_x=b.max_x+.5*(c-1)*e;d.min_y=b.min_y-.5*(c-1)*k;d.max_y=b.max_y+.5*(c-1)*k;d.min_z=b.min_z-.5*(c-1)*g;d.max_z=b.max_z+.5*(c-1)*g;return d};a.yp=function(b,c,d){d||(d=a.oi());g.transform_vec3(b.K,c,d.K);d.Pa=b.Pa*g.get_scale(c);return d};a.xp=function(a,b,d){d||(d=c());g.transform_vec3(a.K,b,d.K);l.copy(a.Be,d.Be);l.copy(a.Ce,d.Ce);l.copy(a.De,d.De);g.transform_dir_vec3(d.Be,
b,d.Be);g.transform_dir_vec3(d.Ce,b,d.Ce);g.transform_dir_vec3(d.De,b,d.De);return d};a.Rm=function(a,b){return{Pa:a,K:new Float32Array(b)}};a.oi=function(){return{K:new Float32Array([0,0,0]),Pa:0}};a.Iy=c;a.Qm=function(a,b,c,d){return{Be:new Float32Array(a),Ce:new Float32Array(b),De:new Float32Array(c),K:new Float32Array([d[0],d[1],d[2]])}};a.aB=function(){return{K:new Float32Array([0,0,0]),Pa:1E12}};a.bD=function(a,b){var c=l.subtract(b.K,a.K,l.create());0==l.length(c)&&l.set(1,0,0,c);var d=l.normalize(c,
l.create()),c=l.scale(d,a.Pa,l.create());l.add(c,a.K,c);var e=l.scale(d,-a.Pa,l.create());l.add(e,a.K,e);var k=l.scale(d,b.Pa,l.create());l.add(k,b.K,k);var g=l.scale(d,-b.Pa,l.create());l.add(g,b.K,g);c=[c,e,k,g];d=l.normalize(d,l.create());e=c[0];k=c[0];for(g=1;g<c.length;g++){var f=l.dot(c[g],d);f<l.dot(e,d)&&(e=c[g]);f>l.dot(k,d)&&(k=c[g])}d=[e,k];c=d[0];d=d[1];a.K=l.scale(l.add(c,d,l.create()),.5,l.create());a.Pa=l.length(l.subtract(d,c,l.create()))/2};a.mu=function(a,b){var c=b.max_y,d=b.min_y,
e=Math.max(0,c-d-2*a);return{Pa:a,height:e,K:new Float32Array([0,(c+d)/2,0])}};a.ou=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Pa:a,height:e,K:new Float32Array([0,(c+d)/2,0])}};a.nu=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Pa:a,height:e,K:new Float32Array([0,(c+d)/2,0])}};a.mK=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.kG=function(a){for(var b=0,c=0,d=0,e=0,k=0,g=0,
f=0,m=0,h=0;h<a.submeshes.length;h++){var x=a.submeshes[h];if(x.position.length){b=e=x.position[0];c=k=x.position[1];d=g=x.position[2];break}}for(h=0;h<a.submeshes.length;h++)for(var x=a.submeshes[h],x=x.position,L=0;L<x.length/3;L++)var l=x[3*L],A=x[3*L+1],w=x[3*L+2],b=Math.max(l,b),c=Math.max(A,c),d=Math.max(w,d),e=Math.min(l,e),k=Math.min(A,k),g=Math.min(w,g),f=Math.max(Math.sqrt(l*l+A*A+w*w),f),m=Math.max(Math.sqrt(l*l+w*w),m);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=e;a.b4w_bounding_box.max_y=
c;a.b4w_bounding_box.min_y=k;a.b4w_bounding_box.max_z=d;a.b4w_bounding_box.min_z=g;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=e;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=k;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=g;a.b4w_bounding_sphere_radius=f;a.b4w_bounding_cylinder_radius=m};a.gE=function(b){var c=b.subarray(0,3),d=b.subarray(6,9),g=b.subarray(12,15),t=b.subarray(18,21);b=l.subtract(d,c,e);l.normalize(b,b);var C=q.lE(c,d,
g,H),C=l.cross(C,b,C);l.normalize(C,C);var v=l.create(),f=l.create();l.subtract(d,c,k);f[0]=l.dot(k,b);f[1]=l.dot(k,C);d=l.create();l.subtract(g,c,k);d[0]=l.dot(k,b);d[1]=l.dot(k,C);g=l.create();l.subtract(t,c,k);g[0]=l.dot(k,b);g[1]=l.dot(k,C);t=a.oi();g=[v,f,d,g];v=n(t,g[0],g[1]);for(t=2;t<g.length;t++)if(l.distance(v.K,g[t])>v.Pa){for(var m=v,v=g,f=g[t],d=t-1,m=n(m,f,v[0]),h=1;h<=d;h++)if(l.distance(m.K,v[h])>m.Pa){for(var x=m,m=v,L=f,P=v[h],A=h-1,x=n(x,L,P),w=0;w<=A;w++)if(l.distance(x.K,m[w])>
x.Pa){var I=L,T=P,O=m[w],B=l.subtract(T,O,k),B=l.squaredLength(B),G=l.subtract(I,O,k),M=l.squaredLength(G),G=l.subtract(I,T,k),F=l.squaredLength(G),G=B*(M+F-B),R=M*(F+B-M),B=F*(B+M-F),M=G+R+B;l.copy(I,x.K);l.scale(x.K,G/M,x.K);l.scaleAndAdd(x.K,T,R/M,x.K);l.scaleAndAdd(x.K,O,B/M,x.K);x.Pa=l.distance(x.K,I)}m=x}v=m}t=v;b=l.scale(b,t.K[0],k);l.scaleAndAdd(b,C,t.K[1],b);l.add(b,c,t.K);return t}};b4w.module.__compat=function(a,p){function d(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function b(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function c(){return!window.ActiveXObject&&"ActiveXObject"in window}var n=p("__config"),g=p("__extensions"),q=p("__print");
p("__util");var l="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";"),t=n.Yg,e=n.p,H=n.context,k=n.Aj,r=n.H,u=n.o;a.OC=function(a){a.getError()==a.INVALID_ENUM&&q.warn("Possible Tegra invalid enum issue detected, ignoring")};a.QG=function(a){e.gw=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);e.wb=a.getParameter(a.MAX_TEXTURE_SIZE);e.jg=
a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);e.Cc=e.Gc?Math.min(e.Cc,a.getParameter(a.MAX_SAMPLES)):1;var n=Boolean(g.bE());d("Firefox/28.0")&&(d("Linux")||d("Macintosh"))&&(q.warn("Firefox 28 detected, applying depth hack"),n=!1);d("Windows Phone")||(d("iPad")||d("iPhone")?(q.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),H.alpha||(e.background_color[3]=
1),e.ry=!0,e.smaa=!1,e.Xc=!1,e.precision="highp",e.Pq=!0,k.Hk=256):d("Mac OS X")&&d("Safari")&&!d("Chrome")&&(q.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),e.fx=!0,r.Ht=!0,r.cu=!0));d("Windows")&&(d("Chrome/40")||d("Firefox/33")||d("Firefox/34")||d("Firefox/35")||d("Firefox/36"))&&(q.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),e.Jp=!0);d("Mac OS X")&&(e.Fn=
!0,q.warn("OS X detected, applying shadows hack."));b()&&(q.warn("Mobile detected, applying various hacks for video textures."),e.gg=!0,d("iPad")||d("iPhone")||d("Windows Phone")||(q.warn("Mobile (not iOS) detected, disable playback rate for video textures."),r.Cu=!0));(d("Firefox/35.0")||d("Firefox/36.0"))&&d("Windows")&&(q.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),e.Lu=!0);if(d("iPhone")||c()||d("Edge"))q.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
e.Jl=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(q.warn("Not enough varyings, disable shadows on blend objects"),e.fq=!0);d("Windows Phone")&&(q.warn("Windows Phone detected. Disable wireframe mode, glow materials, ssao, smaa, shadows, reflections, refractions."),e.wireframe_debug=!1,e.precision="highp",e.tf=!1,e.Xc=!1,e.smaa=!1,e.Cj=!1,e.El=!1,e.Fc=!1,e.Qw=!1);d("Firefox")&&e.gg&&(q.warn("Mobile Firefox detected, disable workers."),u.$l=!1);d("Firefox")&&"HMD"==e.stereo&&(q.warn("Firefox detected, using custom distortion correction."),
e.use_browser_distortion_cor=!1);var y=g.iv();if(y){var C=a.getParameter(y.UNMASKED_VENDOR_WEBGL),y=a.getParameter(y.UNMASKED_RENDERER_WEBGL),v=/\b4\d{2}\b/;d("Macintosh")&&-1<y.indexOf("Intel HD Graphics 3000")&&(q.warn("OS X / Intel HD 3000 detected, applying depth hack"),n=!1);-1<C.indexOf("ARM")&&v.test(y)&&(q.warn("ARM Mali-400 series detected, applying depth and frames blending hacks"),n=!1,t.Pu=!0);-1<C.indexOf("ARM")&&-1<y.indexOf("Mali-T604")&&(q.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),
e.precision="highp",e.Cj=!1);-1<C.indexOf("ARM")&&-1<y.indexOf("Mali-T760")&&(q.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),e.precision="highp",e.Xc=!1,e.bp=!0);-1<C.indexOf("Qualcomm")&&-1<y.indexOf("Adreno")&&(q.warn("Qualcomm Adreno detected, applying shader constants hack."),e.px=!0,-1<y.indexOf("305")&&(q.warn('Qualcomm Adreno305 detected, set "highp" precision.'),e.precision="highp"),-1<y.indexOf("330")&&(q.warn('Qualcomm Adreno330 detected, set "highp" precision.'),
e.precision="highp"),-1<y.indexOf("420")&&(q.warn("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),e.wb=4096,e.jg=4096));-1<C.indexOf("NVIDIA")&&-1<y.indexOf("Tegra 3")&&(q.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),e.tq=!0);d("Windows")&&d("Chrome")&&!d("Edge")&&(y.match(/NVIDIA GeForce 8..0/)||y.match(/NVIDIA GeForce 9..0/)||y.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(q.warn("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),
e.jg=256,e.ax=!0);C="";for(v=0;v<l.length;v++)if(-1<y.indexOf(l[v])){C=l[v];break}C&&(q.warn("Architecture "+C+" detected. Blending between frames and shadows on blend objects will be disabled."),e.bp=!0,e.fq=!0)}0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(q.warn("Vertex textures are not allowed. Disabling vertex textures"),e.tm=!1);n||(e.Ki=!1,e.ul=!1,e.cc=!1,e.water_dynamic=!1,e.shore_smoothing=!1,e.Dj=!1,e.smaa=!1);e.jy=Boolean(g.jv());e.Kk=n;if(a.getShaderPrecisionFormat)var f=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,
a.HIGH_FLOAT);a.getShaderPrecisionFormat&&0!==f.precision||(e.precision="mediump");c()&&(q.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),k.Hk=512);if(c()&&d("Touch")||d("Edge"))q.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),e.Nq=!0;128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&(q.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),e.tq=!0);d("Chrome")&&!d("Edge")&&(q.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),
e.lu=!0);if(d("Chrome")&&!d("Edge")||d("Firefox"))e.gq=!0;b()&&d("Firefox")&&(q.log("Mobile firefox detected. Applying autoplay media hack."),e.pr=!0);d("Edge")&&(q.warn("Microsoft Edge detected, set up new minimal texture size."),e.Ok=!0);d("SamsungBrowser")&&(q.warn("Default Android browser detected, setting max cubemap size to 1024, setting max texture size to 1024."),e.wb=1024,e.jg=1024)};a.FB=d;a.detect_mobile=b;a.LA=function(){d("Firefox/35.0")&&d("Windows")&&(q.warn("Windows/Firefox 35 detected, forcing context's alpha"),
n.context.alpha=!0)};a.Wq=c};b4w.module.__constraints=function(a,p){function d(a){var b={};b.type=a;return b}function b(a,b){a.ib&&a.ib.da&&c(a.ib.da,a);if(b.da){var f=b.da;if(-1==f.fe.indexOf(a))f.fe.push(a);else throw"Descendant object override is forbidden";}a.ib=b}function c(a,b){var c=a.fe.indexOf(b);if(-1!=c)a.fe.splice(c,1);else throw"No descendant object";}function n(a,b,c){switch(b.type){case 1:var B=u.get_quat_view(a.g.i),f=b.da.g.i;c=u.get_quat_view(b.da.g.i);b.xc?(r.copy(b.xc,B),r.multiply(c,B,B)):r.copy(c,B);var h=
u.transform_vec3(b.offset,f,v);u.set_trans(h,a.g.i);h=u.get_scale(b.da.g.i);u.set_scale(b.Il*h,a.g.i);break;case 9:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);f=b.da.g.i;c=u.get_quat_view(b.da.g.i);r.multiply(r.invert(b.Rh,b.Rh),B,B);r.multiply(c,B,B);u.transform_vec3(b.offset,f,h);r.copy(c,b.Rh);break;case 10:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);f=b.da.g.i;c=u.get_quat_view(b.da.g.i);r.multiply(r.invert(b.Rh,b.Rh),B,B);r.multiply(c,B,B);u.transform_vec3(b.offset,f,h);r.copy(c,
b.Rh);h=u.get_quat_view(a.g.i);B=u.get_quat_view(b.da.g.i);B=r.multiply(B,b.xc,x);B=e.$u(B,y);h=e.$u(h,C);e.rotate_eye_camera(a,z.fh(h[0],B[0]+b.JB,B[0]+b.IB),z.fh(h[1],B[1]+b.HB,B[1]+b.KB));break;case 13:var h=u.get_trans_view(a.g.i),B=u.get_quat_view(a.g.i),f=b.da.g.i,d=u.get_trans_view(f),m=b.tH,k=v,g=x;u.transform_vec3(b.offset,f,k);z.smooth_v(k,h,c,m,h);f=v;D.sub(d,h,f);D.normalize(f,f);var n=B,h=L,d=h.subarray(0,3),k=h.subarray(3,6),p=h.subarray(6,9);D.copy(f,k);D.negate(k,k);D.normalize(k,
k);Boolean(.999999<Math.abs(D.dot(f,z.AXIS_Y)))?(f=H.fromQuat(r.normalize(n,g),P),D.copy(f.subarray(0,3),d)):D.cross(z.AXIS_Y,k,d);D.normalize(d,d);D.cross(d,k,p);D.normalize(p,p);r.fromMat3(h,g);r.normalize(g,g);z.wx(g,B,c,.16*m,B);break;case 2:B=u.get_quat_view(a.g.i);c=A;t.get_bone_tsr(b.da,b.dh,!0,!1,c);u.multiply(b.da.g.i,c,c);B[0]=c[4];B[1]=c[5];B[2]=c[6];B[3]=c[7];b.xc&&(r.copy(b.xc,B),r.multiply(B,b.xc,B));u.set_scale(b.Il*c[3],a.g.i);h=u.get_trans_view(a.g.i);u.transform_vec3(b.offset,c,
h);break;case 3:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);c=u.get_trans_view(b.da.g.i);q(h,B,c);break;case 4:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);c=b.target;q(h,B,c);break;case 5:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);c=u.get_trans_view(b.da.g.i);q(h,B,c);B=D.dist(h,c);if(B=B>b.dist_max?B-b.dist_max:B<b.Mk?B-b.Mk:0)D.sub(c,h,v),D.normalize(v,v),D.scale(v,B,v),D.add(h,v,h);break;case 6:h=u.get_trans_view(a.g.i);B=u.get_quat_view(a.g.i);c=b.target;q(h,B,c);B=D.dist(h,
c);if(B=B>b.dist_max?B-b.dist_max:B<b.Mk?B-b.Mk:0)D.sub(c,h,v),D.normalize(v,v),D.scale(v,B,v),D.add(h,v,h);break;case 7:f=b.da.g.i;h=u.get_trans_view(a.g.i);u.transform_vec3(b.offset,f,h);break;case 8:d=u.get_trans_view(b.da.g.i);h=u.get_trans_view(a.g.i);D.add(d,b.offset,h);break;case 14:B=u.get_quat_view(a.g.i);f=b.da.g.i;c=u.get_quat_view(b.da.g.i);b.xc?(r.copy(b.xc,B),r.multiply(c,B,B)):r.copy(c,B);h=u.get_trans_view(a.g.i);u.transform_vec3(b.offset,f,h);break;case 11:u.multiply(b.da.g.i,b.Bo,
a.g.i);break;case 12:h=b.Bo;c=A;t.get_bone_tsr(b.da,b.dh,!0,!1,c);u.multiply(b.da.g.i,c,c);u.multiply(c,h,a.g.i);break;case 15:B=b.da,c=e.eE(B),h=u.get_trans_view(a.g.i),f=e.Ri(c,"LEFT"),d=e.Ri(c,"RIGHT"),m=e.Ri(c,"TOP"),g=e.Ri(c,"BOTTOM"),k="heights"==b.hor_units?m-g:d-f,b.Wv?(f=e.Ri(c,"LEFT"),h[0]=f+k*b.br):(d=e.Ri(c,"RIGHT"),h[0]=d-k*b.br),f="heights"==b.vert_units?m-g:d-f,h[2]=b.Vx?-(m-f*b.Hs):-(g+f*b.Hs),e.QE(c)?h[1]=-b.distance:(h[1]=-1,D.normalize(h,h),D.scale(h,b.distance/Math.abs(h[1]),h)),
u.transform_dir_vec3(h,B.g.i,h),c=u.get_trans_view(B.g.i),D.add(c,h,h),h=u.get_quat_view(a.g.i),B=u.get_quat_view(B.g.i),b.xc?(r.copy(b.xc,h),r.multiply(B,h,h)):r.copy(B,h)}"CAMERA"==a.g.type&&(h=z.AXIS_Y,10==b.type&&(c=u.get_quat_view(b.da.g.i),h=D.transformQuat(h,c,w)),e.Ns(a),l(a,h))}function g(a,b){switch(b.type){case 1:var c=b.target.g.i,B=A;u.invert(a.g.i,B);u.multiply(B,c,B);t.set_bone_tsr(a,b.dh,B,!1)}a.sr=!0}function q(a,b,c){var B=v;z.quat_to_dir(b,z.AXIS_MY,B);D.normalize(B,B);var d=f;
D.subtract(c,a,d);D.normalize(d,d);a=z.ex(B,d,h);r.multiply(a,b,b);r.normalize(b,b)}function l(a,b,c){var B=a.g,h=u.get_quat_view(B.i),d=z.quat_to_dir(h,z.AXIS_Y,v);D.normalize(d,d);if(.999999<Math.abs(D.dot(b,d)))d=r.identity(x);else{var F=D.cross(b,d,f);D.normalize(F,F);B.Ua==e.MS_TARGET_CONTROLS?B.vo&&D.negate(F,F):(B=z.quat_to_dir(h,z.AXIS_Z,m),0<D.dot(B,b)&&D.negate(F,F));B=z.quat_to_dir(h,z.AXIS_X,m);D.normalize(B,B);var k=z.clamp(D.dot(B,F),-1,1),d=-.999999>=k?r.setAxisAngle(d,Math.acos(k),
x):r.rotationTo(B,F,x);r.normalize(d,d)}r.multiply(d,h,h);c&&(c=z.quat_to_dir(h,z.AXIS_MZ,v),0>D.dot(b,c)&&r.rotateY(h,Math.PI,h));e.Ns(a)}var t=p("__armature"),e=p("__camera"),H=p("__mat3"),k=p("__print"),r=p("__quat"),u=p("__tsr"),z=p("__util"),D=p("__vec3");a.DJ=1;a.CJ=2;a.HJ=3;a.IJ=4;a.xJ=5;a.yJ=6;a.EJ=7;a.wJ=8;a.BJ=9;a.AJ=10;a.uJ=11;a.vJ=12;a.zJ=13;a.FJ=14;a.GJ=15;a.tJ=1;var y=new Float32Array(2),C=new Float32Array(2),v=new Float32Array(3),f=new Float32Array(3),m=new Float32Array(3),h=new Float32Array(4),
x=new Float32Array(4),L=new Float32Array(9),P=new Float32Array(9),A=u.create(),w=new Float32Array(3);a.Ct=function(a,c,h,B,f){var e=d(1);e.da=c;e.offset=new Float32Array(h);e.xc=B?new Float32Array(B):null;e.Il=f;b(a,e);n(a,e,0)};a.BA=function(a,c,h,B,f,e){var F=d(2);F.da=c;F.dh=h;F.offset=new Float32Array(B);F.xc=f?new Float32Array(f):null;F.Il=e;b(a,F);n(a,F,0)};a.AA=function(a,c,h,B){var f=d(9),e=u.get_quat_view(a.g.i),F=u.get_quat_view(c.g.i);f.da=c;f.offset=new Float32Array(h);f.Rh=new Float32Array(F);
B&&(r.copy(B,e),r.multiply(F,e,e));b(a,f);n(a,f,0)};a.zA=function(a,c,h,B,f,e,F,k){var m=d(10),g=u.get_quat_view(a.g.i),x=u.get_quat_view(c.g.i);m.da=c;m.offset=new Float32Array(h);m.Rh=new Float32Array(x);m.IB=z.angle_wrap_0_2pi(f);m.JB=z.angle_wrap_0_2pi(e);m.KB=z.angle_wrap_periodic(F,-Math.PI,Math.PI);m.HB=z.angle_wrap_periodic(k,-Math.PI,Math.PI);B?(m.xc=new Float32Array(B),r.copy(B,g),r.multiply(x,g,g)):m.xc=r.create();b(a,m);n(a,m,0)};a.yA=function(a,c,h,B){var f=d(13);f.da=c;f.offset=new Float32Array(h);
f.tH=B;b(a,f);n(a,f,0)};a.EA=function(a,c,h,B){var f=d(14);f.da=c;f.offset=new Float32Array(h);f.Il=1;f.xc=B?new Float32Array(B):null;b(a,f);n(a,f,0)};a.PL=c;a.HA=function(a,c){var h=d(3);h.da=c;b(a,h);n(a,h,0)};a.IA=function(a,c){var h=d(4);h.target=new Float32Array(c);b(a,h);n(a,h,0)};a.uA=function(a,c,h,B){var f=d(5);f.da=c;f.Mk=h;f.dist_max=B;b(a,f);n(a,f,0)};a.vA=function(a,c,h,f){var e=d(6);e.target=new Float32Array(c);e.Mk=h;e.dist_max=f;b(a,e);n(a,e,0)};a.DA=function(a,c,h){var f=d(7);f.da=
c;f.offset=new Float32Array(h);b(a,f);n(a,f,0)};a.tA=function(a,c,h){var f=d(8);f.da=c;f.offset=new Float32Array(h);b(a,f);n(a,f,0)};a.rA=function(a,c,h){var f=d(11);f.da=c;f.Bo=new Float32Array(h);b(a,f);n(a,f,0)};a.sA=function(a,c,h,f){var e=d(12);e.da=c;e.dh=h;e.Bo=new Float32Array(f);b(a,e);n(a,e,0)};a.append_stiff_viewport=function(a,c,h){var f=d(15);f.da=c;if(z.nd(h.left))f.Wv=!0,f.br=h.left;else if(z.nd(h.right))f.Wv=!1,f.br=h.right;else{k.error("append_stiff_viewport: Wrong positioning params");
return}if(z.nd(h.top))f.Vx=!0,f.Hs=h.top;else if(z.nd(h.bottom))f.Vx=!1,f.Hs=h.bottom;else{k.error("append_stiff_viewport: Wrong positioning params");return}z.nd(h.distance)?(f.distance=h.distance,f.xc=z.nd(h.rotation)?new Float32Array(h.rotation):null,f.hor_units=z.nd(h.hor_units)?h.hor_units:"widths",f.vert_units=z.nd(h.vert_units)?h.vert_units:"heights",b(a,f),n(a,f,0)):k.error("append_stiff_viewport: Wrong positioning params")};a.oI=function(a,b){a.ib&&n(a,a.ib,b)};a.CA=function(a,b,c,h,f){var e=
d(1);e.dh=c;e.target=b;e.offset=new Float32Array(h);e.xc=f?new Float32Array(f):null;e.Il=1;b=e.target;c=e.dh;h=a.g.Jd[c];f=b.Pp;for(var F=0;F<f;F++){var m=f[F];if(m[0]==a&&m[1]==c){f.splice(F,1);break}}b.Pp.push([a,c]);h.ib=e;g(a,e)};a.hI=function(a,b){var c=a.g.Jd[b];c.ib&&g(a,c.ib)};a.yG=q;a.correct_up=l;a.yB=function(a){return a.ib?!0:!1};a.remove=function(a){a.ib.da&&c(a.ib.da,a);a.ib=null};a.fL=function(a){return a.ib?a.ib.type:null};a.Sd=function(a){a=a.ib;return!a||11!=a.type&&12!=a.type?!1:
!0};a.gn=function(a){if((a=a.ib)&&11==a.type)return a.da.g.i;if(a&&12==a.type){var b=A;t.get_bone_tsr(a.da,a.dh,!0,!1,b);u.multiply(a.da.g.i,b,b);return b}return null};a.Rd=function(a){a=a.ib;return!a||11!=a.type&&12!=a.type?null:a.Bo}};b4w.module.__container=function(a,p){var d,b,c,n,g;function q(a,c){d=a;b=c}function l(){var a=f.getBoundingClientRect();q(a.left,a.top)}function t(){return v.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}var e=p("__anchors"),H=p("__config"),k=p("__data"),r=p("__hud");p("__objects");var u=p("__print"),z=p("__scenes"),D=p("__time"),y=p("__transform"),C=p("__util"),v=H.p,f=null,m=null,h=null,x=!1;n=c=0;g=1;d=b=0;var L=null;a.Vo=320;a.Uo=240;a.yd=function(a){L=a};a.get_canvas=function(){return f};a.get_canvas_hud=
function(){return m};a.get_container=function(){return h};a.init=function(a,b){a&&a.parentNode?(f=a,m=b,h=a.parentNode):C.Z("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":h.insertBefore(a,h.firstElementChild);break;case "JUST_BEFORE_CANVAS":h.insertBefore(a,f);break;case "JUST_AFTER_CANVAS":f.nextElementSibling?h.insertBefore(a,f.nextElementSibling):h.appendChild(a,f);break;case "LAST":h.appendChild(a,f);break;default:u.error(b+" invalid stack order")}};
a.tE=function(){return c};a.sE=function(){return n};a.set_canvas_offsets=q;a.update_canvas_offsets=l;a.mH=function(a,b,h){c=a;n=b;g=h;l()};a.force_offsets_updating=function(){x=!0};a.client_to_canvas_coords=function(a,c,h){h||(h=new Float32Array(2));var f=h;x&&(l(),x=!1);f[0]=a-d;a=h;x&&(l(),x=!1);a[1]=c-b;return h};a.Fp=function(a,b,h,f){h||(h=new Float32Array(2));h[0]=a*g;h[1]=b*g;f&&(a=f.width/c,h[0]*=a,h[1]*=a);return h};a.gJ=function(a,b,h,f){h||(h=new Float32Array(2));h[0]=a/g;h[1]=b/g;f&&(a=
f.width/c,h[0]/=a,h[1]/=a)};a.Bv=function(b){return b&&b.parentNode?b.parentNode==h?!0:a.Bv(b.parentNode):!1};a.ME=t;a.mD=function(a){var b=document.getElementsByTagName("script");a=C.pl(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=function(b,c,d){if(!b||!c){b=a.Vo;c=a.Uo;var g=h;g.style.width=a.Vo+"px";g.style.height=a.Uo+"px"}var g=f,x=m;!1!==d&&(g.style.width=b+"px",g.style.height=c+"px",x&&(x.style.width=b+"px",x.style.height=c+"px"));x&&(x.width=b,x.height=c,
r.Tl());d=Math.floor(b*v.canvas_resolution_factor);c=Math.floor(c*v.canvas_resolution_factor);t()&&(d*=window.devicePixelRatio,c*=window.devicePixelRatio);k.is_primary_loaded()&&(x=z.get_active().k,d=Math.floor(d*x.Tc),c=Math.floor(c*x.Tc));g.width=d;g.height=c;if(d>L.drawingBufferWidth||c>L.drawingBufferHeight)u.warn("Canvas size exceeds platform limits, downscaling"),x=Math.min(L.drawingBufferWidth/d,L.drawingBufferHeight/c),d*=x,c*=x,g.width=d,g.height=c;z.ox(d,c,d/b);z.la()&&y.m(z.get_active().Tg);
k.tI(g.width,g.height);k.is_primary_loaded()&&(e.update(),z.update(D.get_timeline(),0),e.iy())}};b4w.module.__controls=function(a,p){function d(a){return{type:a,value:0,aa:null,he:!1,key:0,Ya:"",Fe:!1,Mp:null,Lp:function(){},Kp:null,eu:function(){},Gf:null,from:new Float32Array(3),to:new Float32Array(3),Av:!1,pn:!1,Cl:0,Uw:function(){},axis:"",Cd:0,Vj:new Float32Array(3),ao:new Float32Array(4),threshold:0,Rw:new Float32Array(4),Am:0,zm:0,dx:0,Bm:0,sd:0,repeat:!1,kp:!1,Yi:0,Xi:0,Wi:0,on:0,nn:0,mn:0,callback:function(){}}}function b(a,b){a.value=Number(b)}function c(a){for(var b=a.yg,c=a.FG,h=
0;h<b.length;h++)c[h]=b[h].value;return a.sF(c)}function n(a,b){a=a||M;var c=a.pe;if(c){var h=a.Yh;if(b){var f=c[b];if(f){for(var d=f.yg,B=0;B<d.length;B++){var X=d[B],e;e=F.indexOf(X);e=-1<e?R[e]:[];1==e.length?(g(X),X=F.indexOf(X),-1<X?(F.splice(X,1),R.splice(X,1)):I.Z("Sensors cache is corrupted")):1<e.length&&e.splice(e.indexOf(f,1))}delete c[b];B=h.indexOf(f);-1<B?h.splice(B,1):I.Z("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=G.indexOf(a),-1<c?G.splice(c,1):x.error("Wrong object"))}}else{h=
[];for(b in c)h.push(b);for(B=0;B<h.length;B++)n(a,h[B])}sa=!0}}function g(a){switch(a.type){case 80:L.remove_collision_test(a.Mp,a.Ya,a.Lp);a.he=!0;break;case 90:L.clear_collision_impulse_test(a.Kp);a.he=!0;break;case 100:L.remove_ray_test(a.Cl);a.he=!0;break;case 130:a.he=!0}}function q(a){for(var c=0;c<F.length;c++){var h=F[c];20==h.type&&a.keyCode==h.key&&b(h,1)}ga&&a.preventDefault();ca&&ca(a)}function l(a){for(var c=0;c<F.length;c++){var h=F[c];20==h.type&&0==a.keyCode&&16==h.key&&b(h,0);20==
h.type&&a.keyCode==h.key&&b(h,0)}ga&&a.preventDefault();ca&&ca(a)}function t(a){var c=!1,f=null;na=!0;oa=a.clientX;fa=a.clientY;ha=a.clientX;N=a.clientY;for(var B=0;B<F.length;B++){var d=F[B];50==d.type&&(b(d,1),d.aa=a.which);160==d.type&&(c||(c=m.client_to_canvas_coords(a.clientX,a.clientY,la),f=h.pick_object(c[0],c[1]),c=!0),d.value=f==d.Gf?1:0)}Z&&a.preventDefault();ja&&ja(a)}function e(a){for(var c=0;c<F.length;c++){var h=F[c];50==h.type&&b(h,0);160==h.type&&h.kp&&(h.value=0)}na=!1;Z&&!ua&&a.preventDefault();
ja&&ja(a)}function H(a){var c=a.clientX,h=a.clientY;ha=c;N=h;if(!B.Nq||na)for(var f=c-oa,d=h-fa,e=Math.sqrt(f*f+d*d),m=0;m<F.length;m++){var X=F[m];if(40===X.type)switch(X.axis){case "X":b(X,f);X.aa=c;break;case "Y":b(X,d);X.aa=h;break;case "XY":b(X,e),X.aa[0]=c,X.aa[1]=h}}Z&&!ua&&a.preventDefault();ja&&ja(a)}function k(a){m.Bv(a.relatedTarget)||e(a)}function r(a){var c=a.wheelDelta||-40*a.detail,c=c*O.IF;S+=c;for(c=0;c<F.length;c++){var h=F[c];30===h.type&&b(h,S)}Y&&a.preventDefault();da&&da(a)}
function u(a){var b=a.targetTouches;if(1==b.length){for(var c=b[0],b=c.clientX,c=c.clientY,f=!1,d=null,B=0;B<F.length;B++){var e=F[B];160==e.type&&(f||(f=m.client_to_canvas_coords(b,c,la),d=h.pick_object(f[0],f[1]),f=!0),e.value=d==e.Gf)}ea[0]=b;ea[1]=-1;qa[0]=c;qa[1]=-1}else 1<b.length&&(V=W=C(b),ea[0]=b[0].clientX,ea[1]=b[1].clientX,qa[0]=b[0].clientY,qa[1]=b[1].clientY,Q=v(b));ba.set(ea);E.set(qa);K&&K(a)}function z(c){var h=c.targetTouches;if(0!==h.length){if(1===h.length){ba[0]=h[0].clientX;
ba[1]=-1;E[0]=h[0].clientY;E[1]=-1;var h=ba[0]-ea[0],f=E[0]-qa[0],d=Math.sqrt(h*h+f*f);if(-1!=ea[1]&&-1!=qa[1]){var B=ba[0]-ea[1],e=E[0]-qa[1],m=Math.sqrt(B*B+e*e);m<d&&(h=B,f=e,d=m)}for(m=0;m<F.length;m++){var X=F[m];if(60===X.type)switch(X.aa=a.PL_SINGLE_TOUCH_MOVE,X.axis){case "X":b(X,h);break;case "Y":b(X,f);break;case "XY":b(X,d)}}}else if(1<h.length){ba[0]=h[0].clientX;ba[1]=h[1].clientX;E[0]=h[0].clientY;E[1]=h[1].clientY;V=C(h);d=V-W;B=la;B[0]=(ba[0]+ba[1])/2;B[1]=(E[0]+E[1])/2;e=ia;e[0]=
(ea[0]+ea[1])/2;e[1]=(qa[0]+qa[1])/2;var G,f=B[0]-e[0],m=B[1]-e[1];G=Math.sqrt(f*f+m*m);for(var k=v(h),m=0;m<F.length;m++)switch(X=F[m],X.type){case 70:X.aa=a.PL_MULTITOUCH_MOVE_ZOOM;b(X,d);break;case 60:X.aa=a.PL_MULTITOUCH_MOVE_PAN;switch(X.axis){case "X":h=B[0]-e[0];b(X,h);break;case "Y":f=B[1]-e[1];b(X,f);break;case "XY":b(X,G)}break;case 75:X.aa=a.PL_MULTITOUCH_MOVE_ROTATE,b(X,k-Q)}}Fa&&c.preventDefault();K&&K(c)}}function D(a){if(0==a.targetTouches.length)for(var c=0;c<F.length;c++){var h=F[c];
160==h.type&&h.kp&&b(h,0)}K&&K(a)}function y(a){for(var c=0;c<F.length;c++){var h=F[c];if(170==h.type||180==h.type||190==h.type)h.Xi=a.beta,h.Yi=a.gamma,h.Wi=a.alpha,h.value||(h.on=a.gamma,h.nn=a.beta,h.mn=a.alpha,b(h,1))}}function C(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function v(a){var b=a[0];a=a[1];return Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}var f=p("__config"),m=p("__container"),h=p("__objects"),x=p("__print"),L=p("__physics"),
P=p("__quat"),A=p("__time"),w=p("__tsr"),I=p("__util"),T=p("__vec3"),O=f.controls,B=f.p,G=[],M={},F=[],R=[],S=0,ha=0,N=0,oa=0,fa=0,na=!1,ba=new Float32Array(2),E=new Float32Array(2),ea=new Float32Array(2),qa=new Float32Array(2),la=new Float32Array(2),ia=new Float32Array(2),ya=T.create(),J=P.create(),V=0,W=0,Q=0,sa=!1,ma=0,ga=!1,Z=!1,Y=!1,Fa=!1,ua=!1,ca=null,ja=null,da=null,K=null;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;
a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;a.update=function(h,f){for(var B=0;B<F.length;B++){var d=F[B],e=h,m=f;if(m)switch(d.type){case 110:var k=d.Gf,X=w.get_trans_view(k.g.i),k=w.get_quat_view(k.g.i),g=T.dist(d.Vj,X),ka=d.Rw;P.invert(d.ao,ka);P.multiply(k,ka,ka);P.normalize(ka,ka);ka=Math.abs(2*Math.acos(ka[3]));g/=m;d.Am=I.smooth(g,d.Am,m,.3);d.aa[0]=g;g=ka/m;d.zm=I.smooth(g,d.zm,m,.3);d.aa[1]=g;d.Am>=d.threshold||d.zm>=d.dx?b(d,1):b(d,0);T.copy(X,d.Vj);
P.copy(k,d.ao);d.Cd=e;break;case 120:k=d.Gf;X=w.get_trans_view(k.g.i);k=Math.abs(X[1]-d.Vj[1])/m;d.Bm=I.smooth(k,d.Bm,m,.3);d.aa=k;d.Bm>=d.threshold?b(d,1):b(d,0);T.copy(X,d.Vj);d.Cd=e;break;case 130:!d.he&&0<=d.sd&&e-d.Cd>=d.sd&&(b(d,1),d.repeat?d.Cd=e:d.sd=-d.sd);break;case 140:d.Cd||(d.Cd=e);b(d,e-d.Cd);d.Cd=e;break;case 150:b(d,e);break;case 170:d.aa[0]=Math.PI*(d.Yi-d.on)/180;d.aa[1]=Math.PI*(d.Xi-d.nn)/180;d.aa[2]=Math.PI*(d.Wi-d.mn)/180;d.on=d.Yi;d.nn=d.Xi;d.mn=d.Wi;break;case 180:d.aa[0]=
Math.PI*d.Yi/180;d.aa[1]=Math.PI*d.Xi/180;d.aa[2]=Math.PI*d.Wi/180;break;case 190:if(d.Yi==d.on&&d.Xi==d.nn&&d.Wi==d.mn)break;e=ya;e[0]=Math.PI*d.Wi/180;e[1]=Math.PI*d.Xi/180;e[2]=Math.PI*d.Yi/180;I.ordered_angles_to_quat(e,I.ZXY,d.aa);e=P.setAxisAngle(I.AXIS_Z,-(Math.PI*window.orientation/180),J);P.multiply(d.aa,e,d.aa);k=P.setAxisAngle(I.AXIS_X,-Math.PI/2,J);P.multiply(k,d.aa,d.aa);k=P.setAxisAngle(I.AXIS_X,Math.PI/2,J);P.multiply(d.aa,k,d.aa);break;case 200:b(d,d.callback())}}for(B=0;B<G.length;B++)for(m=
G[B],d=m.Yh,e=0;e<d.length;e++)if(X=d[e],X.$x!=ma){X.$x=ma;ka=X;k=0;switch(ka.type){case a.CT_POSITIVE:k=(g=c(ka))?1:0;break;case a.CT_CONTINUOUS:k=ka.vf;(g=c(ka))?(k=1,ka.vf=1):1==k?(k=-1,ka.vf=-1):k=0;break;case a.CT_TRIGGER:k=ka.vf;(g=c(ka))&&-1==k?(k=1,ka.vf=1):g||1!=k?k=0:(k=-1,ka.vf=-1);break;case a.CT_SHOT:k=ka.vf;(g=c(ka))&&-1==k?(k=1,ka.vf=1):g||1!=k?k=0:(k=0,ka.vf=-1);break;case a.CT_LEVEL:g=c(ka);ka.Tv!=g?(k=1,ka.Tv=g):k=0;break;case a.CT_CHANGE:for(var g=ka.yg,ka=ka.XE,r=0;r<g.length;r++){var x=
g[r].value;k||x==ka[r]||(k=1);ka[r]=x}break;default:I.Z("Wrong sensor manifold type: "+ka.type)}if(k&&(g=m==M?null:m,sa=!1,X.callback(g,X.id,k,X.nB),sa)){B=-1;break}}for(B=0;B<G.length;B++)for(m=G[B],d=m.Yh,e=0;e<d.length;e++)for(X=d[e],m=X.yg,X=0;X<m.length;X++)switch(k=m[X],k.type){case 30:b(k,0);break;case 40:b(k,0);break;case 60:b(k,0);break;case 70:b(k,0);break;case 75:b(k,0);break;case 130:b(k,0)}S=0;oa=ha;fa=N;ea.set(ba);qa.set(E);W=V;ma++};a.create_custom_sensor=function(a){var c=d(10);b(c,
a);return c};a.create_keyboard_sensor=function(a){var b=d(20);b.key=a;return b};a.create_collision_sensor=function(a,c,h){if(!a||!L.R(a))return x.error("Wrong collision object"),null;var f=d(80);f.Mp=a;f.Ya=c;f.Fe=h;f.aa={coll_obj:null,coll_pos:h?new Float32Array(3):null,coll_norm:h?new Float32Array(3):null,coll_dist:0};f.Lp=function(a,c,h,X,d){b(f,a);a=f.aa;a.coll_obj=c;f.Fe&&(a.coll_pos.set(h),a.coll_norm.set(X),a.coll_dist=d)};f.he=!0;return f};a.create_collision_impulse_sensor=function(a){if(!a||
!a.o)return x.error("Wrong collision impulse object"),null;var c=d(90);c.Kp=a;c.eu=function(a){b(c,a)};c.he=!0;return c};a.create_ray_sensor=function(a,c,h,f,B,e,k){var X=d(100);X.Gf=a;X.from=c;X.to=h;X.Ya=f;X.Av=B;X.Fe=e;X.pn=k;X.aa={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Cl:0};X.Uw=function(a,c,h,f,d,B){X.Av?b(X,-1==c?0:1):b(X,c);X.aa.hit_fract=c;X.aa.obj_hit=h;X.aa.hit_time=f;X.Fe&&(X.aa.hit_pos.set(d),X.aa.hit_norm.set(B))};X.he=!0;return X};
a.create_mouse_click_sensor=function(){return d(50)};a.create_mouse_wheel_sensor=function(){return d(30)};a.create_mouse_move_sensor=function(a){var b=d(40);b.axis=a||"XY";b.aa="XY"==b.axis?new Float32Array(2):0;return b};a.create_touch_move_sensor=function(a){var b=d(60);b.axis=a||"XY";b.aa=0;return b};a.create_touch_zoom_sensor=function(){var a=d(70);a.aa=0;return a};a.create_touch_rotate_sensor=function(){var a=d(75);a.aa=0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return x.error("Wrong collision object"),
null;var h=d(110);h.Gf=a;var f=w.get_trans_view(a.g.i);a=w.get_quat_view(a.g.i);h.Rw=new Float32Array(4);h.Vj=new Float32Array(f);h.ao=new Float32Array(a);h.Am=0;h.zm=0;h.threshold=b||.1;h.dx=c||.1;h.Cd=0;h.aa=new Float32Array([0,0]);return h};a.create_vertical_velocity_sensor=function(a,b){if(!a)return x.error("Wrong collision object"),null;var c=d(120);c.Gf=a;var h=w.get_trans_view(a.g.i),f=w.get_quat_view(a.g.i);c.Vj=new Float32Array(h);c.ao=new Float32Array(f);c.Bm=0;c.threshold=b||1;c.Cd=0;c.aa=
0;return c};a.create_timer_sensor=function(a,b){var c=d(130);c.sd=a;c.repeat=b;c.he=!0;return c};a.reset_timer_sensor=function(a,b,c,h){a=a||M;a=a.pe;if(!a||!a[b])return x.error("reset_timer_sensor(): wrong object"),null;b=a[b].yg[c];if(!b)return x.error("reset_timer_sensor(): sensor not found"),null;b.Cd=A.get_timeline();b.sd=h};a.create_elapsed_sensor=function(){var a=d(140);a.Cd=0;return a};a.create_gyro_delta_sensor=function(){var a=d(170);a.aa=new Float32Array(3);return a};a.create_gyro_angles_sensor=
function(){var a=d(180);a.aa=new Float32Array(3);return a};a.create_gyro_quat_sensor=function(){var a=d(190);a.aa=P.create();return a};a.create_timeline_sensor=function(){return d(150)};a.create_selection_sensor=function(a,b){var c=d(160);c.Gf=a;c.kp=b;return c};a.create_callback_sensor=function(a,c){var h=d(200);h.callback=a;b(h,c);return h};a.EG=b;a.get_sensor_value=function(a,b,c){a=a||M;a=a.pe;if(!a||!a[b])return x.error("get_sensor_value(): wrong object"),null;b=a[b].yg[c];return b?b.value:(x.error("get_sensor_value(): sensor not found"),
null)};a.get_sensor_payload=function(a,b,c){a=a||M;a=a.pe;if(!a||!a[b])return x.error("get_sensor_payload(): wrong object"),null;b=a[b].yg[c];return b?b.aa:(x.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){G=[];M={};F.length=0;R.length=0};a.check_sensor_manifold=function(a,b){a=a||M;if(!a.pe)return!1;if(b&&a.pe[b])return!0;if(!b)for(var c in a.pe)return!0;return!1};a.create_sensor_manifold=function(a,b,c,h,f,d,B){a=a||M;a.Yh=a.Yh||[];a.pe=a.pe||{};var X=a.pe,e=a.Yh;X[b]&&
n(a,b);c={id:b,type:c,yg:h.slice(0),sF:f,FG:Array(h.length),callback:d,nB:B,vf:-1,Tv:0,XE:Array(h.length),$x:-1};X[b]=c;e.push(c);-1==G.indexOf(a)&&G.push(a);h=c.yg;for(a=0;a<h.length;a++){X=b=h[a];if(X.he){switch(X.type){case 80:L.append_collision_test(X.Mp,X.Ya,X.Lp,X.Fe);break;case 90:L.apply_collision_impulse_test(X.Kp,X.eu);break;case 100:X.Cl=L.append_ray_test(X.Gf,X.from,X.to,X.Ya,X.Uw,!1,!1,X.Fe,X.pn);X.aa.Cl=X.Cl;break;case 130:X.Cd=A.get_timeline(),0>X.sd&&(X.sd=-X.sd)}X.he=!1}X=F.indexOf(b);
-1==X?(F.push(b),R.push([c])):R[X].push(c)}sa=!0};a.wu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.xu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.remove_sensor_manifold=n;a.reset=function(){for(var a=0;a<G.length;a++){var b=G[a],c=b.pe,b=b.Yh,h;for(h in c)delete c[h];b.length=0}for(a=0;a<F.length;a++)g(F[a]);G.length=0;F.length=0;R.length=0};a.debug=function(){x.log(String(G.length)+" objects with manifolds",G);x.log(String(F.length)+
" sensors",F);for(var a=[],b=[],c=0;c<F.length;c++){var h=F[c];80==h.type&&a.push(h);100==h.type&&b.push(h)}x.log(String(a.length)+" collision sensors",a);x.log(String(b.length)+" ray sensors",b)};a.register_keyboard_events=function(a,b){a.addEventListener("keydown",q,!1);a.addEventListener("keyup",l,!1);ga=b};a.register_mouse_events=function(a,b,c){if(c)var h=window;else h=a,h.addEventListener("mouseout",k,!1);a.addEventListener("mousedown",t,!1);h.addEventListener("mousemove",H,!1);h.addEventListener("mouseup",
e,!1);Z=b;ua=c};a.register_wheel_events=function(a,b){a.addEventListener("mousewheel",r,!1);a.addEventListener("DOMMouseScroll",r,!1);Y=b};a.register_touch_events=function(a,b){a.addEventListener("touchstart",u,!1);a.addEventListener("touchend",D,!1);a.addEventListener("touchmove",z,!1);document.addEventListener("touchstart",function(){});Fa=b};a.register_device_orientation=function(){window.DeviceOrientationEvent&&B.gyro_use&&window.addEventListener("deviceorientation",y,!1)};a.unregister_keyboard_events=
function(a){a.removeEventListener("keydown",q,!1);a.removeEventListener("keyup",l,!1)};a.unregister_mouse_events=function(a){a.removeEventListener("mousedown",t,!1);a.removeEventListener("mousemove",H,!1);a.removeEventListener("mouseout",k,!1);a.removeEventListener("mouseup",e,!1)};a.unregister_wheel_events=function(a){a.removeEventListener("mousewheel",r,!1);a.removeEventListener("DOMMouseScroll",r,!1)};a.unregister_touch_events=function(a){a.removeEventListener("touchstart",u,!1);a.removeEventListener("touchmove",
z,!1);document.removeEventListener("touchstart",function(){})};a.unregister_device_orientation=function(){window.DeviceOrientationEvent&&B.gyro_use&&window.removeEventListener("deviceorientation",y,!1)};a.aK=function(a){ca=a};a.bK=function(a){ja=a};a.dK=function(a){da=a};a.cK=function(a){K=a}};b4w.module.__curve=function(a,p){function d(a,b,c,d,g){var l=d.length;g||(g=new Float32Array(l));for(var n=l+a,q=new Float32Array(n),y=1;y<=n-1;y++)q[y-1]=b>=c[y-1]&&b<c[y+1-1]?1:0;for(var C=2;C<=a;C++)for(y=1;y<=n-C;y++)q[y-1]=(0!=q[y-1]?(b-c[y-1])*q[y-1]/(c[y+C-1-1]-c[y-1]):0)+(0!=q[y+1-1]?(c[y+C-1]-b)*q[y+1-1]/(c[y+C-1]-c[y+1-1]):0);b==c[n-1]&&(q[l-1]=1);a=0;for(y=1;y<=l;y++)a+=q[y-1]*d[y-1];for(y=1;y<=l;y++)g[y-1]=0!=a?q[y-1]*d[y-1]/a:0;return g}function b(a){a=a.yn;return a[a.length-1]}function c(a){a=
a.su;return a[a.length-1]}function n(a,b,c,d,r,l,q,D){var y=a+(b-a)/2,C=g(y,d,r,l,q)-c;D=D?D:.01;return Math.abs(C)<D?y:0<C?n(a,y,c,d,r,l,q,D):n(y,b,c,d,r,l,q,D)}function g(a,b,c,d,g){var l=1-a;return b*l*l*l+3*c*l*l*a+3*d*l*a*a+g*a*a*a}p("__print");var q=p("__util"),l=p("__vec3");a.rC=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var k=a.order_u;b.ng=k;a=a.points;var g=a.length/5,l=[],n=g+k,g=g+2;l[0]=0;for(var q=2;q<=n;q++)l[q-1]=q>k&&q<g?l[q-
2]+1:l[q-2];b.yn=l;if("2D"==c.dimensions)b.fg=!1;else if("3D"==c.dimensions)b.fg=!0;else throw"Wrong curve dimensions";k=[];l=[];for(c=0;c<a.length;c+=5)k.push(a[c]),k.push(a[c+1]),k.push(a[c+2]),b.fg&&k.push(a[c+3]),l.push(a[c+4]);b.Rp=k;b.Zs=l;a=[];for(var c=b.Rp,k=b.fg?4:3,l=b.Zs,n=b.yn,g=b.ng,q=c.length/k,y=q+g,C=0,v=n[y-1]/999,f=0;1E3>f;f++){5E-6>n[y-1]-C&&(C=n[y-1]);for(var m=d(g,C,n,l),h=0;h<k;h++)for(var x=a[k*f+h]=0;x<q;x++)a[k*f+h]+=m[x]*c[k*x+h];C+=v}k=b.fg?4:3;l=new Float32Array(1E3);
l[0]=0;for(c=1;1E3>c;c+=1)n=a[(c-1)*k],g=a[(c-1)*k+1],q=a[(c-1)*k+2],y=a[c*k],C=a[c*k+1],v=a[c*k+2],l[c]=l[c-1]+Math.sqrt((y-n)*(y-n)+(C-g)*(C-g)+(v-q)*(v-q));b.su=l;return b};a.EH=function(a,c,g){g||(g=[]);var k=c,r=Math.max(k,0);c=r=Math.min(k,b(a));var k=a.Rp,r=a.fg?4:3,l=a.Zs,n=a.yn,q=a.ng;a=k.length/r;var y=a+q;5E-6>n[y-1]-c&&(c=n[y-1]);y=new Float32Array(a);d(q,c,n,l,y);for(c=0;c<r;c++)for(l=g[c]=0;l<a;l++)g[c]+=y[l]*k[r*l+c]};a.BH=function(a,b,c){c||(c=[]);var d=a.Rp,g=a.fg?4:3,l=a.Zs,n=a.yn,
q=a.ng;a=d.length/g;var y=a+q;5E-6>n[y-1]-b&&(b=n[y-1]);var y=new Float32Array(a),C=b;b=y;var v=l.length;b||(b=new Float32Array(v));var f=new Float32Array(v),m=new Float32Array(v),h=f,x=m;h||(h=new Float32Array(v));x||(x=new Float32Array(v));for(var L=v+q,P=new Float32Array(L),A=new Float32Array(L),w=1;w<=L-1;w++)P[w-1]=C>=n[w-1]&&C<n[w+1-1]?1:0;C==n[L-1]&&(P[v-1]=1);for(var I=2;I<=q;I++)for(w=1;w<=L-I;w++){var p=0!=P[w-1]?P[w-1]/(n[w+I-1-1]-n[w-1]):0,O=0!=P[w+1-1]?-P[w+1-1]/(n[w+I-1]-n[w+1-1]):0,
B=0!=A[w-1]?(C-n[w-1])*A[w-1]/(n[w+I-1-1]-n[w-1]):0,G=0!=A[w+1-1]?(n[w+I-1]-C)*A[w+1-1]/(n[w+I-1]-n[w+1-1]):0;P[w-1]=(0!=P[w-1]?(C-n[w-1])*P[w-1]/(n[w+I-1-1]-n[w-1]):0)+(0!=P[w+1-1]?(n[w+I-1]-C)*P[w+1-1]/(n[w+I-1]-n[w+1-1]):0);A[w-1]=p+O+B+G}for(w=1;w<=v;w++)h[w-1]=P[w-1],x[w-1]=A[w-1];n=0;for(q=1;q<=v;q++)n+=f[q-1]*l[q-1];C=0;for(q=1;q<=v;q++)C+=m[q-1]*l[q-1];for(q=1;q<=v;q++)b[q-1]=0!=n?m[q-1]*l[q-1]/n+f[q-1]*l[q-1]*C/(n*n):0;for(l=0;l<g;l++)for(n=c[l]=0;n<a;n++)c[l]+=y[n]*d[g*n+l]};a.cM=b;a.DH=
c;a.CH=function(a,d){if(0>=d)return 0;var g=b(a);if(d>=c(a))return g;var k=a.su,r=q.Dm(k,d,0,k.length-1);return g*(r+(d-k[r])/(k[r+1]-k[r]))/1E3};a.Dn=function(a,b,c,d,g){return c+(g-d)*(a-c)/(b-d)};a.Yv=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.$A=function(a,b,c,d,r){return g(n(0,1,a,b[0],c[0],d[0],r[0],.001),b[1],c[1],d[1],r[1])};a.Cp=function(a,b,c,d,g){var n=new Float32Array(3),q=new Float32Array(3),p=new Float32Array(3),y=new Float32Array(3),C=new Float32Array(3),
v=new Float32Array(3);l.copy(a[1],q);null==b?(l.copy(c[1],p),n[0]=2*q[0]-p[0],n[1]=2*q[1]-p[1]):l.copy(b[1],n);null==c?(l.copy(b[1],n),p[0]=2*q[0]-n[0],p[1]=2*q[1]-n[1]):l.copy(c[1],p);l.subtract(q,n,y);l.subtract(p,q,C);b=l.length(y);c=l.length(C);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==g)v[0]=C[0]/c+y[0]/b,v[1]=C[1]/c+y[1]/b,n=2.5614*l.length(v),0!=n&&("AUTO"==d&&l.scaleAndAdd(q,v,-(b/n),a[0]),"AUTO"==g&&l.scaleAndAdd(q,v,c/n,a[2]));"VECTOR"==d&&l.scaleAndAdd(q,y,-1/3,a[0]);"VECTOR"==g&&l.scaleAndAdd(q,
C,1/3,a[2])};a.PB=function(a,b,c,d){var g=[],l=[],n,q,y;g[0]=a[0]-b[0];g[1]=a[1]-b[1];l[0]=d[0]-c[0];l[1]=d[1]-c[1];y=d[0]-a[0];n=Math.abs(g[0]);q=Math.abs(l[0]);0!=n+q&&n+q>y&&(n=y/(n+q),b[0]=a[0]-n*g[0],b[1]=a[1]-n*g[1],c[0]=d[0]-n*l[0],c[1]=d[1]-n*l[1])}};b4w.module.__dds=function(a,p){function d(a,b,c,d){var g=new Uint16Array(4),e=new Uint16Array(c*d),l=0,n=0,q=0,f=n=l=0,m=0,h=0,x=0,L=c/4;d/=4;for(var t=0;t<d;t++)for(var A=0;A<L;A++)q=b+4*(t*L+A),g[0]=a[q],g[1]=a[q+1],l=g[0]&31,n=g[0]&2016,f=g[0]&63488,m=g[1]&31,h=g[1]&2016,x=g[1]&63488,g[2]=5*l+3*m>>3|5*n+3*h>>3&2016|5*f+3*x>>3&63488,g[3]=5*m+3*l>>3|5*h+3*n>>3&2016|5*x+3*f>>3&63488,l=a[q+2],n=4*t*c+4*A,e[n]=g[l&3],e[n+1]=g[l>>2&3],e[n+2]=g[l>>4&3],e[n+3]=g[l>>6&3],n+=c,e[n]=g[l>>8&3],e[n+1]=g[l>>
10&3],e[n+2]=g[l>>12&3],e[n+3]=g[l>>14],l=a[q+3],n+=c,e[n]=g[l&3],e[n+1]=g[l>>2&3],e[n+2]=g[l>>4&3],e[n+3]=g[l>>6&3],n+=c,e[n]=g[l>>8&3],e[n+1]=g[l>>10&3],e[n+2]=g[l>>12&3],e[n+3]=g[l>>14];return e}function b(a,b,c,n){var z=new Int32Array(c,0,31),p,y,C,v,f,m;if(542327876!=z[0])return q.error("Invalid magic number in DDS header"),0;if(!z[20]&4)return q.error("Unsupported format, must contain a FourCC code"),0;p=z[21];switch(p){case l:y=8;C=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case t:y=16;C=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case e:y=16;C=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return q.error("Unsupported FourCC code:",g(p)),null}m=1;z[2]&131072&&!1!==n&&(m=Math.max(1,z[7]));v=z[4];f=z[3];z=z[1]+4;if(b)for(p=0;p<m;++p)n=Math.max(4,v)/4*Math.max(4,f)/4*y,b=new Uint8Array(c,z,n),a.compressedTexImage2D(a.TEXTURE_2D,p,C,v,f,0,b),z+=n,v=Math.max(.5*v,1),f=Math.max(.5*f,1);else if(p==l)Math.max(4,v),Math.max(4,f),b=new Uint16Array(c),c=d(b,z/2,v,f),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,v,f,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,c),n&&a.generateMipmap(a.TEXTURE_2D);else return q.error("No manual decoder for",g(p),"and no native support"),0;return m}function c(a,c,d,g,e,l){var n=new XMLHttpRequest;n.open("GET",d,!0);n.responseType="arraybuffer";n.onload=function(){if(200==n.status){a.bindTexture(a.TEXTURE_2D,g);var d=b(a,c,n.response,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}l&&
l(g)};n.send(null);return g}function n(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var q=p("__print"),l=n("DXT1"),t=n("DXT3"),e=n("DXT5");a.DK=d;a.GI=b;a.lv=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.$D=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case l:b=6;break;case t:case e:b=4;break;default:q.error("Unsupported FourCC code:",g(a))}return b};
a.EL=c;a.DL=function(a,b,d,g){var e=a.createTexture();c(a,b,d,e,!0,g);return e}};b4w.module.__debug=function(a,p){function d(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function b(a){for(var b=g.hn(),c=a.Vm,d=0;d<c.length;d++){var f=c[d],m=b.PD(f,b.PJ),k=u.getParameter(b.LJ);m&&!k&&(f=b.PD(f,b.QJ)/1E6,a.Zf=a.Zf?e.smooth(f,a.Zf,1,10):f,c.splice(d,1),d--)}}function c(a,b){typeof a!=typeof b&&e.Z("Structure assertion failed: incompatible types");if(null!==a&&null!==b&&"object"==typeof a){for(var c in a)c in b||e.Z("Structure assertion failed: missing key in the first object: "+
c);for(c in b)c in a||e.Z("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&e.Z("Structure assertion failed: incompatible types for key "+c)}}var n=p("__config"),g=p("__extensions"),q=p("__print"),l=p("__textures"),t=p("__time"),e=p("__util"),H=p("__graph"),k=n.p,r={},u=null,z=!1,D={},y=[],C=-1,v=null,f=!1;a.WM_NONE=0;a.WM_OPAQUE_WIREFRAME=1;a.WM_TRANSPARENT_WIREFRAME=2;a.WM_FRONT_BACK_VIEW=3;a.WM_DEBUG_SPHERES=4;a.yd=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),
c;for(c in b){var d=b[c];d in a&&(r[a[d]]=d)}u=a};a.Hp=function(a){if(z){var b=u.getError();b!=u.NO_ERROR&&(b in r?e.Z("GL Error: "+b+", gl."+r[b]+" ("+a+")"):e.Z("Unknown GL error: "+b+" ("+a+")"))}};a.vB=function(){if(z)switch(u.checkFramebufferStatus(u.FRAMEBUFFER)){case u.FRAMEBUFFER_COMPLETE:break;case u.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:q.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case u.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:q.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
break;case u.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:q.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case u.FRAMEBUFFER_UNSUPPORTED:q.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:q.error("FRAMEBUFFER CHECK FAILED")}};a.zB=function(){if(-1!=C)return C;u.bindFramebuffer(u.FRAMEBUFFER,u.createFramebuffer());var a=l.Ek("DEBUG",l.pi);l.resize(a,1,1);u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,a.Gb,a.Qa,0);u.checkFramebufferStatus(u.FRAMEBUFFER)!=
u.FRAMEBUFFER_COMPLETE?(C=!0,q.warn("depth-only issue was found")):C=!1;u.bindFramebuffer(u.FRAMEBUFFER,null);return C};a.BB=function(a,b,c){if(z&&!u.getShaderParameter(a,u.COMPILE_STATUS)){var f=k.zt&&g.Cq();f&&(c=f.getTranslatedShaderSource(a));c=d(c);q.error("shader compilation failed:\n"+c+"\n"+u.getShaderInfoLog(a)+" ("+b+")");throw"Engine failed: see above for error messages";}};a.CB=function(a,b,c,f,e,m){if(z&&!u.getProgramParameter(a,u.LINK_STATUS)){var l=k.zt&&g.Cq();l&&(e=l.getTranslatedShaderSource(c),
m=l.getTranslatedShaderSource(f));e=d(e);m=d(m);q.error("shader linking failed:\n"+e+"\n\n\n"+m+"\n"+u.getProgramInfoLog(a)+" ("+b+")");throw"Engine failed: see above for error messages";}};a.set_check_gl_errors=function(a){z=a};a.Or=function(a){if(k.show_hud_debug_info||"PERFORMANCE"==a.type){var b=g.hn();if(b){var c=b.tK();a.Vm.push(c);b.iK(b.gA,c)}else a.Vm.push(performance.now())}};a.Pr=function(a){if(k.show_hud_debug_info||"PERFORMANCE"==a.type){var c=g.hn();c?(c.EK(c.gA),b(a)):(c=performance.now()-
a.Vm.pop(),a.Zf=a.Zf?e.smooth(c,a.Zf,1,10):c)}};a.hG=b;a.FK=function(a){D[a]=a in D?D[a]+1:1};a.update=function(){for(var a in D)q.log(a,D[a]),D[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(e.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}y.push(a)};a.msg=function(){for(var a=1,b=0;b<y.length;b++){var c=y[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],e.is_vector(a))for(var d=
0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);y.push(c)};var m=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),f=0;f<y.length;f++){var g=y[f];a=g[0];if(!(a<d)){var e=String(g[1]);c[e]||(c[e]=m[b++%m.length]);a=["%c"+(a/1E3).toFixed(6),c[e],e];for(e=2;e<g.length;e++)a.push(g[e]);q.log.apply(this,a)}}y.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b=
{},c=Math.max(0,performance.now()-1E3*a),d=0;d<y.length;d++){var f=y[d];a=f[0];if(!(a<c))for(var g=2;g<f.length;g++){var e=String(f[1]);3<f.length&&(e+="_"+String(g-2));b[e]||(b[e]=e+"\n");b[e]+=String(a)+" "+f[g]+"\n"}}a="";for(e in b)a+=b[e]+"\n\n";q.log(a);y.splice(0)};a.nK=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&
b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(e.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.YJ=function(a,b){a.constructor!=b&&e.Z("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.ZJ=c;a.$J=
function(a){f?c(a,v):f=!0;v=a};a.fake_load=function(a,b,c,d,f){(a=a||null)||e.Z("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&e.Z("Max percentage must be less than 100");0>c&&e.Z("Min percentage must be greater than 0");c>d&&e.Z("Max percentage must be greater than min percentage");var g=t.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(t.clear_animation(g),f&&f())})};a.JL=function(a){return H.GC(a,function(a,b){return b.type},function(b,c,d){b=H.Da(a,b);c=H.Da(a,c);return b.Aa[d[0]].identifier+
"\n==>\n"+c.J[d[1]].identifier})}};b4w.module.__extensions=function(a,p){function d(a){if(a in q)return q[a];var b=g.getExtension(a)||null;q[a]=b;c.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}var b=p("__config"),c=p("__print"),n=b.p,g=null,q={};a.yd=function(a){g=a};a.jv=function(){return d("WEBGL_compressed_texture_s3tc")||d("WEBKIT_WEBGL_compressed_texture_s3tc")||d("MOZ_WEBGL_compressed_texture_s3tc")};a.bE=function(){return n.Gc?{}:d("WEBGL_depth_texture")||d("WEBKIT_WEBGL_depth_texture")||d("MOZ_WEBGL_depth_texture")};
a.TD=function(){return d("EXT_texture_filter_anisotropic")||d("WEBKIT_EXT_texture_filter_anisotropic")||d("MOZ_EXT_texture_filter_anisotropic")};a.Cq=function(){return d("WEBGL_debug_shaders")};a.iv=function(){return d("WEBGL_debug_renderer_info")};a.cv=function(){return n.Gc?{}:d("OES_element_index_uint")};a.oE=function(){return n.Gc?null:d("OES_standard_derivatives")};a.hn=function(){return d("EXT_disjoint_timer_query")};a.cleanup=function(){q={}}};b4w.module.__graph=function(a,p){function d(a,c,d){d||(d=null);if(b(a,c))throw"Graph already has node with given ID";a.G.push(c,d)}function b(a,b){for(var c=a.G,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function c(a,c,d,f){f||(f=null);if(b(a,c)&&b(a,d))a.ga.push(c,d,f);else throw"Wrong node IDs";}function n(a,c){if(!b(a,c))throw"Node not found";for(var d=a.G,f=0;f<d.length;f+=2)d[f]==c&&(d.splice(f,2),f-=2)}function g(a,b,c,d){if(!P(a,b,c))throw"Edge not found";a=a.ga;for(var f=0,h=0;h<a.length;h+=
3)if(a[h]==b&&a[h+1]==c){if(-1==d)a.splice(h,3);else{if(d==f){a.splice(h,3);break}f++}h-=3}}function q(a){a=a.G;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function l(a,b){for(var c=a.G,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function t(a){var b=[],c={};e(a,c);for(var d=a.G,f=0;f<d.length;f+=2)0==h(a,d[f])&&H(a,d[f],c,b);return{G:b,ga:a.ga.slice(0)}}function e(a,b){for(var c=a.G,d=0;d<c.length;d+=2)b[c[d]]=!1}function H(a,b,c,d){if(!c[b]){c[b]=!0;for(var h=0;h<m(a,
b);h++)H(a,x(a,b,h),c,d);d.unshift(b,f(a,b))}}function k(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var f=0;f<m(a,b);f++){var g=x(a,b,f);k(a,g,c,d)}if(20==d||30==d)for(f=0;f<h(a,b);f++)g=L(a,b,f),k(a,g,c,d)}}function r(a){for(var c=a.ga,d=0;d<c.length;d+=3){var f=c[d+1];b(a,c[d])&&b(a,f)||(c.splice(d,3),d-=3)}}function u(a){for(var b=[],c=a.G,d=0;d<c.length;d+=2){var f=c[d];m(a,f)||b.push(f)}return b}function z(a){var b=a.G;a=a.ga;for(var c=[],d=[],f=[],h=0;h<b.length;h++)f[b[2*h]]=h,c.push(h,
b[2*h+1]);for(h=0;h<a.length;h+=3)d.push(f[a[h]],f[a[h+1]],a[h+2]);return{G:c,ga:d}}function D(a,b,c){if(c.Ge==c.lg){for(var d=0,f=0;d<c.lg;d++)-1!=c.kf[d]&&(a[f]=d,b[f]=c.kf[d],f++);return!0}if(c.lg>c.oj||c.Cg>c.Dg||c.Rj>c.Tj||c.Qj>c.Sj)return!1;for(var f=d=-1,g=!1;!g&&y(c,O,d,f);)if(d=O[0],f=O[1],C(c,d,f)){var e;e=c;g={};g.$k=e.$k;g.al=e.al;g.wr=e.wr;g.Zm=e.Zm;g.lg=e.lg;g.oj=e.oj;g.ng=e.ng;g.Ge=g.On=e.Ge;g.Qj=e.Qj;g.Rj=e.Rj;g.Cg=e.Cg;g.Sj=e.Sj;g.Tj=e.Tj;g.Dg=e.Dg;g.hk=-1;g.kf=e.kf;g.kh=e.kh;g.yh=
e.yh;g.zh=e.zh;g.Oh=e.Oh;g.Ph=e.Ph;g.lo=e.lo;e.lo[0]+=1;var g=e=g,k=d,l=f,r=g.$k,w=g.al,n=g.lg,A=g.oj,u=g.kf,q=g.kh,t=g.yh,P=g.zh,I=g.Oh,J=g.Ph;v(k<n);v(l<A);v(g.Ge<n);v(g.Ge<A);n=++g.Ge;g.hk=k;t[k]||(t[k]=n,g.Qj++,I[k]&&g.Cg++);I[k]||(I[k]=n,g.Rj++,t[k]&&g.Cg++);P[l]||(P[l]=n,g.Sj++,J[l]&&g.Dg++);J[l]||(J[l]=n,g.Tj++,P[l]&&g.Dg++);u[k]=l;q[l]=k;for(u=0;u<h(r,k);u++)q=L(r,k,u),t[q]||(t[q]=n,g.Qj++,I[q]&&g.Cg++);for(u=0;u<m(r,k);u++)q=x(r,k,u),I[q]||(I[q]=n,g.Rj++,t[q]&&g.Cg++);for(u=0;u<h(w,l);u++)q=
L(w,l,u),P[q]||(P[q]=n,g.Sj++,J[q]&&g.Dg++);for(u=0;u<m(w,l);u++)q=x(w,l,u),J[q]||(J[q]=n,g.Tj++,P[q]&&g.Dg++);g=D(a,b,e);v(1>=e.Ge-e.On);v(-1!=e.hk);q=e.$k;k=e.al;l=e.Ge;r=e.hk;w=e.kf;t=e.kh;n=e.yh;P=e.zh;A=e.Oh;I=e.Ph;if(e.On<l){n[r]==l&&(n[r]=0);for(J=0;J<h(q,r);J++)u=L(q,r,J),n[u]==l&&(n[u]=0);A[r]==l&&(A[r]=0);for(J=0;J<m(q,r);J++)u=x(q,r,J),A[u]==l&&(A[u]=0);q=w[r];P[q]==l&&(P[q]=0);for(J=0;J<h(k,q);J++)u=L(k,q,J),P[u]==l&&(P[u]=0);I[q]==l&&(I[q]=0);for(J=0;J<m(k,q);J++)u=x(k,q,J),I[u]==l&&
(I[u]=0);w[r]=-1;t[q]=-1;e.Ge=e.On;e.hk=-1}}return g}function y(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var f=a.Cg,h=a.Dg,g=a.Rj,e=a.Tj,m=a.Qj,k=a.Sj,l=a.Ge,r=a.lg,x=a.oj,w=a.kf,n=a.kh,L=a.yh,A=a.zh,u=a.Oh,q=a.Ph;if(f>l&&h>l)for(;c<r&&(-1!=w[c]||0==u[c]||0==L[c]);)c++,d=0;else if(g>l&&e>l)for(;c<r&&(-1!=w[c]||0==u[c]);)c++,d=0;else if(m>l&&k>l)for(;c<r&&(-1!=w[c]||0==L[c]);)c++,d=0;else if(0==c&&0!=a.ng){for(L=0;L<r&&-1!=w[c=a.ng[L]];)L++;L==r&&(c=r)}else for(;c<r&&-1!=w[c];)c++,d=0;if(f>l&&h>l)for(;d<
x&&(-1!=n[d]||0==q[d]||0==A[d]);)d++;else if(g>l&&e>l)for(;d<x&&(-1!=n[d]||0==q[d]);)d++;else if(m>l&&k>l)for(;d<x&&(-1!=n[d]||0==A[d]);)d++;else for(;d<x&&-1!=n[d];)d++;return c<r&&d<x?(b[0]=c,b[1]=d,!0):!1}function C(a,b,c){var d=a.$k,g=a.al,e=a.oj,k=a.kf,l=a.kh,r=a.yh,w=a.zh,n=a.Oh,u=a.Ph;v(b<a.lg);v(c<e);v(-1==k[b]);v(-1==l[c]);if(!(0,a.wr)(f(d,b),f(g,c)))return!1;for(var q=e=0,t=0,I=0,z=0,C=0,y=0;y<m(d,b);y++){var J=x(d,b,y);if(-1!=k[J]){var V=k[J];if(!P(g,c,V)||!A(a.Zm,d,b,J,g,c,V))return!1}else r[J]&&
t++,n[J]&&e++,r[J]||n[J]||z++}for(y=0;y<h(d,b);y++)if(J=L(d,b,y),-1!=k[J]){if(V=k[J],!P(g,V,c)||!A(a.Zm,d,J,b,g,V,c))return!1}else r[J]&&t++,n[J]&&e++,r[J]||n[J]||z++;for(y=0;y<m(g,c);y++)if(V=x(g,c,y),-1!=l[V]){if(J=l[V],!P(d,b,J))return!1}else w[V]&&I++,u[V]&&q++,w[V]||u[V]||C++;for(y=0;y<h(g,c);y++)if(V=L(g,c,y),-1!=l[V]){if(J=l[V],!P(d,J,b))return!1}else w[V]&&I++,u[V]&&q++,w[V]||u[V]||C++;return t<=I&&e<=q&&z<=C}function v(a){if(!a)throw"Assertion failed";}function f(a,b){for(var c=a.G,d=0;d<
c.length;d+=2)if(c[d]==b)return c[d+1];return null}function m(a,b){for(var c=a.ga,d=0,f=0;f<c.length;f+=3)c[f]==b&&d++;return d}function h(a,b){for(var c=a.ga,d=0,f=0;f<c.length;f+=3)c[f+1]==b&&d++;return d}function x(a,b,c){a=a.ga;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==b){if(d==c)return a[f+1];d++}return-1}function L(a,b,c){a=a.ga;for(var d=0,f=0;f<a.length;f+=3)if(a[f+1]==b){if(d==c)return a[f];d++}return-1}function P(a,b,c){a=a.ga;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}
function A(a,b,c,d,f,h,g){for(var e=w(b,c,d),m=w(f,h,g),k=0;k<e;k++){for(var l=!1,r=0;r<m;r++)if(a(I(b,c,d,k),I(f,h,g,r))){l=!0;break}if(!l)return!1}return!0}function w(a,b,c){var d=0;a=a.ga;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&d++;return d}function I(a,b,c,d){a=a.ga;for(var f=0,h=0;h<a.length;h+=3)if(a[h]==b&&a[h+1]==c){if(f==d)return a[h+2];f++}return null}p("__print");var T=p("__util"),O=[-1,-1];a.it=-1;a.KJ=10;a.hm=20;a.SJ=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<
a.length;d++){var f=a[d];switch(f.length){case 2:b.push(f[0],f[1]);break;case 3:c.push(f[0],f[1],f[2]);break;default:throw"Wrong graph constructor params";}}return{G:b,ga:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.G.length),f=0;f<a.G.length;f+=2)d[f]=a.G[f],d[f+1]=b(a.G[f+1]);else d=T.za(a.G);if(c)for(b=Array(a.ga.length),f=0;f<a.ga.length;f+=3)b[f]=a.ga[f],b[f+1]=a.ga[f+1],b[f+2]=c(a.ga[f+2]);else b=T.za(a.ga);return a={G:d,ga:b}};a.vK=function(a,b){for(var c=[],d=[],f=0;f<a.length;f++)c.push(a[f][0],
a[f][1]);for(f=0;f<b.length;f++)d.push(b[f][0],b[f][1],b[f][2]);return{G:c,ga:d}};a.si=d;a.lL=b;a.rc=c;a.Re=n;a.Wh=g;a.co=function(a,b,c,d){if(!P(a,b,c))throw"Edge not found";a=a.ga;for(var f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c&&a[f+2][0]==d[0]&&a[f+2][1]==d[1]){a.splice(f,3);break}};a.v=function(a,b){if(-1==l(a,b)){var c=q(a);d(a,c,b);return c}throw"Non-unique attribute";};a.sG=function(a,b,c,d,f){a=a.ga;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&a[h+2]==d&&(a[h+2]=f)};a.FA=function(a,b,
f){var h;f=f||[];h=h||[];for(var g={},e=0;e<a.G.length;e+=2){var m=a.G[e],k=a.G[e+1],l=q(b);d(b,l,k);g[m]=l}for(e=0;e<a.ga.length;e+=3)k=g[a.ga[e]],l=g[a.ga[e+1]],m=a.ga[e+2],c(b,k,l,m);for(e=0;e<f.length;e+=3)k=g[f[e]],a=f[e+1],m=f[e+2],c(b,k,a,m);for(e=0;e<h.length;e+=3)f=h[e],l=g[h[e+1]],m=h[e+2],c(b,f,l,m)};a.bl=q;a.Oe=l;a.n=function(a,b,d,f){b=l(a,b);d=l(a,d);if(-1!=b&&-1!=d)c(a,b,d,f);else throw"Attributes not found";};a.ba=function(a,b){for(var c=a.G,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};
a.re=function(a,b){for(var c=a.ga,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.se=function(a,b,c){for(var d=a.ga,h=0;h<d.length;h+=3)if(d[h+1]==b){var g=d[h];if(c(g,f(a,g),d[h+2]))break}};a.Fg=function(a,b,c){for(var d=a.ga,h=0;h<d.length;h+=3)if(d[h]==b){var g=d[h+1];if(c(g,f(a,g),d[h+2]))break}};a.Is=t;a.SH=function(a){a=t(a).G;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.vL=function(){};a.so=function(a,c,d){if(!b(a,c))throw"No such node";var h={};e(a,h);k(a,c,h,d);c=[];for(var g in h)h[g]&&
(g=Number(g),c.push(g,f(a,g)));a={G:c,ga:a.ga.slice(0)};r(a);return a};a.Ip=r;a.nE=function(a){for(var b=[],c=a.G,d=0;d<c.length;d+=2){var f=c[d];h(a,f)||b.push(f)}return b};a.el=u;a.match=function(a,b,c,d){var f={};f.$k=z(a);f.al=z(b);f.wr=c||function(a,b){return a==b};f.Zm=d||function(a,b){return a==b};d=a.G.length/2;var h=b.G.length/2;f.lg=d;f.oj=h;f.ng=0;f.Ge=f.On=0;f.Cg=f.Qj=f.Rj=0;f.Dg=f.Sj=f.Tj=0;f.hk=-1;f.kf=Array(d);f.kh=Array(h);f.yh=Array(d);f.zh=Array(h);f.Oh=Array(d);f.Ph=Array(h);f.lo=
[1];for(c=0;c<d;c++)f.kf[c]=-1,f.yh[c]=0,f.Oh[c]=0;for(c=0;c<h;c++)f.kh[c]=-1,f.zh[c]=0,f.Ph[c]=0;h=Array(d);d=Array(d);if(D(h,d,f)){for(c=0;c<h.length;c++)h[c]=a.G[2*h[c]],d[c]=b.G[2*d[c]];return[h,d]}return null};a.Da=f;a.og=m;a.qn=h;a.cg=x;a.Si=L;a.VK=w;a.sf=I;a.replace=function(a,b,c){for(var f=a.ga,h=q(a),g=0;g<b.length;g++){var e=b[g];n(a,e);for(var m=0;m<f.length;m+=3)f[m]==e&&(f[m]=h),f[m+1]==e&&(f[m+1]=h),f[m]==f[m+1]&&(f.splice(m,3),m-=3)}d(a,h,c)};a.Xw=function(a,b,c,d,f){if(!P(a,b,c))throw"Edge not found";
a=a.ga;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&(a[h]=d,a[h+1]=f)};a.ZC=function(a,b){function c(a,b){if(-1!=m.indexOf(a)){var d=m.slice(m.indexOf(a));if(-1!=f[d[d.length-1]].indexOf(d[0])){k.push([a,d[d.length-1]]);return}}m.push(a);for(d=0;d<b.length;d++)b[d]in f&&c(b[d],f[b[d]])}b||(b=u(a)[0]);var d=a.ga;if(d.length){for(var f={},h=0,e=0;e<d.length;e+=3)d[e+1]in f?f[d[e+1]].push(d[e]):f[d[e+1]]=[d[e]],h++;var m=[],k=[];c(b,f[b]);for(e=0;e<k.length;e++)for(var l=h=0;l<d.length;l+=3)k[e][1]==
d[l+1]&&k[e][0]==d[l]&&g(a,d[l],d[l+1],h),h++}};a.GC=function(a,b,c){var d=a.G;a=a.ga;var f;f="digraph debug {\n    node [shape=box];\n";for(var h=0;h<d.length;h+=2){var g=d[h],e=d[h+1],e=b?b(g,e):String(g);f+="    ";f+=String(g)+' [label="'+e.replace(/\"/g,'\\"')+'"];\n'}for(h=0;h<a.length;h+=3)b=a[h],d=a[h+1],e=a[h+2],f+="    ",f+=String(b)+" -> "+String(d),c&&(f+=' [label="'+c(b,d,e)+'"]'),f+=";\n";return f+="}"}};b4w.module.__ipc=function(a,p){function d(a,b,c){for(var d=0;d<r.length;d+=2)r[d+1]==a&&(k[d+Number(!b)]=c)}function b(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var g=c[f];switch(g.constructor){case Float32Array:d+=g.length;break;case Number:d+=1}}--d;c.len=d}}var c=!0;a.az=0;var n=a.Ty=1,g=a.Vy=2;a.Uy=3;a.Xy=4;a.Yy=5;a.Zy=6;a.bz=7;var q=a.dz=8,l=a.ht=9,t=a.ez=10;a.fz=11;var e=a.gz=12;a.hz=13;a.cz=14;a.$y=15;a.Wy=16;a.Iz=100;a.jz=101;a.kz=102;a.lz=103;a.mz=104;a.oz=105;a.nz=106;
a.pz=107;a.qz=108;a.rz=109;a.sz=110;a.tz=111;a.uz=112;a.wz=113;a.xz=114;a.Lz=115;a.yz=116;a.zz=117;a.Az=118;a.Cz=119;a.Dz=120;a.Ez=121;a.Gz=122;a.Hz=123;a.Jz=124;a.vz=125;a.Nz=126;a.Bz=127;a.kt=128;a.Mz=129;a.Oz=130;a.Pz=131;a.Qz=132;a.Rz=133;a.Sz=134;a.Tz=135;a.Uz=136;a.Vz=137;a.Wz=138;a.Xz=139;a.lt=140;var H=a.km=141;a.Yz=142;a.jt=143;a.Zz=144;a.$z=145;a.Kz=146;a.Fz=147;a.aA=148;var k=b4w.worker_listeners,r=b4w.worker_namespaces,u={rd:e,A:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Le:new Float32Array(3),ze:new Float32Array(3),len:0},z={rd:q,Gp:0,Jr:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},D={rd:l,id:0,wi:0,hit_fract:0,hit_time:0,len:0},y={rd:t,id:0,wi:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},C={rd:n,ah:0,bh:0,result:0,len:0},v={rd:g,ah:0,bh:0,result:0,jh:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},f={rd:H,A:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},m=[u,z,D,y,C,v,f];
a.zC=function(a,b){var f={xn:a?!0:!1,Pg:null,Ee:[],Nd:""};if(b)if(f.Pg={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");d(f.Nd,f.xn,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");d(f.Nd,f.xn,null)},postMessage:function(a){var b;a:{for(b=0;b<r.length;b+=2)if(r[b+1]==f.Nd){b=k[b+Number(!!f.xn)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<r.length;a+=2)if(r[a+1]==f.Nd){k.splice(a,2);r.splice(a,2);break}}},f.xn){var g=
p("__util"),e=p("__container"),m=b4w.get_namespace(p),g=g.Wj(m+"_worker");r.push(m);r.push(g);k.push(null);k.push(null);f.Nd=g;(e=e.mD(a))?c?e.addEventListener("load",function(){b4w.require("__bindings",f.Nd)},!1):(b4w.cleanup("__bindings",f.Nd),b4w.cleanup("__ipc",f.Nd),b4w.require("__bindings",f.Nd)):(e=document.createElement("script"),e.src=a,e.defer="defer",e.async="async",e.addEventListener("load",function(){c=!1;b4w.require("__bindings",f.Nd)},!1),document.head.appendChild(e))}else f.Nd=b4w.get_namespace(p);
else f.Pg=a?new Worker(a):self;return f};a.WA=function(a,c){function d(b){if(b.constructor==ArrayBuffer)b=new Float32Array(b);else if(b[0].constructor==ArrayBuffer){for(var m=0;m<b.length;m++)d(b[m]);return}m=b[0]|0;switch(m){case e:var k=u;k.A=b[1]|0;k.time=b[2];k.trans[0]=b[3];k.trans[1]=b[4];k.trans[2]=b[5];k.quat[0]=b[6];k.quat[1]=b[7];k.quat[2]=b[8];k.quat[3]=b[9];k.Le[0]=b[10];k.Le[1]=b[11];k.Le[2]=b[12];k.ze[0]=b[13];k.ze[1]=b[14];k.ze[2]=b[15];break;case q:k=z;k.Gp=b[1]|0;k.Jr=b[2]|0;k.trans[0]=
b[3];k.trans[1]=b[4];k.trans[2]=b[5];k.quat[0]=b[6];k.quat[1]=b[7];k.quat[2]=b[8];k.quat[3]=b[9];break;case l:k=D;k.id=b[1]|0;k.wi=b[2]|0;k.hit_fract=b[3];k.hit_time=b[4];break;case t:k=y;k.id=b[1]|0;k.wi=b[2]|0;k.hit_fract=b[3];k.hit_time=b[4];k.hit_pos[0]=b[5];k.hit_pos[1]=b[6];k.hit_pos[2]=b[7];k.hit_norm[0]=b[8];k.hit_norm[1]=b[9];k.hit_norm[2]=b[10];break;case n:k=C;k.ah=b[1]|0;k.bh=b[2]|0;k.result=!!b[3];break;case g:k=v;k.ah=b[1]|0;k.bh=b[2]|0;k.result=!!b[3];k.jh[0]=b[4];k.jh[1]=b[5];k.jh[2]=
b[6];k.coll_norm[0]=b[7];k.coll_norm[1]=b[8];k.coll_norm[2]=b[9];k.coll_dist=b[10];break;case H:k=f;k.A=b[1]|0;k.trans[0]=b[2];k.trans[1]=b[3];k.trans[2]=b[4];k.quat[0]=b[5];k.quat[1]=b[6];k.quat[2]=b[7];k.quat[3]=b[8];break;default:k=b}c(a,m,k)}b(m);a.Pg.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.C=function(a,b){if(a)switch(b){case e:var c=u,d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.A;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];
d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Le[0];d[11]=c.Le[1];d[12]=c.Le[2];d[13]=c.ze[0];d[14]=c.ze[1];d[15]=c.ze[2];a.Ee.push(d.buffer);break;case q:c=z;d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.Gp;d[2]=c.Jr;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.Ee.push(d.buffer);break;case l:c=D;d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.id;d[2]=c.wi;d[3]=c.hit_fract;d[4]=c.hit_time;a.Ee.push(d.buffer);break;case t:c=y;d=new Float32Array(c.len);
d[0]=c.rd;d[1]=c.id;d[2]=c.wi;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.Ee.push(d.buffer);break;case n:c=C;d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.ah;d[2]=c.bh;d[3]=c.result;a.Ee.push(d.buffer);break;case g:c=v;d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.ah;d[2]=c.bh;d[3]=c.result;d[4]=c.jh[0];d[5]=c.jh[1];d[6]=c.jh[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.Ee.push(d.buffer);break;case H:c=f;d=new Float32Array(c.len);d[0]=c.rd;d[1]=c.A;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.Ee.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Pg.postMessage(d)}};a.cG=function(a){a&&a.Ee.length&&(a.Pg.postMessage(a.Ee),a.Ee.length=0)};a.fv=function(a){switch(a){case e:return u;case q:return z;case l:return D;case t:return y;case n:return C;case g:return v;case H:return f;
default:return null}};a.terminate=function(a){a.Pg.terminate();a.Pg=null};a.un=function(a){return!!a.Pg};a.Ev=function(a){return!!a.Nd}};b4w.module.__hud=function(a,p){function d(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function b(a){c(' SCENE "'+a.name+'"');if(a.k){var b=0,d=0,g=0;l.ba(a.k.jb,function(a,e){if("SINK"==e.type)c(" (F)",e.type);else{var k=e.type,l=Math.round(e.j.width)+"x"+Math.round(e.j.height),f=e.s.length,m=e.Ik;"MAIN_CUBE_REFLECT"==e.type&&(f*=6);var h=e.enqueue&&e.Jb,x=h?e.Zf:0;c(h?" (A)":" (P)",k,e.Nn,l,m,"of",f,"  ",x.toFixed(3));e.Ik=0;h&&(b+=f,d+=m,g+=x)}});return[b,
d,g]}c("No INFO")}function c(){for(var a=80+20*H[0],b=arguments[0],c=1;c<arguments.length;c++){for(var d="",g=0;g<t[c]-String(arguments[c]).length;g++)d+=" ";b+=d+arguments[c]}H[0]++;e.fillText(b,30,a)}function n(a,b,c){b*=a.pb;c.x=a.x+b;c.y=a.y;c.pb=a.pb-2*b;c.eb=a.eb}function g(a){return a.x+a.pb/2}function q(a){var b=e,c={x:0,y:0,pb:0,eb:0},d=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.pb=d;c.eb=b;n(c,.01,c);d=.02*c.eb;c.x=c.x;c.y+=d;c.pb=c.pb;c.eb-=2*d;d=c.pb/8;c.x+=d*a;c.y=c.y;c.pb=d;c.eb=
c.eb;n(c,.02,c);return c}var l=p("__graph");p("__print");var t=[5,19,3,10,4,3,5],e=null,H=[0,0];a.init=function(a){a=a.getContext("2d");d(a);return e=a};a.Tl=function(){e&&d(e)};a.reset=function(){var a=e;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),H[0]=0,H[1]=0)};a.qH=function(a,d){var g=e;if(g){g.textAlign="left";g.fillStyle="rgba(0,255,0,255)";c(" FPS",(1/d).toFixed(2));H[0]++;for(var l=g=0,n=0,q=0;q<a.length;q++){var t=
b(a[q]),g=g+t[0],l=l+t[1],n=n+t[2];H[0]++}c(" -----------------------------------------------");c("    ","TOTAL ACTIVE","","",l,"of",g,"  ",n.toFixed(3))}};a.print=function(){var a=e;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",c.apply(Math,arguments))};a.plot_array=function(a,b,c,d,l,n,t){var v=e;if(v){b=q(b);var f=b.eb/5;b.x=b.x;b.y+=4*f;b.pb=b.pb;b.eb=f;v.textAlign="center";v.fillStyle="#00FF00";e.fillText(a,g(b),b.y-10);v.strokeStyle="#00FF00";v.lineWidth=.5;v.beginPath();v.moveTo(b.x,
b.y);v.lineTo(b.x+b.pb,b.y);v.lineTo(b.x+b.pb,b.y+b.eb);v.lineTo(b.x,b.y+b.eb);v.closePath();v.stroke();if(!n&&!t)for(n=1E6,t=-1E6,a=0;a<c.length;a++)n=Math.min(n,c[a]),t=Math.max(t,c[a]);v.textAlign="right";e.fillText(String(n),b.x-10,b.y+b.eb);e.fillText(String(t),b.x-10,b.y);v.textAlign="center";e.fillText(String(d),b.x,b.y+b.eb+15);e.fillText(String(l),b.x+b.pb,b.y+b.eb+15);v.strokeStyle="#FF0000";v.lineWidth=1.5;v.beginPath();d=b.pb/(c.length-1);t=b.eb/(t-n);for(a=0;a<c.length;a++)l=b.x+d*a,
f=b.y+b.eb-(c[a]-n)*t,0==a?v.moveTo(l,f):v.lineTo(l,f);v.stroke()}};a.draw_mixer_strip=function(a,b,c,d,l,n,t){var v=e;if(v)for(v.textAlign="center",v.fillStyle="#00FF00",v.font="bold 12px Courier",c=q(c),e.fillText(b?"["+a+"]":a,g(c),c.y),0<=n&&e.fillText(n?"[M]":"[ ]",g(c)-15,c.y+30),0<=t&&e.fillText(t?"[S]":"[ ]",g(c)+15,c.y+30),a={x:0,y:0,pb:0,eb:0},b=0;b<d.length;b++){n=d[b];var f="VOLUME"==n[0];if(f){t=c.y+350;var m=c.pb,h=a;h.x=c.x;h.y=t;h.pb=m;h.eb=250}else{t=c.y+10+50*b;var m=c.pb,h=c.eb,
x=a;x.x=c.x;x.y=t;x.pb=m;x.eb=h}t=v;var m=a,x=b==l,L=n[0],h=n[1],P=n[2],A=n[3],w=(A-P)/n[4],w=1>w?Math.floor(1/w-1E-5).toFixed(0).length:0;n=n[5]?Math.log(h/P)/Math.log(A/P):(h-P)/(A-P);t.textAlign="center";x?t.fillText("["+L+"]",g(m),m.y):t.fillText(L,g(m),m.y);t.strokeStyle="#00FF00";t.lineWidth=f?3:1;f?(t.textAlign="right",t.fillText(A.toFixed(w),g(m)-10,m.y+15),t.textAlign="right",t.fillText(P.toFixed(w),g(m)-10,m.y+m.eb-15)):(t.textAlign="right",t.fillText(P.toFixed(w),m.x+28,m.y+15),t.textAlign=
"left",t.fillText(A.toFixed(w),m.x+m.pb-28,m.y+15));t.beginPath();if(f){var I=m.y+15+(m.eb-30)*(1-n);t.moveTo(g(m),m.y+15);t.lineTo(g(m),m.y+m.eb-15);t.moveTo(g(m)-5,m.y+15);t.lineTo(g(m)+5,m.y+15);t.moveTo(g(m)-5,m.y+m.eb-15);t.lineTo(g(m)+5,m.y+m.eb-15);t.moveTo(g(m)-5,I);t.lineTo(g(m)+5,I)}else{var p=m.x+30+(m.pb-60)*n;t.moveTo(m.x+30,m.y+15);t.lineTo(m.x+m.pb-30,m.y+15);t.moveTo(m.x+30,m.y+15-5);t.lineTo(m.x+30,m.y+15+5);t.moveTo(m.x+m.pb-30,m.y+15-5);t.lineTo(m.x+m.pb-30,m.y+15+5);t.moveTo(p,
m.y+15-5);t.lineTo(p,m.y+15+5)}t.stroke();"EQ_Q"==L?(n=Math.log(1+1/(2*h*h)+Math.sqrt((2+1/(h*h))*(2+1/(h*h))/4-1))/Math.log(2),f?(t.textAlign="left",t.fillText(h.toFixed(w),g(m)+10,I),t.textAlign="left",t.fillText("("+n.toFixed(w+1)+")",g(m)+10,I+10)):(t.textAlign="right",t.fillText(h.toFixed(w),p,m.y+30),t.textAlign="left",t.fillText("("+n.toFixed(w+1)+")",p,m.y+30))):f?(t.textAlign="left",t.fillText(h.toFixed(w),g(m)+10,I)):(t.textAlign="center",t.fillText(h.toFixed(w),p,m.y+30))}}};b4w.module.__renderer=function(a,p){function d(a){for(var b=a.j,d=a.s,f=0;f<d.length;f++){var g=d[f];if(g.Jb){var e=a,k=b,l=g.ne,B=g.I,r=B.gc;v.useProgram(r.Th);for(var g=B.P,t=B.ym,F=r.Yx,q=F.length;q--;){var u=F[q];u.xq(v,u.Eh,e,l,B,k)}k=B.fu;v.colorMask(k,k,k,k);v.depthMask(B.ra);B.nb?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE);k=B.U;for(B=0;B<k.length;B++)F=k[B],v.activeTexture(v.TEXTURE0+B),v.bindTexture(F.Gb,F.Qa);if("SKY"==e.type){k=e;r=r.ei;B=k.j.Ib.Qa;F=k.Gk;for(q=0;6>q;q++)if(u=n(q),h.Jp?
(v.bindTexture(v.TEXTURE_CUBE_MAP,B),v.texImage2D(u,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,C)):(v.uniformMatrix4fv(r.u_cube_view_matrix,!1,F[q]),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,u,B,0),c(g,t,l.Rs)),k.Ln&&3!=q){var u=k,p=q,N=m;h.Jp?N.set(C):(v.readPixels(191,191,1,1,v.RGBA,v.UNSIGNED_BYTE,N),255!=N[0]&&255!=N[1]&&255!=N[2]||v.readPixels(191,220,1,1,v.RGBA,v.UNSIGNED_BYTE,N));var z=N[0],y=N[1],N=N[2],z=z/255,y=y/255,N=N/255;2===p?(u.fd[3]=z,u.fd[7]=y,u.fd[11]=N):2>p?(u.fd[4*p]=
z,u.fd[4*p+1]=y,u.fd[4*p+2]=N):(u.fd[4*(p-2)]=z,u.fd[4*(p-2)+1]=y,u.fd[4*(p-2)+2]=N)}e.Ik+=6}else c(g,t,l.Rs),e.Ik++}}}function b(a){if(a){var b=(a.Ea?v.COLOR_BUFFER_BIT:0)|(a.Ka?v.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=y;break;case "SHADOW_CAST":a=u;break;case "SHADOW_RECEIVE":a=z;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=D;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=y;break;default:a=
h.background_color}}else b=v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT,a=h.background_color;v.colorMask(!0,!0,!0,!0);v.depthMask(!0);v.clearColor(a[0],a[1],a[2],a[3]);v.clear(b)}function c(a,b,c){v.bindBuffer(v.ARRAY_BUFFER,a.Kg);for(var d=0;d<b.length;d++){var f=b[d];v.enableVertexAttribArray(f.Eh);v.vertexAttribPointer(f.Eh,f.Wd,v.FLOAT,!1,0,f.XA+f.vD*c)}a.uf?(v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,a.uf),v.drawElements(a.mode,a.count,a.Mq,0)):v.drawArrays(a.mode,0,a.count);for(d=0;d<b.length;d++)f=b[d],
v.disableVertexAttribArray(f.Eh)}function n(a){switch(a){case 0:return v.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return v.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return v.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return v.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return v.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return v.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function g(a){var b=a.ei,c=[],d=[],h={},g;for(g in b){var e=!1;switch(g){case "u_proj_matrix":var m=function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.mb)},e=!0;break;case "u_view_matrix":m=
function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.Wa)};e=!0;break;case "u_view_tsr":case "u_view_tsr_frag":m=function(a,b,c,d,f,h){h.$b?a.uniformMatrix3fv(b,!1,h.Ww):a.uniformMatrix3fv(b,!1,h.we)};e=!0;break;case "u_shadow_cast_billboard_view_tsr":m=function(a,b,c,d,f,h){a.uniformMatrix3fv(b,!1,h.gs)};e=!0;break;case "u_view_proj_prev":m=function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.gG)};e=!0;break;case "u_view_proj_matrix":m=function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.ve)};e=!0;break;case "u_view_proj_inverse":m=
function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.yy)};e=!0;break;case "u_sky_vp_inverse":m=function(a,b,c,d,f,h){a.uniformMatrix4fv(b,!1,h.Se)};e=!0;break;case "u_camera_eye":case "u_camera_eye_frag":m=function(a,b,c,d,h,e){a.uniform3fv(b,k.Ui(e.i,f))};e=!0;break;case "u_camera_quat":m=function(a,b,c,d,f,h){a.uniform4fv(b,k.get_quat_view(h.i))};e=!0;break;case "u_view_max_depth":m=function(a,b,c,d,f,h){a.uniform1f(b,h.Eb)};e=!0;break;case "u_camera_range":m=function(a,b,c,d,f,h){a.uniform2f(b,h.Va,
h.Eb)};break;case "u_csm_center_dists":m=function(a,b,c,d,f,h){a.uniform4fv(b,h.qu)};break;case "u_cam_water_depth":m=function(a,b,c){a.uniform1f(b,c.Dp)};e=!0;break;case "u_waves_height":m=function(a,b,c){a.uniform1f(b,c.Vs)};break;case "u_waves_length":m=function(a,b,c){a.uniform1f(b,c.Ws)};break;case "u_fog_color_density":m=function(a,b,c){a.uniform4fv(b,c.Ac)};break;case "u_fog_params":m=function(a,b,c){a.uniform4fv(b,c.Pd)};break;case "u_underwater_fog_color_density":m=function(a,b,c){a.uniform4fv(b,
c.xe)};break;case "u_bloom_key":m=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":m=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":m=function(a,b,c){a.uniform1f(b,c.time)};e=!0;break;case "u_wind":m=function(a,b,c){a.uniform3fv(b,c.Lf)};e=!0;break;case "u_sky_tex_dvar":m=function(a,b,c){a.uniform1f(b,c.tx)};break;case "u_sky_tex_fac":m=function(a,b,c){a.uniform4fv(b,c.ux)};break;case "u_sky_tex_color":m=function(a,b,c){a.uniform3fv(b,c.sx)};break;case "u_horizon_color":m=
function(a,b,c){a.uniform3fv(b,c.Td)};break;case "u_zenith_color":m=function(a,b,c){a.uniform3fv(b,c.ce)};break;case "u_environment_energy":m=function(a,b,c){a.uniform1f(b,c.pf)};break;case "u_sky_color":m=function(a,b,c){a.uniform3fv(b,c.Gj)};break;case "u_rayleigh_brightness":m=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":m=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":m=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;
case "u_scatter_strength":m=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":m=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":m=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":m=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":m=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":m=function(a,b,c){a.uniform1f(b,
c.mie_distribution)};break;case "u_light_positions":m=function(a,b,c){a.uniform3fv(b,c.Bn)};break;case "u_light_directions":m=function(a,b,c){a.uniform3fv(b,c.dr)};break;case "u_light_color_intensities":m=function(a,b,c){a.uniform3fv(b,c.An)};break;case "u_light_factors":m=function(a,b,c){a.uniform4fv(b,c.er)};break;case "u_sun_quaternion":m=function(a,b,c){a.uniform4fv(b,c.Mx)};break;case "u_sun_intensity":m=function(a,b,c){a.uniform3fv(b,c.Lx)};break;case "u_sun_direction":m=function(a,b,c){a.uniform3fv(b,
c.ys)};break;case "u_height":m=function(a,b,c,d,f,h){a.uniform1f(b,h.height)};e=!0;break;case "u_model_tsr":m=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.i)};e=!0;break;case "u_transb":m=function(a,b,c,d){a.uniform4fv(b,d.Yc)};e=!0;break;case "u_transa":m=function(a,b,c,d){a.uniform4fv(b,d.Dd)};e=!0;break;case "u_arm_rel_trans":m=function(a,b,c,d){a.uniform4fv(b,d.hp)};e=!0;break;case "u_arm_rel_quat":m=function(a,b,c,d){a.uniform4fv(b,d.gp)};e=!0;break;case "u_quat":m=function(a,b,c,d){c=k.get_quat_view(d.i);
a.uniform4fv(b,c)};e=!0;break;case "u_quatsb":m=function(a,b,c,d){a.uniform4fv(b,d.Qc)};e=!0;break;case "u_quatsa":m=function(a,b,c,d){a.uniform4fv(b,d.ud)};e=!0;break;case "u_frame_factor":m=function(a,b,c,d){a.uniform1f(b,d.Qd)};e=!0;break;case "au_center_pos":m=function(){};e=!0;break;case "au_wind_bending_amp":m=function(a,b,c,d){a.uniform1f(b,d.Ye)};e=!0;break;case "au_wind_bending_freq":m=function(a,b,c,d){a.uniform1f(b,d.Mf)};e=!0;break;case "au_detail_bending_freq":m=function(a,b,c,d){a.uniform1f(b,
d.mf)};e=!0;break;case "au_detail_bending_amp":m=function(a,b,c,d){a.uniform1f(b,d.lf)};e=!0;break;case "au_branch_bending_amp":m=function(a,b,c,d){a.uniform1f(b,d.ff)};e=!0;break;case "u_node_values":m=function(a,b,c,d){a.uniform1fv(b,d.xf)};e=!0;break;case "u_node_rgbs":m=function(a,b,c,d){a.uniform3fv(b,d.qd)};e=!0;break;case "u_diffuse_color":m=function(a,b,c,d,f){a.uniform4fv(b,f.vc)};e=!0;break;case "u_diffuse_intensity":m=function(a,b,c,d,f){a.uniform1f(b,f.ag)};e=!0;break;case "u_diffuse_params":m=
function(a,b,c,d,f){a.uniform2fv(b,f.hd)};e=!0;break;case "u_emit":m=function(a,b,c,d,f){a.uniform1f(b,f.of)};e=!0;break;case "u_ambient":m=function(a,b,c,d,f){a.uniform1f(b,f.bf)};e=!0;break;case "u_specular_color":m=function(a,b,c,d,f){a.uniform3fv(b,f.Te)};e=!0;break;case "u_specular_alpha":m=function(a,b,c,d,f){a.uniform1f(b,f.qs)};e=!0;break;case "u_specular_params":m=function(a,b,c,d,f){a.uniform3fv(b,f.Wc)};e=!0;break;case "u_reflect_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.reflect_factor)};
e=!0;break;case "u_mirror_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.or)};e=!0;break;case "u_grass_map_dim":m=function(a,b,c,d,f){a.uniform3fv(b,f.Kc)};e=!0;break;case "u_grass_size":m=function(a,b,c,d,f){a.uniform1f(b,f.Hq)};e=!0;break;case "u_scale_threshold":m=function(a,b,c,d,f){a.uniform1f(b,f.mv)};e=!0;break;case "u_cube_fog":m=function(a,b,c,d,f){a.uniformMatrix4fv(b,!1,f.fd)};break;case "u_jitter_amp":m=function(a,b,c,d,f){a.uniform1f(b,f.Qv)};e=!0;break;case "u_jitter_freq":m=function(a,
b,c,d,f){a.uniform1f(b,f.Rv)};e=!0;break;case "u_wireframe_mode":m=function(a,b,c,d,f){a.uniform1i(b,f.wireframe_mode)};break;case "u_wireframe_edge_color":m=function(a,b,c,d,f){a.uniform3fv(b,f.wireframe_edge_color)};break;case "u_subpixel_jitter":m=function(a,b,c){a.uniform2fv(b,c.RE)};e=!0;break;case "u_subsample_indices":m=function(a,b,c){a.uniform4fv(b,c.SE)};e=!0;break;case "u_refr_bump":m=function(a,b,c,d,f){a.uniform1f(b,f.Zw)};e=!0;break;case "u_line_width":m=function(a,b,c,d,f){a.uniform1f(b,
f.Cn)};e=!0;break;case "u_lamp_light_positions":m=function(a,b,c,d,f){a.uniform3fv(b,f.$q)};break;case "u_lamp_light_directions":m=function(a,b,c,d,f){a.uniform3fv(b,f.Yq)};break;case "u_lamp_light_color_intensities":m=function(a,b,c,d,f){a.uniform3fv(b,f.Xq)};break;case "u_lamp_light_factors":m=function(a,b,c,d,f){a.uniform4fv(b,f.Zq)};break;case "u_halo_size":m=function(a,b,c,d,f){a.uniform1f(b,f.sv)};e=!0;break;case "u_halo_hardness":m=function(a,b,c,d,f){a.uniform1f(b,f.pv)};e=!0;break;case "u_halo_rings_color":m=
function(a,b,c,d,f){a.uniform3fv(b,f.rv)};e=!0;break;case "u_halo_lines_color":m=function(a,b,c,d,f){a.uniform3fv(b,f.qv)};e=!0;break;case "u_halo_stars_blend":m=function(a,b,c,d,f){a.uniform1f(b,f.tv)};e=!0;break;case "u_halo_stars_height":m=function(a,b,c,d,f){a.uniform1f(b,f.uv)};e=!0;break;case "u_fresnel_params":m=function(a,b,c,d,f){a.uniform4fv(b,f.ke)};e=!0;break;case "u_texture_scale":m=function(a,b,c,d,f){a.uniform3fv(b,f.Eg)};e=!0;break;case "u_parallax_scale":m=function(a,b,c,d,f){a.uniform1f(b,
f.parallax_scale)};e=!0;break;case "u_color_id":m=function(a,b,c,d){a.uniform3fv(b,d.Lm)};e=!0;break;case "u_line_points":m=function(a,b,c,d,f){a.uniform3fv(b,f.CL)};e=!0;break;case "u_diffuse_color_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.$f)};e=!0;break;case "u_alpha_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.Sf)};e=!0;break;case "u_specular_color_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.bi)};e=!0;break;case "u_normal_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.pw)};e=!0;break;case "u_normalmap0_scale":m=
function(a,b,c,d,f){a.uniform2fv(b,f.Lh[0])};e=!0;break;case "u_normalmap1_scale":m=function(a,b,c,d,f){a.uniform2fv(b,f.Lh[1])};e=!0;break;case "u_normalmap2_scale":m=function(a,b,c,d,f){a.uniform2fv(b,f.Lh[2])};e=!0;break;case "u_normalmap3_scale":m=function(a,b,c,d,f){a.uniform2fv(b,f.Lh[3])};e=!0;break;case "u_foam_factor":m=function(a,b,c,d,f){a.uniform1f(b,f.foam_factor)};e=!0;break;case "u_foam_uv_freq":m=function(a,b,c,d,f){a.uniform2fv(b,f.Nu)};e=!0;break;case "u_foam_mag":m=function(a,b,
c,d,f){a.uniform2fv(b,f.Mu)};e=!0;break;case "u_foam_scale":m=function(a,b,c,d,f){a.uniform2fv(b,f.sq)};e=!0;break;case "u_water_norm_uv_velocity":m=function(a,b,c,d,f){a.uniform1f(b,f.bk)};e=!0;break;case "u_shallow_water_col":m=function(a,b,c,d,f){a.uniform3fv(b,f.shallow_water_col)};e=!0;break;case "u_shore_water_col":m=function(a,b,c,d,f){a.uniform3fv(b,f.shore_water_col)};e=!0;break;case "u_water_shallow_col_fac":m=function(a,b,c,d,f){a.uniform1f(b,f.shallow_water_col_fac)};e=!0;break;case "u_water_shore_col_fac":m=
function(a,b,c,d,f){a.uniform1f(b,f.shore_water_col_fac)};e=!0;break;case "u_p_length":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.Tx)};e=!0;break;case "u_p_cyclic":m=function(a,b,c,d,f){a.uniform1i(b,f.Ba.cyclic)};e=!0;break;case "u_p_max_lifetime":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.Xv)};e=!0;break;case "u_p_fade_in":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.sh)};e=!0;break;case "u_p_fade_out":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.kd)};e=!0;break;case "u_p_size":m=function(a,b,c,d,f){a.uniform1f(b,
f.Ba.size)};e=!0;break;case "u_p_alpha_start":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.Bt)};e=!0;break;case "u_p_alpha_end":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.At)};e=!0;break;case "u_p_nfactor":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.ur)};e=!0;break;case "u_p_gravity":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.nv)};e=!0;break;case "u_p_mass":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.Me)};e=!0;break;case "u_p_color_ramp":m=function(a,b,c,d,f){a.uniform4fv(b,f.Ba.gu)};e=!0;break;case "u_p_wind_fac":m=
function(a,b,c,d,f){a.uniform1f(b,f.Ba.Fy)};e=!0;break;case "u_texel_size":m=function(a,b,c){a.uniform2fv(b,c.Fs)};e=!0;break;case "u_p_time":m=function(a,b,c,d,f){a.uniform1f(b,f.Ba.time)};e=!0;break;case "u_position":m=function(a,b,c,d,f){a.uniform3fv(b,f.xj)};e=!0;break;case "u_va_frame_factor":m=function(a,b,c,d){a.uniform1f(b,d.my)};e=!0;break;case "u_normal_offset":m=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":m=function(a,b,c,d,f,h){a.uniform4fv(b,
h.Vn)};break;case "u_v_light_ts":m=function(a,b,c){a.uniform4fv(b,c.Ko)};e=!0;break;case "u_v_light_r":m=function(a,b,c){a.uniform4fv(b,c.Jo)};e=!0;break;case "u_v_light_tsr":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Qs)};e=!0;break;case "u_p_light_matrix0":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qh[0])};e=!0;break;case "u_p_light_matrix1":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qh[1])};e=!0;break;case "u_p_light_matrix2":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qh[2])};e=!0;break;case "u_p_light_matrix3":m=
function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qh[3])};e=!0;break;case "u_motion_blur_exp":m=function(a,b,c){a.uniform1f(b,c.jw)};e=!0;break;case "u_motion_blur_decay_threshold":m=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};e=!0;break;case "u_refl_plane":m=function(a,b,c,d){a.uniform4fv(b,d.$b)};e=!0;break;case "u_radial_blur_step":m=function(a,b,c){a.uniform1f(b,c.bo)};break;case "u_god_rays_intensity":m=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":m=
function(a,b,c){a.uniform1f(b,c.Kj)};break;case "u_ssao_blur_discard_value":m=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};e=!0;break;case "u_ssao_influence":m=function(a,b,c){a.uniform1f(b,c.Jj)};break;case "u_ssao_dist_factor":m=function(a,b,c){a.uniform1f(b,c.Ij)};break;case "u_dof_dist":m=function(a,b,c,d,f,h){h.dof_on?a.uniform1f(b,h.dof_distance):a.uniform1f(b,0)};e=!0;break;case "u_dof_front":m=function(a,b,c,d,f,h){a.uniform1f(b,h.dof_front)};e=!0;break;case "u_dof_rear":m=function(a,
b,c,d,f,h){a.uniform1f(b,h.dof_rear)};e=!0;break;case "u_outline_intensity":m=function(a,b,c,d){a.uniform1f(b,d.pg)};e=!0;break;case "u_outline_color":m=function(a,b,c){a.uniform3fv(b,c.Af)};break;case "u_draw_outline":m=function(a,b,c){a.uniform1f(b,c.iq)};e=!0;break;case "u_glow_mask_small_coeff":m=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};e=!0;break;case "u_glow_mask_large_coeff":m=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};e=!0;break;case "u_brightness":m=function(a,
b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":m=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":m=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":m=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":m=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":m=function(a,b,c){a.uniform4fv(b,c.Ci)};break;case "u_chromatic_aberration_coefs":m=function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};
break;default:m=null}m&&(m={name:g,xq:m,Eh:b[g]},e?c.push(m):(d.push(m),h[g]=m))}a.Yx=c;d.length?(a.xl=d,a.Er=h):a.vr=!0}var q=p("__batch"),l=p("__camera"),t=p("__config"),e=p("__debug"),H=p("__textures"),k=p("__tsr"),r=p("__util"),u=[1,1,1,1],z=[1,1,1,1],D=[0,0,0,1],y=[0,0,0,0],C=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var v=null,f=new Float32Array(3),m=new Uint8Array(4);new Float32Array(9);
new Float32Array(8);var h=t.p;a.yd=function(a){var b=h.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);v=a};a.Gi=function(a){if(a.Jb)if("RESOLVE"==a.type){e.Or(a);var c=a.j;v.bindFramebuffer(v.READ_FRAMEBUFFER,c.vq);v.bindFramebuffer(v.DRAW_FRAMEBUFFER,c.je);v.blitFramebuffer(0,0,c.width,c.height,0,0,c.width,c.height,
v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT,v.NEAREST);e.Pr(a);e.Hp("draw resolve")}else if("COPY"==a.type)e.Or(a),c=a.j,v.bindFramebuffer(v.FRAMEBUFFER,c.vq),v.bindTexture(v.TEXTURE_2D,c.Ib.Qa),v.copyTexSubImage2D(v.TEXTURE_2D,0,0,0,0,0,c.width,c.height,0),e.Pr(a),e.Hp("draw copy");else{e.Or(a);c=a.j;v.bindFramebuffer(v.FRAMEBUFFER,c.je);if(a.jp){var f=c.Ib;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,f.Gb,f.Qa,0)}v.viewport(0,0,c.width,c.height);"MAIN_CUBE_REFLECT"!=a.type&&b(a);a.Ja?v.enable(v.BLEND):
v.disable(v.BLEND);a.tc?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST);if(a.ia){for(var c=a.j,f=a.s,m=0;m<f.length;m++){var r=f[m],t=r.I,q=t.gc;if(!q.vr){v.useProgram(q.Th);r=r.ne;q.xl.length||g(q);for(var q=q.xl,u=q.length;u--;){var B=q[u];B.xq(v,B.Eh,a,r,t,c)}}}a.ia=!1}switch(a.type){case "SHADOW_CAST":v.enable(v.POLYGON_OFFSET_FILL);v.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);v.cullFace(v.BACK);break;case "MAIN_PLANE_REFLECT":v.disable(v.POLYGON_OFFSET_FILL);v.cullFace(v.FRONT);
break;case "MAIN_GLOW":if(1<h.Cc){v.enable(v.POLYGON_OFFSET_FILL);v.polygonOffset(-2,-2);break}default:v.disable(v.POLYGON_OFFSET_FILL),v.cullFace(v.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(c=a.j,f=c.Ib.Qa,m=0;6>m;m++){t=n(m);c.Wa=a.Gk[m];k.from_mat4(c.Wa,c.we);l.Im(c);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,t,f,0);b(a);t=a.s;for(r=0;r<t.length;r++)t[r].Jb=t[r].hq[m];d(a)}else d(a);e.Pr(a);e.Hp("draw subscene: "+a.type);v.bindFramebuffer(v.FRAMEBUFFER,null)}};a.clear=function(a){v.bindFramebuffer(v.FRAMEBUFFER,
a.j.je);b(a)};a.ip=function(a){var b=a.ym;b.length=0;var c=a.P;a=a.gc;c&&a||r.Z("Incomplete batch");c=c.xb;a=a.attributes;for(var d in a){var f=c[d];b.push({Eh:a[d],XA:4*f.offset,vD:1<f.frames?4*f.length:0,Wd:f.Wd})}};a.VA=g;a.Ft=function(a){var b=a.gc,c=a.U;a=a.lc;v.useProgram(b.Th);for(var d=0;d<c.length;d++)v.uniform1i(b.ei[a[d]],d)};a.Vw=function(a,b,c,d,f,h){d||(d=1);f||(f=1);h||(h=new Uint8Array(4*d*f));h.length!=4*d*f&&r.Z("read_pixels(): Wrong storage");v.bindFramebuffer(v.FRAMEBUFFER,a);
v.readPixels(b,c,d,f,v.RGBA,v.UNSIGNED_BYTE,h);v.bindFramebuffer(v.FRAMEBUFFER,null);return h};a.gI=function(a){var b=a.gc;b.vr||(v.useProgram(b.Th),b.xl.length||g(b),b=b.Er.u_cube_fog,b.xq(v,b.Eh,null,null,a,null))};a.rG=function(a,b){var c=v.createFramebuffer();v.bindFramebuffer(v.FRAMEBUFFER,c);if(H.cj(a)){var d=a.Fd;v.framebufferRenderbuffer(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.RENDERBUFFER,d)}else if(H.ej(a)){var f=a,d=f.Qa,f=f.Gb==v.TEXTURE_CUBE_MAP?v.TEXTURE_CUBE_MAP_NEGATIVE_Z:f.Gb;v.framebufferTexture2D(v.FRAMEBUFFER,
v.COLOR_ATTACHMENT0,f,d,0)}H.cj(b)?(d=b.Fd,v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,d)):H.ej(b)&&(f=b,d=f.Qa,f=f.Gb,v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,f,d,0));e.vB();v.bindFramebuffer(v.FRAMEBUFFER,null);return c};a.qG=function(a,b,c,d,f){null==a?(v.bindFramebuffer(v.FRAMEBUFFER,a),v.viewport(0,0,d,f),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT)):(H.cj(b)?v.deleteRenderbuffer(b.Fd):H.ej(b)&&v.deleteTexture(b.Qa),H.cj(c)?v.deleteRenderbuffer(c.Fd):
H.ej(c)&&v.deleteTexture(c.Qa),v.deleteFramebuffer(a))};a.oL=function(){};a.SC=function(a,b,d,f,h,e){a=a.Qa;v.viewport(0,0,d,d);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,b,a,0);b=q.Tp("FLIP_CUBEMAP_COORDS");a=b.gc;v.activeTexture(v.TEXTURE0);v.bindTexture(v.TEXTURE_2D,h);var m=h=0;d!=f&&(h=1/(6*f),m=1/(4*f));v.uniform1i(a.ei.u_tex_number,e);v.uniform2fv(a.ei.u_delta,[h,m]);v.useProgram(a.Th);c(b.P,b.ym,0);v.bindTexture(v.TEXTURE_2D,null)};a.TC=function(a,b,d,f,h){v.bindFramebuffer(v.FRAMEBUFFER,
f);f=a.Qa;a=a.Gb;v.bindTexture(a,f);v.viewport(0,0,b,d);v.texImage2D(a,0,v.RGBA,b,d,0,v.RGBA,v.UNSIGNED_BYTE,null);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,a,f,0);b=q.Tp("NONE");d=b.gc;v.bindTexture(a,null);v.activeTexture(v.TEXTURE0);v.bindTexture(a,h);v.useProgram(d.Th);c(b.P,b.ym,0);v.bindFramebuffer(v.FRAMEBUFFER,null);v.bindTexture(a,null)};a.cleanup=function(){}};b4w.module.__shaders=function(a,p){function d(a,c,d){var f=a.bg;"string"==typeof d&&(a=b(a,d))&&(d=a[1]);for(a=0;a<f.length;a++)if(f[a][0]==c){f[a][1]=d;return}f.push([c,d])}function b(a,b){for(var c=a.bg,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function c(a,b){var c=a+b;if(v[c])return v[c];if(f){var d=f[b];if(!d)return null;d=p("__gpp_parser").ML.parse(d)}else if(d=p("shader_texts")[b],!d)return null;return v[c]=d}function n(a,b,d){function f(b){b=b.b;for(var d=0;d<b.length;d++){var r=
b[d];switch(r.type){case "condition":a:for(var r=r.b,x=0;x<r.length;x++){var w=r[x];switch(w.type){case "if":case "elif":if(h(w.d)){f(w.group);break a}break;case "else":f(w.group);break a;case "ifdef":w.name in l&&f(w.group);break;case "ifndef":w.name in l||f(w.group)}}break;case "include":r=c(y.shaders_dir,y.oH+r.file);f(r);break;case "var":case "export":case "import":break;case "define":x=r.name;l[x]=r.a;r.r&&(n[x]=r.r);break;case "error":throw"Shader error: #error "+r.a.join(" ");case "line":break;
case "pragma":k.push("#pragma "+r.name+" "+r.a.join(" "));break;case "undef":r=r.name;delete l[r];delete n[r];break;case "warning":z.warn("Shader warning: #warning "+r.a.join(" "));break;case "extension":r=g(r.a,l,n,!1);k.push("#extension "+r.join(" "));break;case "#":break;case "node":t[r.name]=r;break;case "nodes_global":r=m;for(x=0;x<r.length;x++){var w=r[x],A=t[w.id];if(A)for(var F=0,J=0;J<A.h.length;J++){var V=A.h[J];if("node_param"==V.type){var W;if("PARTICLE_INFO"==w.id&&V.c)if(1==l.PARTICLE_BATCH)switch(W=
!1,F){case 0:W=H(w.La,"PART_INFO_IND")||H(w.La,"PART_INFO_AGE")||H(w.La,"PART_INFO_LT")||H(w.La,"PART_INFO_SIZE");break;case 1:W=H(w.La,"PART_INFO_LOC");break;case 2:W=H(w.La,"PART_INFO_VEL");break;case 3:W=H(w.La,"PART_INFO_A_VEL");break;case 4:W=H(w.La,"PART_INFO_IND")}else W=!1;else W=!0;W&&(V=V.qualifier.join(" ")+" ","vert"==a?V+=w.Mg[F]:"frag"==a&&(V+=w.r[F],null!==w.Rn[F]&&(V+=" = "+w.Rn[F])),V+=";",k.push(V));F++}}}break;case "nodes_main":r=m;for(x=0;x<r.length;x++)if(w=r[x],A=t[w.id]){F=
{};J={};for(V=0;V<w.La.length;V++)J[w.La[V][0]]=[w.La[V][1]];v=L=u=0;V=w;W=A.h;for(var N=F,p=J,C=0;C<W.length;C++){var D=W[C];switch(D.type){case "node_in":var Z=V.J[u];if(null!==V.Rq[u]){if(("MATERIAL_BEGIN"==V.id&&3===u||!p.MATERIAL_EXT&&("MATERIAL_BEGIN"==V.id&&4===u||"MATERIAL_END"==V.id&&3===u||"MATERIAL_END"==V.id&&4===u||"MATERIAL_END"==V.id&&5===u)||"TEXTURE_COLOR"==V.id||"TEXTURE_NORMAL"==V.id)&&D.c){N[D.name]=V.Rq[u];u++;continue}var Y=D.qualifier.join(" ")+" ",Y=Y+Z,Y=Y+(" = "+V.Rq[u]),
Y=Y+";";k.push(Y)}N[D.name]=Z;u++;break;case "node_out":Z=V.Aa[L];if(!D.c||-1<q.indexOf(Z))Y=D.qualifier.join(" ")+" ",Y+=Z,Y+=";",k.push(Y),N[D.name]=Z;-1<q.indexOf(Z)&&(p["USE_OUT_"+D.name]=[1]);L++;break;case "node_param":"vert"==a?Z=V.Mg[v]:"frag"==a&&(Z=V.r[v]),N[D.name]=Z,v++}}k.push("{");e(w,A.f,F,J);k.push("}")}break;case "textline":r=g(r.a,l,n,!1);k.push(r.join(" "));break;default:throw"Unknown element type: "+r.type;}}}function h(a,b){var c;c=g(a,l,n,!0,b);for(var d=[],f=0;f<c.length;f++)if(c[f]instanceof
Object)switch(c[f].type){case "conditional_expr":var e=d.pop(),m=d.pop();d.pop()?d.push(m):d.push(e);break;case "logical_or_expr":e=d.pop();for(m=0;m<c[f].e-1;m++)k=d.pop(),e=e||k;d.push(e);break;case "logical_and_expr":e=d.pop();for(m=0;m<c[f].e-1;m++)k=d.pop(),e=e&&k;d.push(e);break;case "logical_bitor_expr":e=d.pop();for(m=0;m<c[f].e-1;m++)e|=d.pop();d.push(e);break;case "logical_bitxor_expr":e=d.pop();for(m=0;m<c[f].e-1;m++)e^=d.pop();d.push(e);break;case "logical_bitand_expr":e=d.pop();for(m=
0;m<c[f].e-1;m++)e&=d.pop();d.push(e);break;case "equal_expr":e=d.pop();m=d.pop();d.push(m==e);break;case "non_equal_expr":e=d.pop();m=d.pop();d.push(m!=e);break;case "le_expr":e=d.pop();m=d.pop();d.push(m<=e);break;case "ge_expr":e=d.pop();m=d.pop();d.push(m>=e);break;case "l_expr":e=d.pop();m=d.pop();d.push(m<e);break;case "g_expr":e=d.pop();m=d.pop();d.push(m>e);break;case "left_shift_expr":m=d.pop();e=d.pop();d.push(m<<e);break;case "right_shift_expr":m=d.pop();e=d.pop();d.push(m>>e);break;case "add_expr":m=
d.pop();e=d.pop();d.push(m+e);break;case "sub_expr":m=d.pop();e=d.pop();d.push(m-e);break;case "mul_expr":m=d.pop();e=d.pop();d.push(m*e);break;case "div_expr":m=d.pop();e=d.pop();d.push(m/e);break;case "mod_expr":m=d.pop();e=d.pop();d.push(m%e);break;case "pre_inc_expr":case "post_inc_expr":k=d.pop();d.push(++k);break;case "pre_dec_expr":case "post_dec_expr":k=d.pop();d.push(--k);break;case "positive_expr":k=d.pop();d.push(+k);break;case "negative_expr":k=d.pop();d.push(-k);break;case "one_compl_expr":k=
d.pop();d.push(~k);break;case "logic_negative_expr":k=d.pop();d.push(!k);break;default:D.Z("Unknown operation type: "+c[f].type)}else{var k=c[f];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(k)?d.push(0):d.push(parseFloat(c[f]))}1==d.length?c=d[0]:(D.Z("Incorrect expression: "+c.join(" ")),c=void 0);return c}function e(a,b,c,d){for(var f=0;f<b.length;f++){var m=b[f];switch(m.type){case "node_condition":a:for(var r=a,m=m.b,t=c,q=d,x=0;x<m.length;x++){var w=m[x];switch(w.type){case "node_if":case "node_elif":if(h(w.d,
q)){e(r,w.f,t,q);break a}break;case "node_else":e(r,w.f,t,q);break a;case "node_ifdef":(w.name in l||w.name in q)&&e(r,w.f,t,q);break;case "node_ifndef":w.name in l||w.name in q||e(r,w.f,t,q)}}break;case "textline":r=[];for(t=0;t<m.a.length;t++)q=m.a[t],q in c?r.push(c[q]):r.push(q);r=g(r,l,n,!0,d);k.push(r.join(" "))}}}var m=d.mg;d=d.bg||[];for(var k=[],l={},r=0;r<d.length;r++)l[d[r][0]]=[d[r][1]];for(r=0;r<m.length;r++)l["USE_NODE_"+m[r].id]=[1];var n={},t={},q=[];for(r in m)for(var x in m[r].J)q.push(m[r].J[x]);
f(b);var u=0,L=0,v=0;return k.join("\n")}function g(a,b,c,d,f){var h=[];q(a,b,c,d,h,f);return h}function q(a,b,c,d,f,h){for(var e=0;e<a.length;e++){var m=a[e];m in b||h&&m in h?(m=h&&h[m]||b[m],0==m.length&&d?f.push(0):q(m,b,c,d,f,h)):f.push(m)}}function l(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);u.BB(d,b,c);return d}function t(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return e(a);case 2:return"vec2("+e(a[0])+","+e(a[1])+")";case 3:return"vec3("+e(a[0])+","+
e(a[1])+","+e(a[2])+")";case 4:return"vec4("+e(a[0])+","+e(a[1])+","+e(a[2])+","+e(a[3])+")";case 9:return"mat3("+e(a[0])+","+e(a[1])+","+e(a[2])+","+e(a[3])+","+e(a[4])+","+e(a[5])+","+e(a[6])+","+e(a[7])+","+e(a[8])+")";case 16:return"mat4("+e(a[0])+","+e(a[1])+","+e(a[2])+","+e(a[3])+","+e(a[4])+","+e(a[5])+","+e(a[6])+","+e(a[7])+","+e(a[8])+","+e(a[9])+","+e(a[10])+","+e(a[11])+","+e(a[12])+","+e(a[13])+","+e(a[14])+","+e(a[15])+")";default:throw"Wrong glsl value dimension";}}function e(a){return a%
1?String(a):String(a)+".0"}function H(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var k=p("__assets"),r=p("__config"),u=p("__debug"),z=p("__print"),D=p("__util"),y=r.Dc,C={},v={},f=null,m="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv wireframe.glslf wireframe.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
h=[],x=null,L=!1;a.yd=function(a){x=a};a.L=d;a.cE=b;a.wL=function(a,b){for(var c=a.bg,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.HG=function(a){a.bg=[];for(var b="ALPHA ALPHA_CLIP ANAGLYPH BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_DISTORTION_CORRECTION DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WEBGL2 WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS NUM_CAST_LAMPS SUN_NUM MAC_OS_SHADOW_HACK USE_COLOR_RAMP HALO_PARTICLES PARTICLE_BATCH".split(" "),
c=0;c<b.length;c++){var f=b[c],h;switch(f){case "ALPHA":case "ALPHA_CLIP":case "ANAGLYPH":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_DISTORTION_CORRECTION":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":case "NUM_CAST_LAMPS":case "SUN_NUM":case "MAC_OS_SHADOW_HACK":case "USE_COLOR_RAMP":case "HALO_PARTICLES":case "PARTICLE_BATCH":h=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":h=1;break;case "WEBGL2":h=r.p.Gc|0;break;case "EPSILON":h="highp"==r.p.precision?1E-6:1E-4;break;case "SHADOW_TEX_RES":h=t(2048);break;case "AA_METHOD":h="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":h="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":h="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":h=
"POST_EFFECT_NONE";break;case "SHADOW_USAGE":h="NO_SHADOWS";break;case "SSAO_QUALITY":h="SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":h="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":h="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":h=r.p.precision;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":h="u_va_frame_factor";break;default:z.error("Unknown directive ("+a.$j+", "+a.Mi+"): "+f)}d(a,f,h)}};a.hL=function(a){return a.$j};a.XK=function(a){return a.Mi};a.pL=function(a,c){for(var f=c.bg,h=0;h<
f.length;h++){var e=f[h][0],m=f[h][1];b(a,e)&&d(a,e,m)}};a.ZD=function(a){var b=JSON.stringify(a),d=C[b];if(d)return d;var f=a.Mi,d=c(y.shaders_dir,a.$j),f=c(y.shaders_dir,f);if(!d||!f)return null;var h=n("vert",d,a),e=n("frag",f,a),d=x,m=l(d,b,h,d.VERTEX_SHADER),g=l(d,b,e,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,m);d.attachShader(f,g);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.JJ&&z.error("shader program is not valid",b);u.CB(f,b,m,g,h,e);a=
{Us:m,Qu:g,Th:f,attributes:{},ei:{},xl:[],Er:{},vr:!1,Yx:[],zb:a};e=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(h=0;h<e;h++)m=d.getActiveAttrib(f,h).name,a.attributes[m]=d.getAttribLocation(f,m);e=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(h=0;h<e;h++)m=d.getActiveUniform(f,h).name.split("[0]").join(""),a.ei[m]=d.getUniformLocation(f,m);return C[b]=d=a};a.lF=function(){L=!1;if(b4w.module_check("shader_texts"))L=!0;else{for(var a=[],b=k.AT_TEXT,c=0;c<m.length;c++){var d=D.pl(y.shaders_dir+
m[c]);a.push({id:m[c],type:b,url:d})}b=function(a,b){f||(f={});f[b]=a};a.length?k.enqueue(a,b,function(){L=!0}):z.error("Shaders have not been found.")}};a.DB=function(){return L};a.yK=function(){return h};a.av=function(){return C};a.cleanup=function(){for(var a in C){var b=C[a];x.deleteProgram(b.Th);x.deleteShader(b.Us);x.deleteShader(b.Qu);delete C[a]}for(var c in v)delete v[c];for(var d in h)delete h[d]};a.zK=function(a){var b=a.bg;z.log("Shader: "+a.$j+" "+a.Mi+", "+String(b.length)+" directives: ");
for(a=0;a<b.length;a++)z.log("  "+b[a][0],b[a][1])};a.q=t;a.bu=function(a,b){return b in a.ei?!0:!1};a.rE=function(a){return(x.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__geometry=function(a,p){function d(a,b){for(var c=1;c<a.qa.length;c++){for(var d=a.qa[c].Bc,f=d.a_position,h=d.a_normal,e=b.a_position,m=b.a_normal,g=f.length,k=a.qa[c].tn,l=0;l<g;l++)e[l]+=k*f[l],m[l]+=k*h[l];d=d.a_tangent;f=b.a_tangent;h=d.length;for(l=0;l<h;l++)f[l]+=k*d[l]}}function b(a){return 65536<a.fa?h.cv()?!1:!0:!1}function c(a){return 0<a.Ia.length?!0:!1}function n(a,b,d){if(!c(a))return a;d||x.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.fa*(b||
1)+", will use drawArrays","color: #aa0");b=a.Ia;d=a.fa;var f=a.O,h=a.D,e;for(e in f){var m=f[e],k=z(m,d);f[e]=g(b,m,k)}for(f=0;f<h.length;f++){var l=h[f];for(e in l)m=l[e],k=z(m,d),l[e]=g(b,m,k)}for(f=0;f<a.qa.length;f++){e=a.qa[f].Bc;for(var r in e)m=e[r],k=z(m,d),e[r]=g(b,m,k)}a.fa=b.length;a.Ia=new Uint16Array(0);return a}function g(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),f=0;f<a.length;f++)for(var h=a[f],e=0;e<c;e++)d[c*f+e]=b[c*h+e];return d}function q(a,
b){var c=a.zc,d=a.xb[b];if(d)return c.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function l(b,c){var d,f;switch(c){case a.ek:case a.jm:d=O.TRIANGLES;f=O.STATIC_DRAW;break;case a.gt:d=O.POINTS;f=O.STATIC_DRAW;break;case a.im:d=O.TRIANGLES;f=O.DYNAMIC_DRAW;break;case a.Py:d=O.POINTS;f=O.DYNAMIC_DRAW;break;case a.Qy:d=O.LINES;f=O.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=d;b.Wl=f}function t(a){a.eg?(a.uf||(a.uf=O.createBuffer()),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,
a.uf),O.bufferData(O.ELEMENT_ARRAY_BUFFER,a.eg,a.Wl),a.Um=a.eg.byteLength):a.Um=0;a.Kg||(a.Kg=O.createBuffer());O.bindBuffer(O.ARRAY_BUFFER,a.Kg);O.bufferData(O.ARRAY_BUFFER,a.zc,a.Wl);a.vu=a.zc.byteLength}function e(a){for(var b=P.Xb("JOIN_"+a.length+"_SUBMESHES"),c=0,d=0;d<a.length;d++)c+=a[d].Ia.length;b.Ia=new Uint32Array(c);var f=c=0,h=0;if(0<a[0].qa.length)for(var e=0;e<a[0].qa.length;e++){for(d=0;d<a.length;d++)c+=a[d].qa[e].Bc.a_position.length,f+=a[d].qa[e].Bc.a_normal.length,h+=a[d].qa[e].Bc.a_tangent.length;
d={a_position:new Float32Array(c),a_normal:new Float32Array(f),a_tangent:new Float32Array(h)};b.qa.push({tn:a[0].qa[e].tn,Bc:d})}for(d=c=0;d<a.length;d++)c+=a[d].fa;b.fa=c;var f=a[0],m;for(m in f.O){for(d=c=0;d<a.length;d++)c+=a[d].O[m].length;b.O[m]=new Float32Array(c)}for(m in f.D[0]){for(d=c=0;d<a.length;d++)c+=a[d].D[0][m].length;for(d=0;d<f.D.length;d++)b.D[d]=b.D[d]||{},b.D[d][m]=new Float32Array(c)}for(m=f=c=0;m<a.length;m++){for(var h=a[m],g=h.Ia,e=h.fa,k=h.O,d=0;d<g.length;d++)b.Ia[c+d]=
g[d]+f;var c=c+g.length,l;for(l in k){var g=k[l],r=f*z(g,e);b.O[l].set(g,r)}for(d=0;d<h.D.length;d++){var k=h.D[d],n=b.D[d];for(l in k)g=k[l],r=f*z(g,e),n[l].set(g,r)}f+=e}if(0<b.qa.length)for(m=0;m<b.qa.length;m++)for(l=b.qa[m].Bc,d=h=f=c=0;d<a.length;d++)e=a[d].qa[m].Bc,l.a_position.set(e.a_position,c),l.a_normal.set(e.a_normal,f),l.a_tangent.set(e.a_tangent,h),c+=e.a_position.length,f+=e.a_normal.length,h+=e.a_tangent.length;return b}function H(a,b,c,d,f,h){var e=P.Xb("SUBMESH_"+a.name+"_"+b),
m=a.submeshes[b],g=m.base_length,l=a.materials[b];e.fa=g;var t=!1;if(r(c,"a_texcoord")){var q=null,w=a.materials[b];b=a.submeshes[b];if(w.texture_slots.length)switch(w=w.texture_slots[0],w.texture_coords){case "UV":w=a.uv_textures.indexOf(w.uv_layer);0==w?q=new Float32Array(b.texcoord):1==w&&(q=new Float32Array(b.texcoord2));break;case "ORCO":for(var A=a.b4w_bounding_box_source,q=new Float32Array(2*b.base_length),w=(A.max_x+A.min_x)/2,L=(A.max_z+A.min_z)/2,p=A.max_x-A.min_x,A=A.max_z-A.min_z,z=0,
I=0;I<b.position.length;I+=3)q[z++]=(b.position[I]-w)/p+.5,q[z++]=(L-b.position[I+2])/A+.5}null===q&&(q=new Float32Array(2*b.base_length));b=q}else b=new Float32Array(0);if(r(c,"a_orco_tex_coord")){q=a.b4w_bounding_box_source;w=new Float32Array(3*m.base_length);L=q.max_x-q.min_x;p=q.max_y-q.min_y;A=q.max_z-q.min_z;for(I=z=0;I<m.position.length;I+=3)0==L?w[z++]=.5:w[z++]=P.clamp(parseFloat(((m.position[I]-q.min_x)/L).toFixed(5)),0,1),0==A?w[z++]=.5:w[z++]=P.clamp(parseFloat(((q.max_z-m.position[I+
2])/A).toFixed(5)),0,1),0==p?w[z++]=.5:w[z++]=P.clamp(parseFloat(((m.position[I+1]-q.min_y)/p).toFixed(5)),0,1);q=w}else q=new Float32Array(0);var J,w=m.group;if(r(c,"a_influence")&&d){L=new Float32Array(4*g);p=w.length/g;A=new Float32Array(p);for(z=0;z<p;z++)for(J in A[z]=-1,d)if(I=d[J],I.sy===z){A[z]=I.cq;break}var V=3<p?p:4;d=new Float32Array(V);J=new Uint32Array(V);for(var z=new Float32Array(4),I=new Float32Array(V),V=new Uint32Array(V),W=new Float32Array(4),Q=0;Q<g;Q++)d.set(I),J.set(V),z.set(W),
L.set(u(w,p,Q,g,A,d,J,z),4*Q)}else L=new Float32Array(0);J=L;d=f?P.za(f):{};d.a_color={vh:!0};d.a_color.src=r(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Ud:7}]:[];f={a_texcoord:b,a_influence:J,a_orco_tex_coord:q};J=m.vertex_colors;b=m.color;q=a.name;w=[];for(L=0;L<J.length;L++)w.push(J[L].name);for(var y in d)if(L=d[y].src,L.length){for(A=p=0;A<L.length;A++)p+=P.Xh(L[A].Ud);f[y]=new Float32Array(p*g);for(A=z=0;A<L.length;A++){var H=L[A].name,I=L[A].Ud,V=P.cx(I),C=w.indexOf(H);-1==
C&&P.Z('vertex color "'+H+'" for mesh "'+q+'" not found.');W=J[C].mask;Q=P.Xh(W);(I&W)!==I&&x.error("Wrong color extraction from "+H+" to "+y+".");for(var Z=H=0;Z<C;Z++)H+=P.Xh(J[Z].mask);C=H*g;for(H=0;H<g;H++)for(Z=0;3>Z;Z++)V[Z]&&(f[y][H*p+(z+P.Hl(I,Z))]=b[C+H*Q+P.Hl(W,Z)]);z+=Q}}else f[y]=new Float32Array(0);y=a.uv_textures;d=m.texcoord;J=m.texcoord2;if(h)for(var D in h){b=y.indexOf(D);if(0==b)var O=new Float32Array(d);else 1==b&&(O=new Float32Array(J));f[h[D]]=O}e.O=f;e.Ia=new Uint32Array(m.indices);
h=m.position.length/g/3;O=(D=r(c,"a_normal")&&m.normal.length?!0:!1)&&r(c,"a_tangent")&&m.tangent.length?!0:!1;y=l.texture_slots[0];y=D&&l.texture_slots.length&&r(c,"a_tangent")&&"ORCO"==y.texture_coords&&y.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&(t=!0);for(f=0;f<h;f++){l=k(m,c,g,D,O,y,f,a.name);if(t)if(d={},d.name=a.b4w_shape_keys[f].name,e.qa.push(d),0!=f){d.Bc=l;d.tn=a.b4w_shape_keys[f].value;continue}else d.Bc=k(m,c,g,D,O,y,f,a.name),d.tn=1;e.D.push(l)}if(1<h&&!t){a=e.D[0];var l={},T;
for(T in a)l[T]=new Float32Array(a[T]);e.D.push(l)}r(c,"a_polyindex")&&(n(e,1,!0),e.O.a_polyindex=v(e));return e}function k(a,b,c,d,f,h,e,m){var g={},k=new Float32Array(3*c),l=new Float32Array(d?3*c:0),n=new Float32Array(f||h?4*c:0),q=e*c*3;k.set(a.position.subarray(q,q+3*c),0);d&&(q=e*c*3,l.set(a.normal.subarray(q,q+3*c),0));if(f)q=e*c*4,n.set(a.tangent.subarray(q,q+4*c),0);else if(h)for(a=n,x.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+m+
'". Please add a UV-map.'),m=0;m<c;m++)b=w,d=I,b[0]=l[3*m],b[1]=l[3*m+1],b[2]=l[3*m+2],A.cross(b,P.AXIS_Z,d),0==A.length(d)&&A.cross(b,P.AXIS_X,d),A.normalize(d,d),a[4*m]=d[0],a[4*m+1]=d[1],a[4*m+2]=d[2],a[4*m+3]=1;else if(d&&r(b,"a_tangent"))for(n=new Float32Array(4*c),c=0;c<n.length;c++)n[c]=1;g.a_position=k;g.a_normal=l;g.a_tangent=n;return g}function r(a,b){return-1<a.indexOf(b)?!0:!1}function u(b,c,d,f,h,e,m,g){for(var k=!0,l=0;l<c;l++){var r=b[l*f+d];if(-1!==r){var n=h[l];-1!==n&&(e[l]=r,m[l]=
n,k=!1)}}if(k)return g;D(e,m,a.Yo,!1);for(l=b=0;4>l;l++)b+=e[l];if(.01>b)return g;for(l=0;4>l;l++)e[l]/=b;if(.01>Math.abs(e[0]-1))g[0]=m[0]+1;else for(l=0;4>l;l++)g[l]=m[l]+e[l];return g}function z(a,b){if(0==b)return 0;var c=a.length,d=c/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+c+", base length="+b;return d}function D(b,c,d,f){for(var h=b.length,e=h,m=!1,g=f?-1:1;1<e||m;){1<e&&(e=Math.floor(e/1.247330950103979));for(var m=!1,k=0;e+k<h;k++)if(d==
a.Yo?0>g*(b[k]-b[k+e]):b[k]<b[k+e]&&f)m=b[k],b[k]=b[k+e],b[k+e]=m,m=c[k],c[k]=c[k+e],c[k+e]=m,m=!0}}function y(a,b,c){var d=[],f=[];A.subtract(b,a,d);A.subtract(c,a,f);A.normalize(d,d);A.normalize(f,f);return Math.acos(A.dot(d,f))}function C(a,b,d){b||(b=[]);d=d?a.D[0].a_normal:a.D[0].a_position;if(c(a)){a=a.Ia;for(var f=a.length/3,h=0;h<f;h++){var e=new Float32Array(9),m=a[3*h];e[0]=d[3*m];e[1]=d[3*m+1];e[2]=d[3*m+2];m=a[3*h+1];e[3]=d[3*m];e[4]=d[3*m+1];e[5]=d[3*m+2];m=a[3*h+2];e[6]=d[3*m];e[7]=
d[3*m+1];e[8]=d[3*m+2];b[h]=e}}else for(h=0;h<d.length;h++)e=new Float32Array(9),e[0]=d[9*h],e[1]=d[9*h+1],e[2]=d[9*h+2],e[3]=d[9*h+3],e[4]=d[9*h+4],e[5]=d[9*h+5],e[6]=d[9*h+6],e[7]=d[9*h+7],e[8]=d[9*h+8],b[h]=e;return b}function v(a){for(var b=new Float32Array(a.fa),c=0;c<a.fa;c++)b[c]=c%3;return b}function f(a,b,c){var d=A.dist(a,b);a=A.dist(a,c);b=A.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function m(a,b,c,d,f){c-=b;for(var h=0;h<c;h+=d)h%d==f&&vec3.normalize(a.subarray(h+b-f,h+b+1),a.subarray(h+
b-f,h+b+1))}var h=p("__extensions"),x=p("__print"),L=p("__tsr"),P=p("__util"),A=p("__vec3"),w=new Float32Array(3),I=new Float32Array(3),T=new Float32Array(3);a.af=10;a.qt=20;a.TJ=30;a.jm=10;a.gt=20;a.im=30;a.Py=40;a.Qy=50;a.Yo=0;a.bA=1;a.ek=a.jm;var O=null;a.yd=function(a){O=a};a.AK=function(a){var b=_buffers[a];O.deleteBuffer(b.uf);O.deleteBuffer(b.Kg);delete _buffers[a]};a.MH=function(f,h,e,m){b(f)&&n(f);var g=f.Ia,k=f.fa,r=f.D,q={},x;for(x in f.O)x in m&&!m[x].vh||(q[x]=f.O[x]);m={eg:null,zc:null,
Mq:0,count:0,xb:{},mode:0,Wl:0,Um:0,vu:0,Kg:null,uf:null,rn:null,qa:null};0<f.qa.length&&d(f,r[0]);if(g.length)if(x=g.length,65536>=k)var u=new Uint16Array(g),w=O.UNSIGNED_SHORT;else u=new Uint32Array(g),w=O.UNSIGNED_INT;else x=k,u=null;var A=0,L=r.length,v;for(v in r[0])var p=r[0][v],A=A+p.length*L;for(v in q)p=q[v],A+=p.length;v=new Float32Array(A);var A=0,L={},I;for(I in q){var y=q[I];if(p=y.length)v.set(y,A),L[I]={eK:I,Wd:z(y,k),offset:A,frames:1,length:p},A+=p}q=r.length;for(I in r[0])if(y=r[0][I],
p=y.length,y=z(y,k),p){L[I]={Wd:y,offset:A,frames:q,length:p};1<q&&(L[I+"_next"]={Wd:y,offset:A+p,frames:q,length:p});for(var H=0;H<q;H++)y=r[H][I],v.set(y,A),A+=p}m.count=x;m.eg=u;m.zc=v;m.Mq=w;m.xb=L;l(m,e);t(m);h!=a.af&&c(f)&&(m.rn={FF:new Float32Array(g.length),GF:new Float32Array(g.length),RC:new Float32Array(g.length/3),type:h});m.qa=f.qa;return m};a.KH=d;a.OE=b;a.NE=c;a.uo=n;a.Zx=function(a,b,c){l(a,b);a.count=c.length;a.eg=c;a.Mq=c instanceof Uint16Array?O.UNSIGNED_SHORT:O.UNSIGNED_INT};a.Eo=
function(a,b,c,d){var f=a.zc,h=a.xb,e=h[b];e?(c&&e.Wd!=c&&P.Z('invalid num_comp for "'+b+'"'),f.set(d,e.offset)):(f=f.length,e=new Float32Array(f+d.length),e.set(a.zc),e.set(d,f),a.zc=e,h[b]={Wd:c,offset:f});t(a)};a.eD=q;a.HL=function(a){a.Wl=O.STATIC_DRAW};a.wF=function(a){a.Wl=O.DYNAMIC_DRAW};a.cy=t;a.du=function(a){a.uf&&O.deleteBuffer(a.uf);a.Kg&&O.deleteBuffer(a.Kg)};a.vv=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Jx=function(a,b){for(var c=0;c<a.D.length;c++){var d=a.D[c].a_position;
L.transform_vectors(d,b,d,0);d=a.D[c].a_normal;0<d.length&&L.transform_dir_vectors(d,b,d,0);d=a.D[c].a_tangent;0<d.length&&L.transform_tangents(d,b,d,0)}(c=a.O.au_center_pos)&&c.length&&L.transform_vectors(c,b,c,0);return a};a.JH=function(a,b){var c=a.O.au_center_pos;if(c&&c.length){var d=new Float32Array(c);L.transform_vectors(d,b,d,0);for(var f=0;f<a.D.length;f++)for(var h=0;h<d.length;h++)a.D[f].a_position[h]+=d[h]-c[h];c.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';
};a.IH=function(a,b){var c=a.fa,d;for(d in b){var f=b[d].length;a.O[d]=new Float32Array(f*c);for(var h=0;h<c;h++)for(var e=0;e<f;e++)a.O[d][h*f+e]=b[d][e]}};a.LH=e;a.vF=function(a,b,c){if(!a.fa)return P.Xb("EMPTY");var d=c.length;65536<a.fa*d&&!h.cv()&&n(a,d);var f=a.Ia,e=a.fa,m=a.O;a=a.D;for(var g in b){var k=b[g].length,l=k*e;m[g]=new Float32Array(l);for(var r=0;r<e;r++)for(l=0;l<k;l++)m[g][r*k+l]=b[g][l]}b=P.Xb("CLONE_"+d+"_SUBMESHES");b.fa=e*d;b.Ia=new Uint32Array(f.length*d);for(r=0;r<d;r++)for(k=
f.length*r,g=e*r,l=0;l<f.length;l++)b.Ia[k+l]=f[l]+g;for(var q in m)for(f=m[q],l=f.length*d,k=z(f,e),b.O[q]=new Float32Array(l),r=0;r<d;r++)g=e*k*r,b.O[q].set(f,g);for(q in a[0])for(r=0;r<a.length;r++)for(f=a[r][q],l=f.length*d,k=z(f,e),b.D[r]=b.D[r]||{},b.D[r][q]=new Float32Array(l),l=0;l<d;l++)switch(m=c[l],g=e*k*l,q){case "a_position":L.transform_vectors(f,m,b.D[r][q],g);break;case "a_normal":L.transform_dir_vectors(f,m,b.D[r][q],g);break;case "a_tangent":L.transform_tangents(f,m,b.D[r][q],g);
break;default:throw"Wrong attribute name: "+q;}return b};a.Ju=H;a.hD=function(a){var b=a.fa,c=a.D[0].a_position,d=new Float32Array(12*b),f=new Float32Array(8*b);a=new Uint32Array(4*a.Ia.length);for(var h=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];f[8*e]=-.5;f[8*e+1]=-.5;f[8*e+2]=-.5;f[8*e+
3]=.5;f[8*e+4]=.5;f[8*e+5]=.5;f[8*e+6]=.5;f[8*e+7]=-.5;a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var m=Math.random();h[4*e]=m;h[4*e+1]=m;h[4*e+2]=m;h[4*e+3]=m}c=P.Xb("HALO");c.D=[];c.D[0]={};c.fa=4*b;c.D[0].a_position=d;c.O.a_halo_bb_vertex=f;c.O.a_random_vals=h;c.Ia=a;return c};a.yE=r;a.Ku=function(a,b,c){for(var d=[],f=0;f<a.submeshes.length;f++){var h=H(a,f,b,null,c,null);h.fa&&d.push(h)}return 0==d.length?P.Xb("EMPTY"):1==d.length?d[0]:e(d)};a.jI=function(a,
b,c){for(var d=a.eg,f=q(a,"a_position"),h=a.rn,e=h.FF,m=h.GF,h=h.RC,g=d,k=g.length/3,l=0;l<k;l++){var r=g[3*l],n=g[3*l+1],t=g[3*l+2],x=f[3*r+1],u=f[3*r+2],w=f[3*n+1],A=f[3*n+2],v=f[3*t+1],V=f[3*t+2];e[3*l]=(f[3*r]+f[3*n]+f[3*t])/3;e[3*l+1]=(x+w+v)/3;e[3*l+2]=(u+A+V)/3}L.transform_vectors(e,b,m);b=m.length/3;for(f=0;f<b;f++)e=m[3*f]-c[0],g=m[3*f+1]-c[1],k=m[3*f+2]-c[2],h[f]=e*e+g*g+k*k;c=d;d=h.length;if(!(2>d))for(m=d,f=!1;1<m||f;)for(1<m&&(m=Math.floor(m/1.247330950103979)),f=!1,b=0;m+b<d;b++)0>h[b]-
h[b+m]&&(f=h[b],h[b]=h[b+m],h[b+m]=f,f=c,e=b,g=b+m,k=f[3*e],l=f[3*e+1],r=f[3*e+2],f[3*e]=f[3*g],f[3*e+1]=f[3*g+1],f[3*e+2]=f[3*g+2],f[3*g]=k,f[3*g+1]=l,f[3*g+2]=r,f=!0);d=c;O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,a.uf);O.bufferData(O.ELEMENT_ARRAY_BUFFER,d,O.DYNAMIC_DRAW)};a.xx=D;a.Qt=function(a,b,c){for(var d=b.length/3,f=a.length/3,h=[],e=Array(3),m=Array(3),g=Array(3),k=0;k<f;k++){for(var l=a[3*k],r=a[3*k+1],n=a[3*k+2],q=0;3>q;q++)e[q]=b[3*l+q],m[q]=b[3*r+q],g[q]=b[3*n+q];if(c)var q=y(e,m,g),t=y(m,
g,e),x=Math.PI-q-t;else x=t=q=1;var u=h,w;w=e;var L=g,V=[],W=[],v=[];A.subtract(m,w,V);A.subtract(L,w,W);A.cross(V,W,v);A.normalize(v,v);w=v;for(L=0;3>L;L++)V=3*r+L,W=3*n+L,u[3*l+L]=q*w[L],u[V]=t*w[L],u[W]=x*w[L]}if(c)for(var p in c)for(k=c[p],a=0;3>a;a++){b=3*k[0]+a;for(f=1;f<k.length;f++)e=3*k[f]+a,h[b]+=h[e];for(f=1;f<k.length;f++)e=3*k[f]+a,h[e]=h[b]}for(k=0;k<d;k++){c=k;p=h;a=new Float32Array(3);for(b=0;3>b;b++)f=3*c+b,a[b]=p[f];A.normalize(a,a);for(b=0;3>b;b++)f=3*c+b,p[f]=a[b]}return h};a.Rt=
function(a,b,c){for(var d={},f=b.length/3,h=0;h<f;h++){var e=String(b[3*h])+String(b[3*h+1])+String(b[3*h+2]);d[e]=[]}f=a.length;for(h=0;h<f;h++)b=a[h],e=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),e in d&&d[e].push(b);return d};a.Aq=function(a,b,c,d){var h=C(a,null,!1);if(c)var e=C(a,null,!0);var m=h.length,g=new Float32Array(m),k=w,l=I;for(a=0;a<m;a++){var r=h[a];k.set(r.subarray(0,3));l.set(r.subarray(3,6));T.set(r.subarray(6));g[a]=Math.sqrt(f(k,l,T))}k=new Float32Array(m);k[0]=g[0];for(a=
1;a<m;a++)k[a]=k[a-1]+g[a];m=k[g.length-1];g=[];for(a=0;a<b;a++){var l=m*P.Yd(d),l=P.Dm(k,l,0,k.length-1),r=c?e[l]:h[l],l=a,n=r,q=d,r=void 0,r=new Float32Array(3),t=n[0],x=n[1],u=n[2],A=n[3],L=n[4],v=n[5],V=n[6],W=n[7],Q=n[8],n=P.Yd(q),q=P.Yd(q);1<n+q&&(n=1-n,q=1-q);var p=1-n-q,x=p*x+n*L+q*W,u=p*u+n*v+q*Q;r[0]=p*t+n*A+q*V;r[1]=x;r[2]=u;g[l]=r}return g};a.GK=C;a.qq=v;a.jM=f;a.gx=function(a,b,c){a=a.D[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],
a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.Dt=function(a,b,c){var d=a.B[0].T;a=a.g.zg;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].Ke&&d[f].te&&!d[f].nh){c=d[f].P.xb;b=d[f].P.zc;O.bindBuffer(O.ARRAY_BUFFER,d[f].P.Kg);var h=c.a_position,e=d[f],g=b,k=a;if(h){for(var l=h.offset,h=h.length+l,r=e.P.qa[0].Bc.a_position,n=l;n<h;n++)g[n]=r[n-l];for(n=1;n<e.P.qa.length;n++){var r=e.P.qa[n].Bc.a_position,q=k[n].value;if(q)for(var t=l;t<h;t++)g[t]+=q*r[t-l]}O.bufferSubData(O.ARRAY_BUFFER,
4*l,g.subarray(l))}h=c.a_normal;e=d[f];g=b;k=a;if(h){l=h.offset;h=h.length+l;r=e.P.qa[0].Bc.a_normal;for(n=l;n<h;n++)g[n]=r[n-l];for(n=1;n<e.P.qa.length;n++)if(r=e.P.qa[n].Bc.a_normal,q=k[n].value)for(t=l;t<h;t++)g[t]+=q*r[t-l];m(g,l,h,3,2);O.bufferSubData(O.ARRAY_BUFFER,4*l,g.subarray(l))}k=c.a_tangent;c=d[f];e=a;if(k){g=k.offset;k=k.length+g;h=c.P.qa[0].Bc.a_tangent;for(l=g;l<k;l++)b[l]=h[l-g];for(l=1;l<c.P.qa.length;l++)if(h=c.P.qa[l].Bc.a_tangent,n=e[l].value)for(r=g;r<k;r++)b[r]+=n*h[r-g];m(b,
g,k,4,3);O.bufferSubData(O.ARRAY_BUFFER,4*g,b.subarray(g))}}};a.check_shape_keys=function(a){return a.g.te};a.get_shape_keys_names=function(a){var b=[];if(a.g)for(var c=1;c<a.g.zg.length;c++)b.push(a.g.zg[c].name);return b};a.get_shape_key_value=function(a,b){if(a.g)for(var c=1;c<a.g.zg.length;c++)if(b==a.g.zg[c].name)return a.g.zg[c].value;return 0};a.Kq=function(a,b){var c=a.g.zg;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Zi=function(a){return a&&a.g&&a.g.He?!0:!1};a.draw_line=
function(b,c,d){var f=b.P;if(f){for(var h=d?c.length/3/2:c.length/3-1,e=new Float32Array(12*h),m=new Float32Array(12*h),g=new Uint16Array(6*h),k=0;k<h;k++){if(d)var l=6*k,r=6*k+3;else l=3*k,r=3*(k+1);var n=c[l],q=c[l+1],l=c[l+2],x=c[r],u=c[r+1],r=c[r+2],w=x-n,A=u-q,L=r-l;e[12*k]=n;e[12*k+1]=q;e[12*k+2]=l;m[12*k]=w;m[12*k+1]=A;m[12*k+2]=L;e[12*k+3]=x;e[12*k+4]=u;e[12*k+5]=r;m[12*k+3]=-w;m[12*k+4]=-A;m[12*k+5]=-L;e[12*k+6]=n;e[12*k+7]=q;e[12*k+8]=l;m[12*k+6]=-w;m[12*k+7]=-A;m[12*k+8]=-L;e[12*k+9]=x;
e[12*k+10]=u;e[12*k+11]=r;m[12*k+9]=w;m[12*k+10]=A;m[12*k+11]=L;g[6*k]=4*k;g[6*k+1]=4*k+1;g[6*k+2]=4*k+2;g[6*k+3]=4*k;g[6*k+4]=4*k+3;g[6*k+5]=4*k+1}d=0;for(var v in f.xb)c=f.xb[v],d+=e.length/3*c.Wd;f.zc=new Float32Array(d);d=f.zc;a.Zx(f,b.nf,g);b=0;for(v in f.xb)switch(c=f.xb[v],v){case "a_position":d.set(e,b);c.offset=b;c.length=e.length;b+=c.length;break;case "a_direction":d.set(m,b);c.offset=b;c.length=m.length;b+=c.length;break;default:c.offset=b,c.length=e.length/3*c.Wd,g=new Float32Array(c.length),
d.set(g,b),b+=c.length}t(f)}}};b4w.module.__objects=function(a,p){function d(a){a.g.pg=0;a=ia.indexOf(a);-1!=a&&ia.splice(a,1)}function b(a){if(a.Ii)for(var b=a.B,c=0;c<b.length;c++)G.qI(b[c].wa,a)}function c(a,b){for(var c=a.B,d=b.B,f=0;f<c.length;f++){for(var h=!1,e=0;e<d.length;e++)if(c[f].wa==d[e].wa){h=!0;break}h||n(b,c[f].wa)&&A.ti(b,c[f].wa)}}function n(a,b){return!b.st&&"SPEAKER"==a.type||!b.jA&&("LAMP"==a.type||"CAMERA"==a.type)?!1:!0}function g(a,b){if(a.dg_parent&&a.dg_parent.Zo||a.parent&&a.parent.Zo)return!0;switch(a.type){case "MESH":var c=
a.b4w_do_not_batch,d=a.b4w_collision,f=a.b4w_vehicle,h=a.b4w_floating,e=a.b4w_character,m=w.AE(a),g=P.Ot(a),k=0<a.data.b4w_shape_keys.length,l=a.b4w_dynamic_geometry;if(!(c=y.Pt(a,b)||c||d||f||k||h))a:{c=a.data;for(d=0;d<c.materials.length;d++)if("LENS_FLARES"===c.materials[d].name){c=!0;break a}c=!1}return c||m||e||g||l;case "EMPTY":return e=P.Ot(a),m=a.b4w_do_not_batch,g=Boolean(a.b4w_anchor),y.Pt(a,b)||e||m||g;default:return!0}}function q(a,b,c,d,f,h,e,m,g){for(var k=0;k<a.nodes.length;k++){var r=
a.nodes[k];if("VALUE"==r.type){var n=t(b,r.name);d.push(r.outputs[0].default_value);f.push(n,f.length/2)}else"RGB"==r.type?(n=t(b,r.name),r=r.outputs[0].default_value.slice(0,3),e.push(r[0],r[1],r[2]),m.push(n,m.length/2)):"GROUP"==r.type&&(n=r.node_group.node_tree,q(n,t(b,r.name),n.animation_data,d,f,h,e,m,g))}if(c)for((a=c.action)&&a.k.type==y.et&&l(a,b,h,f,g,m),c=c.nla_tracks,d=0;d<c.length;d++)for(e=c[d].strips,k=0;k<c[d].strips.length;k++)(a=e[k].action)&&a.k.type==y.et&&l(a,b,h,f,g,m)}function l(a,
b,c,d,f,h){var m=a.k.r,g;for(g in m){var k=t(b,g.match(/"(.*?)"/)[1]),m=e(d,k);null!=m?(k=t(a.name,g),c.push(k,m)):(m=e(h,k),null!=m&&(k=t(a.name,g),f.push(k,m)))}}function t(a,b){return a+"%join%"+b}function e(a,b){for(var c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}function H(a,b){for(var c=a.g.Hh,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function k(a,b){for(var c=a.g.Gh,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function r(a,b){var c=a.animation_data,d=
a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.k.type==y.Ny||c.k.type==y.Ky&&"ARMATURE"==b.type||c.k.type==y.My&&"LAMP"==b.type||c.k.type==y.Ly&&"WORLD"==b.type)&&b.actions.push(c));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.actions.push(d.action);"MESH"==b.type&&b.actions.push.apply(b.actions,y.WD(a))}function u(a,b,c){b=E[b]||[];for(var d=[],f=0;f<b.length;f++){var h=b[f];if(h.g.Jc==c||-1==c)for(var e=h.B,m=0;m<e.length;m++)e[m].wa==a&&d.push(h)}return d}function z(a,b,c,
d){for(var f=null,h=0;h<b.length;h++){var e=b[h];if((c?e.Nh:e.name)==a&&(e.g.Jc==d||-1==d)&&(f=e,!A.get_dg_parent(f)))break}return f}function D(a){E.ALL.push(a);E[a.type]||(E[a.type]=[]);E[a.type].push(a);var b=a.g.td;if(null!=b)for(var c=0;c<la.length;c++){var d=la[c];d.g.td==b&&d.Fl.push(a)}}var y=p("__animation"),C=p("__batch"),v=p("__boundings"),f=p("__camera"),m=p("__config"),h=p("__constraints"),x=p("__geometry"),L=p("__lights"),P=p("__nla"),A=p("__obj_util"),w=p("__particles"),I=p("__physics"),
T=p("__print"),O=p("__primitives"),B=p("__quat"),G=p("__scenes"),M=p("__sfx"),F=p("__transform"),R=p("__textures"),S=p("__tsr"),ha=p("__util"),N=p("__vec3"),oa=p("__armature"),fa=p("__anchors"),na=m.p,ba=m.Kb,E={ALL:[]},ea=0,qa=0,la=[],ia=[],ya=new Float32Array(3),J=new Float32Array(4);a.Xo=0;a.Wo=1;a.hc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=E.ALL,c=E.ARMATURE,f=0;f<b.length;f++)for(var h=b[f],e=h.B,m=0;m<e.length;m++){var g=e[m],k=g.wa,g=g.T;if(k.k.outline){if(-1!=ia.indexOf(h)){var l=
h,r=a,n=0,q=l.xw;0==q.wo&&(q.wo=r);r-=q.wo;if(q.Nr&&r/q.sd>=q.Nr)d(l);else{r%=q.sd;if(r<q.zr)switch(q=r/(q.zr/5),r=Math.floor(q),r){case 0:n=(q-r)/2;break;case 1:n=(q-r)/2+.5;break;case 2:n=1;break;case 3:n=1-(q-r)/2;break;case 4:n=.5-(q-r)/2}l.g.pg=n}}h.g.pg&&G.uG(k)}w.pI(h,g)}if(c)for(f=0;f<c.length;f++)a=c[f],a.sr&&(F.m(a),a.sr=!1)};a.apply_outline_anim=function(a,b,c,d){var f=a.xw;f.wo=0;f.zr=b;f.sd=c;f.Nr=d;-1==ia.indexOf(a)&&ia.push(a)};a.clear_outline_anim=d;a.Ig=function(a,b){b.Jg=a.uuid;
b.eh=!0;r(a,b);a.Zo=b.ma=g(a,b);a.kA=!0;b.Mc=a.b4w_vehicle;b.is_character=a.b4w_character;b.Bh=a.b4w_floating;b.gi=a.b4w_collision;b.Ya=a.b4w_collision_id;b.Pm=a.b4w_correct_bounding_offset;var c=a.game;b.oe={Wn:c.physics_type,Zl:c.use_ghost,ly:c.use_sleep,Me:c.mass,py:c.velocity_min,oy:c.velocity_max,$p:c.damping,Ur:c.rotation_damping,mF:c.lock_location_x,nF:c.lock_location_y,oF:c.lock_location_z,pF:c.lock_rotation_x,qF:c.lock_rotation_y,rF:c.lock_rotation_z,zk:c.collision_margin,xk:c.collision_group,
Ak:c.collision_mask,Os:c.use_collision_bounds,Km:c.collision_bounds_type,Xl:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.Zc={name:c.name,Oc:c.part,PH:c.suspension_rest_length,zs:c.suspension_compression,Bs:c.suspension_stiffness,As:c.suspension_damping,$s:c.wheel_friction,Sr:c.roll_influence,mr:c.max_suspension_travel_cm,Uk:c.force_max,ok:c.brake_max,Mj:c.steering_max,jj:c.max_speed_angle,Jk:c.delta_tach_angle,Nl:c.speed_ratio,Ql:c.steering_ratio,jl:c.inverse_control,th:c.floating_factor,
mi:c.water_lin_damp,ni:c.water_rot_damp,Nx:c.synchronize_position};if(c=a.b4w_floating_settings)b.Ji={name:c.name,Oc:c.part,th:c.floating_factor,mi:c.water_lin_damp,ni:c.water_rot_damp,Nx:c.synchronize_position};if(c=a.b4w_character_settings)b.Yt={jJ:c.walk_speed,zG:c.run_speed,HH:c.step_height,UE:c.jump_strength,lJ:c.waterline};for(c=0;c<a.constraints.length;c++){var d=a.constraints[c];"RIGID_BODY_JOINT"==d.type&&b.Fr.push({target:d.target.oa,XF:d.pivot_type,YF:d.pivot_x,ZF:d.pivot_y,$F:d.pivot_z,
Be:d.axis_x,Ce:d.axis_y,De:d.axis_z,MI:d.use_limit_x,NI:d.use_limit_y,OI:d.use_limit_z,HI:d.use_angular_limit_x,II:d.use_angular_limit_y,JI:d.use_angular_limit_z,dF:d.limit_max_x,eF:d.limit_max_y,fF:d.limit_max_z,gF:d.limit_min_x,hF:d.limit_min_y,iF:d.limit_min_z,YE:d.limit_angle_max_x,ZE:d.limit_angle_max_y,$E:d.limit_angle_max_z,aF:d.limit_angle_min_x,bF:d.limit_angle_min_y,cF:d.limit_angle_min_z})}c=b.g=A.lh("MESH"===b.type?b.ma?"DYNAMIC":"STATIC":b.type);a.parent?(b.parent=a.parent.oa,"BONE"==
a.parent_type&&"ARMATURE"==a.parent.type&&(b.vl=a.parent_bone),a.pinverse_tsr&&(b.Xn=S.create(),S.copy(a.pinverse_tsr,b.Xn))):a.dg_parent&&(b.parent=a.dg_parent.oa,b.rg=!0);var d=a.location,h=a.scale[0];ha.Kr(a.rotation_quaternion,J);F.set_translation(b,d);F.set_rotation(b,J);F.set_scale(b,h);b.Yl=a.b4w_use_default_animation;b.ik=y.cp(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Jn={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});a.b4w_viewport_alignment&&
(b.Oo={mA:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":oa.Ig(a,b);d=c.Jd;h=y.lB(d);a.b4w_animation_mixing?(c.Qc=new Float32Array(h.Ca),c.ud=new Float32Array(h.Ca),c.Yc=new Float32Array(h.trans),c.Dd=new Float32Array(h.trans)):(c.Qc=h.Ca,c.ud=h.Ca,c.Yc=h.trans,c.Dd=h.trans);for(var e in d){var m=d[e];1==m.Jm.length&&oa.iI(m,!0,h.trans,h.Ca)}c.Gr=h;c.Qd=0;c.Xg=a.b4w_animation_mixing;break;case "MESH":c.Di=a.b4w_do_not_render;c.vi=C.YA(a.data.b4w_bounding_box);
c.xg=ba.outlining_overview_mode||a.b4w_selectable;c.Qn=a.b4w_selectable;c.Kb=ba.outlining_overview_mode||a.b4w_outlining;c.Pn=a.b4w_outlining;c.yw=ba.outlining_overview_mode||a.b4w_outline_on_select;c.ee=a.b4w_billboard;c.rp=a.b4w_pres_glob_orientation;c.mk="BASIC";c.lk="SPHERICAL"==a.b4w_billboard_geometry;e=c.sj;e.tj=a.b4w_outline_settings.outline_duration;e.uj=a.b4w_outline_settings.outline_period;e.vj=a.b4w_outline_settings.outline_relapses;c.xg&&(c.Lm=ha.Ru(ea),ea++);for(e=0;e<a.data.b4w_vertex_anim.length;e++)d=
a.data.b4w_vertex_anim[e],b.mc.push({name:d.name,Y:d.frame_start,pa:d.frame_end,gK:d.averaging,hK:d.averaging_interval,nA:d.allow_nla});b.g.mc=b.mc.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;e=b.g;if(a.data.b4w_shape_keys.length)for(e.te=!0,d=0;d<a.data.b4w_shape_keys.length;d++)h={},h.value=a.data.b4w_shape_keys[d].value,h.name=a.data.b4w_shape_keys[d].name,e.zg.push(h);else e.te=!1;e=b.g;for(var d=a.data.materials,h=[],m=[],k=[],l=[],n=[],t=[],x=0;x<d.length;x++){var u=d[x],
w=u.node_tree;w&&q(w,u.name,w.animation_data,h,m,k,l,n,t)}e.xf=h;e.Hh=m;e.Hn=k;e.qd=l;e.Gh=n;e.In=t;c.zd=a.b4w_shadow_cast;c.Vc=a.b4w_shadow_receive;c.Uc=a.b4w_shadow_cast_only&&c.zd;c.Ec=a.b4w_reflexible;c.wc=a.b4w_reflexible_only&&c.Ec;c.Rc=a.b4w_reflective;c.Qe=a.b4w_reflection_type;c.gf=a.b4w_caustics;c.Gd=a.b4w_wind_bending;c.em=a.b4w_wind_bending_angle;e=C.mJ(a.b4w_wind_bending_angle,c.vi,a.scale[0]);c.Ye=e;c.Mf=a.b4w_wind_bending_freq;c.mf=a.b4w_detail_bending_freq;c.lf=a.b4w_detail_bending_amp;
c.ff=a.b4w_branch_bending_amp;c.xh=!1;c.wf=a.b4w_main_bend_stiffness_col;e=a.b4w_detail_bend_colors;c.uc={};c.uc.Vv=e.leaves_stiffness_col;c.uc.Uv=e.leaves_phase_col;c.uc.zw=e.overall_stiffness_col;c.ph=a.b4w_do_not_cull;c.Xm=a.b4w_disable_fogging;c.He=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";e=a.data.materials[0];c.Yk=e.physics.friction;c.Pk=e.physics.elasticity;c.ol=0;c.ig=1E6;c.Fh=a.b4w_lod_transition;c.zn=!0;break;case "LINE":c.ph=!0;c.bc=v.$c();c.dd=v.oi();c.ef=v.Iy();c.Cb=
v.$c();c.Wb=v.oi();c.Uf=v.Iy();break;case "CAMERA":f.oB(a,b);f.SA(b);break;case "LAMP":L.VE(a,b);break;case "SPEAKER":b.H=M.oC();c=!1;for(e=0;e<b.B.length;e++)if(b.B[e].wa.b4w_enable_audio){c=!0;break}c&&M.Ig(a,b);break;case "EMPTY":c.bc=v.$c(),e=v.oi(),c.dd=e,a.field&&(b.Ii={type:a.field.type,Hx:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Bi:a.b4w_anchor.detect_visibility,$m:a.b4w_anchor.element_id,DF:a.b4w_anchor.max_width})}D(b)};a.FI=function(a,b){b.Jg=a.uuid;b.eh=!0;r(a,
b);a.Zo=b.ma=g(a,b);a.kA=!0;b.g=A.lh(b.type);b.Yl=a.b4w_use_default_animation;b.ik=y.cp(a.b4w_anim_behavior);D(b)};a.vI=function(a,b){var d=b.g;if(b.parent){!b.rg&&b.oe.Xl&&b.parent.oe.Xl&&(b.gi=!1);for(var f=!1,e=0;e<b.B.length;e++)if(b.B[e].wa.tb){f=!0;break}if(e=f)e=b.oe,e=b.Mc||b.Bh||I.is_character(b)||b.gi&&!e.Zl&&0<e.Me&&("DYNAMIC"==e.Wn||"RIGID_BODY"==e.Wn);if(e)e=b.rg?S.copy(d.i,S.create()):d.i,S.multiply(b.parent.g.i,e,d.i),F.set_translation(b,S.get_trans_view(d.i)),F.set_scale(b,S.get_scale(d.i)),
F.set_rotation(b,S.get_quat_view(d.i));else if(b.rg||!b.vl)if(e=S.copy(d.i,S.create()),b.Oo&&"CAMERA"==b.parent.type){e={distance:b.Oo.distance,rotation:S.get_quat_view(e)};switch(b.Oo.mA){case "TOP_LEFT":e.top=0;e.left=0;break;case "TOP":e.top=0;e.left=.5;break;case "TOP_RIGHT":e.top=0;e.right=0;break;case "LEFT":e.top=.5;e.left=0;break;case "CENTER":e.top=.5;e.left=.5;break;case "RIGHT":e.top=.5;e.right=0;break;case "BOTTOM_LEFT":e.bottom=0;e.left=0;break;case "BOTTOM":e.bottom=0;e.left=.5;break;
case "BOTTOM_RIGHT":e.bottom=0,e.right=0}h.append_stiff_viewport(b,b.parent,e)}else h.rA(b,b.parent,e);else e=S.copy(d.i,S.create()),h.sA(b,b.parent,b.vl,e)}if("ARMATURE"==b.type)for(f=a.pose.bones,e=0;e<f.length;e++){var m=f[e],g=m.constraints;if(g)for(var k=0;k<g.length;k++){var l=g[k];"COPY_TRANSFORMS"!=l.type||l.subtarget||l.mute||h.CA(b,l.target.oa,m.name,ha.ot,ha.nt)}}if("MESH"==b.type)var r=y.Zu(a);if(r){g=r.oa;e=g.g.Gr;f=b.g;m=a.data;b.xm=g;m=m.vertex_groups;if(m.length){var g=g.g.Jd,k=0,
l={},n;for(n in g){var q=ha.keysearch("name",n,m);q&&(l[n]={sy:q.index,Vf:g[n].Vf,cq:k++})}f.xi=l;n=k;m=y.ev();f.yf=n;n>2*m?(f.dj=!1,T.error('too many bones for "'+a.name+'" / '+f.yf+" bones (max "+m+" with blending, "+2*m+" without blending). Skinning will be disabled.")):f.dj=!0}n=y.iD(e.trans,e.Ca,d.xi);r.b4w_animation_mixing?(d.Qc=new Float32Array(n.Ca),d.ud=new Float32Array(n.Ca),d.Yc=new Float32Array(n.trans),d.Dd=new Float32Array(n.trans)):(d.Qc=n.Ca,d.ud=n.Ca,d.Yc=n.trans,d.Dd=n.trans);d.hp=
new Float32Array(4);d.gp=B.create();d.Gr=n;d.Qd=0}if(d.Rc)if(d=b.g,"CUBE"==d.Qe)d.Kd=qa++;else if("PLANE"==d.Qe){a:{r=a.constraints;for(n=0;n<r.length;n++)if(e=r[n],"LOCKED_TRACK"==e.type&&"REFLECTION PLANE"==e.name){if(e.target.oa){r=e.target.oa;break a}T.warn('Reflection plane target "'+e.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}r=null}r||(r=ha.Wj("%reflection%"),r=A.Ai(r,"EMPTY"),n=A.lh("EMPTY"),r.g=n,c(b,r),h.Ct(r,b,[0,0,0],null,1),D(r));n=
null;for(e=0;e<la.length;e++)if(la[e]==r){n=e;break}null==n&&(n=la.length,la.push(r));r.g.td=n;d.td=n;r.Fl.push(b)}};a.by=b;a.sK=c;a.xB=n;a.wI=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.g||"DYNAMIC"!=c.g.type&&"CAMERA"!=c.g.type||F.m(c);c.Yl&&y.ww(c)&&(y.apply_def(c),c.M.length&&y.play(c,null,y.SLOT_ALL))}};a.get_meta_tags=function(a){return ha.za(a.Jn)};a.cleanup=function(){qa=ea=0;la=[];ia.length=0;E={ALL:[]}};a.copy=function(a,b,d){var f=b,e=A.get_dg_parent(a);b=e?A.Su(e.name,b):b;if(z(b,
E.ALL,!1,-1)){for(var e=1,h;;){h="."+(3>String(e).length?("000"+String(e)).slice(-3):String(e));if(!z(b+h,E.ALL,!1,-1))break;e++}T.error('Object "'+b+'" already exists. Name was replaced by "'+b+h+'".');f+=h;b+=h}f=A.Ai(b,a.type,f);f.eh=a.eh;f.ma=a.ma;f.ll=a.ll;f.Yl=a.Yl;f.g=A.zi(a.g);f.Jn=A.zi(a.Jn);c(a,f);f.ri=A.Qp(a.ri);f.parent=A.Qp(a.parent);f.rg=a.rg;f.vl=a.vl;!a.o||a.Mc||a.is_character||a.Bh||(f.gi=a.gi,f.o=null);f.Ya=a.Ya;f.Pm=a.Pm;f.oe=A.zi(a.oe);b=[];for(e=0;e<a.B.length;e++){var m=f.B[e];
h=a.B[e].T;if(d){for(var m=m.T,g=0;g<h.length;g++)if(!h[g].Ke){var k=A.zi(h[g]);m.push(k);b.push(h[g].P)}for(g=0;g<h.length;g++)if(h[g].Ke){k=A.zi(h[g]);m.push(k);for(var l=0;l<b.length;l++)b[l]==h[g].P&&(k.P=m[l].P)}for(g=0;g<m.length;g++)m[g].P&&x.cy(m[g].P),m[g].rj=f.Jg,C.dI(m[g],C.mB(f.g));R.pH(m)}else m.T=A.Qp(h)}A.Wr(f,!1);D(f);f.g.Cv=!0;f.g.Lm=ha.Ru(ea);ea++;return f};a.gL=H;a.cL=k;a.update_boundings=function(a){for(var b=a.g,c=a.B[0].T,d,f,e,h,m,g,k=0;k<c.length;k++)if("MAIN"==c[k].type){var l=
c[k].P.zc,r=c[k].P.xb.a_position.offset;d=h=l[r];f=m=l[r+1];e=g=l[r+2];break}for(k=0;k<c.length;k++)if(l=c[k],"MAIN"==l.type)for(var l=l.P.zc,n=c[k].P.xb,r=n.a_position.offset,n=n.a_position.length+r,q=r;q<n;q+=3){var r=l[q],t=l[q+1],u=l[q+2];d=Math.max(r,d);f=Math.max(t,f);e=Math.max(u,e);h=Math.min(r,h);m=Math.min(t,m);g=Math.min(u,g)}var w={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(m.toFixed(3)),
min_z:parseFloat(g.toFixed(3))},A=d-h,L=f-m,J=e-g;h=.5*(d+h);var p=.5*(f+m),X=.5*(e+g),Ca=h,ka=X;m=Math.max(A,Math.max(L,J))/2;g=Math.max(A,J)/2;var wa=[h/(A?A:1),p/(L?L:1),X/(J?J:1)],Da=.5;if(b.ee)r=Math.max(Math.abs(w.max_x),Math.abs(w.min_x)),t=Math.max(Math.abs(w.max_y),Math.abs(w.min_y)),u=Math.max(Math.abs(w.max_z),Math.abs(w.min_z)),m=Math.sqrt(r*r+t*t+u*u),g=Math.sqrt(r*r+t*t),w.max_x=w.max_y=w.max_z=m,w.min_x=w.min_y=w.min_z=-m,h=new Float32Array([0,0,0]),J=new Float32Array([m,m,m]),L=new Float32Array([0,
0,0]);else{for(k=0;k<c.length;k++)if(l=c[k],"MAIN"==l.type)for(l=l.P.zc,n=c[k].P.xb,r=n.a_position.offset,n=n.a_position.length+r,q=r;q<n;q+=3){var r=l[q],t=l[q+1],u=l[q+2],N=Math.sqrt((h-r)*(h-r)+(p-t)*(p-t)+(X-u)*(X-u));if(N>m){var z=h-m*(r-h)/N,I=p-m*(t-p)/N,N=X-m*(u-X)/N;h=(z+r)/2;p=(I+t)/2;X=(N+u)/2;m=Math.sqrt((h-r)*(h-r)+(p-t)*(p-t)+(X-u)*(X-u))}I=Math.sqrt((Ca-r)*(Ca-r)+(ka-u)*(ka-u));I>g&&(z=Ca-g*(r-Ca)/I,N=ka-g*(u-ka)/I,Ca=(z+r)/2,ka=(N+u)/2,g=Math.sqrt((Ca-r)*(Ca-r)+(ka-u)*(ka-u)));r/=
A?A:1;t/=L?L:1;u/=J?J:1;N=Math.sqrt((wa[0]-r)*(wa[0]-r)+(wa[1]-t)*(wa[1]-t)+(wa[2]-u)*(wa[2]-u));N>Da&&(z=wa[0]-Da*(r-wa[0])/N,I=wa[1]-Da*(t-wa[1])/N,N=wa[2]-Da*(u-wa[2])/N,wa[0]=(z+r)/2,wa[1]=(I+t)/2,wa[2]=(N+u)/2,Da=Math.sqrt((wa[0]-r)*(wa[0]-r)+(wa[1]-t)*(wa[1]-t)+(wa[2]-u)*(wa[2]-u)))}k=A?A*wa[0]:d;f=L?L*wa[1]:f;e=J?J*wa[2]:e;A*=Da;L*=Da;J*=Da;h=new Float32Array([h,p,X]);J=new Float32Array([A,L,J]);L=new Float32Array([k,f,e]);g=parseFloat(g.toFixed(3))}b.bc=w;C.WG(b,g,g,w);w=v.Rm(m,h);b.dd=w;
w=v.Qm([J[0],0,0],[0,J[1],0],[0,0,J[2]],L);b.ef=w;F.m(a);if(na.wireframe_debug)for(k=0;k<c.length;k++)if("WIREFRAME"===c[k].type&&c[k].nh){a=O.zq(1,w.K);x.gx(a,[w.Be[0],w.Ce[1],w.De[2]],w.K);x.uo(a,1,!0);a.O.a_polyindex=x.qq(a);C.cI(c[k],a);break}};a.Ga=u;a.mE=function(a,b){for(var c=E.ALL||[],d=[],f=0;f<c.length;f++){var e=c[f];if((e.g.Jc==b||-1==b)&&e.eh)for(var h=e.B,m=0;m<h.length;m++)h[m].wa==a&&d.push(e)}return d};a.get_all_objects=function(a){var b=E.ALL;if(-1==a)return b;for(var c=[],d=0;d<
b.length;d++){var f=b[d];f.g.Jc==a&&c.push(f)}return c};a.vH=function(a){var b=u(a,"LAMP",-1);if(b.length==a.k.KL){for(var c=[],d=0;d<b.length;d++){var f=b[d],f=A.Sa(f,a);c[f.Ch]=d}for(d=0;d<c.length-1;d++)for(f=d+1;f<c.length;f++){var e=b[c[d]].Oa,h=b[c[f]].Oa;if(h.Yj&&h.hi&&(!e.Yj||!e.hi)||!e.Yj&&(h.Yj||!e.hi&&h.hi))e=c[d],c[d]=c[f],c[f]=e}for(d=0;d<c.length;d++)f=b[c[d]],A.Sa(f,a).Ch=d,G.Fo(b[c[d]],a)}};a.aI=function(a){for(var b=u(a,"LAMP",-1),c=u(a,"MESH",-1),d=0;d<c.length;d++)for(var f=A.Sa(c[d],
a).T,e=0;e<f.length;e++){var h=f[e];"MAIN"==h.type&&(C.eI(h,b,a),C.Sb(h))}};a.get_selectable_objects=function(){for(var a=[],b=E.MESH,c=0;c<b.length;c++){var d=b[c];d.g.xg&&d.eh&&a.push(d)}return a};a.get_outlining_objects=function(){for(var a=[],b=E.MESH,c=0;c<b.length;c++){var d=b[c];d.g.Kb&&d.eh&&a.push(d)}return a};a.Qb=function(b,c,d,f){var e=null,h=E.ALL;switch(b){case a.Xo:e=z(c,h,!0,d);break;case a.Wo:a:{for(b=0;b<h.length;b++)if(e=h[b],e.Nh==d&&(e.g.Jc==f||-1==f)){var m=A.get_dg_parent(e);
if(m&&m.Nh==c)break a}e=null}break;case a.hc:a:{for(f=0;f<h.length;f++){b=h[f];for(var e=c.length-1,m=b,g=!0;0<=e&&g;)g=m&&m.Nh==c[e]&&(m.g.Jc==d||-1==d),m&&(m=A.get_dg_parent(m)),e--;if(g&&!m){e=b;break a}}e=null}}return e};a.pick_object=function(b,c){var d=G.Ti();if(!d)return T.error("No active scene"),null;var f=fa.VF(b,c);if(f)return f;f=G.WF(d,b,c);if(!f)return null;for(var d=u(d,"MESH",-1),e=0;e<d.length;e++){var h=d[e].g,m=h.Lm;if(m&&3>Math.abs(255*m[0]-f[0])&&3>Math.abs(255*m[1]-f[1])&&3>
Math.abs(255*m[2]-f[2]))return h.Kb&&h.yw&&(ba.outlining_overview_mode?a.apply_outline_anim(d[e],ba.tj,ba.uj,ba.vj):(f=h.sj,a.apply_outline_anim(d[e],f.tj,f.uj,f.vj))),d[e]}return null};a.set_wind_params=function(a,c){for(var d=u(a,"EMPTY",-1),f=0;f<d.length;f++){var e=d[f];if(e.Ii&&"WIND"===e.Ii.type)var h=e}if(!h)return T.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=c.wind_dir/180*Math.PI,N.set(Math.sin(d),0,Math.cos(d),ya),ha.QC(ya,ha.AXIS_Y,J),F.set_rotation(h,J));
"number"==typeof c.wind_strength&&(h.Ii.Hx=c.wind_strength);b(h)};a.remove_object=function(a){h.yB(a)&&h.remove(a);var b=E.ALL,c=E[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.PF=D;a.QF=function(a){return E[a.type]&&-1<E[a.type].indexOf(a)};a.set_nodemat_rgb=function(a,b,c,d,f){b=b.join("%join%");var e=k(a,b);null!=e?(a.g.qd[3*e]=c,a.g.qd[3*e+1]=d,a.g.qd[3*e+2]=f):T.error('The RGB node "'+b+'" was not found in the object "'+a.name+'".')};a.set_nodemat_value=function(a,
b,c){b=b.join("%join%");var d=H(a,b);null!=d?a.g.xf[d]=c:T.error('The Value node "'+b+'" was not found in the object "'+a.name+'".')}};b4w.module.__obj_util=function(a,p){function d(a){if(!(a instanceof Object))return a;var b=null,c=null,g=null;a.U&&(b=a.U,a.U=null);a.lc&&(c=a.lc,a.lc=null);a.qa&&(g=a.qa,a.qa=null);var l;l=a.constructor;switch(l){case Float32Array:case Uint32Array:case Uint16Array:l=new l(a);break;case Array:l=new l(a.length);for(var n=0;n<a.length;n++)l[n]=d(a[n]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=
a;break;default:for(n in l=new l,a)l[n]=d(a[n])}b&&(l.U=b,a.U=b);c&&(l.lc=c,a.lc=c);g&&(l.qa=g,a.qa=g);return l}function b(a,b){for(var c=a.B,d=0;d<c.length;d++){var g=c[d];if(g.wa==b)return g}return null}function c(a){return a.rg?a.parent:a.parent?c(a.parent):null}var n=p("__tsr"),g=p("__util"),q=p("__vec3"),l=p("__vec4"),t=p("__config").p;new Float32Array(4);new Float32Array(4);new Float32Array(4);n.create();n.create();a.lh=function(a){a={id:0,type:a,Jc:0,xE:[0,0],i:n.Sm(),pivot:new Float32Array(3),
fb:new Float32Array(3),aj:0,bj:0,Cv:!1,Lm:null,pg:0,vo:!1,ue:q.create(),use_panning:!1,Ua:0,bm:1,am:1,cm:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,jd:null,ZH:!1,Ha:null,ea:null,Ma:null,fc:null,ec:null,Xd:null,Sk:!0,N:null,fs:null,sj:{tj:1,uj:1,vj:0},Kd:null,td:null,$b:new Float32Array(4),Yk:0,Pk:0,ol:0,Fh:0,Di:!1,zd:!1,Vc:!1,Uc:!1,Ec:!1,wc:!1,Rc:!1,Qe:"",gf:!1,Gd:!1,Xm:!1,He:!1,cc:!1,ph:!1,xh:!1,zn:!1,xg:!1,Qn:!1,Kb:!1,Pn:!1,yw:!1,wn:!1,is_visible:!1,uq:!1,em:0,Ye:0,Mf:0,mf:0,lf:0,ff:0,
wf:"",uc:null,Cm:!1,ee:!1,rp:!1,mk:"",lk:!1,Qd:0,time:0,Rs:0,my:0,yf:0,Xk:!1,mc:!1,te:!1,zg:[],dj:!1,Xg:!1,Tf:1,ep:0,dp:1,Co:new Int8Array([-1,-1]),mo:[],hw:[],rx:[],Qc:null,ud:null,Yc:null,Dd:null,Jd:null,xi:null,Gr:null,hp:null,gp:null,xf:null,Hh:null,Hn:null,qd:null,Gh:null,In:null,vi:null,bc:null,op:null,mp:null,np:null,Cb:null,dd:null,Wb:null,ef:null,Uf:null,ig:1E4};q.copy(g.AXIS_Y,a.ue);return a};a.Ai=function(a,b,c){c||(c=a);return{name:a,Jg:g.yq(),Nh:c,type:b,eh:!1,ma:!1,ll:!1,Yl:!1,g:null,
ib:null,H:null,Oa:null,xm:null,anchor:null,Ii:null,Jn:null,B:[],mc:[],fe:[],Pp:[],M:[],Fl:[],Vd:[],ri:[],pe:null,Yh:[],parent:null,rg:!1,vl:"",Oo:null,Xn:null,gi:!1,Ya:"",Pm:"AUTO",Mc:!1,is_character:!1,Bh:!1,o:null,l:null,Od:null,Zc:null,Ji:null,Yt:null,Fr:[],oe:{Wn:"NO_COLLISION",Zl:!1,ly:!1,Me:0,py:0,oy:0,$p:0,Ur:0,mF:!1,nF:!1,oF:!1,pF:!1,qF:!1,rF:!1,zk:0,xk:0,Ak:0,Os:!1,Km:"BOX",Xl:!1},xw:{wo:0,zr:0,sd:0,Nr:0},ik:0,actions:[],sr:!1,iw:[]}};a.Qp=function(a){return a instanceof Array?a.slice():
a};a.zi=d;a.ma=function(a){return a.ma};a.Vq=function(a){return"MESH"==a.type&&a.ma};a.ti=function(a,b){a.B.push({wa:b,un:!1,T:[],Pe:[],Yf:null,hs:[],Ch:0,vw:!1})};a.wm=function(a,c,d){b(a,c).T.push(d)};a.QL=function(a,b){for(var c=a.B,d=0;d<c.length;d++)if(c[d].wa==b){c.splice(d,1);break}};a.Sa=b;a.ey=function(a,b){for(var c=0;c<a.length;c++)l.copy(b,a[c].g.$b)};a.Wr=function(a,b,c){for(var d=0;d<a.B.length;d++){var g=a.B[d];c&&g.wa!=c||(g.un=b)}};a.jn=function(a,b){for(var c=[],d=b?t.fw-1:t.fw,
g=0;g<a.length;g++){var l=a[g];l.Oa.Vu&&c.length<d&&c.push(l)}return c.length?c:a[0]?[a[0]]:[]};a.$t=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.Su=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.rg?null:a.parent};a.get_dg_parent=c;a.Dq=function(a,
b){for(var d=[],g=0;g<b.length;g++){var l=b[g];c(l)==a&&d.push(l)}return d};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,p){function d(){throw"_rand() undefined";}function b(a,b,c,d,f,m){var h=a.Wm,g=a.ie,k=a.time;a=a.Mw;for(var l=0;l<h.length;l+=4){var r=h[l];if(k>a&&k>=r&&r>a||k<a&&(r>a||k>=r))for(r=0;8>r;r++)g[8*l+r]=d[r],u[r]=d[r];else for(r=0;8>r;r++)u[r]=g[8*l+r];r=z;r[0]=b[3*l];r[1]=b[3*l+1];r[2]=b[3*l+2];e.transform_vec3(r,u,r);f[3*l]=r[0];f[3*l+1]=r[1];f[3*l+2]=r[2];var n=z;n[0]=c[3*l];n[1]=c[3*l+1];n[2]=c[3*l+2];e.transform_dir_vec3(n,u,n);m[3*l]=n[0];m[3*l+1]=n[1];m[3*l+
2]=n[2];for(r=1;4>r;r++)f[3*(l+r)]=f[3*l],f[3*(l+r)+1]=f[3*l+1],f[3*(l+r)+2]=f[3*l+2],m[3*(l+r)]=n[0],m[3*(l+r)+1]=n[1],m[3*(l+r)+2]=n[2]}}function c(a){a?(H.FH(a),d=function(){return H.jG()}):d=function(){return Math.random()}}var n=p("__config"),g=p("__batch"),q=p("__geometry");p("__scenes");var l=p("__textures"),t=p("__time"),e=p("__tsr"),H=p("__util"),k=p("__vec3"),r=n.p,u=new Float32Array(8),z=new Float32Array(3);a.pj=function(a){a=a.B;for(var b=0;b<a.length;b++)for(var c=a[b].T,d=0;d<c.length;d++)if(c[d].Ba)return!0;
return!1};a.uw=function(a){a=a.B;for(var b=0;b<a.length;b++)for(var c=a[b].T,d=0;d<c.length;d++){var f=c[d].Ba;if(f&&"EMITTER"==f.Ar)return!0}return!1};a.hB=function(a){return 0<a.particle_systems.length};a.gB=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.AE=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.EE=function(a,
b,c){var d=a.Ba={name:b.name,Ar:b.settings.type,time:0,Mw:-1,Io:!1,Y:0,pa:0,Tx:0,cr:0,Xv:0,cyclic:!1,Me:0,ur:0,nv:0,sh:0,kd:0,Fy:0,size:0,Bt:0,At:0,hu:0,gu:new Float32Array(16),xj:null,Jw:null,qw:null,rw:null,Wm:null,dq:null,ie:null,Aw:null};d.Y=b.settings.frame_start;d.pa=b.settings.frame_end;d.Tx=(d.pa-d.Y)/t.Yb();d.cr=b.settings.lifetime;d.Xv=d.cr/t.Yb();d.cyclic=b.settings.b4w_cyclic?1:0;d.Me=b.settings.mass;d.ur=b.settings.normal_factor;d.nv=9.81*b.settings.effector_weights.gravity;d.sh=b.settings.b4w_fade_in/
t.Yb();d.kd=b.settings.b4w_fade_out/t.Yb();d.Fy=b.settings.effector_weights.wind;d.Io="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,e,h;a.Iq?(f=c.halo.size,e=c.halo.hardness,30>e?(e=.5,h=.9):40>e?(e=.1,h=1):50>e?(e=0,h=.8):(e=0,h=.5)):(f=b.settings.particle_size,h=e=1);d.size=f;d.Bt=e;d.At=h;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(g.va(a,"NODES",1),g.va(a,"PARTICLE_BATCH",1),a.UI=!0,a.$i=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&
b[0].texture.use_color_ramp&&r.tm&&(f=[],l.kB(b[0].texture.color_ramp,l.mt,f),f=new Uint8Array(f.map(function(a){return H.clamp(255*a,0,255)})),g.GA(a,f,"u_color_ramp_tex",l.mt),g.va(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)e=c[f/4],a[f]=e.position,a[f+1]=e.color[0],
a[f+2]=e.color[1],a[f+3]=e.color[2];d.hu=c.length}d.gu.set(a)};a.GD=function(a,e,g,l){var f=a.Ba,m=g.settings.count,h=g.settings.frame_start/t.Yb(),r=g.settings.frame_end/t.Yb(),n=g.settings.lifetime/t.Yb(),u=g.settings.lifetime_random,A=g.settings.emit_from,w=g.settings.factor_random,p=g.settings.angular_velocity_mode,z=g.settings.angular_velocity_factor,O=g.settings.b4w_randomize_emission,B=g.settings.b4w_cyclic;c(g.seed);e=q.Ku(e,["a_position","a_normal"],null);switch(A){case "VERT":g=e.D[0].a_position;
e=e.D[0].a_normal;for(var G=g.length/3,A=[],M=0;M<m;M++){var F=Math.round((G-1)*d());A.push(F);A.push(F);A.push(F);A.push(F)}G=[];for(M=0;M<A.length;M++)G.push(g[3*A[M]]),G.push(g[3*A[M]+1]),G.push(g[3*A[M]+2]);g=new Float32Array(G);G=[];for(M=0;M<A.length;M++)G.push(e[3*A[M]]),G.push(e[3*A[M]+1]),G.push(e[3*A[M]+2]);A=new Float32Array(G);break;case "FACE":g=[];A=[];M=[];H.sn(0,M);G=q.Aq(e,m,!1,M);H.sn(0,M);e=q.Aq(e,m,!0,M);for(M=0;M<G.length;M++)g.push(G[M][0],G[M][1],G[M][2]),g.push(G[M][0],G[M][1],
G[M][2]),g.push(G[M][0],G[M][1],G[M][2]),g.push(G[M][0],G[M][1],G[M][2]),A.push(e[M][0],e[M][1],e[M][2]),A.push(e[M][0],e[M][1],e[M][2]),A.push(e[M][0],e[M][1],e[M][2]),A.push(e[M][0],e[M][1],e[M][2]);g=new Float32Array(g);A=new Float32Array(A);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}A=[g,A];e=A[0];A=A[1];f.xj=new Float32Array(e);f.qw=new Float32Array(A);f.Jw=new Float32Array(e.length);f.rw=new Float32Array(A.length);g=[];r=
(r-h)/m;for(G=0;G<m;G++)M=O?r*G+10*r*(.5-d()):r*G,B||(M+=h),g.push(M),g.push(M),g.push(M),g.push(M);h=new Float32Array(g);f.Wm=new Float32Array(h);f.dq=new Float32Array(h);if(f.Io){f.ie=new Float32Array(8*h.length);for(O=0;O<8*h.length;O++)for(B=0;8>B;B++)f.ie[8*O+B]=l[B];b(f,e,A,l,e,A)}l=H.Xb("EMITTER_PARTICLES");O=H.ge();O.a_position=e;O.a_normal=A;l.D[0]=O;a.nf=q.im;a=[];for(O=0;O<m;O++)a.push(4*O,4*O+2,4*O+1,4*O,4*O+3,4*O+2);a=new Uint16Array(a);l.Ia=a;a=l.O;O=[];for(B=0;B<m;B++)O.push(-.5,-.5,
-.5,.5,.5,.5,.5,-.5);O=new Float32Array(O);a.a_p_bb_vertex=O;l.fa=e.length/3;a=[];u*=n;for(O=0;O<m;O++)B=u*d(),a.push(n-B),a.push(n-B),a.push(n-B),a.push(n-B);n=l.O;u=[];for(O=0;O<m;O++)B=Math.random(),u.push(a[4*O],h[4*O],B),u.push(a[4*O+1],h[4*O+1],B),u.push(a[4*O+2],h[4*O+2],B),u.push(a[4*O+3],h[4*O+3],B);u=new Float32Array(u);n.a_p_data=u;n=l.O;u=[];for(a=0;a<m;a++){h=[d()-.5,d()-.5,d()-.5];k.normalize(h,h);u.push(w*h[0]);u.push(w*h[1]);u.push(w*h[2]);switch(p){case "NONE":u.push(0);break;case "SPIN":case "VELOCITY":u.push(z);
break;case "RAND":u.push(2*z*(d()-.5));break;default:throw"Undefined velocity factor";}h=u.slice(-4);for(O=0;12>O;O++)u.push(h[O%4])}m=new Float32Array(u);n.a_p_vels=m;f.Aw=new Float32Array(l.O.a_p_data);return l};a.pI=function(a,c){for(var d=0;d<c.length;d++){var e=c[d],f=e.Ba;if(f&&f.Io&&!e.Ke){var e=e.P,m=f.Jw,h=f.rw;b(f,f.xj,f.qw,a.g.i,m,h);q.wF(e);q.Eo(e,"a_position",3,m);q.Eo(e,"a_normal",3,h)}}};a.cH=function(a,b,c){a=a.B;for(var d=0;d<a.length;d++)for(var f=a[d].T,e=0;e<f.length;e++){var h=
f[e].Ba;h&&h.name==b&&!f[e].Ke&&(h.Mw=h.time,h.time=c)}};a.dG=function(a){for(var b=a.fa,c=a.D[0].a_position,d=a.O.a_texcoord,f=[],e=[],h=0;h<b;h++)e.push(c[3*h]),e.push(c[3*h+1]),f.push(c[3*h+2]);f=new Float32Array(f);e=new Float32Array(e);a.O.a_lf_dist=f;a.O.a_lf_bb_vertex=e;a.O.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.B;for(var d=0;d<a.length;d++)for(var f=a[d].T,e=0;e<f.length;e++){var h=f[e].Ba;h&&h.name==b&&(h.size=c)}};a.set_normal_factor=function(a,b,c){a=a.B;for(var d=0;d<a.length;d++)for(var f=
a[d].T,e=0;e<f.length;e++){var h=f[e].Ba;h&&h.name==b&&(h.ur=c)}};a.set_factor=function(a,b,c){a=a.B;for(var d=0;d<a.length;d++)for(var f=a[d].T,e=0;e<f.length;e++){var h=f[e],g=h.Ba;if(g&&g.name==b){var l=g.Wm;if(1==c)var k=l;else if(0==c)for(var k=g.dq,r=0;r<k.length;r+=4)k[r]=1E4,k[r+1]=k[r],k[r+2]=k[r],k[r+3]=k[r];else for(var n=4/c,k=g.dq,t=0,r=0;r<k.length;r+=4)r>=t?(k[r]=l[r],t+=n):k[r]=1E4,k[r+1]=k[r],k[r+2]=k[r],k[r+3]=k[r];h=h.P;if(h.xb.a_p_data){g=g.Aw;for(r=0;r<g.length;r+=3)g[r+1]=k[Math.round(r/
3)];q.Eo(h,"a_p_data",3,g)}}}};a.EI=function(a,b,c){a=a.B;for(var d=0;d<a.length;d++)for(var f=a[d].T,e=0;e<f.length;e++){var h=f[e].Ba;if(h&&h.Io)for(var g=0;g<8*h.Wm.length;g++)h.ie[8*g]=b[0],h.ie[8*g+1]=b[1],h.ie[8*g+2]=b[2],h.ie[8*g+3]=b[3],h.ie[8*g+4]=c[0],h.ie[8*g+5]=c[1],h.ie[8*g+6]=c[2],h.ie[8*g+7]=c[3]}};a.yI=function(a,b,c){if(b.Sn){for(var d=[],f=0;f<c;f++)d.push(1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1);a.O.a_tangent=new Float32Array(d)}if(b.Cr){d=[];for(f=0;f<c;f++)d.push(f,f,f,f);a.O[b.Cr.name]=
new Float32Array(d)}}};b4w.module.__primitives=function(a,p){function d(a,b,c,d){for(var g=[],n=[],q=[],t=[],p=2*c/(a-1),v=2*d/(b-1),f=0;f<a;f++)for(var m=-c+f*p,h=0;h<b;h++)if(n.push(m,0,-d+h*v),q.push(0,1,0),t.push(f/(a-1),h/(b-1)),f&&h){var x=f*b+h,L=x-1,P=(f-1)*b+h,A=P-1;g.push(x,L,P);g.push(L,A,P)}a=l.ge();a.a_position=new Float32Array(n);a.a_normal=new Float32Array(q);q=l.Xb("GRID_PLANE");q.D[0]=a;q.O.a_texcoord=new Float32Array(t);q.Ia=new Uint32Array(g);q.fa=n.length/3;return q}function b(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],d=[],g=0;g<b;g+=4){var q=a[g+1],t=a[g+2],p=a[g+3];n(a[g],d);n(q,d);n(t,d);n(p,d);c.push(g,g+1,g+2);c.push(g,g+2,g+3)}a=l.ge();a.a_position=new Float32Array(d);b=l.Xb("FROM_QUADS");b.D[0]=a;b.Ia=new Uint32Array(c);b.fa=d.length/3;return b}function c(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function n(a,b){b.push(a[0],a[1],a[2])}var g=p("__config"),q=p("__geometry");p("__print");var l=p("__util"),t=g.p;a.KD=function(){var a=l.Xb("LINE"),b=l.ge();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.D[0]=b;a.Ia=new Uint32Array(1);a.fa=1;return a};a.TK=function(a,b){var c=d(2,2,a,b);c.name="PLANE";return c};a.SK=d;a.ND=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==y-1)||1==b%2&&(0==a||a==p-1)?!0:!1}var g=c/=Math.pow(2,a-1),n=c,p=b+1,y=b+1;b=[];c=[];for(var C=0,v=0,f=-1,m=[],h=0;h<a;h++){for(var x=2*g/(p-1),L=2*n/(y-1),P=[],A=[],w=0,I=0;I<p;I++){for(var T=-g+I*x,O=[],B=0;B<y;B++){var G=-n+B*L;if(T>-C&&T<C&&G>-v&&G<v)O.push(-1),w++;else{for(var M=null,
F=0;F<m.length;F+=3)if(T==m[F]&&G==m[F+1]){M=m[F+2];break}F=null!==M?M:f+1;d(I,B)?(O.push(-2),w++):(null==M&&(0==B||B==y-1||0==I||I==p-1?(M=h==a-1?x:2*x,P.push(T,G,F)):M=x,c.push(T,M,G),f++),O.push(F));if(I&&B)if(1==I)if(d(I-1,B)){if(1<B){var G=F-1,M=A[I-1][B+1],R=M-1;b.push(F,G,R)}else M=A[I-1][B+1],R=M-1;b.push(F,R,M)}else d(I,B)||(G=F-1,M=A[I-1][B],b.push(F,G,M));else if(I==p-1){if(!d(I,B))if(B==y-1)G=F-1,M=A[I-1][B-1],R=A[I-2][B],b.push(F,G,M),b.push(F,M,R);else{var G=F-1,M=A[I-1][B],R=M-1,S=
M+1;b.push(F,G,R);b.push(F,R,M);b.push(F,M,S);2==B&&(S=A[I-2][B-2],b.push(G,S,R))}}else 1==B?d(I,B-1)?(G=A[I-1][B],M=A[I-1][B-1],b.push(F,M,G)):(G=O[B-1],M=A[I-1][B],R=A[I-2][B-1],b.push(F,G,M),b.push(G,R,M)):B==y-1?d(I,B)||(G=O[B-1],M=A[I-1][B-1],R=A[I-2][B],b.push(F,G,M),b.push(F,M,R)):-1!=A[I-1][B]&&-1!=A[I-1][B-1]&&-1!=O[B-1]?(G=O[B-1],M=A[I-1][B],R=A[I-1][B-1],b.push(F,G,M),b.push(G,R,M),B==y-2&&d(I,B+1)&&(S=A[I-1][B+1],b.push(F,M,S))):B==y-2&&d(I,B+1)&&(M=A[I-1][B],S=A[I-1][B+1],b.push(F,M,
S))}}A.push(O)}m=P;C=g;v=n;g*=2;n*=2}2E4>C&&(a=-(2*C)/(p-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-C,a,-v),c.push(-C,a,v),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(C,a,-v),c.push(C,a,v),F=f+1,b.push(F+3,F+2,F+1,F+2,F+0,F+1,F+6,F+4,F+2,F+4,F+0,F+2,F+5,F+7,F+1,F+7,F+3,F+1,F+5,F+4,F+7,F+7,F+4,F+6));a=l.ge();a.a_position=new Float32Array(c);g=l.Xb("multigrid_plane");g.D[0]=a;g.Ia=new Uint32Array(b);g.fa=c.length/3;t.Dy&&(q.uo(g,1,!0),a.a_polyindex=q.qq(g));return g};a.RK=function(a){var b=a.length;
if(b%3)throw"Wrong array";for(var c=[],d=[],g=0;g<b;g+=3){var q=a[g+1],t=a[g+2];n(a[g],d);n(q,d);n(t,d);c.push(g,g+1,g+2)}a=l.ge();a.a_position=new Float32Array(d);b=l.Xb("FROM_TRIANGLES");b.D[0]=a;b.Ia=new Uint32Array(c);b.fa=d.length/3;return b};a.QK=b;a.HD=function(a){a=l.bJ(a);var c=[];c.push(a[0],a[1],a[2],a[3]);c.push(a[0],a[3],a[5],a[4]);c.push(a[3],a[2],a[6],a[5]);c.push(a[1],a[7],a[6],a[2]);c.push(a[0],a[4],a[7],a[1]);c.push(a[4],a[5],a[6],a[7]);a=b(c);a.name="FRUSTUM";return a};a.Pb=function(){var a=
l.Xb("FULLSCREEN_TRI"),b=l.ge();b.a_position=new Float32Array([0,0,1,0,0,1]);a.D[0]=b;a.Ia=new Uint32Array([0,1,2]);a.fa=3;return a};a.ID=function(){var a=l.Xb("FULLSCREEN_QUAD"),b=l.ge();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.D[0]=b;a.Ia=new Uint32Array([0,2,1,1,2,3]);a.fa=4;return a};a.DD=function(){var a=l.Xb("BILLBOARD"),b=l.ge();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.D[0]=b;a.Ia=new Uint32Array([0,2,1,0,3,2]);a.fa=4;return a};a.ED=function(){var a=l.Xb("CUBEMAP_BOARD"),
b=l.ge();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.D[0]=b;a.Ia=new Uint32Array([0,2,1,0,3,2]);a.fa=4;return a};a.zq=function(a,b){var d=l.Xb("UV_SPHERE"),g,t,p=[],D=[],y=[];for(t=0;8>=t;t++)for(g=0;16>=g;g++){var C=g/16,v=t/8;D.push(-a*Math.cos(2*C*Math.PI)*Math.sin(v*Math.PI)+b[0],a*Math.cos(v*Math.PI)+b[1],a*Math.sin(2*C*Math.PI)*Math.sin(v*Math.PI)+b[2])}for(t=C=0;8>t;t++)for(g=0;16>g;g++){var v=c(D,17*t+g+1),f=c(D,17*t+g),m=c(D,17*(t+1)+g),h=c(D,17*(t+1)+g+1);Math.abs(v[1])==a+b[1]?
(n(v,p),n(m,p),n(h,p),y.push(C,C+1,C+2),C+=3):Math.abs(m[1])==a+b[1]?(n(v,p),n(f,p),n(m,p),y.push(C,C+1,C+2),C+=3):(n(v,p),n(f,p),n(m,p),n(h,p),y.push(C,C+1,C+2),y.push(C,C+2,C+3),C+=4)}g={};g.a_position=p;D=q.Rt(y,D,p);g.a_normal=q.Qt(y,p,D);g.a_tangent=[];d.O.a_influence=[];d.O.a_color=[];d.O.a_texcoord=[];d.D[0]=g;d.Ia=y;d.fa=p.length/3;return d};a.Uu=function(a){var b=l.Xb("INDEX"),c=l.ge();c.a_index=new Float32Array(a);for(var d=0;d<a;d++)c.a_index[d]=d;b.D[0]=c;b.Ia=new Uint16Array(0);b.fa=
a;return b}};b4w.module.__prerender=function(a,p){function d(a,b){var d=a.ne;d.is_visible=!1;var e=b.j,g="SHADOW_CAST"==b.type?e.bw:q.Ui(e.i,k),n;if(!(n=!d||d.xh)){var t=d.Wb.K;n=d.ig;g=Math.sqrt((t[0]-g[0])*(t[0]-g[0])+(t[1]-g[1])*(t[1]-g[1])+(t[2]-g[2])*(t[2]-g[2]));t=d.Fh*d.Wb.Pa;n=!(g>=d.ol&&g<n+t)}if(n)return!1;d.is_visible=!0;(n="OUTLINE_MASK"==b.type&&!Boolean(d.pg))||(e=e.Zk,d.ph?n=!1:("STATIC"===d.type?(n=d.Wb,d=n.K,d=l.AH(d,e,n.Pa)):(n=d.Uf,d=n.K,d=l.YC(d,e,n.Be,n.Ce,n.De)),n=d));return n?!1:"WIREFRAME"==
b.type?a.I.wireframe_mode==c.WM_DEBUG_SPHERES?a.I.nh:!a.I.nh:!0}var b=p("__config"),c=p("__debug"),n=p("__geometry"),g=p("__renderer"),q=p("__tsr"),l=p("__util"),t=p("__vec3"),e=b.p,H="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST SHADOW_RECEIVE OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" "),k=new Float32Array(3);a.Hr=function(a){if(-1<H.indexOf(a.type)){for(var b=!1,c=a.s,l=0;l<c.length;l++){var p=c[l];if("MAIN_CUBE_REFLECT"==a.type)for(var C=
0;6>C;C++)a.j.Zk=a.Wp[C],p.hq[C]=d(p,a),p.hq[C]&&(b=!0);else p.Jb=d(p,a),p.Jb&&(b=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"SHADOW_RECEIVE"===a.type||"MAIN_GLOW"===a.type||b?a.Jb=!0:(a.Jb&&g.clear(a),a.Jb=!1)}}if("MAIN_BLEND"==a.type&&e.alpha_sort&&a.s){b=q.Ui(a.j.i,k);c=t.dist(b,a.Jy)>e.alpha_sort_threshold;for(l=0;l<a.s.length;l++)if(C=a.s[l],p=C.ne,p.uq||c){var v=C.I;if(v&&v.Ja&&v.Pf!=n.af){v=v.P;if(!v||!C.Jb)continue;(C=v.rn)&&C.type==n.qt&&n.jI(v,p.i,b)}p.uq=
!1}c&&t.copy(b,a.Jy)}}};b4w.module.__print=function(a){function p(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function d(){g++;var a=p(arguments,"B4W ERROR");console.error.apply(console,a)}function b(a){a in l||(l[a]=a,d([a]))}function c(a,c){b(a+"() is deprecated, use "+c+"() instead.")}var n=!1,g=0,q=0,l={};a.dH=function(a){n=a};a.ir=function(){console.log.apply(console,arguments)};a.log=function(){if(n){var a=p(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=d;a.bn=b;a.Na=c;a.Ie=function(a,d){switch(1<d.length){case !0:b(a+"() is deprecated, use "+d.slice(0,-1).join("(), ")+"() or "+d[d.length-1]+"() instead.");break;case !1:c(a,d[0])}};a.$C=function(){b('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){q++;var a=p(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=p(arguments,"B4W INFO");console.info.apply(console,a)};a.cD=function(){g++;
var a=p(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.dD=function(){q++;var a=p(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){n&&console.time.apply(console,arguments)};a.timeEnd=function(){n&&console.timeEnd.apply(console,arguments)};a.group=function(){n&&console.group.apply(console,arguments)};a.groupCollapsed=function(){n&&console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){n&&console.groupEnd.apply(console,arguments)};a.clear=
function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.uE=function(){return q};a.dE=function(){return g};a.clear_errors_warnings=function(){g=q=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,p){function d(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},c("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},c("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},c("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",c("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,c("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,c("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,c("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,c("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,c("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",c("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,c("node material",a,"specular_ior"));"specular_hardness"in
a||(a.specular_hardness=50,c("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,c("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,c("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,c("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,c("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",c("node material",
a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,c("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,c("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,c("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,c("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name=
"B4W_"+a.node_tree_name}}}function b(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.strips.length;e++){var h=d.strips[e];"action"in h||(h.action=null,c("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,c("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,c("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,c("strip",h,"repeat"));"use_reverse"in h||(h.use_reverse=!1,c("strip",h,"use_reverse"));"scale"in
h||(h.scale=1,c("strip",h,"scale"))}}function c(a,b,c){c=c+">>"+a;c in y||(y[c]={ws:[],$w:"undefined",type:a});y[c].ws.push(b.name)}function n(a,b,c){c=c+">>"+a;c in y||(y[c]={ws:[],$w:"deprecated",type:a});y[c].ws.push(b.name)}function g(a){H.warn(a)}function q(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var h=r.hh(a);a.materials=c;a.submeshes=d;h.name=b;h.materials=a.materials.slice(0);h.submeshes=[];for(c=0;c<d.length;c++){var e=r.wk(d[c]);h.submeshes.push(e)}return h}
var l=p("__boundings"),t=p("__curve"),e=p("__mat4"),H=p("__print"),k=p("__quat"),r=p("__util"),u=p("__vec3"),z=p("__vec4"),D=[5,4],y={};a.au=function(a){return-1!=r.qy(a,D)};a.wB=function(a){y={};var e=a.worlds;if(0==e.length){H.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},
fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};e.push(f)}for(var e=a.worlds,m=0;m<e.length;m++){f=e[m];"use_sky_blend"in f||(c("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(c("world",f,"use_sky_paper"),f.use_sky_paper=!1);"use_sky_real"in f||(c("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in
f.b4w_sky_settings||(c("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in f||(c("world",f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,
color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(c("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var h=f.texture_slots,l=0;l<h.length;l++){var k=h[l];"blend_type"in k||(k.blend_type="MIX",c("world_texture_slot",k,"blend_type"));"use_map_blend"in k||(k.use_map_blend=!1,c("world_texture_slot",k,"use_map_blend"));
"use_map_horizon"in k||(k.use_map_horizon=!0,c("world_texture_slot",k,"use_map_horizon"));"use_map_zenith_up"in k||(k.use_map_zenith_up=!1,c("world_texture_slot",k,"use_map_zenith_up"));"use_rgb_to_intensity"in k||(k.use_rgb_to_intensity=!1,c("world_texture_slot",k,"use_rgb_to_intensity"));"invert"in k||(k.invert=!1,c("world_texture_slot",k,"invert"));"color"in k||(k.color=[1,0,1],c("world_texture_slot",k,"color"));"blend_factor"in k||(k.blend_factor=0,c("world_texture_slot",k,"blend_factor"));"horizon_factor"in
k||(k.horizon_factor=1,c("world_texture_slot",k,"horizon_factor"));"zenith_up_factor"in k||(k.zenith_up_factor=0,c("world_texture_slot",k,"zenith_up_factor"));"zenith_down_factor"in k||(k.zenith_down_factor=0,c("world_texture_slot",k,"zenith_down_factor"));"default_value"in k||(k.default_value=1,c("world_texture_slot",k,"default_value"))}"b4w_use_default_animation"in f||(c("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(c("world",f,"b4w_anim_behavior"),
f.b4w_anim_behavior="CYCLIC")}l=a.scenes;for(m=0;m<l.length;m++)h=l[m],k=h.world,"timeline_markers"in h||(h.timeline_markers=null,c("scene",h,"timeline_markers")),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",c("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,c("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,c("scene",h,"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,c("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],c("scene",
h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(n("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},c("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in
h||(h.b4w_enable_bloom=!1,c("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,c("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,c("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",c("scene",h,"b4w_antialiasing_quality")),"b4w_tags"in h||(h.b4w_tags={title:"",description:""},c("scene",h,"b4w_tags")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection=
"AUTO",c("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",c("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials="AUTO",c("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",c("scene",h,"b4w_enable_anchors_visibility")),"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],c("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor=
"b4w_glow_factor"in h?h.b4w_glow_factor:1,c("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(c("scene",h,"b4w_shadow_settings"),e=k.b4w_shadow_settings,h.b4w_shadow_settings=e?e:{csm_resolution:2048,self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),e=h.b4w_shadow_settings,"csm_resolution"in e||(c("scene",h,"b4w_shadow_settings.csm_resolution"),
e.csm_resolution=2048),"self_shadow_polygon_offset"in e||(c("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),e.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in e||(c("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),e.self_shadow_normal_offset=.01),"b4w_enable_csm"in e||(c("scene",h,"b4w_shadow_settings.b4w_enable_csm"),e.b4w_enable_csm=!1),"csm_num"in e||(c("scene",h,"b4w_shadow_settings.csm_num"),e.csm_num=1),"csm_first_cascade_border"in e||(c("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),
e.csm_first_cascade_border=10),"first_cascade_blur_radius"in e||(c("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),e.first_cascade_blur_radius=3),"csm_last_cascade_border"in e||(c("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),e.csm_last_cascade_border=100),"last_cascade_blur_radius"in e||(c("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),e.last_cascade_blur_radius=1.5),"fade_last_cascade"in e||(c("scene",h,"b4w_shadow_settings.fade_last_cascade"),e.fade_last_cascade=
!0),"blend_between_cascades"in e||(c("scene",h,"b4w_shadow_settings.blend_between_cascades"),e.blend_between_cascades=!0),"b4w_ssao_settings"in h||(c("scene",h,"b4w_ssao_settings"),e=k.b4w_ssao_settings,h.b4w_ssao_settings=e?e:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),e=h.b4w_ssao_settings,"dist_factor"in e||(c("scene",h,"b4w_ssao_settings.dist_factor"),e.dist_factor=0),"samples"in e||(c("scene",h,"b4w_ssao_settings.samples"),e.samples=16),"hemisphere"in e||(c("scene",
h,"b4w_ssao_settings.hemisphere"),e.hemisphere=!1),"blur_depth"in e||(c("scene",h,"b4w_ssao_settings.blur_depth"),e.blur_depth=!1),"blur_discard_value"in e||(c("scene",h,"b4w_ssao_settings.blur_discard_value"),e.blur_discard_value=1),"b4w_bloom_settings"in h||(c("scene",h,"b4w_bloom_settings"),e=k.b4w_bloom_settings,h.b4w_bloom_settings=e?e:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(c("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(c("scene",
h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(c("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=1),"b4w_motion_blur_settings"in h||(c("scene",h,"b4w_motion_blur_settings"),e=k.b4w_motion_blur_settings,h.b4w_motion_blur_settings=e?e:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(c("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=
.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(c("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in h||(c("scene",h,"b4w_color_correction_settings"),e=k.b4w_color_correction_settings,h.b4w_color_correction_settings=e?e:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(c("scene",h,"b4w_god_rays_settings"),e=k.b4w_god_rays_settings,h.b4w_god_rays_settings=
e?e:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(c("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=10),"b4w_glow_settings"in h||(c("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},e=h.b4w_glow_settings,"b4w_render_glow_over_blend"in k&&(e.render_glow_over_blend=k.b4w_render_glow_over_blend),
"b4w_small_glow_mask_coeff"in k&&(e.small_glow_mask_coeff=k.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in k&&(e.large_glow_mask_coeff=k.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in k&&(e.small_glow_mask_width=k.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in k&&(e.large_glow_mask_width=k.b4w_large_glow_mask_width)),k=h.b4w_render_shadows,"AUTO"!=k&&"OFF"!=k&&"ON"!=k&&(h.b4w_render_shadows=k?"ON":"OFF"),k=h.b4w_render_reflections,"OFF"!=k&&"ON"!=k&&(h.b4w_render_reflections=
k?"ON":"OFF"),k=h.b4w_render_refractions,"AUTO"!=k&&"OFF"!=k&&"ON"!=k&&(h.b4w_render_refractions=k?"ON":"OFF"),h.b4w_nla_script&&n("scene",h,"b4w_nla_script");h=a.meshes;for(m=0;m<h.length;m++){k=h[m];k.b4w_bounding_box||(c("mesh",k,"b4w_bounding_box"),k.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});k.b4w_bounding_box_source||(c("mesh",k,"b4w_bounding_box_source"),k.b4w_bounding_box_source=k.b4w_bounding_box);k.uv_textures||(c("mesh",k,"uv_textures"),k.uv_textures=[]);k.b4w_bounding_sphere_center||
(k.b4w_bounding_sphere_center=[0,0,0]);k.b4w_bounding_cylinder_center||(k.b4w_bounding_cylinder_center=[0,0,0]);k.b4w_bounding_ellipsoid_center||(k.b4w_bounding_ellipsoid_center=[0,0,0]);k.b4w_bounding_ellipsoid_axes||(l=k.b4w_bounding_box,k.b4w_bounding_ellipsoid_axes=[(l.max_x-l.min_x)/2,(l.max_y-l.min_y)/2,(l.max_z-l.min_z)/2]);"b4w_shape_keys"in k||(k.b4w_shape_keys=[],c("mesh",k,"b4w_shape_keys"));for(var l=k,e=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim",
"b4w_shape_keys"],f=null,q=0;q<e.length;q++)l[e[q]]&&(f?(l[e[q]]=!1,H.warn('WARNING property "'+e[q]+'" of object "'+l.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=e[q]);for(l=0;l<k.b4w_vertex_anim.length;l++)e=k.b4w_vertex_anim[l],"allow_nla"in e||(c('mesh["b4w_vertex_anim"]',k,"allow_nla"),e.allow_nla=!0)}l=a.cameras;for(m=0;m<l.length;m++)h=l[m],h.type||(h.type="PERSP",c("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,n("camera",
h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,c("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,c("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,c("camera",h,"b4w_rot_velocity")),"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,c("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,c("camera",h,"b4w_use_target_distance_limits")),
"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,c("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,c("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,c("camera",h,"b4w_distance_max")),"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,c("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,c("camera",h,"b4w_horizontal_translation_max")),
"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,c("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,c("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in h||(h.b4w_use_horizontal_clamping=!1,c("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,c("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=
Math.PI,c("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",c("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,c("camera",h,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,c("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,c("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in
h||(h.b4w_vertical_clamping_type="LOCAL",c("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,c("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,c("camera",h,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,c("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,c("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in
h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,c("camera",h,"b4w_use_pivot_limits"));l=a.lamps;for(m=0;m<l.length;m++)h=l[m],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,c("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,c("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,c("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,c("lamp",h,"use_specular"));l=a.speakers;for(m=0;m<l.length;m++)h=
l[m],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in h||(h.b4w_disable_doppler=!1),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_count"in h||(h.b4w_loop_count=0),"b4w_loop_count_random"in
h||(h.b4w_loop_count_random=0),"b4w_playlist_id"in h||(h.b4w_playlist_id=""),h.animation_data&&b(h.animation_data);l=a.textures;for(m=0;m<l.length;m++)h=l[m],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",c("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,c("texture",h,"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],c("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=[1,1],c("texture",
h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,c("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,c("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,c("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in h||(h.b4w_shore_boundings=new Float32Array(4),h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],c("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,
c("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,c("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",c("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",c("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,c("texture",h,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,c("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in
h||(h.b4w_nla_video=!1,c("texture",h,"b4w_nla_video"));e=a.materials;for(m=0;m<e.length;m++){f=e[m];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"b4w_node_mat_type"in f&&n("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&n("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&n("material",f,"b4w_procedural_skydome");f.b4w_water&&("b4w_water_shore_smoothing"in f||(f.b4w_water_shore_smoothing=!1,c("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in
f||(f.b4w_water_dynamic=!1,c("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=1,c("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,c("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,c("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=.03,c("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=
1.3,c("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=1,c("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,c("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,c("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in f||(f.b4w_water_dir_noise_scale=.05,c("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in
f||(f.b4w_water_dir_noise_freq=.07,c("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in f||(f.b4w_water_dir_min_noise_fac=.5,c("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,c("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,c("material",f,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,c("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in
f||(f.b4w_water_fog_color=new Float32Array(3),f.b4w_water_fog_color=[.5,.7,.7],c("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in f||(f.b4w_foam_factor=5,c("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,c("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,c("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=64,c("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=
1E3,c("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,c("material",f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,c("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,c("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in
f||(f.diffuse_intensity=1,c("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in f||(f.b4w_collision_margin=.04,c("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,c("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,c("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=!1,c("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in
f||(f.b4w_halo_sky_stars=!1,c("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=10,c("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,c("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",c("material",f,"specular_shader"));"diffuse_shader"in f||(f.diffuse_shader="LAMBERT",c("material",f,"diffuse_shader"));"roughness"in
f||(f.roughness=.5,c("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,c("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in f||(f.diffuse_fresnel_factor=.5,c("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,c("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,c("material",f,"specular_toon_size"));"specular_toon_smooth"in f||(f.specular_toon_smooth=.1,c("material",f,"specular_toon_smooth"));"specular_alpha"in
f||(f.specular_alpha=1,c("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,c("material",f,"b4w_wettable"));"b4w_refractive"in f||(f.b4w_refractive=!1,c("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,c("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],c("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=[0,.9,.2],c("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in
f||(f.b4w_shallow_water_col_fac=1,c("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,c("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,c("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,c("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=!1,c("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in
f||(f.b4w_water_norm_uv_velocity=.05,c("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,c("material",f,"specular_ior"));"darkness"in f||(f.darkness=0,c("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,c("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,c("material",f,"diffuse_toon_smooth"));h=f.texture_slots;for(l=0;l<h.length;l++)k=h[l],"blend_type"in k||(k.blend_type="MIX",c("texture_slot",k,"blend_type"));
if(f.node_tree){h=f.node_tree.nodes;for(l=0;l<h.length;l++)d(h[l]);f.node_tree.animation_data&&b(f.node_tree.animation_data)}}k=a.node_groups;for(m=0;m<k.length;m++)for(h=k[m].node_tree.nodes,l=0;l<h.length;l++)d(h[l]);h=a.objects;for(m=0;m<h.length;m++){k=h[m];switch(k.type){case "MESH":"b4w_dynamic_geometry"in k||(k.b4w_dynamic_geometry=!1);"b4w_reflexible"in k||(k.b4w_reflexible=!1);"b4w_reflexible_only"in k||(k.b4w_reflexible_only=!1);"b4w_reflective"in k||(k.b4w_reflective=!1);"b4w_reflection_type"in
k||(k.b4w_reflection_type="PLANE",c("object",k,"b4w_reflection_type"));"b4w_wind_bending"in k||(k.b4w_wind_bending=!1,c("object",k,"b4w_wind_bending"));"b4w_wind_bending_angle"in k||(k.b4w_wind_bending_angle=10,k.b4w_wind_bending_freq=.25,c("object",k,"wind bending params"));"b4w_detail_bending_amp"in k||(k.b4w_detail_bending_amp=.1,k.b4w_branch_bending_amp=.3,c("object",k,"detail bending params"));"b4w_detail_bending_freq"in k||(k.b4w_detail_bending_freq=1,c("object",k,"b4w_detail_bending_freq"));
"b4w_main_bend_stiffness_col"in k||(k.b4w_main_bend_stiffness_col="",c("object",k,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in k||(k.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},c("object",k,"b4w_detail_bend_colors"));"b4w_caustics"in k||(k.b4w_caustics=!1);"vertex_groups"in k&&k.vertex_groups.length&&k.data&&0==k.data.vertex_groups.length&&(k.data.vertex_groups=k.vertex_groups,delete k.vertex_groups,c("object",k,"vertex_groups"));"b4w_vertex_anim"in
k&&k.b4w_vertex_anim.length&&k.data&&0==k.data.b4w_vertex_anim.length&&(k.data.b4w_vertex_anim=k.b4w_vertex_anim,delete k.b4w_vertex_anim,c("object",k,"b4w_vertex_anim"));"b4w_do_not_render"in k||(k.b4w_do_not_render=!1);"use_ghost"in k.game||(k.game.use_ghost=!1);"use_sleep"in k.game||(k.game.use_sleep=!1);"velocity_min"in k.game||(k.game.velocity_min=0);"velocity_max"in k.game||(k.game.velocity_max=0);"collision_group"in k.game||(k.game.collision_group=1);"collision_mask"in k.game||(k.game.collision_mask=
255);"b4w_vehicle_settings"in k?k.b4w_vehicle_settings&&("steering_ratio"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.steering_ratio=10),"steering_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.steering_max=1),"inverse_control"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.inverse_control=!1),"force_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.force_max=1500),"brake_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.brake_max=100),"speed_ratio"in k.b4w_vehicle_settings||
(k.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.floating_factor=3),"floating_factor"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in k.b4w_vehicle_settings||
(k.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.water_rot_damp=.9)):(k.b4w_vehicle_settings=null,c("object",k,"b4w_vehicle_settings"));"b4w_floating_settings"in k?k.b4w_floating_settings&&("floating_factor"in k.b4w_floating_settings||(k.b4w_floating_settings.floating_factor=3),"water_lin_damp"in k.b4w_floating_settings||(k.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in k.b4w_floating_settings||(k.b4w_floating_settings.water_rot_damp=
.8)):(k.b4w_floating_settings=null,c("object",k,"b4w_floating_settings"));"b4w_character_settings"in k?k.b4w_character_settings&&("walk_speed"in k.b4w_character_settings||(k.b4w_character_settings.walk_speed=4),"run_speed"in k.b4w_character_settings||(k.b4w_character_settings.run_speed=8),"step_height"in k.b4w_character_settings||(k.b4w_character_settings.step_height=.25),"jump_strength"in k.b4w_character_settings||(k.b4w_character_settings.jump_strength=5),"waterline"in k.b4w_character_settings||
(k.b4w_character_settings.waterline=0)):(k.b4w_character_settings=null,c("object",k,"b4w_character_settings"));"b4w_selectable"in k||(k.b4w_selectable=!1,c("object",k,"b4w_selectable"));"b4w_outlining"in k||(k.b4w_outlining=!1,c("object",k,"b4w_outlining"));"b4w_outline_on_select"in k||(k.b4w_outline_on_select=!1,c("object",k,"b4w_outline_on_select"));"b4w_billboard"in k||(k.b4w_billboard=!1,c("object",k,"b4w_billboard"));"b4w_billboard_geometry"in k||(k.b4w_billboard_geometry="SPHERICAL",c("object",
k,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in k||(k.b4w_pres_glob_orientation=!1,c("object",k,"b4w_pres_glob_orientation"));"b4w_outline_settings"in k||("b4w_glow_settings"in k?k.b4w_outline_settings=k.b4w_glow_settings:(k.b4w_outline_settings={},k.b4w_outline_settings.outline_duration=1,k.b4w_outline_settings.outline_period=1,k.b4w_outline_settings.outline_relapses=0),c("object",k,"b4w_outline_settings"));"b4w_lod_transition"in k||(k.b4w_lod_transition=.01,c("object",k,"b4w_lod_transition"));
"lod_levels"in k||(k.lod_levels=[],c("object",k,"lod_levels"));"b4w_animation_mixing"in k||(k.b4w_animation_mixing=!1,c("object",k,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in k||(k.b4w_anchor=null,c("object",k,"b4w_anchor")),!k.b4w_anchor||"max_width"in k.b4w_anchor||(k.b4w_anchor.max_width=250)}"collision_margin"in k.game||(k.game.collision_margin=.04,c("object",k,"collision_margin"));"b4w_anim_behavior"in k||(k.b4w_anim_behavior=k.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",c("object",
k,"b4w_anim_behavior"));if(!("rotation_quaternion"in k)){l=[0,0,0,1];r.euler_to_quat(k.rotation_euler,l);var e=l,f=l[0],q=l[1],t=l[2];e[0]=l[3];e[1]=f;e[2]=q;e[3]=t;k.rotation_quaternion=l;c("object",k,"rotation_quaternion")}"webgl_do_not_batch"in k&&(k.b4w_do_not_batch=k.webgl_do_not_batch)&&n("object",k,"webgl_do_not_batch");"b4w_shadow_cast_only"in k||(k.b4w_shadow_cast_only=!1,c("object",k,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in k||(k.b4w_correct_bounding_offset="AUTO",c("object",
k,"b4w_correct_bounding_offset"));e=k.particle_systems;for(l=0;l<e.length;l++)f=e[l],q=f.settings,"use_rotation_dupli"in q||(q.use_rotation_dupli=!1,c("object",q,"use_rotation_dupli")),"use_whole_group"in q||(q.use_whole_group=!1,c("object",q,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,c("particle_system",f,"transforms")),"b4w_billboard_align"in q||(q.b4w_billboard_align="VIEW",c("particle_settings",q,"b4w_billboard_align")),"b4w_dynamic_grass"in q||(q.b4w_dynamic_grass=!1,c("object",
q,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in q||(q.b4w_dynamic_grass_scale_threshold=.01,c("object",q,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in q||(q.b4w_initial_rand_rotation=!1,c("particle_settings",q,"b4w_initial_rand_rotation")),"b4w_rotation_type"in q||(q.b4w_rotation_type="Z",c("particle_settings",q,"b4w_rotation_type")),"b4w_rand_rotation_strength"in q||(q.b4w_rand_rotation_strength=1,c("particle_settings",q,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in
q||(q.b4w_hair_billboard=!1,c("particle_settings",q,"b4w_hair_billboard")),"b4w_hair_billboard_type"in q||(q.b4w_hair_billboard_type="BASIC",c("particle_settings",q,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in q||(q.b4w_hair_billboard_jitter_amp=0,c("particle_settings",q,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in q||(q.b4w_hair_billboard_jitter_freq=0,c("particle_settings",q,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in q||(q.b4w_hair_billboard_geometry=
"SPHERICAL",c("particle_settings",q,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in q||(q.b4w_wind_bend_inheritance="PARENT",c("particle_settings",q,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in q||(q.b4w_shadow_inheritance="PARENT",c("particle_settings",q,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in q||(q.b4w_reflection_inheritance="PARENT",c("particle_settings",q,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in q||(q.b4w_vcol_from_name="",c("particle_settings",
q,"b4w_vcol_from_name")),"b4w_vcol_to_name"in q||(q.b4w_vcol_to_name="",c("particle_settings",q,"b4w_vcol_to_name")),"b4w_coordinate_system"in q||(q.b4w_coordinate_system="LOCAL",c("particle_settings",q,"b4w_coordinate_system")),"b4w_allow_nla"in q||(q.b4w_allow_nla=!0,c("particle_settings",q,"b4w_allow_nla")),"b4w_enable_soft_particles"in q||(q.b4w_enable_soft_particles=!1,c("particle_settings",q,"b4w_enable_soft_particles")),"b4w_particles_softness"in q||(q.b4w_particles_softness=1,c("particle_settings",
q,"b4w_particles_softness"));"constraints"in k||(k.constraints=[],c("object",k,"constraints"));e=k.modifiers;for(l=0;l<e.length;l++){a:{f=e[l];switch(f.type){case "ARRAY":if(!("fit_type"in f)){H.error("WARNING Incomplete modifier "+String(f.type)+' for "'+k.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(e.splice(l,1),l--)}"animation_data"in k||(k.animation_data={action:null,nla_tracks:[]},c("object",k,"animation_data"));k.animation_data&&("action"in k.animation_data||
(k.animation_data.action=null,g("no action in animation data "+k.name)),"nla_tracks"in k.animation_data||(k.animation_data.nla_tracks=[],g("no NLA in animation data "+k.name)),b(k.animation_data));"b4w_collision_id"in k||(k.b4w_collision_id="",c("object",k,"b4w_collision_id"));"b4w_viewport_alignment"in k||(k.b4w_viewport_alignment=null,c("object",k,"b4w_viewport_alignment"));"pinverse_tsr"in k||(k.pinverse_tsr=null,c("object",k,"pinverse_tsr"));(0>k.scale[0]||0>k.scale[1]||0>k.scale[2])&&g('negative scale for object "'+
k.name+'", can lead to some errors');l=k.scale;0==l[0]&&0==l[1]&&0==l[2]?l=!0:(e=Math.abs((l[1]-l[2])/l[1]),l=.005>Math.abs((l[0]-l[1])/l[0])&&.005>e);l||g("non-uniform scale for object "+k.name)}for(var w in y)m=y[w],l=w.match(/.*?(?=>>|$)/i)[0],H.warn('Property "'+String(l)+'" is '+m.$w+' for "'+m.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.tB=function(a,b){"num_channels"in a||(a.num_channels=1,g('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};
a.MA=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=q(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var h=a[c];switch(h.type){case "ARRAY":for(var d=b,g=h,n=0,p=0,A=0,w=new Float32Array(16),h=[],I=1;I<g.count;I++){g.use_constant_offset&&(n+=g.constant_offset_displace[0],p+=g.constant_offset_displace[1],A+=g.constant_offset_displace[2]);if(g.use_relative_offset)var y=d.b4w_bounding_box,
n=n+(y.max_x-y.min_x)*g.relative_offset_displace[0],p=p+(y.max_y-y.min_y)*g.relative_offset_displace[1],A=A+(y.max_z-y.min_z)*g.relative_offset_displace[2];r.TH(n,p,A,w);for(var H=y=q(d),B=w,G=0;G<H.submeshes.length;G++){var D=H.submeshes[G];r.yj(D.position,B,D.position,0);r.cJ(D.normal,B,D.normal);r.QH(D.tangent,B,D.tangent)}h.push(y)}for(I=0;I<h.length;I++)for(g=d,n=h[I],p=0;p<g.submeshes.length;p++){A=g.submeshes[p];w=n.submeshes[p];y=A.base_length;H=A.indices.length;A.base_length+=w.base_length;
for(var F in A)if("base_length"!=F)if("indices"==F)for(A[F]=r.YH(A[F],w[F]),B=H;B<A.indices.length;B++)A.indices[B]+=y;else"vertex_colors"!=F&&(A[F]=r.nD(A[F],w[F]))}break;case "CURVE":for(var d=b,I=t.rC(h.object),g=new Float32Array(16),p=I.fg?4:3,n=new Float32Array(p),p=new Float32Array(p),A=new Float32Array(3),w=new Float32Array(4),y=new Float32Array(4),H=new Float32Array(3),B=new Float32Array(3),G=new Float32Array(3),D=new Float32Array(4),R=new Float32Array(4),S=0;S<d.submeshes.length;S++){var ha=
d.submeshes[S],N=ha.position,oa=ha.normal,ha=ha.tangent,fa;a:switch(fa=h.deform_axis,fa){case "POS_X":case "NEG_X":fa=0;break a;case "POS_Y":case "NEG_Y":fa=1;break a;case "POS_Z":case "NEG_Z":fa=2;break a;default:throw"Wrong deform axis value "+fa;}H[0]=0;H[1]=0;H[2]=0;H[fa]=1;for(var na=t.DH(I),ba=0;ba<N.length/3;ba++){G[0]=N[3*ba];G[1]=N[3*ba+1];G[2]=N[3*ba+2];var E=G[fa],ea=t.CH(I,E);t.EH(I,ea,n);A[0]=n[0];A[1]=n[1];A[2]=n[2];t.BH(I,ea,p);B[0]=p[0];B[1]=0;B[2]=p[2];u.normalize(B,B);k.rotationTo(H,
B,w);0>E?(n[0]=B[0],n[1]=B[1],n[2]=B[2],u.scale(n,E,n),u.add(A,n,A)):E>na&&(n[0]=B[0],n[1]=B[1],n[2]=B[2],u.scale(n,E-na,n),u.add(A,n,A));e.fromRotationTranslation(w,A,g);I.fg&&(k.setAxisAngle(H,n[3],y),u.transformQuat(G,y,G));G[fa]=0;u.transformMat4(G,g,G);N[3*ba]=G[0];N[3*ba+1]=G[1];N[3*ba+2]=G[2];oa.length&&(D[0]=oa[3*ba],D[1]=oa[3*ba+1],D[2]=oa[3*ba+2],D[3]=0,z.transformMat4(D,g,D),oa[3*ba]=D[0],oa[3*ba+1]=D[1],oa[3*ba+2]=D[2]);ha.length&&(R[0]=ha[3*ba],R[1]=ha[3*ba+1],R[2]=ha[3*ba+2],R[3]=0,
z.transformMat4(R,g,R),ha[3*ba]=R[0],ha[3*ba+1]=R[1],ha[3*ba+2]=R[2])}}}l.kG(b)}return b};a.fC=function(){return{name:"DEFAULT",uuid:r.yq(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,
b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,
game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.TA=function(a,b){for(var c=b.b4w_logic_nodes,d=0;d<c.length;d++)for(var e=c[d],k=0;k<e.length;k++){var l=e[k],r={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in r)n in l&&(l[r[n]]=l[n]);switch(l.type){case "SELECT":for(var q=0;q<a.length;q++){var t=
a[q];t.name==l.object&&(t.b4w_selectable=!0)}l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=!1);g('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":for(var u in l.objects_paths){t=l.objects_paths[u];r=t[0];if(1<t.length)for(q=1;q<t.length;q++)r+="*"+t[q];for(q=0;q<a.length;q++)t=a[q],t.name==r&&(t.b4w_selectable=!0)}if(l.links instanceof Array){g('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');r={};t=0;for(q in l.objects_paths)r[q]=
l.links[t],t++;l.links=r}break;case "SELECT_PLAY":g('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');l.mute=!0;break;case "SELECT_PLAY_ANIM":g('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "PLAY_ANIM":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":for(u in l.objects_paths){t=l.objects_paths[u];r=t[0];if(1<t.length)for(q=1;q<t.length;q++)r+="*"+t[q];for(q=0;q<a.length;q++)t=a[q],t.name==r&&(t.b4w_do_not_batch=
!0)}break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":for(u in l.objects_paths){t=l.objects_paths[u];r=t[0];if(1<t.length)for(q=1;q<t.length;q++)r+="*"+t[q];for(q=0;q<a.length;q++)t=a[q],t.name==r&&(t.b4w_do_not_batch=!0)}break;case "TRANSFORM_OBJECT":for(u in l.objects_paths){t=l.objects_paths[u];r=t[0];if(1<t.length)for(q=1;q<t.length;q++)r+="*"+t[q];for(q=0;q<a.length;q++)t=a[q],t.name==r&&(t.b4w_do_not_batch=!0)}break;case "CONDJUMP":if(l.condition)switch(l.floats||(l.floats={}),l.condition){case "GEQUAL":l.floats.cnd=
0;break;case "LEQUAL":l.floats.cnd=1;break;case "GREATER":l.floats.cnd=2;break;case "LESS":l.floats.cnd=3;break;case "NOTEQUAL":l.floats.cnd=4;break;case "EQUAL":l.floats.cnd=5}void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);break;case "SEND_REQ":l.bools||(l.bools={});void 0===l.bools.prs&&(l.bools.prs=!0);void 0===l.bools.enc&&(l.bools.enc=!0);void 0===l.bools.ct&&(l.bools.ct=!1);break;case "MATH":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=
l.number2);break;case "REGSTORE":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);break;case "REGSTORE":void 0!=l.number1&&(l.input1=l.number1)}}}};b4w.module.__scenegraph=function(a,p){function d(a){var b=a.jd;a.jd=null;var c=xa.za(a);c.jd=b;a.jd=b;c.je=null;c.Ib=null;c.Ld=null;return c}function b(a,b){var d=[];K.re(a,function(b,c,f){-1<d.indexOf(f)?K.sG(a,b,c,f,h(f)):d.push(f)});K.ba(a,function(c,f){for(var e=0;e<f.na.length;e++){var g=f.na[e];b||"MAIN_PLANE_REFLECT"!=f.type&&"MAIN_CUBE_REFLECT"!=f.type&&"MAIN_XRAY"!=f.type||(g.be=!0);-1<d.indexOf(g)?f.na[e]=h(g):d.push(g)}"ANTIALIASING"==f.type&&K.se(a,c,function(a,b){if("MOTION_BLUR"==b.type)for(var c=
0;c<b.na.length;c++){var d=b.na[c];d.ua=U.u;d.sa=U.u}});b||K.se(a,c,function(a,b,c){"DEPTH"==c.from&&(c.be=!0)})});K.ba(a,function(b){var d={};c(a,b,d);for(var f in d){b=d[f];for(var e=b[0],h=0;h<b.length;h++)if(b[h].ua==U.u){e=b[h];break}for(var g=b[0],h=0;h<b.length;h++)if(b[h].sa==U.u){g=b[h];break}for(var k=b[0],h=0;h<b.length;h++)if(!b[h].be){k=b[h];break}for(h=0;h<b.length;h++)b[h].ua=e.ua,b[h].sa=g.sa,b[h].be=k.be}})}function c(a,b,d){K.se(a,b,function(b,f,e){e.Bb&&e.from==e.to&&(d[e.from]=
d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),c(a,b,d))});K.Fg(a,b,function(a,b,c){c.Bb&&(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});b=K.Da(a,b);if("MOTION_BLUR"==b.type)for(var f=0;f<b.na.length;f++){var e=b.na[f];d[e.from].push(e)}}function n(a){var b=["MOTION_BLUR","SMAA_RESOLVE","SMAA_NEIGHBORHOOD_BLENDING","MAIN_PLANE_REFLECT","MAIN_QUBE_REFLECT"],c=K.Is(a),d=[];K.ba(c,function(a,f){for(var h=0;h<f.na.length;h++){var k=f.na[h];-1<b.indexOf(f.type)&&(k.Do=
!0);var m=e(d,k,g(k));k.xa=m;f.Ve[h]=m}for(h=0;h<f.Ve.length;h++)m=f.Ve[h],t(d,m);K.Fg(c,a,function(h,k,m){-1<b.indexOf(f.type)&&(m.Do=!0);m.xa||((h=q(c,a,m.from))&&m.Bb&&!m.xa?l(d,h):h=e(d,m,g(m)),m.xa=h)});K.se(c,a,function(a,b,c){t(d,c.xa)});K.Fg(c,a,function(a,b,c){c.xa&&"NONE"==c.to&&t(d,c.xa)})})}function g(a){a=xa.hh(a);delete a.to;delete a.Bb;delete a.xa;return JSON.stringify(a)}function q(a,b,c){var d=null;K.se(a,b,function(a,b,f){if(f.Bb&&f.from==f.to&&f.from==c&&f.xa)return d=f.xa,!0});
K.Fg(a,b,function(a,b,f){if(f.Bb&&f.from==c&&f.xa)return d=f.xa,!0});return d}function l(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Es===b&&d.Dl++}}function t(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Es===b&&d.Dl&&d.Dl--}}function e(a,b,c){if(b.wl)return l(a,b.wl.xa),b.wl.xa;if(b.Do)return H(b);for(var d=null,f=0;f<a.length;f++){var e=a[f];if(e.id==c&&0===e.Dl){d=e;break}}if(d&&!aa.tF)return d.Dl++,d.Es;b=H(b);a.push({id:c,Dl:1,Es:b});return b}function H(a){var b=a.$h*a.size,c=a.Kl*a.size;
switch(a.from){case "COLOR":if(a.be){var d=U.Ek("COLOR_RB",a.nj?U.om:U.nm);U.resize(d,b,c)}else d=U.Ek("COLOR",U.Rg),U.resize(d,b,c),U.bs(d,a.ua,a.sa);return d;case "DEPTH":return a.be?(d=U.Ek("DEPTH_RB",a.nj?U.mm:U.lm),U.resize(d,b,c)):(d=U.Ek("DEPTH_TEX",U.pi),U.resize(d,b,c),U.bs(d,a.ua,a.sa)),d;case "CUBEMAP":return d=U.XB(b);case "SCREEN":case "NONE":return null;default:throw"Wrong slink param: "+a.from;}}function k(a,b){var c=!1;K.re(a,function(d,f,e){if(e&&(d=K.Da(a,d),f=K.Da(a,f),b(e,!1,d,
f)))return c=!0});c||K.ba(a,function(a,c){for(var d=0;d<c.na.length;d++)if(b(c.na[d],!0,c,null))return!0})}function r(a){K.ba(a,function(b,c){if("SINK"!=c.type){var d=c.j;K.Fg(a,b,function(a,b,c){c.Bb&&c.xa&&(ca.jo(d,c.from,c.xa),c.from==c.to&&b.j&&ca.jo(b.j,c.from,c.xa))});for(var f=0;f<c.na.length;f++){var e=c.na[f];e.Bb&&e.from==e.to&&ca.jo(d,e.from,c.Ve[f])}!d.Ib&&!d.Ld||d.je||(d.je=va.rG(d.Ib,d.Ld))}});K.ba(a,function(b,c){if("RESOLVE"==c.type||"COPY"==c.type){var d=Z(a,c);c.j.vq=d[0].j.je}})}
function u(a){var b=null,c=0;K.ba(a,function(a,d){if(d.type==Ba.OH){if(c==Ba.NH)return b=d,!0;c++}});return b}function z(a,b){var c=K.Oe(a,b),d=L("NONE"),f=K.v(a,d),e=K.el(a)[0];K.re(a,function(b,c){c==e&&K.Xw(a,b,e,b,f)});K.re(a,function(f,e,h){if(f==c)return K.n(a,b,d,m(Ba.rH,"u_color",h.size,h.$h,h.Kl,h.Tl)),!0});K.rc(a,f,e,m("SCREEN","NONE",.5,.5,.5,!0))}function D(a,b,c){var d=["GRASS_MAP","SHADOW_CAST","MAIN_CUBE_REFLECT"],e=c.N,g=b.antialiasing,k=b.xv,l,r,n;k&&g?K.ba(a,function(b,c){if("ANTIALIASING"==
c.type){var d=ga(a,c,"COMPOSITING");l=d?K.Da(a,d):b}else"COMPOSITING"==c.type&&(l=b)}):l=K.el(a)[0];K.se(a,l,function(b,c){if(ma(a,c,"MAIN_OPAQUE"))return r=b,n=c,!0});for(var q=K.so(a,r,K.hm),t=[],w=[],u=[],q=K.clone(q,function(h){var g;if(-1<d.indexOf(h.type))w.push(h),g=h;else{g=f(h);if("MAIN_PLANE_REFLECT"==g.type)for(var m=b.vg.Pe,l=0;l<m.length;l++)if(m[l][0]==h){b.vg.Pe[l]=[h,g];g.j.$b=h.j.$b;c.N.push(g.j);break}-1<e.indexOf(h.j)&&(k?(ca.Gn(h.j,ca.nc),ca.Gn(g.j,ca.oc)):(ca.Gn(h.j,ca.Ab),ca.Gn(g.j,
ca.Hb)),e.push(g.j));m=K.Oe(a,h);K.se(a,m,function(a,b,c){-1<d.indexOf(b.type)&&t.push([b,g,c])});for(l=0;l<h.na.length;l++)g.na[l].wl=h.na[l];h=!0;for(l=0;l<K.qn(a,m);l++){var r=K.Si(a,m,l),r=K.Da(a,r);-1==d.indexOf(r.type)&&(h=!1)}h&&u.push(g)}return g},function(a){var b=h(a,!0);b.wl=a;return b}),A=0;A<w.length;A++)K.Re(q,K.Oe(q,w[A]));K.Ip(q);var x=ia(k),A=K.v(a,x);K.Xw(a,r,l,A,l);g=la();K.v(a,g);var aa=m("COLOR","COPY",1,1,1,!0);K.n(a,n,g,aa);var J=m("COLOR","u_sampler_left",1,1,1,!0);J.Do=!0;
J.ua=U.u;J.sa=U.u;K.n(a,g,x,J);x=m("COLOR","u_sampler_right",1,1,1,!0);x.ua=U.u;x.sa=U.u;x.wl=aa;K.FA(q,a,[K.el(q)[0],A,x]);for(A=0;A<t.length;A++)K.n(a,t[A][0],t[A][1],t[A][2]);q=m("SCREEN","NONE",0,0,0,!1);for(A=0;A<u.length;A++)K.n(a,g,u[A],q);if(k){var p=[];K.ba(a,function(b,c){if(-1==d.indexOf(c.type)&&c.na.length&&sa(a,c,"STEREO"))for(var f=0;f<c.na.length;f++){var e=c.na[f];-1==p.indexOf(e)&&p.push(e)}});K.re(a,function(b,c,f){b=K.Da(a,b);c=K.Da(a,c);-1==d.indexOf(b.type)&&sa(a,c,"STEREO")&&
-1==p.indexOf(f)&&p.push(f)});for(A=0;A<p.length;A++)p[A].$h*=.5}}function y(a,b){a.Nn=b;a.dr=new Float32Array(3*b);a.Bn=new Float32Array(3*b);a.An=new Float32Array(3*b);a.er=new Float32Array(0==b%2?2*b:2*b+2)}function C(a,b,c,d){var f=v("SHADOW_CAST");f.Up=a;f.self_shadow_polygon_offset=c.self_shadow_polygon_offset;f.qe=b;switch(c.le[b]){case "SPOT":case "POINT":f.j=ca.Nb(ca.pc);ca.ko(f.j,180*c.Bx[b]/Math.PI,.1,2*c.Du[b]);break;default:f.j=ca.Nb(ca.Sg)}y(f,d);return f}function v(a){a={type:a,hb:"",
Ja:!1,Bw:!1,jp:!1,Ln:!1,Ik:0,Zf:0,Vm:[],time:0,j:null,Gk:null,Wp:[],s:[],na:[],Ve:[],Lf:new Float32Array(3),Jy:new Float32Array(3),Kc:new Float32Array(3),Ac:new Float32Array(4),Pd:new Float32Array(4),fd:new Float32Array(16),tx:0,pf:0,Nn:0,dr:null,Bn:null,An:null,er:null,Td:new Float32Array(3),ce:new Float32Array(3),ux:new Float32Array(4),Lx:new Float32Array([0,0,0]),ys:new Float32Array(3),Mx:new Float32Array(4),sx:new Float32Array(3),rl:0,iq:0,kl:!1,Af:new Float32Array(3),Ng:0,Dp:0,xe:null,Vs:0,Ws:0,
Og:0,gf:!1,Ut:0,Vt:new Float32Array(2),Tt:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Gj:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,Kj:0,Jj:0,Ij:0,Dx:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,ij:0,bo:0,Oj:0,Up:0,self_shadow_polygon_offset:0,
self_shadow_normal_offset:0,Ko:null,Jo:null,Qs:null,Qh:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,sp:0,pq:0,mb_decay_threshold:0,mb_factor:0,jw:0,Yn:"",RE:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Fs:new Float32Array(2),sb:new Float32Array(2),Ci:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,qe:0,Jb:!0,enqueue:!0,Ea:!0,Ka:!0,tc:!0,ia:!0,Jf:1};a.sb[0]=1;a.sb[1]=1;a.Ci[2]=1;return a}
function f(a){var b=a.j;a.j=null;var c=xa.za(a);a.j=b;c.j=d(b);return c}function m(a,b,c,d,f,e){return{from:a,to:b,size:c,$h:d,Kl:f,Tl:e,Bb:!0,xa:null,nj:!1,be:!1,ua:U.Ze,sa:U.Ze,Do:!1}}function h(a,b){if(b){var c=a.xa;a.xa=null}a.xa&&xa.Z("Failed to clone slink with attached texture");var d=xa.hh(a);b&&(a.xa=c,d.xa=c);return d}function x(){var a=v("GRASS_MAP");a.j=ca.Nb(ca.Qf);return a}function L(a){var b=v("POSTPROCESSING");b.Ea=!1;b.Ka=!1;b.tc=!1;b.j=ca.Nb(ca.Ub);b.Yn=a;switch(a){case "NONE":b.sb[0]=
1;b.sb[1]=1;break;case "GRAYSCALE":b.sb[0]=1;b.sb[1]=1;break;case "X_BLUR":b.sb[0]=1;b.sb[1]=0;break;case "Y_BLUR":b.sb[0]=0;b.sb[1]=1;break;case "X_GLOW_BLUR":b.sb[0]=1;b.sb[1]=0;break;case "Y_GLOW_BLUR":b.sb[0]=0;b.sb[1]=1;break;case "X_EXTEND":b.sb[0]=1;b.sb[1]=0;break;case "Y_EXTEND":b.sb[0]=0;b.sb[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function P(a){var b=v("BLOOM_BLUR");b.Ea=!1;b.Ka=!1;b.tc=!1;b.j=ca.Nb(ca.Ub);b.Yn=a;switch(a){case "X_BLUR":b.sb[0]=1;b.sb[1]=0;break;
case "Y_BLUR":b.sb[0]=0;b.sb[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function A(a,b){var c=v("GLOW_COMBINE");c.Ea=!1;c.Ka=!1;c.tc=!1;c.small_glow_mask_coeff=b.dg.small_glow_mask_coeff;c.large_glow_mask_coeff=b.dg.large_glow_mask_coeff;c.small_glow_mask_width=b.dg.small_glow_mask_width;c.large_glow_mask_width=b.dg.large_glow_mask_width;c.j=a;return c}function w(a,b,c,d,f,e,h,g,k){var m=v("MAIN_"+a);if("OPAQUE"===a)m.Ea=!0,m.Ka=c,m.Ja=!1;else if("BLEND"===
a)m.Ea=!1,m.Ka=!1,m.Ja=!0;else if("XRAY"===a)m.Ea=!1,m.Ka=!0,m.Ja=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)m.Ea=!0,m.Ka=!0,m.Ja=!1;else if("GLOW"===a)m.Ea=!0,m.Ka=!1,m.Ja=!1;else throw"wrong main subscene type";m.Ja&&g&&(m.self_shadow_normal_offset=g.self_shadow_normal_offset);m.j=b;if(a=h.ns)m.ux.set([a.bB,a.CE,a.pJ,a.oJ]),m.sx.set(a.color),m.tx=a.Ra;m.Td.set(h.Td);m.ce.set(h.ce);m.pf=h.pf;m.Ac=e.Ac;m.Pd=e.Pd;d&&(m.Tb=d,d.Ac&&(m.xe=new Float32Array(d.Ac)),m.Vs=d.waves_height,m.Ws=d.waves_length,
m.Og=d.Og,d.gf&&k&&(m.gf=!0,m.Ut=d.qB,m.Tt=d.pB,m.Vt.set(d.rB)));y(m,f);return m}function I(){var a=v("RESOLVE");a.j=ca.Nb(ca.Ub);return a}function T(a,b,c){var d=v("COLOR_PICKING");b&&(d.type+="_XRAY",d.Ea=!1,d.Ka=!0);d.enqueue=!1;d.j=a;y(d,c);return d}function O(a){var b=v("WIREFRAME");b.Jb=!1;b.Ea=!1;b.Ka=!1;b.j=a;return b}function B(a){var b=v("ANCHOR_VISIBILITY");b.Ea=!0;b.Ka=!1;b.j=a;return b}function G(a,b){var c=v("SHADOW_RECEIVE");c.j=a;y(c,b);return c}function M(a){var b=v("DEPTH_PACK");
b.Ea=!1;b.Ka=!1;b.j=a;return b}function F(a,b,c){var d=v("SSAO");d.Ea=!1;d.Ka=!1;d.tc=!1;d.j=a;d.Ac=b.Ac;d.xe=new Float32Array(b.Ac);d.Kj=c.radius_increase;d.ssao_hemisphere=c.BE;d.Jj=c.influence;d.Ij=c.dist_factor;d.Dx=c.AG;return d}function R(a,b){var c=v("SSAO_BLUR");c.Ea=!1;c.Ka=!1;c.tc=!1;c.j=a;c.ssao_blur_depth=b.eB;c.ssao_blur_discard_value=b.Nt;return c}function S(a){var b=v("ANTIALIASING");b.Ea=!1;b.Ka=!1;b.tc=!1;b.Jf=1/a.Tc;b.CD=a.tt;b.j=ca.Nb(ca.Ub);return b}function ha(a,b){var c=v(a);
c.Ea="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;c.Ka=!1;c.tc=!1;c.Jf=1/b.Tc;c.j=ca.Nb(ca.Ub);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(c.SE=new Float32Array(4));return c}function N(a,b,c,d){var f=v("COMPOSITING");f.Ea=!1;f.Ka=!1;f.tc=!1;f.j=ca.Nb(ca.Ub);f.brightness=a;f.contrast=b;f.exposure=c;f.saturation=d;return f}function oa(a,b){var c=v("MOTION_BLUR");c.Ea=!1;c.Ka=!1;c.tc=!1;c.j=ca.Nb(ca.Ub);c.jp=!0;c.mb_decay_threshold=a;c.mb_factor=b;return c}function fa(a){var b=v("DOF");
b.Ea=!1;b.Ka=!1;b.tc=!1;b.j=a;b.Jf=b.j.dof_power;return b}function na(a,b){var c=v("OUTLINE_MASK");c.tc=!1;c.j=a;y(c,b);return c}function ba(a){var b=v("OUTLINE");pa.outlining_overview_mode?b.Af.set(pa.Af):b.Af.set(a.Af);b.rl=a.rl;b.pq=5;b.sp=3;b.tc=!1;b.j=ca.Nb(ca.Ub);return b}function E(a,b,c,d,f,e,h){var g=v("GOD_RAYS");g.Ea=!1;g.Ka=!1;g.tc=!1;g.Td=new Float32Array([1,1,1]);g.ce=new Float32Array([1,1,1]);g.pf=1;g.Bw=d;g.Ng=b;g.bo=f;g.ij=c;g.Oj=h;g.j=a;y(g,e);return g}function ea(a,b){var c=v("GOD_RAYS_COMBINE");
c.Ea=!1;c.Ka=!1;c.tc=!1;c.j=ca.Nb(ca.Ub);c.god_rays_intensity=a;y(c,b);return c}function qa(a,b){var c=v("SKY");c.enqueue=!1;c.Ea=!1;c.Ka=!1;c.tc=!1;var d=ca.Nb(ca.Ub);d.width=Ja.Hk;d.height=Ja.Hk;c.j=d;c.Gk=xa.FD();y(c,a);c.Td=new Float32Array([1,1,1]);c.ce=new Float32Array([1,1,1]);c.pf=1;c.Gj.set(b.Gj);c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=
b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;return c}function la(){var a=v("COPY");a.Ea=!1;a.Ka=!1;a.j=ca.Nb(ca.Ub);return a}function ia(a){var b=v("STEREO");b.Ea=!1;b.Ka=!1;b.hb=a?"HMD":"ANAGLYPH";b.j=ca.Nb(ca.Ub);return b}function ya(){var a=v("LUMINANCE");a.Ea=!1;a.Ka=!1;a.j=
ca.Nb(ca.Ub);return a}function J(){var a=v("AVERAGE_LUMINANCE");a.Ea=!1;a.Ka=!1;a.j=ca.Nb(ca.Ub);return a}function V(a,b,c,d){var f=v("LUMINANCE_TRUNCED");f.Ea=!1;f.Ka=!1;f.bloom_key=a;f.bloom_edge_lum=b;f.j=d;y(f,c);return f}function W(a){var b=v("BLOOM");b.Ea=!1;b.Ka=!1;b.j=ca.Nb(ca.Ub);b.bloom_blur=a;return b}function Q(){var a=v("SINK");a.enqueue=!1;return a}function sa(a,b,c){if(b.type===c)return!0;b=Y(a,b);for(var d=0;d<b.length;d++)if(sa(a,b[d],c))return!0;return!1}function ma(a,b,c){if(b.type===
c)return!0;b=Z(a,b);for(var d=0;d<b.length;d++)if(ma(a,b[d],c))return!0;return!1}function ga(a,b,c){if(b.type===c)return b;b=Z(a,b);for(var d=0;d<b.length;d++){var f=ga(a,b[d],c);if(f)return f}return null}function Z(a,b){var c=K.Oe(a,b);if(c==K.it)throw"Subscene not in graph";for(var d=[],f=K.qn(a,c),e=0;e<f;e++){var h=K.Si(a,c,e);h!=c&&d.push(K.Da(a,h))}return d}function Y(a,b){var c=K.Oe(a,b);if(c==K.it)throw"Subscene not in graph";for(var d=[],f=K.og(a,c),e=0;e<f;e++){var h=K.cg(a,c,e);h!=c&&d.push(K.Da(a,
h))}return d}function Fa(a){var b=[],c=[];k(a,function(a){a.xa&&-1==b.indexOf(a.xa)&&(b.push(a.xa),c.push(a.xa,b.length-1))});return c}function ua(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.Tl){var d=a.$h,f=a.Kl;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==f?"":f)+"S")}else d=a.$h,f=a.Kl,c+=a.size*d+"x"+a.size*f;if("SCREEN"!=a.from){c+=" ";if(a.be)c+="RR";else{var d=a.ua,f=a.sa,e="";d==U.u?e+="L":d==U.Ze&&(e+="N");f==
U.u?e+="L":f==U.Ze&&(e+="N");c+=e}for(d=0;d<b.length;d+=2)b[d]==a.xa&&(c+=" "+b[d+1])}return c+")\\n"}var ca=p("__camera"),ja=p("__config"),da=p("__debug"),K=p("__graph");p("__obj_util");var va=p("__renderer"),U=p("__textures");p("__tsr");var xa=p("__util"),Ba=ja.bq,aa=ja.p,pa=ja.Kb,Ja=ja.Aj;a.EB=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.XH=k;a.lC=function(a,c,f){function e(b){var f=
d(Ua);c.N.push(f);f=w(b,f,!1,sa,H,yb,qc,Ia,a.di);K.v(g,f);"XRAY"==b?(K.n(g,k[0],f,m("COLOR","COLOR",1,1,1,!0)),f.na.push(m("DEPTH","DEPTH",1,1,1,!0))):(b=Ib&&"RESOLVE"==k[0].type?nb:k[0],K.n(g,b,f,vb),K.n(g,b,f,Bc));Ea&&(K.n(g,Ea,f,Jb),K.n(g,Ea,f,Ga));for(b=0;b<q.length;b++)K.n(g,q[b],f,t[b]);Rb&&K.n(g,Rb,f,Kb);if(p.length){var h=p.length;for(b=0;b<h;b++)K.n(g,p[b],f,v[b])}if(pa.length)for(b=0;b<pa.length;b++)K.n(g,pa[b],f,y[b]);Lb&&K.n(g,Lb,f,m("COLOR","u_refractmap",1,1,1,!0));return f}var g=K.create(),
k=[],l=[],q=[],t=[],p=[],v=[],pa=[],y=[],H=a.WE,sa=a.Tb,ma=a.shore_smoothing,ia=a.sH,Fa=a.Xc,ga=a.Vi,ua=a.AF,ja=a.vg,va=a.dB,fc=a.Jh,Rc=a.yi,Qc=a.antialiasing,qc=a.at,yb=a.Hy,Ia=a.kc,Mb=a.EF,Cc=a.sB,Dc=a.vE,Hc=a.SF,Zc=a.Ei,Ic=a.NC,$c=a.Fc,lb=Boolean(f.length),Ib=1<aa.Cc,Bc=m("COLOR","COLOR",1,1,1,!0),vb=m("DEPTH","DEPTH",1,1,1,!0);if(Ib){h(vb);var ob=h(vb);Bc.nj=!0;Bc.be=!0;vb.nj=!0;vb.be=!0}var Ua=c.N[0];if(Ia){ca.Ms(Ua,Ia);for(var Ra=0;Ra<Ia.le.length;Ra++)for(var jc=Ia.csm_num,db=0;db<jc;db++){var zb=
C(db,Ra,Ia,H);K.v(g,zb);q.push(zb);var ab=Ia.csm_resolution,Ka=zb.j;c.fs.push(Ka);Ka.width=ab;Ka.height=ab;zb.Ea=!1;t.push(m("DEPTH","u_shadow_map"+(0<Ra?Ra:db),ab,1,1,!1));(da.zB()||aa.Lu)&&zb.na.push(m("COLOR","COLOR",ab,1,1,!1))}}if(ja&&ja.sw&&!lb)for(db=0;db<ja.sw;db++){Ka=ca.Nb(ca.pc);Ka.width=a.mh;Ka.height=a.mh;ca.ko(Ka,90,.1,100);ca.Ff(Ka,Ka.Xa);var eb=w("CUBE_REFLECT",Ka,!1,sa,H,yb,qc,null,a.di);eb.Gk=xa.JD();for(Ra=0;6>Ra;Ra++)eb.Wp.push(ca.$B());K.v(g,eb);var bb=m("CUBEMAP","u_cube_reflection",
a.mh,1,1,!1);bb.ua=U.u;bb.sa=U.u;var La=m("DEPTH","DEPTH",a.mh,1,1,!1);y.push(bb);eb.na.push(La);pa.push(eb);ja.Yf.push(eb)}if(ja&&0<ja.Yw.length&&!lb)for(Ra=0;Ra<ja.Yw.length;Ra++)Ka=d(Ua),Ka.$b=new Float32Array(4),c.N.push(Ka),eb=w("PLANE_REFLECT",Ka,!1,sa,H,yb,qc,null,a.di),K.v(g,eb),bb=m("COLOR","u_plane_reflection",1,a.Sh,a.Sh,!0),bb.ua=U.u,bb.sa=U.u,La=m("DEPTH","DEPTH",1,a.Sh,a.Sh,!0),v.push(bb),eb.na.push(La),p.push(eb),ja.Pe.push([eb]);if(a.cc){var Ea=x();K.v(g,Ea);ab=Ja.ln;Ea.j.width=ab;
Ea.j.height=ab;var Jb=m("DEPTH","u_grass_map_depth",ab,1,1,!1);Jb.ua=U.u;Jb.sa=U.u;var Ga=m("COLOR","u_grass_map_color",ab,1,1,!1);Ga.ua=U.u;Ga.sa=U.u}else Ga=Jb=Ea=null;if(Ic&&Ia){var rc=d(Ua);c.N.push(rc);var fb=G(rc,H);K.v(g,fb);fb.self_shadow_normal_offset=Ia.self_shadow_normal_offset;for(db=0;db<q.length;db++)zb=q[db],K.n(g,zb,fb,t[db]);var sc=m("COLOR","u_color",1,1,1,!0),tc=m("DEPTH","u_depth",1,1,1,!0);if(Fa){var gc=d(Ua);c.N.push(gc);var Vc=a.GH,Ec=F(gc,yb,Vc);K.v(g,Ec);var Vb=m("COLOR",
"u_ssao_mask",1,1,1,!0);K.n(g,fb,Ec,sc);K.n(g,fb,Ec,tc);var Wb=d(Ua);c.N.push(Wb);var Ab=R(Wb,Vc);K.v(g,Ab);var Jc=m("COLOR","u_shadow_mask",1,1,1,!0);K.n(g,Ec,Ab,Vb);K.n(g,fb,Ab,tc)}Ib?fb.na.push(m("DEPTH","DEPTH",1,1,1,!0)):fb.na.push(vb);Ea&&(K.n(g,Ea,fb,Jb),K.n(g,Ea,fb,Ga))}else fb=null;var nb=w("OPAQUE",Ua,!0,sa,H,yb,qc,null,a.di);K.v(g,nb);if(Ib){var Bb=I();K.v(g,Bb);l.push(Bb);var gb=m("COLOR","RESOLVE",1,1,1,!0);gb.nj=!0;gb.be=!0;var Cb=m("DEPTH","RESOLVE",1,1,1,!0);Cb.nj=!0;Cb.be=!0;K.n(g,
nb,Bb,gb);K.n(g,nb,Bb,Cb)}else l.push(nb);fb&&(Vb?K.n(g,Ab,nb,Jc):Ia?K.n(g,fb,nb,m("COLOR","u_shadow_mask",1,1,1,!0)):xa.Z("Internal error"));Ea&&(K.n(g,Ea,nb,Jb),K.n(g,Ea,nb,Ga));if(p.length)for(var Na=p.length,Ra=0;Ra<Na;Ra++)K.n(g,p[Ra],nb,v[Ra]);if(pa.length)for(Ra=0;Ra<pa.length;Ra++)K.n(g,pa[Ra],nb,y[Ra]);k=l;l=[];if(!lb&&a.MB){Ka=d(Ua);c.N.push(Ka);var hb=T(Ka,!1,H);K.v(g,hb);if(a.Nf){Ka=d(Ua);c.N.push(Ka);var wb=T(Ka,!0,H);K.v(g,wb);K.n(g,hb,wb,m("COLOR","COLOR",1,1,1,!0));K.n(g,hb,wb,m("DEPTH",
"DEPTH",1,1,1,!0))}}else hb=null;if(ua.Fc&&!lb)if(Ib)Lb=Bb;else{var Lb=la();K.v(g,Lb);K.n(g,k[0],Lb,m("COLOR","COPY",1,1,1,!0))}else Lb=null;if(Ic&&(ua.Fc&&$c||ma||ia)){var Kc=d(Ua);c.N.push(Kc);var Rb=M(Kc);K.v(g,Rb);K.n(g,Ib?Bb:nb,Rb,m("DEPTH","u_depth",1,1,1,!0));var Kb=m("COLOR","u_scene_depth",1,1,1,!0);Kb.ua=U.Ze;Kb.sa=U.Ze}else Rb=null;if(a.kn){var pb=e("BLEND");l.push(pb);k=l;l=[]}if(a.tf){var Lc=d(Ua);c.N.push(Lc);var qb=w("GLOW",Lc,!1,sa,H,yb,qc);K.v(g,qb);K.n(g,Ib?Bb:nb,qb,Ib?ob:vb);var Db=
L("X_GLOW_BLUR");Db.hb="GLOW_MASK_SMALL";Db.Jf=a.dg.small_glow_mask_width;var Xb=m("COLOR","u_color",1,1,1,!0);Xb.ua=U.u;Xb.sa=U.u;K.v(g,Db);K.n(g,qb,Db,Xb);var Ma=L("Y_GLOW_BLUR");Ma.hb="GLOW_MASK_SMALL";Ma.Jf=a.dg.small_glow_mask_width;var Ya=m("COLOR","u_color",1,.5,.5,!0);Ya.ua=U.u;Ya.sa=U.u;K.v(g,Ma);K.n(g,Db,Ma,Ya);var Wa=L("X_GLOW_BLUR");Wa.hb="GLOW_MASK_LARGE";Wa.Jf=a.dg.large_glow_mask_width;var Va=m("COLOR","u_color",1,.5,.5,!0);Va.ua=U.u;Va.sa=U.u;K.v(g,Wa);K.n(g,Ma,Wa,Va);var Aa=L("Y_GLOW_BLUR");
Aa.hb="GLOW_MASK_LARGE";Aa.Jf=a.dg.large_glow_mask_width;var Yb=m("COLOR","u_color",1,.25,.25,!0);Yb.ua=U.u;Yb.sa=U.u;K.v(g,Aa);K.n(g,Wa,Aa,Yb);var rb=d(Ua);c.N.push(rb);var Sb=A(rb,a);K.v(g,Sb);var Sa=m("COLOR","u_src_color",1,1,1,!0);if(a.kn)if(Ib){var kc=I();K.v(g,kc);K.n(g,pb,kc,gb);K.n(g,pb,kc,Cb);K.n(g,kc,Sb,Sa)}else K.n(g,pb,Sb,Sa);else K.n(g,Ib?Bb:nb,Sb,Sa);K.n(g,a.kn?pb:nb,Sb,vb);var sb=m("COLOR","u_glow_mask_small",1,.5,.5,!0);sb.ua=U.u;sb.sa=U.u;K.n(g,Ma,Sb,sb);var tb=m("COLOR","u_glow_mask_large",
1,.25,.25,!0);tb.ua=U.u;tb.sa=U.u;K.n(g,Aa,Sb,tb);k=[Sb];l=[]}a.kn||(pb=e("BLEND"),l.push(pb),k=l,l=[]);if(aa.wireframe_debug){Ka=d(Ua);c.N.push(Ka);var Nb=O(Ka);l.push(Nb);K.v(g,Nb);K.n(g,k[0],Nb,Bc);K.n(g,k[0],Nb,vb);Ea&&(K.n(g,Ea,Nb,Jb),K.n(g,Ea,Nb,Ga));k=l;l=[]}if(Ib){var hc=I();K.v(g,hc);l.push(hc);K.n(g,k[0],hc,gb);K.n(g,k[0],hc,Cb);k=l;l=[]}var Ob=k.slice(0);if(!lb&&a.oA){Ka=d(Ua);c.N.push(Ka);var uc=B(Ka);K.v(g,uc);K.n(g,k[0],uc,Ib?ob:vb)}if(ga&&Ic&&!lb){var Tb=Dc.ij,Pb=Dc.Sq,Eb=Dc.Oj,Oa=
k[0],Ta=sa?!0:!1,ib=m("DEPTH","u_input",1,1,1,!0);ib.ua=U.u;ib.sa=U.u;var bc=m("COLOR","u_input",1,.25,.25,!0);bc.ua=U.u;bc.sa=U.u;var Zb=Tb/Eb,Fb=d(Ua);c.N.push(Fb);var cc=E(Fb,Ta,Tb,!0,Zb,H,Eb);K.v(g,cc);K.n(g,Oa,cc,ib);var Zb=Tb/Eb*.5,jb=d(Ua);c.N.push(jb);var Qb=E(jb,Ta,Tb,!1,Zb,H,Eb);K.v(g,Qb);K.n(g,cc,Qb,bc);var Zb=Tb/Eb*.25,kb=d(Ua);c.N.push(kb);var lc=E(kb,Ta,Tb,!1,Zb,H,Eb);K.v(g,lc);K.n(g,Qb,lc,bc);var vc=ea(Pb,H);l.push(vc);K.v(g,vc);K.n(g,Oa,vc,m("COLOR","u_main",1,1,1,!0));K.n(g,lc,vc,
m("COLOR","u_god_rays",1,1,1,!0));k=l;l=[]}if(va&&!lb){var Oa=k[0],mc=ya();K.v(g,mc);K.n(g,Oa,mc,m("COLOR","u_input",1,1,1,!0));var dc=J();K.v(g,dc);dc.j.width=aa.Ok?2:1;dc.j.height=aa.Ok?2:1;var wc=m("COLOR","u_input",1,.25,.25,!0);wc.ua=U.u;wc.sa=U.u;var $b=m("COLOR","u_luminance",1,.25,.25,!0);$b.ua=U.u;$b.sa=U.u;K.n(g,mc,dc,wc);var Sc=va.key,Fc=va.VC,Mc=d(Ua);c.N.push(Mc);var Gb=V(Sc,Fc,H,Mc);K.v(g,Gb);K.n(g,Oa,Gb,m("COLOR","u_main",1,1,1,!0));K.n(g,mc,Gb,$b);K.n(g,dc,Gb,m("COLOR","u_average_lum",
1,1,1,!1));var nc=m("COLOR","u_color",1,.25,.25,!0);nc.ua=U.u;nc.sa=U.u;Db=P("X_BLUR");K.v(g,Db);K.n(g,Gb,Db,nc);Ma=P("Y_BLUR");K.v(g,Ma);K.n(g,Db,Ma,nc);var cb=W(va.blur);K.v(g,cb);var Pa=m("COLOR","u_bloom",1,.25,.25,!0);Pa.ua=U.u;Pa.sa=U.u;K.n(g,Ma,cb,Pa);K.n(g,Oa,cb,m("COLOR","u_main",1,1,1,!0));l.push(cb);k=l;l=[]}if(Zc&&Ic&&!lb){var Oa=k[0],ac=d(Ua);c.N.push(ac);nc=m("COLOR","u_color",1,1,1,!0);nc.ua=U.u;nc.sa=U.u;var xc=L("X_BLUR");K.v(g,xc);K.n(g,Oa,xc,nc);var yc=L("Y_BLUR");K.v(g,yc);K.n(g,
xc,yc,nc);var pd=Ob[0],Ub=fa(ac);ac.dof_distance=c.dof_distance;ac.jd=c.jd;ac.dof_front=c.dof_front;ac.dof_rear=c.dof_rear;ac.dof_power=c.dof_power;ac.dof_on=!0;l.push(Ub);K.v(g,Ub);K.n(g,Oa,Ub,m("COLOR","u_sharp",1,1,1,!0));K.n(g,yc,Ub,m("COLOR","u_blurred",1,1,1,!0));K.n(g,pd,Ub,m("DEPTH","u_depth",1,1,1,!0));k=l;l=[]}if(a.Nf){var ud=e("XRAY");l.push(ud);k=l;l=[]}if(fc&&!lb){var qd=k[0],Nc=oa(Mb.mb_decay_threshold,Mb.mb_factor);l.push(Nc);K.v(g,Nc);K.n(g,qd,Nc,m("COLOR","u_mb_tex_curr",1,1,1,!0));
Nc.na.push(m("COLOR","u_mb_tex_accum",1,1,1,!0));k=l;l=[]}if(!lb&&a.outline){var Oa=k[0],rd=d(Ua);c.N.push(rd);var ad=na(rd,H);K.v(g,ad);var Oc=L("X_EXTEND"),bd=m("COLOR","u_color",1,1,1,!0),vd=m("COLOR","u_outline_mask",1,1,1,!0);Oc.kl=!0;K.v(g,Oc);K.n(g,ad,Oc,bd);var Wc=m("COLOR","u_color",1,.5,.5,!0);Wc.ua=U.u;Wc.sa=U.u;var cd=L("Y_EXTEND");cd.kl=!0;K.v(g,cd);K.n(g,Oc,cd,Wc);xc=L("X_BLUR");xc.kl=!0;K.v(g,xc);K.n(g,cd,xc,Wc);var dd=m("COLOR","u_color",1,.25,.25,!0);dd.ua=U.u;dd.sa=U.u;var ub=m("COLOR",
"u_outline_mask_blurred",1,.25,.25,!0);ub.ua=U.u;ub.sa=U.u;yc=L("Y_BLUR");yc.kl=!0;K.v(g,yc);K.n(g,xc,yc,dd);var Xc=ba(Hc);K.v(g,Xc);K.n(g,Oa,Xc,m("COLOR","u_outline_src",1,1,1,!0));K.n(g,ad,Xc,vd);K.n(g,yc,Xc,ub);l.push(Xc);k=l;l=[]}if(Rc&&!lb){var Oa=k[0],Gc=N(Cc.brightness,Cc.contrast,Cc.exposure,Cc.saturation);K.v(g,Gc);K.n(g,Oa,Gc,m("COLOR","u_color",1,1,1,!0));l.push(Gc);k=l;l=[]}if(Qc){Oa=k[0];if(aa.smaa){var Yc=m("COLOR","u_color",1,1,1,!0);Yc.ua=U.u;Yc.sa=U.u;var ed=ha("SMAA_EDGE_DETECTION",
a);K.v(g,ed);K.n(g,Oa,ed,Yc);var Tc=ha("SMAA_BLENDING_WEIGHT_CALCULATION",a);K.v(g,Tc);K.n(g,ed,Tc,Yc);var Pc=m("COLOR","u_search_tex",1,1,1,!1),ld=m("COLOR","u_area_tex",1,1,1,!1);Pc.ua=U.u;Pc.sa=U.u;ld.ua=U.u;ld.sa=U.u;Tc.na.push(Pc);Tc.na.push(ld);var fd=ha("SMAA_NEIGHBORHOOD_BLENDING",a);K.v(g,fd);K.n(g,Oa,fd,Yc);var gd=m("COLOR","u_blend",1,1,1,!0);gd.ua=U.u;gd.sa=U.u;K.n(g,Tc,fd,gd);l.push(fd)}else{var md=S(a);K.v(g,md);var hd=m("COLOR","u_color",1,1,1,!0);hd.ua=U.u;hd.sa=U.u;K.n(g,Oa,md,hd);
l.push(md)}k=l;l=[]}l.push(k[0]);var sd=K.Oe(g,k[0]);if("MOTION_BLUR"==k[0].type||"RESOLVE"==k[0].type)var nd=!0;else nd=!1,K.se(g,sd,function(a,b,c){if(c.from==c.to)return nd=!0});if(nd){var jd=L("NONE");K.v(g,jd);K.n(g,k[0],jd,m("COLOR","u_color",1,1,1,!0));k=l;l=[];l.push(jd)}hb&&(wb?l.push(wb):l.push(hb));uc&&l.push(uc);if(!lb&&a.oo.procedural_skydome){var od=qa(H,a.oo);K.v(g,od);l.push(od)}var zc=Q();K.v(g,zc);for(db=0;db<l.length;db++){var kd=l[db];switch(kd.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":K.n(g,
kd,zc,m("COLOR","NONE",1,1,1,!0));K.n(g,kd,zc,m("DEPTH","NONE",1,1,1,!0));break;case "SKY":K.n(g,kd,zc,m("CUBEMAP","u_sky",Ja.Hk,1,1,!1));break;case "ANCHOR_VISIBILITY":K.n(g,kd,zc,m("COLOR","NONE",1,1,1,!0));break;default:if(lb){var xd=f[0].k,td=m("COLOR","OFFSCREEN",1,1,1,!0);td.xa=xd;K.n(g,l[db],zc,td);for(Ra=1;Ra<f.length;Ra++){var yd=f[Ra].k,wd=L("NONE");K.v(g,wd);K.n(g,l[db],wd,m("COLOR","SCALE",1,1,1,!0));var zd=yd.ai/xd.ai,td=m("COLOR","OFFSCREEN",1,zd,zd,!0);td.xa=yd;K.n(g,wd,zc,td)}}else K.n(g,
l[db],zc,m("SCREEN","NONE",1,1,1,!0))}}Bb&&!Y(g,Bb).length&&(K.Re(g,K.Oe(g,Bb)),K.Ip(g));b(g,Ic);!a.anaglyph_use&&!a.xv||lb||D(g,a,c);if(Ba.enabled){var Ad=u(g);Ad&&z(g,Ad)}n(g);r(g);Ia&&K.ba(g,function(a,b){if("SHADOW_RECEIVE"==b.type||"MAIN_BLEND"==b.type||"MAIN_XRAY"==b.type){for(var c=0,d=Z(g,b),f=0,e=0;e<d.length;e++){var h=d[e];"SHADOW_CAST"==h.type&&(f++,b.Qh=b.Qh||[],b.Qh[0<h.qe?h.qe:c]=h.j.mb,c++)}b.Ko&&b.Jo||(aa.Fn?b.Qs=new Float32Array(9*f):(b.Ko=new Float32Array(4*f),b.Jo=new Float32Array(4*
f)))}});return g};a.rL=v;a.xd=function(a,b,c){var d=a.Jf;a.Fs[0]=b*a.sb[0]*d;a.Fs[1]=c*a.sb[1]*d};a.yc=function(a,b){a.Jf=b};a.jC=function(){var a=K.create(),b=v("PERFORMANCE"),c=ca.Nb(ca.Ub);c.width=1024;c.height=1024;b.j=c;K.v(a,b);c=Q();K.v(a,c);K.n(a,b,c,m("COLOR","NONE",1024,1,1,!1));n(a);r(a);return a};a.JK=function(a){var b=null;K.ba(a,function(a,c){return c.j&&null===c.j.je?(b=c,!0):!1});return b};a.ab=function(a,b,c){a=Z(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};
a.kL=sa;a.mL=ma;a.iE=Z;a.kE=Y;a.Fb=function(a,b){var c=null;K.ba(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.FC=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=Fa(a);K.ba(a,function(a,d){var f=b+="    ",e="",e=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(e+=" ("+d.Yn.replace(/_/g," ")+")");if(d.j){for(var e=e+"\\n",h=0;h<c.length;h+=2){var g=d.j.Ib;c[h]==
g&&(e=U.cj(g)?e+("CR"+c[h+1]+" "):e+("C"+c[h+1]+" "))}for(h=0;h<c.length;h+=2)g=d.j.Ld,c[h]==g&&(e=U.cj(g)?e+("DR"+c[h+1]):e+("D"+c[h+1]))}d.na.length&&(e+="\\n-----\\n");for(h=0;h<d.na.length;h++)e+=ua(d.na[h],c);h="SINK"==d.type?"dotted":d.enqueue?"solid":"dashed";b=f+(String(a)+' [label="'+e+'" color="black" style="'+(h+",bold")+'"];\n')});K.re(a,function(a,d,f){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+ua(f,c)+'" style="'+(f.Bb?"solid":"dotted")+'"];\n'});return b+="}"};a.mC=function(a){a=
K.SH(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__textures=function(a,p){function d(){return{name:"",type:0,source:"",ps:"",width:0,height:0,Op:1,sm:!0,ai:1024,Rk:!1,ed:null,Gb:0,Qa:null,Fd:null,ml:!1,Kf:-1,ha:null,mj:0,rf:0,Y:0,bb:0,Ni:0,Ne:!1,Df:1,jc:null,$r:0,Zr:0,Zh:-1,as:!1,Bj:-1,No:!1,KI:!1,fi:!1,Ho:!1,repeat:!0}}function b(b,f,e,h){var g=b.type,k=new Uint8Array([204,204,204,255]),m=d();switch(g){case "DATA_TEX2D":case "IMAGE":var l=E.createTexture(),r=E.TEXTURE_2D;E.bindTexture(r,l);E.texImage2D(r,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,
k);b.image&&"MOVIE"==b.image.source&&(m.ml=!0,m.Y=b.frame_start,m.bb=b.frame_offset,m.Ni=b.frame_duration,m.KI=b.use_auto_refresh,m.fi=b.use_cyclic,m.mj=b.movie_length,m.Ho=b.b4w_nla_video,0!=m.bb&&T.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":l=E.createTexture();r=E.TEXTURE_2D;E.bindTexture(r,l);if("NONE"==b.b4w_source_type)return null;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=B.keysearch("name",
b.b4w_source_id,e)))m.ai=b.b4w_source_size,e.ye=e.ye||[],e.ye.push(b),E.texImage2D(r,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,k);else return null;break;case "ENVIRONMENT_MAP":l=E.createTexture();r=E.TEXTURE_CUBE_MAP;E.bindTexture(r,l);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var n=0;6>n;n++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+e[n]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,k);break;case "BLEND":return null;case "NODE_TEX":l=E.createTexture();r=E.TEXTURE_2D;E.bindTexture(r,
l);E.texImage2D(r,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,k);break;default:return T.error('texture "'+b.name+'" has unsupported type "'+g+'"'),null}"NONE"==g&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"DATA_TEX2D"==g||"IMAGE"==g&&"MOVIE"==b.image.source||"NODE_TEX"==g?E.texParameteri(r,E.TEXTURE_MIN_FILTER,E.LINEAR):E.texParameteri(r,E.TEXTURE_MIN_FILTER,ea[S.Uj]);E.texParameteri(r,E.TEXTURE_MAG_FILTER,E.LINEAR);k=r;e=b.b4w_anisotropic_filtering;"DEFAULT"===e&&(e=f);"OFF"!==e&&
S.um&&(f=I.TD())&&(e=parseFloat(e.split("x")[0]),E.texParameterf(k,f.TEXTURE_MAX_ANISOTROPY_EXT,e));"REPEAT"!=b.extension||b.b4w_shore_dist_map?(m.repeat=!1,E.texParameteri(r,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(r,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE)):(E.texParameteri(r,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(r,E.TEXTURE_WRAP_T,E.REPEAT));m.type=a.Rg;m.width=1;m.height=1;m.Qa=l;m.Gb=r;"CANVAS"==b.b4w_source_type&&"NONE"==g?(g=b.b4w_source_id,l=b.b4w_source_size,m.Rk=b.b4w_enable_canvas_mipmapping,
m.ps=g,m.source="CANVAS",r=document.createElement("canvas"),r.width=l,r.height=l,m.ed=r.getContext("2d"),h in na||(na[h]={}),na[h][g]=m,c(m)):"SCENE"==b.b4w_source_type&&"NONE"==g?(m.ps=b.b4w_source_id,m.source="SCENE"):(m.source=g,E.generateMipmap(r),E.bindTexture(r,null));m.name=b.name;return b.k=m}function c(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.Gb;E.bindTexture(b,a.Qa);var c=k(a),d=r(a),f=u(a),e=a.ed.canvas;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);E.texImage2D(b,0,d,c,f,e);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,
!1);a.Rk&&E.generateMipmap(b);E.bindTexture(b,null);a.width=e.width;a.height=e.height}function n(a){var b=a.Gb;E.bindTexture(b,a.Qa);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);4!=a.ha.length?a.Ne?l(a,a.ha,a.width*a.Df,a.height*a.Df,!1):E.texImage2D(b,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.ha):E.texImage2D(b,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,a.ha);E.bindTexture(b,null)}function g(a){var b=a.Gb;E.bindTexture(b,a.Qa);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);a.Ne?l(a,a.jc[a.Zh],a.width*a.Df,a.height*a.Df,
!1):E.texImage2D(b,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.jc[a.Zh]);E.bindTexture(b,null)}function q(){N||(N=document.createElement("canvas"));return N}function l(a,b,c,d,f){f||(t(E.TEXTURE_2D),E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,b));E.bindTexture(E.TEXTURE_2D,null);G.TC(a,c,d,fa,oa)}function t(a){fa||(fa=E.createFramebuffer());E.bindTexture(a,null);oa||(oa=E.createTexture());E.bindTexture(a,oa);E.texParameteri(a,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_WRAP_T,
E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(a,E.TEXTURE_MIN_FILTER,E.LINEAR)}function e(a){a.ha.LL=function(){n(a)}}function H(a){return B.vk(a)?B.clamp(Math.pow(2,parseInt(a).toString(2).length),2,S.wb):a}function k(b){switch(b.type){case a.Rg:b=E.RGBA;break;case a.pm:b=E.RGB;break;case a.fk:b=E.RGBA;break;case a.gk:b=E.RGB;break;case a.pi:b=E.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function r(b){switch(b.type){case a.Rg:b=S.Gc?E.RGBA8:
E.RGBA;break;case a.pm:b=S.Gc?E.RGB8:E.RGB;break;case a.fk:b=S.Gc?E.RGBA8:E.RGBA;break;case a.gk:b=S.Gc?E.RGB8:E.RGB;break;case a.pi:b=S.Gc?E.DEPTH_COMPONENT24:E.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function u(b){switch(b.type){case a.Rg:b=E.UNSIGNED_BYTE;break;case a.pm:b=E.UNSIGNED_BYTE;break;case a.fk:b=E.FLOAT;break;case a.gk:b=E.FLOAT;break;case a.pi:b=E.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function z(a){return a&&a.name&&a.Fd?!0:!1}function D(a,
b){if(b in ba&&a in ba[b]){var c=ba[b][a];c.ha?c.ha.play():c.jc&&(c.as=!0);return!0}return!1}function y(a,b){if(b in ba&&a in ba[b]){var c=ba[b][a];c.ha?c.ha.pause():c.jc&&(c.as=!1);return!0}return!1}function C(a,b){if(b in ba&&a in ba[b]){var c=ba[b][a];c.ha?c.ha.currentTime=c.bb/c.rf:c.jc&&(c.Zh=f(c,c.bb),g(c));return!0}return!1}function v(a){return a.ha?!a.ha.paused:a.jc?a.as:!1}function f(a,b){return Math.round(b*a.$r/a.mj)}function m(a,b){if(M.ma(a))return h(a,b);for(var c=a.iw,d=0;d<c.length;d++){var f=
h(c[d],b);if(f)return f}return null}function h(a,b){for(var c=null,d=a.B,f=0;f<d.length;f++)for(var e=d[f].T,h=0;h<e.length;h++)for(var g=e[h],m=0;m<g.U.length;m++)if(g.U[m].name==b){c=g.U[m];break}return c}function x(a,b,c){var d=a.elements;a=a.interpolation;for(var f=0;f<b;f++){var e=f/(b-1),h=L(d,e,!0),g=P(d,e,!0);if(h&&g)if("CONSTANT"==a)c.push.apply(c,h.color);else{var m=c,k=h,l=g;k==l?m.push.apply(m,k.color):(m.push(F.Dn(l.color[0],l.position,k.color[0],k.position,e)),m.push(F.Dn(l.color[1],
l.position,k.color[1],k.position,e)),m.push(F.Dn(l.color[2],l.position,k.color[2],k.position,e)),m.push(F.Dn(l.color[3],l.position,k.color[3],k.position,e)))}g&&!h&&c.push.apply(c,g.color);h&&!g&&c.push.apply(c,h.color)}}function L(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?b-a[f].position:b-a[f][1][0];0<=e&&(d?e<=(c?b-d.position:b-a[f][1][0])&&(d=a[f]):d=a[f])}return d}function P(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?a[f].position-b:a[f][1][0]-b;0<=e&&(d?e<=(c?d.position-b:d[1][0]-
b)&&(d=a[f]):d=a[f])}return d}var A=p("__config"),w=p("__dds"),I=p("__extensions"),T=p("__print"),O=p("__time"),B=p("__util"),G=p("__renderer"),M=p("__obj_util"),F=p("__curve"),R=p("__vec3"),S=A.p,ha=A.H,N=null,oa=null,fa=null;a.Ze=0;a.u=0;a.fA=0;a.dA=0;a.eA=0;a.cA=0;a.Rg=10;a.pm=20;a.fk=30;a.gk=40;a.pi=50;a.nm=60;a.lm=70;a.om=80;a.mm=90;a.ft=128;a.Oy=128;a.mt=128;var na={},ba={},E=null,ea;a.yd=function(b){ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];
a.Ze=b.NEAREST;a.u=b.LINEAR;a.fA=b.NEAREST_MIPMAP_NEAREST;a.dA=b.LINEAR_MIPMAP_NEAREST;a.eA=b.NEAREST_MIPMAP_LINEAR;a.cA=b.LINEAR_MIPMAP_LINEAR;E=b};a.XD=function(a,b){return b in na&&a in na[b]?na[b][a].ed:null};a.mI=function(a,b){return b in na&&a in na[b]?(c(na[b][a]),!0):!1};a.Ek=function(b,c){var f=d();f.name=b;f.type=c;f.source="NONE";if(c==a.nm||c==a.lm||c==a.om||c==a.mm)f.Fd=E.createRenderbuffer();else{var e=E.TEXTURE_2D,h=E.createTexture();E.bindTexture(e,h);E.texParameteri(e,E.TEXTURE_MAG_FILTER,
E.LINEAR);E.texParameteri(e,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(e,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(e,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.bindTexture(e,null);f.Gb=e;f.Qa=h}return f};a.XB=function(b){var c=E.createTexture(),f=E.TEXTURE_CUBE_MAP;E.bindTexture(f,c);E.texParameteri(f,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(f,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(f,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(f,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);for(var e=
"TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),h=0;6>h;h++)E.texImage2D(E[e[h]],0,E.RGBA,b,b,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(f,null);f=d();f.name="CUBEMAP";f.type=a.Rg;f.source="NONE";f.width=3*b;f.height=2*b;f.Op=1;f.Qa=c;f.Gb=E.TEXTURE_CUBE_MAP;return f};a.bs=function(a,b,c){if(!z(a)){var d=a.Gb;E.bindTexture(d,a.Qa);b&&E.texParameteri(d,E.TEXTURE_MIN_FILTER,
b);c&&E.texParameteri(d,E.TEXTURE_MAG_FILTER,c);E.bindTexture(d,null)}};a.WK=function(b){if(z(b))return{min:a.Ze,uF:a.Ze};var c=b.Gb;E.bindTexture(c,b.Qa);b=E.getTexParameter(c,E.TEXTURE_MIN_FILTER);var d=E.getTexParameter(c,E.TEXTURE_MAG_FILTER);E.bindTexture(c,null);return{min:b,uF:d}};a.resize=function(b,c,d){c=Math.max(c,S.Ok?2:1);d=Math.max(d,S.Ok?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.nm:E.bindRenderbuffer(E.RENDERBUFFER,b.Fd);E.renderbufferStorage(E.RENDERBUFFER,E.RGB565,c,
d);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.lm:E.bindRenderbuffer(E.RENDERBUFFER,b.Fd);E.renderbufferStorage(E.RENDERBUFFER,E.DEPTH_COMPONENT16,c,d);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.om:E.bindRenderbuffer(E.RENDERBUFFER,b.Fd);E.renderbufferStorageMultisample(E.RENDERBUFFER,S.Cc,E.RGBA8,c,d);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.mm:E.bindRenderbuffer(E.RENDERBUFFER,b.Fd);E.renderbufferStorageMultisample(E.RENDERBUFFER,S.Cc,E.DEPTH_COMPONENT24,c,d);E.bindRenderbuffer(E.RENDERBUFFER,
null);break;default:var f=b.Gb;E.bindTexture(f,b.Qa);var e=k(b),h=r(b),g=u(b);E.texImage2D(f,0,h,c,d,0,e,g,null);E.bindTexture(f,null)}c>S.wb||d>S.wb?T.error('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+S.wb+"x"+S.wb+"."):(b.width=c,b.height=d)}};a.vC=b;a.hy=n;a.gy=g;a.Ul=function(a,b,c,d,f){var h=a.source,g=a.Qa,m=a.Gb,k=1,r=1;E.bindTexture(m,g);if(4==b.length){var n=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==h)if(n)E.texImage2D(m,0,
E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){r=w.lv(b);n=B.vk(r.width)||B.vk(r.height);if(r.width>S.wb||r.height>S.wb){T.error('Texture "'+d+'" has unsupported size: '+r.width+"x"+r.height+". Max available: "+S.wb+"x"+S.wb+".");return}k=r.width;r=r.height;n&&(a.Ne=!0,t(m),k=H(k*a.Df),r=H(r*a.Df));w.GI(E,I.jv(),b,!0);a.Ne&&(l(a,null,k,r,!0),E.bindTexture(m,g),E.generateMipmap(m));a.width=k;a.height=r;a.Op=w.$D(b)}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);a.ml?S.Jl?(k=b[0].width,
r=b[0].height):(k=b.videoWidth,r=b.videoHeight):(k=b.width,r=b.height);a.width=k;a.height=r;if(k>S.wb||k>S.wb)T.warn('Texture "'+d+'" has unsupported size: '+k+"x"+r+". Max available: "+S.wb+"x"+S.wb+". Reduced image size will be used."),a.Df=Math.min(S.wb/k,S.wb/r),a.Ne=!0;a.ml&&(S.Jl?(f in ba||(ba[f]={}),ba[f][a.name]=a,a.jc=b,a.$r=b.length,a.rf=a.Zr*a.mj/b.length,b=b[0]):(f in ba||(ba[f]={}),ba[f][a.name]=a,a.ha=b,a.ha.loop=a.fi,a.rf=b.duration?a.mj/b.duration:O.Yb(),ha.Cu||(b.playbackRate=O.Yb()/
a.rf,ha.cu&&2<b.playbackRate&&(b.playbackRate=2)),e(a)));k=H(a.width*a.Df);r=H(a.height*a.Df);a.Ne?(d=q(),g=d.getContext("2d"),d.width=k,d.height=r,g.drawImage(b,0,0,a.width,a.height,0,0,k,r),E.texImage2D(m,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,d)):B.vk(a.width)||B.vk(a.height)?(l(a,b,k,r,!1),a.Ne=!0):E.texImage2D(m,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,b);g=a.Qa;E.bindTexture(m,g);a.ml||E.generateMipmap(m);E.bindTexture(m,null);a.width=k;a.height=r}else if("ENVIRONMENT_MAP"==h)if(r=[["POSITIVE_X",2,0],["NEGATIVE_X",
0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],n){for(k=0;6>k;k++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+r[k][0]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){T.error('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}k=b.width/3;if(k>S.jg)T.warn('Cubemap texture "'+d+'" has unsupported size: '+
b.width+"x"+b.height+". Max available: "+3*S.jg+"x"+2*S.jg+". Reduced image size will be used."),d=H(S.jg/k*k),a.Ne=!0;else if(d=H(k),3*d>S.wb||2*d>S.wb)a.Ne=!0;if(a.Ne||S.ax)for(g=d,n=0;6>n;n++)c=r[n],f=q(),f.width=g,f.height=g,h=f.getContext("2d"),"POSITIVE_Y"==c[0]||"NEGATIVE_Y"==c[0]?(h.translate(0,g),h.scale(1,-1)):(h.translate(g,0),h.scale(-1,1)),h.drawImage(b,c[1]*k,c[2]*k,k,k,0,0,g,g),E.texImage2D(E["TEXTURE_CUBE_MAP_"+c[0]],0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,f);else{r=b;b=d;t(E.TEXTURE_2D);
E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,r);E.bindTexture(E.TEXTURE_2D,null);for(r=0;6>r;r++)E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,E.RGBA,b,b,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(a.Gb,null);E.bindFramebuffer(E.FRAMEBUFFER,fa);for(r=0;6>r;r++)G.SC(a,E.TEXTURE_CUBE_MAP_POSITIVE_X+r,b,k,oa,r);E.bindFramebuffer(E.FRAMEBUFFER,null);E.bindTexture(a.Gb,a.Qa);E.texParameteri(a.Gb,E.TEXTURE_MIN_FILTER,ea[S.Uj]);E.texParameteri(a.Gb,E.TEXTURE_MAG_FILTER,E.LINEAR)}a.width=3*
d;a.height=2*d;E.generateMipmap(m)}else if("DATA_TEX2D"==h||"NODE_TEX"==h)E.texImage2D(m,0,E.RGBA,b.width,b.height,0,E.RGBA,E.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height;E.bindTexture(m,null)};a.MC=function(a){E.deleteTexture(a)};a.ej=function(a){return a&&a.name&&(a.Qa||a.Fd)?!0:!1};a.cj=z;a.xL=function(b){return b.type==a.fk||b.type==a.gk?!0:!1};a.qE=function(b){var c=0;switch(b.type){case a.Rg:case a.pm:c=4;break;case a.fk:case a.gk:c=16;break;case a.pi:c=3;break;case a.nm:case a.lm:c=
2;break;case a.om:c=4*S.Cc;break;case a.mm:c=3*S.Cc}return c};a.Wu=function(a,c){var d=null;switch(a){case "SSAO_TEXTURE":d={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};b(d,null,c,0);d.image={filepath:null};break;case "NODE_TEX":d={name:void 0,type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},b(d,null,c,0),d.image={filepath:null}}return d};a.cleanup=function(){if(!S.Jl)for(var a in ba)for(var b in ba[a])ba[a][b].ha.pause(),ba[a][b].ha.src=
"",ba[a][b].ha.load();na={};ba={}};a.pause=function(){for(var a in ba)for(var b in ba[a]){var c=ba[a][b];v(c)&&(y(b,a),c.No=!0)}};a.reset=function(){for(var a in ba)for(var b in ba[a])C(b,a),ba[a][b].No=!1};a.play=function(a){for(var b in ba)for(var c in ba[b]){var d=ba[b][c];if(!a||d.No)D(c,b),d.No=!1}};a.Ts=function(a,b){return b in ba&&a in ba[b]?ba[b][a].Ho:!1};a.play_video=D;a.pause_video=y;a.reset_video=C;a.NG=function(a,b,c){c in ba&&a in ba[c]&&(a=ba[c][a],a.ha?a.ha.currentTime=b/a.rf:a.jc&&
(a.Zh=b,g(a)))};a.wy=v;a.xy=function(a){return a.ha||a.jc?a.ha?2<=a.ha.readyState:!0:0};a.ty=function(a){return a.ha||a.jc?a.ha?Math.round(a.ha.currentTime*a.rf):a.Zh:0};a.vy=function(a){return a.ha||a.jc?a.ha?a.bb:f(a,a.bb):0};a.eJ=function(a){if(!a.ha&&!a.jc)return 0;var b=Math.min(a.Ni,a.mj-a.bb);return a.ha?a.bb+b:f(a,a.bb+b)};a.io=function(a,b){return Math.round(O.Yb()/a.rf*a.Zr*b)};a.uy=function(a){return Math.min(a.Ni,a.mj-a.bb)};a.dJ=f;a.YD=function(a,b){var c=m(a,b);return c&&"CANVAS"==c.source?
c.ed:null};a.nI=function(a,b){var d=m(a,b);return d&&"CANVAS"==d.source?(c(d),!0):!1};a.pH=function(a){for(var b={},f=0;f<a.length;f++){for(var e=a[f].U,h=[],g=0;g<e.length;g++){var k=e[g];if("CANVAS"==k.source)if(k.name in b)k=b[k.name];else{var m=e[g],k=d();k.name=m.name;k.source="CANVAS";k.width=m.width;k.height=m.height;k.Rk=m.Rk;k.type=m.type;m=document.createElement("canvas");m.width=k.width;m.height=k.height;k.ed=m.getContext("2d");k.Gb=E.TEXTURE_2D;k.Qa=E.createTexture();E.bindTexture(E.TEXTURE_2D,
k.Qa);k.Rk?E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,ea[S.Uj]):E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR);E.bindTexture(E.TEXTURE_2D,null);m=k;m.ed.drawImage(e[g].ed.canvas,0,0);c(m);b[k.name]=k}h.push(k)}a[f].U=h}};a.VB=function(a,b){for(var c=[],d=0;d<a.length;d++)x(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return B.clamp(255*a,0,255)}))};a.kB=x;a.xC=function(a,b){for(var c=new Float32Array(3),
d=new Float32Array(3),f=[],e=0;e<a.length;e++){for(var h=a[e].data.value,g=[],k=h.curve_mapping.curves_data,m=h.curve_mapping.curve_extend,l=h.curve_mapping.curves_handle_types,h=0;h<k.length;h++){for(var r=m[h],n=k[h],q=[],t=l[h],w=0;w<n.length;w++)q.push([new Float32Array(3),new Float32Array(n[w].concat(0)),new Float32Array(3)]);F.Cp(q[0],null,q[1],t[0],t[0]);for(w=1;w<q.length-1;w++)F.Cp(q[w],q[w-1],q[w+1],t[w],t[w]);F.Cp(q[q.length-1],q[q.length-2],null,t[q.length-1],t[q.length-1]);if(2<q.length){if("AUTO"==
t[0]){R.subtract(q[0][2],q[0][1],c);w=R.length(c);R.copy(q[1][0],d);d[0]<q[0][1][0]&&(d[0]=q[0][1][0]);R.subtract(d,q[0][1],d);var u=R.length(d);1E-8<u&&(R.scale(d,w/u,d),R.add(q[0][1],d,q[0][2]),R.subtract(q[0][1],d,q[0][0]))}n=q.length-1;"AUTO"==t[0]&&(R.subtract(q[n][0],q[n][1],c),w=R.length(c),R.copy(q[n-1][2],d),d[0]>q[n][1][0]&&(d[0]=q[n][1][0]),R.subtract(d,q[n][1],d),u=R.length(d),1E-8<u&&(R.scale(d,w/u,d),R.add(q[n][1],d,q[n][0]),R.subtract(q[n][1],d,q[n][2])))}for(n=0;n<q.length-1;n++)F.PB(q[n][1],
q[n][2],q[n+1][0],q[n+1][1]);n=[];3>=k.length?(w=Math.round(-b/2),t=Math.round(b/2)):(w=0,t=b);for(;w<t;w++){var u=w/(t-1),A=L(q,u,!1),x=P(q,u,!1);A&&x?n.push(F.$A(u,A[1],A[2],x[0],x[1])):x&&!A?"EXTRAPOLATED"==r?n.push(F.Yv(u,x[1],x[2])):n.push(x[1][1]):A&&!x&&("EXTRAPOLATED"==r?n.push(F.Yv(u,A[0],A[1])):n.push(A[1][1]))}g.push(n)}f.push(g)}c=[];for(w=0;w<f.length;w++)for(g=f[w],h=0;h<g[0].length;h++)3>=g.length?(d=B.clamp(127.5*(g[0][h]+1),0,255),e=B.clamp(127.5*(g[1][h]+1),0,255),k=B.clamp(127.5*
(g[2][h]+1),0,255),n=255):(d=B.clamp(255*g[0][h],0,255),e=B.clamp(255*g[1][h],0,255),k=B.clamp(255*g[2][h],0,255),n=B.clamp(255*g[3][h],0,255)),c.push(d,e,k,n);return new Uint8Array(c)}};b4w.module.__assets=function(a,p){function d(){return z.IE()?p(z.Dc.Gm).data:null}function b(){var a={qm:null,lA:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),f=0;f<c;f++)d[f]=b.charCodeAt(f);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.qm=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=d();b&&a.qm in b&&(a.status=200,b[a.qm]&&(a.response=a.lA(b[a.qm])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function c(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=h.CF)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.AT_ARRAYBUFFER:n(f,"arraybuffer");break;case a.AT_JSON:n(f,"json");break;case a.AT_TEXT:n(f,"text");break;case a.AT_AUDIOBUFFER:g(f);break;case a.AT_IMAGE_ELEMENT:q(f);
break;case a.AT_AUDIO_ELEMENT:l(f);break;case a.gm:t(f);break;case a.fm:e(f);break;default:v.Z("Wrong asset type: "+f.type)}}}function n(c,f){var e=d(),h=e&&c.url in e?new b:new XMLHttpRequest,e=null;if("GET"==c.Sc)h.open("GET",c.url,!0);else if("POST"==c.Sc)switch(h.open("POST",c.url,!0),c.sg){case a.So:e="text/plain";break;case a.Ro:e="application/json"}if(c.Bf)for(var g in c.Bf)"Content-Type"==g?e=c.Bf[g]:h.setRequestHeader(g,c.Bf[g]);e&&h.setRequestHeader("Content-Type",e);"text"==f?(h.overrideMimeType("text/plain"),
h.responseType="text"):"json"==f?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=f;h.onreadystatechange=function(){if(40!=c.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==f&&"string"==typeof a)try{a=JSON.parse(a,c.TE)}catch(b){y.error(b+" (parsing JSON "+c.url+")");c.Mb(null,c.id,c.type,c.url,c.gb);return}c.Mb(a,c.id,c.type,c.url,c.gb)}else y.error("empty responce when trying to get "+c.url),c.Mb(null,c.id,c.type,c.url,c.gb)}else y.error(h.status+
" when trying to get "+c.url),c.Mb(null,c.id,c.type,c.url,c.gb);c.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&c.Pw(a.loaded/a.total)},!1);h.send(c.Cf)}function g(a){"GET"!=a.Sc&&v.Z("Unsupported request type for audio buffer");var c=d(),f=c&&a.url in c?new b:new XMLHttpRequest;f.open("GET",a.url,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState)if(200==f.status||0==f.status){var b=f.response;b?C.JC(b,function(b){a.Mb(b,a.id,
a.type,a.url,a.gb);a.state=30},function(){a.Mb(null,a.id,a.type,a.url,a.gb);y.error("failed to decode "+a.url);a.state=30}):(a.Mb(null,a.id,a.type,a.url,a.gb),y.error("empty responce when trying to get "+a.url),a.state=30)}else a.Mb(null,a.id,a.type,a.url,a.gb),y.error(f.status+" when trying to get "+a.url),a.state=30};f.send(a.Cf)}function q(a){"GET"!=a.Sc&&v.Z("Unsupported request type for image element");var b=document.createElement("img");m.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=
a.state&&(a.Mb(b,a.id,a.type,a.url,a.gb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.Mb(null,a.id,a.type,a.url,a.gb),y.error("could not load image: "+a.url),a.state=30)},!1);var c=d();if(c&&a.url in c)if(c[a.url]){var f=k(a.url);b.src="data:"+f+";base64,"+c[a.url]}else D.Wq()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url}function l(a){"GET"!=a.Sc&&v.Z("Unsupported request type for audio element");
var b=document.createElement("audio");if(m.allow_cors||m.lu)b.crossOrigin="Anonymous";b.addEventListener("loadeddata",function(){40!=a.state&&(a.Mb(b,a.id,a.type,a.url,a.gb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Mb(null,a.id,a.type,a.url,a.gb),y.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.Mb(null,a.id,a.type,a.url,a.gb),y.error("could not load sound: "+a.url),a.state=30)},!1);var c=d();if(c&&a.url in
c)if(c[a.url]){var f=r(a.url);b.src="data:"+f+";base64,"+c[a.url];40!=a.state&&(a.Mb(b,a.id,a.type,a.url,a.gb),a.state=30)}else D.Wq()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url,m.gg&&b.load();m.pr&&(b.autoplay=!0,b.pause());setTimeout(function(){b.uH=1},5E3)}function t(a){function b(){40!=a.state&&(a.Mb(null,a.id,a.type,a.url),y.error("could not load video: "+a.url,a.gb),a.state=30)}"GET"!=a.Sc&&v.Z("Unsupported request type for video element");
var c=document.createElement("video");c.muted=!0;if(m.allow_cors||m.gg)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.Mb(c,a.id,a.type,a.url,a.gb),a.state=30)},!1);c.addEventListener("error",b,!1);var f=d();if(f&&a.url in f)if(f[a.url]){var e=u(a.url);c.src="data:"+e+";base64,"+f[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.Mb(c,a.id,a.type,a.url,a.gb);a.state=30},!1)}else D.Wq()?(f=document.createEvent("CustomEvent"),
f.initCustomEvent("error",!1,!1,null)):f=new CustomEvent("error"),c.dispatchEvent(f);else c.src=a.url,m.gg&&c.load();m.pr&&(c.autoplay=!0,c.pause());setTimeout(function(){c.uH=1},1E4)}function e(c){function f(a){c.Mb(a,c.id,c.type,c.url,c.gb);c.state=30}"GET"!=c.Sc&&v.Z("Unsupported request type for seq video element");var e=d(),h=e&&c.url in e?new b:new XMLHttpRequest;if(null==c.sg&&null==c.Cf)h.open("GET",c.url,!0);else switch(h.open("POST",c.url,!0),c.sg){case a.So:h.setRequestHeader("Content-type",
"text/plain");break;case a.Ro:h.setRequestHeader("Content-type","application/json")}h.responseType="arraybuffer";h.onreadystatechange=function(){if(40!=c.state&&4==h.readyState)if(200==h.status||0==h.status){var a=h.response;a?H(a,f):(c.Mb(null,c.id,c.type,c.url,c.gb),y.error("empty responce when trying to get "+c.url),c.state=30)}else c.Mb(null,c.id,c.type,c.url,c.gb),y.error(h.status+" when trying to get "+c.url),c.state=30};h.addEventListener("progress",function(a){a.lengthComputable&&c.Pw(a.loaded/
a.total)},!1);h.send(c.Cf)}function H(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),f=c[3],e={images:[],Mt:[],rf:c[4]},h=20,g=0;g<f;g++){var k=c[h/4],m=new Blob([d.subarray(h+4,h+4+k)],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(m);e.images.push(l);e.Mt.push(m);h+=k+8-k%4}l.onload=function(){for(var a=0;a<e.images.length;a++)window.URL.revokeObjectURL(e.images[a].src);delete e.Mt;b(e)}}function k(a){var b="image";switch(v.Eq(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function r(a){var b="audio";switch(v.Eq(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function u(a){var b="video";switch(v.Eq(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var z=p("__config"),D=p("__compat"),y=p("__print"),C=p("__sfx"),v=p("__util"),f=p("__version"),m=z.p,h=z.Ae;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.gm=70;a.fm=80;a.Ro=a.AT_JSON;a.So=a.AT_TEXT;var x=[],L=0,P={};a.Ol=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.eL=function(a){if(P[a])return P[a];var b=h.Ir?a+f.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return P[a]=b;v.Z("Error XHR: responce is empty, GET "+
a)}else v.Z("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<x.length;a++)x[a].state=40;x=[];L=0;P={}};a.enqueue=function(a,b,e,g,k){for(var m=0;m<a.length;m++){var l=a[m],l={id:l.id,type:l.type,url:l.url,Sc:l.Sc?l.Sc:"GET",sg:l.sg?l.sg:null,Bf:l.Bf?l.Bf:null,Cf:l.Cf?l.Cf:null,gb:l.gb?l.gb:null,state:10,Mb:b||function(){},Cw:e||function(){},Pw:g||function(){},TE:k||null,Dw:L};if(h.Ir){var r=d();r&&l.url in r||(l.url+=f.timestamp())}x.push(l)}c(x);L++};a.update=function(){c(x);
for(var a=x,b=0,d=!0,f=0;f<a.length;f++){var e=a[f];e.Dw===a[b].Dw?30!==e.state&&(d=!1):(d&&(a[f-1].Cw(),d=f-b,a.splice(b,d),f-=d),b=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].Cw(),a.splice(b))}}};b4w.module.__loader=function(a,p){function d(c,d,e,g){var l=v,r=D.create(),n;for(n in d){var q=b(d[n]);(g&&q.vb||!c&&q.Lb)&&k(q);D.v(r,q)}for(n in d)for(q=d[n],q.name=n,c=0;c<q.J.length;c++)D.n(r,d[q.J[c]],q,null);d=b({name:"out",lb:a.Ry,Db:function(a,b,c,d,f){b.Ta&&(l.us=!0);z(b)||(b.status=2);b.aw(b.id,!0);f(b,c);y.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},yb:5});if(e)e=D.el(r);else{n=D.clone(r);do{e=D.el(n);q=[];for(c=0;c<e.length;c++){g=e[c];var t=D.Da(n,g);t.ub&&q.push(g)}for(c=
0;c<q.length;c++)D.Re(n,q[c]);q.length&&D.Ip(n)}while(q.length)}D.v(r,d);for(c=0;c<e.length;c++)g=e[c],t=D.Da(r,g),d.J.push(t.name),D.n(r,t,d,null);return r}function b(a){a.ub=a.ub||!1;a.lb||0===a.lb||(a.lb=a.Hc);a.J=a.J||[];a.Ah=a.Ah||!1;a.ms=a.ms||!1;a.yb=a.yb||0;a.vb=a.vb||!1;a.Lb=a.Lb||!1;a.status=0;a.FL=0;a.gr=0;a.rk=a.rk||null;return a}function c(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var g=b[e];D.Da(a.Ue,g).Ah&&(D.Fg(a.Ue,g,function(d){var e=!0;D.se(a.Ue,d,function(a,b){if(!b.Ah)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function n(a){function b(c,d){var e=D.Da(a.Ue,c),h=D.Da(a.Ue,d),g=h.lb-e.lb;0==g&&(g=e.ub-h.ub);return g}var d=[],e=a.If,g=!1;do{var k=c(a,e);d.push.apply(d,e);0<k.length&&(g=!0);e=k}while(0<k.length);g&&d.sort(b);a.If=d;return a.If.length}function g(a,b,c){if(b.ms)return b.Ah=!0,l(a,b),!1;if(!b.Db&&!b.Wf&&!b.qk)return l(a,b),!1;if(0==b.status&&(b.status++,b.Db))return b.Db(c,a,
b,b.rk,l,t),!0;if(1==b.status){if(b.Wf)return b.Wf(c,a,b,b.rk,l,t),!0;b.status++}return 2==b.status&&(b.status++,b.qk)?(b.qk(c,a,b,b.rk,l,t),!0):!1}function q(a){if(0==a.qo)return 100;var b=0;D.ba(a.Ue,function(c,d){a.do_not_load_resources&&d.vb||(b+=d.gr*d.yb)});return C.trunc(100*b/a.qo)}function l(a,b){b.Ah=!0;b.status=3;e(a,b,1)}function t(a,b,c){1>c?e(a,b,c):b.status++}function e(a,b,c){var d=v;if(b.Db||b.Wf||b.qk)if(b.gr=c,b=q(a),a.tu!=b||1==c)a.ts(b,performance.now()-a.Ux),a.tu=b,d.jr=!0}function H(a,
b){var c=null;D.ba(a.Ue,function(a,d){if(d.name==b)return c=d,1});return c}function k(a){a.ms=!0;a.gr=1}function r(a){a.ts=null;a.Np=null;a.Ue=null;a.If=null}function u(){return 0==v.rm}function z(a){return a&&(3==a.status||4==a.status)}var D=p("__graph"),y=p("__print"),C=p("__util");a.Hc=0;a.Qg=1;a.Ry=2;var v=null;a.kv=function(){return v};a.nC=function(){var a={We:[],Zp:0,rm:0,us:!1,jr:!1};return v=a};a.wC=function(a,b,c,e,g,k,l,r){var n=v,q=n.We.length,t={id:q,Ta:0==q,status:0,qf:b,Kt:"",aw:c||
function(){},$v:r||!1,nM:k,Ux:0,tu:0,qo:0,Qr:!1,ts:e||function(){},Np:g||function(){},Ue:null,If:null,Lq:!1,Jq:!1,Oq:!1};a=d(t.Ta,a,k,l);t.Ue=a;b=[];c=D.nE(a);for(e=0;e<c.length;e++)b.push(c[e]);t.If=b;D.ba(a,function(a,b){!(b.Db||b.Wf||b.qk)||t.do_not_load_resources&&b.vb||(t.qo+=b.yb)});n.We.push(t);n.rm++;return t.id};a.AI=function(b){var c=v;if(c&&!u())if(c.jr)c.jr=!1;else{var d=performance.now();do{var e=c.We[c.Zp],k=b[e.id];if(!z(e))if(0==e.status&&(e.status=1,e.Ux=performance.now(),e.ts(0,
0)),n(e)){var l=e,q=l.If.length;do{var t=D.Da(l.Ue,l.If[0]),p=g(l,t,k);t.lb==a.Qg&&(l.Qr=!0);t=l.If.shift();l.If.push(t);q--}while(!p&&0!=q)}else l=c,q=e,q.Np(k,q),q.status=3,l.rm--,r(q);c.us&&(c.Zp=(c.Zp+1)%c.We.length);if(e.Qr){e.Qr=!1;break}}while(16>performance.now()-d)}};a.ut=function(a){var b=v;a.Np(null,a);a.status=3;b.rm--;r(a);a.status=4;a.Ta&&(b.us=!0);a.aw(a.id,!1)};a.dM=t;a.no=function(a,b){var c=H(a,b);null!==c&&k(c)};a.Ah=u;a.RH=z;a.is_primary_loaded=function(a){var b=v;if(!b)return!1;
a|=0;return b.We[a]&&(3==b.We[a].status||2==b.We[a].status)};a.wE=function(){y.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){v=null}};b4w.module.__logic_nodes=function(a,p){function d(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];if(-2==c.state){for(var e=0;e<c.ho;e++)if(u.get_sensor_value(a,b,e))for(var h=0;h<c.fo.length;h++)if(c.fo[h]==e){f.Kh==c.Sx?(k.is_play(f.S)&&(c.state=-1),d.ae.md||(c.state=1,c.Ll=c.En[h])):(c.state=1,c.Ll=c.En[h]);return}c.state=0}}}function b(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];for(var e=0;e<c.ho;e++)if(u.get_sensor_value(a,b,e)&&e==c.hx){if(k.is_play(f.S)&&f.Kh==c.Sx)c.state=-1;
else if(!d.ae.md||c.V.no_wait)c.state=1;return}c.state=0}}function c(a,b,c){switch(b.state){case 1:H.error("Unknown node type: "+a.type);break;case 2:c.W=a.ja}}function n(a){var b=r.get("url_params");if(b&&a in b)return Number(b[a]);b=location.href.toString();if(-1==b.indexOf("?"))return 0;for(var b=b.split("?")[1].split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(1<d.length&&d[0]==a)return Number(d[1])}return 0}function g(a){return t.Qb(t.hc,a.jq||[],0)}function q(a,b){var d=a.b4w_logic_nodes,
f=b.od;b.state=1;for(var e=0;e<d.length;e++){var h={G:[],ae:{wa:a,W:0,md:!1,Gs:e,F:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};f.push(h);for(var g=f[f.length-1],k=d[e],m=0;m<k.length;m++){var l=k[m],l={type:l.type,label:l.label,ja:l.slot_idx_order,Ll:l.slot_idx_jump,Y:l.frame_range[0],pa:l.frame_range[1],wD:l.frame_range_mask?l.frame_range_mask[0]:!0,uD:l.frame_range_mask?l.frame_range_mask[1]:!0,state:-1,ho:-1,hx:-1,Lo:l.variable1,Mo:l.variable2,Qq:l.input1,yv:l.input2,ji:l.variabled,url:l.url,TF:l.param_name,
RF:l.operation,mute:l.mute,jq:l.object,obj:null,Za:{},Id:l.anim_name,Ew:l.parse_resp_list,ic:l.objects_paths,xr:l.nodes_paths,Ob:l.floats,V:l.bools,ka:l.variables,ro:l.strings,kr:l.materials_names,qx:l.shader_nd_type,jf:l.common_usage_names,Yr:l.send_req_vars_list,Sx:g,Ow:ha[l.type]?ha[l.type]:c,$n:!1,xo:0,yo:0,qb:null,fo:null,jF:l.links,En:[]};g.G.push(l)}for(k=0;k<g.G.length;k++)l=g.G[k],l.Ow(l,b,h.ae,0,0)}var d=a.timeline_markers,r;for(r in d)b.Ml.push(d[r]);b.Ml.sort(function(a,b){return a-b});
b.state=2;O.push(b)}function l(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}var t=p("__objects");p("__obj_util");var e=p("__scenes"),H=p("__print"),k=p("__nla"),r=p("__config"),u=p("__controls"),z=p("__util"),D=p("__animation"),y=p("__assets"),C=p("__batch"),v=p("__geometry"),f=p("__time"),m=p("__camera"),h=p("__vec3");p("__vec4");var x=p("__physics"),L=p("__transform"),P=p("__sfx");p("__constraints");var A=p("__mat3"),w=p("__mat4"),I=p("__tsr"),
T=p("__quat"),O=[],B=new Float32Array(4);new Float32Array(4);var G=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(2),R=new Float32Array(9),S=new Float32Array(16),ha={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.W=a.ja}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=g(a);break;case 2:e.tk(a.obj,!0),c.W=a.ja}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=g(a);break;case 2:e.tk(a.obj,!1),c.W=a.ja}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:c.F[a.ji]=n(a.TF),c.W=a.ja}},
SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.od[c.Gs];var f=t.get_selectable_objects();a.fo=[];a.En=[];for(var e in a.ic){var h=t.Qb(t.hc,a.ic[e],0),g=f.indexOf(h);if(-1==g){H.error("logic script error: non-selectable object:",a.ic[e][a.ic[e].length-1]);break a}a.fo.push(g);a.En.push(a.jF[e])}a.state=-1;a.ho=f.length;e=[];for(g=0;g<f.length;g++)e.push(u.create_selection_sensor(f[g],!0));u.create_sensor_manifold(h,"LOGIC_NODES_SWITCH_SELECT_"+a.label,u.CT_SHOT,e,u.xu,d(),[a,b,c])}break;
case 2:if(-1==a.state){b=b.od[c.Gs].G;for(h=0;h<b.length;h++)f=b[h],"SWITCH_SELECT"==f.type&&(f.state=-1);a.state=-2}-1<a.state&&(c.W=a.state?a.Ll:a.ja,a.state=-1)}},SELECT:function(a,c,d){switch(c.state){case 1:d=c.od[d.Gs];var f=g(a),e=t.get_selectable_objects(),h=e.indexOf(f);if(-1==h)H.error("logic script error: non-selectable object:",a.jq[a.jq.length-1]);else{a.state=-1;a.ho=e.length;a.hx=h;for(var h=[],k=0;k<e.length;k++)h.push(u.create_selection_sensor(e[k],!0));u.create_sensor_manifold(f,
"LOGIC_NODES_SELECT_"+a.label,u.CT_SHOT,h,u.xu,b(),[a,c,d])}break;case 2:if(-1<a.state){d.W=a.state?a.Ll:a.ja;a.state=-1;break}a.V.not_wait&&(d.W=a.ja)}},PLAY:function(a,b,c,d){switch(b.state){case 1:k.vs();a.state=-1;a.V.not_wait||(a.V.not_wait=!1);break;case 2:switch(a.state){case -1:if(k.is_play(b.S))if(b.Xp==b.Kh&&c.md)break;else{var f=b.Kh;if(f){f.ae.W=f.G[f.ae.W].ja;f.G[f.ae.W].state=-1;for(var f=b.Kh.G,e=0;e<f.length;e++){var h=f[e];"PLAY"==h.type&&(h.state=-1)}}}c.md=!a.V.not_wait;b.Kh=b.Xp;
a.state=0;a.wD&&(k.aH(a.Y),k.kx(d));if(a.uD)k.ds(a.pa);else{d=k.get_frame(d);var f=-1,g;for(g in b.Ml)if(d<b.Ml[g]){f=g;break}0<=f?k.ds(b.Ml[f]):k.ds(k.get_frame_end())}k.Iw(null);a.V.not_wait&&(c.W=a.ja,a.state=-1,c.md=!1);break;case 0:k.is_play()||(c.W=a.ja,a.state=-1,c.md=!1);break;case 1:c.W=a.ja;a.state=-1;b.Kh=null;c.md=!1;break;default:z.Z("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b){switch(b.state){case 2:window.location.href=a.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:b=
-1==a.Lo?a.Qq:l(c.F[a.Lo],0);var d=-1==a.Mo?a.yv:l(c.F[a.Mo],0);switch(a.RF){case "ADD":c.F[a.ji]=b+d;break;case "MUL":c.F[a.ji]=b*d;break;case "SUB":c.F[a.ji]=b-d;break;case "DIV":0==d&&z.Z("Division by zero in Logic script");c.F[a.ji]=b/d;break;case "RAND":c.F[a.ji]=Math.random()*(d-b)+b}c.W=a.ja}},CONDJUMP:function(a,b,c){switch(b.state){case 2:b=-1==a.Lo?a.Qq:l(c.F[a.Lo],0);var d=-1==a.Mo?a.yv:l(c.F[a.Mo],0),f=!1;switch(a.Ob.cnd){case 5:b==d&&(f=!0);break;case 4:b!=d&&(f=!0);break;case 3:b<d&&
(f=!0);break;case 2:b>d&&(f=!0);break;case 1:b<=d&&(f=!0);break;case 0:b>=d&&(f=!0)}c.W=f?a.Ll:a.ja}},REGSTORE:function(a,b,c){switch(b.state){case 2:c.F[a.ji]=a.Qq,c.W=a.ja}},PLAY_ANIM:function(a,b,c){var d=D.SLOT_ALL;""==!a.Id&&(d=D.SLOT_0);switch(b.state){case 1:a.obj=g(a);(c=a.jf.param_anim_behavior)||(c="FINISH_STOP");a.yo=D.cp(c);break;case 2:switch(D.is_play(a.obj,d)||0!=a.state||(a.state=1),a.state){case -1:for(var f in b.od){var e=b.od[f].ae.W;-1!=e&&(e=b.od[f].G[e],"PLAY_ANIM"==e.type&&
e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}if(""==a.Id)D.apply_def(a.obj),D.set_behavior(a.obj,a.yo,d);else{a:{for(f=b=0;8>f;f++)if((e=a.obj.M[f])&&e.cf&&e.cf==a.Id)if(0==b)b=1;else{b=!1;break a}b=1==b?!0:!1}b||(D.apply(a.obj,a.Id,d),D.set_behavior(a.obj,a.yo,d))}a.V.not_wait||(c.md=!0);D.play(a.obj,null,d);a.state=0;a.V.not_wait&&(c.W=a.ja,a.state=-1);break;case 0:break;case 1:a.V.not_wait||(c.md=!1);c.W=a.ja;a.state=-1;break;default:z.Z("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:function(a,
b,c){switch(b.state){case 2:c.W=a.ja}},SEND_REQ:function(a,b,c){function d(a,b,c,f,e){if(e[0].V.prs)for(var h in a)for(var g in e[0].Ew)h==e[0].Ew[g]&&(e[1][h]=a[h]);else e[1][e[0].ka.dst]=a;e[0].state=1}function f(a,b){if(""===a)return b;switch(typeof b){case "string":return l(b,1);case "number":return l(b,0);default:return l(b,1)}}function e(a,b){if(""===a)return b;if(Infinity==b||-Infinity==b)return l(b,1);switch(typeof b){case "string":return l(b,1);case "number":return l(b,0);default:return l(b,
1)}}switch(b.state){case 2:switch(a.state){case -1:a.state=0;b=a.V.prs?y.AT_JSON:y.AT_TEXT;var h=a.V.prs?f:null,g={};a.V.ct&&(g["Content-Type"]=a.ro.ct);if("GET"==a.jf.request_type)y.enqueue([{id:a.url,type:b,url:a.url,Bf:g,gb:[a,c.F]}],d,null,null,h);else if("POST"==a.jf.request_type)if(a.V.enc){for(var k={},m=0;m<a.Yr.length;m++){var r=a.Yr[m];switch(typeof c.F[a.Yr[m]]){case "string":k[r]=l(c.F[r],1);break;case "number":k[r]=l(c.F[r],0);break;default:k[r]=l(c.F[r],1)}}y.enqueue([{id:a.url,type:b,
url:a.url,Bf:g,Sc:"POST",sg:y.Ro,Cf:JSON.stringify(k,e),gb:[a,c.F]}],d,null,null,h)}else k=l(c.F[a.ka.dst1],1),y.enqueue([{id:a.url,type:b,url:a.url,Bf:g,Sc:"POST",sg:y.So,Cf:k,gb:[a,c.F]}],d,null,null,h);break;case 1:a.state=-1,c.W=a.ja}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.Za["id"+b]=t.Qb(t.hc,a.ic["id"+b],0);break;case 2:C.inherit_material(a.Za.id0,a.kr.id0,a.Za.id1,a.kr.id1),c.W=a.ja}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.ic.id0&&(a.Za.id0=
t.Qb(t.hc,a.ic.id0,0),a.xr.id0.unshift(a.kr.id0));break;case 2:"ShaderNodeRGB"==a.qx&&t.set_nodemat_rgb(a.Za.id0,a.xr.id0,a.V.id0?l(c.F[a.ka.id0],0):a.Ob.id0,a.V.id1?l(c.F[a.ka.id1],0):a.Ob.id1,a.V.id2?l(c.F[a.ka.id2],0):a.Ob.id2),"ShaderNodeValue"==a.qx&&t.set_nodemat_value(a.Za.id0,a.xr.id0,a.V.id0?l(c.F[a.ka.id0],0):a.Ob.id0),c.W=a.ja}},DELAY:function(a,b,c,d,f){switch(b.state){case 2:-1==a.state?(a.state=0,a.xo=0,c.md=!0):0==a.state&&(a.xo+=f,(a.V.dl?l(c.F[a.ka.dl],0):a.Ob.dl)<a.xo&&(a.state=
-1,c.W=a.ja,c.md=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.Za.id0=t.Qb(t.hc,a.ic.id0,0);c=a.jf.sk;v.check_shape_keys(b)?v.Kq(b,c)||(H.error("Wrong key name:",c),a.mute=!0):(H.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:v.Dt(a.Za.id0,a.jf.sk,a.V.skv?l(c.F[a.ka.skv],0):a.Ob.skv),c.W=a.ja}},OUTLINE:function(a,b,c){switch(b.state){case 1:b=a.Za.id0=t.Qb(t.hc,a.ic.id0,0);b&&b.g&&b.g.Kb||(H.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);
break;case 2:b=a.Za.id0;switch(a.jf.outline_operation){case "PLAY":var d=b.g.sj;t.apply_outline_anim(b,d.tj,d.uj,d.vj);break;case "STOP":t.clear_outline_anim(b);break;case "INTENSITY":b.g.pg=a.V["in"]?l(c.F[a.ka["in"]],0):a.Ob["in"]}c.W=a.ja}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,f){switch(m.get_move_style(a)){case m.MS_TARGET_CONTROLS:m.set_trans_pivot(a,b,c);break;case m.MS_EYE_CONTROLS:case m.MS_STATIC:L.set_tsr(a,f);break;case m.MS_HOVER_CONTROLS:h.sub(c,b,G),h.normalize(G,G),m.set_hover_pivot(a,
c),c=b=0,M[0]=G[0],M[1]=0,M[2]=G[2],b=h.dot(M,G),c=Math.acos(b/(h.length(M)*h.length(G))),b=G[2]?Math.atan(G[0]/G[2]):0<G[0]?0:Math.PI,0<G[2]&&0<G[0]?F[1]=-(Math.PI+F[1]):0<G[2]&&0>G[0]?F[1]=-(Math.PI+F[1]):0>G[2]&&0>G[0]?(F[0]+=Math.PI,b=-(Math.PI-b)):0>G[2]&&0<G[0]&&(F[0]+=Math.PI,b-=Math.PI),m.rotate_hover_camera(a,b+Math.PI,-c,!0,!0)}L.m(a);x.sync_transform(a)}function e(a,b,c,d){w.lookAt(b,c,z.AXIS_Y,S);w.invert(S,S);w.rotateX(S,Math.PI/2,S);A.fromMat4(S,R);T.fromMat3(R,B);T.normalize(B,B);a=
I.get_scale(a.g.i);I.set_sep(b,a,B,d)}switch(b.state){case 1:a.Za.ca=t.Qb(t.hc,a.ic.id0,0);a.Za.tr=t.Qb(t.hc,a.ic.id1,0);a.Za.ta=t.Qb(t.hc,a.ic.id2,0);a.state=-1;a.qb={Xx:new Float32Array(3),Wx:new Float32Array(3),Uq:new Float32Array(3),Ds:new Float32Array(3),Rx:new Float32Array(3),Tq:new Float32Array(3),Hg:new Float32Array(8),Xe:new Float32Array(8),il:new Float32Array(8)};break;case 2:var g=a.Za.ca;b=I.get_trans_view(a.Za.tr.g.i);var k=I.get_trans_view(a.Za.ta.g.i);switch(a.state){case -1:var r=
a.V.dur?l(c.F[a.ka.dur],0):a.Ob.dur;if(0==r){e(g,b,k,a.qb.Xe);d(g,b,k,a.qb.Xe);c.W=a.ja;break}c=I.get_trans_view(g.g.i);h.copy(c,a.qb.Xx);var n=m.get_move_style(g);n==m.MS_HOVER_CONTROLS?h.copy(g.g.fb,a.qb.Ds):n==m.MS_STATIC||n==m.MS_EYE_CONTROLS?(I.copy(g.g.i,a.qb.Hg),e(g,b,k,a.qb.Xe)):h.copy(g.g.pivot,a.qb.Ds);h.copy(b,a.qb.Wx);h.copy(k,a.qb.Rx);a.state=0;r=f.animate(0,1,1E3*r,function(b){n==m.MS_STATIC||n==m.MS_EYE_CONTROLS?I.interpolate(a.qb.Hg,a.qb.Xe,z.smooth_step(b),a.qb.il):(a.qb.Tq=h.lerp(a.qb.Ds,
a.qb.Rx,z.smooth_step(b),a.qb.Tq),a.qb.Uq=h.lerp(a.qb.Xx,a.qb.Wx,z.smooth_step(b),a.qb.Uq));d(g,a.qb.Uq,a.qb.Tq,a.qb.il);1==b&&(a.state=1)});break;case 1:f.clear_animation(r),a.state=-1,c.W=a.ja}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:a.yo=m.JF(a.jf.camera_move_style);break;case 2:b=e.Qi(c.wa),L.m(b),x.sync_transform(b),c.W=a.ja}},MOVE_TO:function(a,b,c){function d(a,b){L.set_tsr(a,b);L.m(a);x.sync_transform(a)}switch(b.state){case 1:a.Za.ob=t.Qb(t.hc,a.ic.id0,0);a.Za.de=t.Qb(t.hc,
a.ic.id1,0);a.state=-1;a.kb={Bu:new Float32Array(8),eq:new Float32Array(8),zv:new Float32Array(8)};break;case 2:var e=a.Za.ob;I.copy(a.Za.ob.g.i,a.kb.Bu);I.copy(a.Za.de.g.i,a.kb.eq);switch(a.state){case -1:b=a.V.dur?l(c.F[a.ka.dur],0):a.Ob.dur;if(0==b){d(e,a.kb.eq);c.W=a.ja;break}a.state=0;var h=f.animate(0,1,1E3*b,function(b){a.kb.sL=I.interpolate(a.kb.Bu,a.kb.eq,z.smooth_step(b),a.kb.zv);d(e,a.kb.zv);1==b&&(a.state=1)});break;case 1:f.clear_animation(h),a.state=-1,c.W=a.ja}}},TRANSFORM_OBJECT:function(a,
b,c){function d(a,b,c){0==c?L.set_tsr(a,b):L.set_tsr_rel(a,b);L.m(a);x.sync_transform(a)}switch(b.state){case 1:a.Za.ob=t.Qb(t.hc,a.ic.id0,0);a.state=-1;a.kb={po:0,Hg:new Float32Array(8),Xe:new Float32Array(8),il:new Float32Array(8)};break;case 2:var e=a.Za.ob;switch(a.state){case -1:M[0]=a.V.trx?l(c.F[a.ka.trx],0):a.Ob.trx;M[1]=a.V["try"]?l(c.F[a.ka["try"]],0):a.Ob["try"];M[2]=a.V.trz?l(c.F[a.ka.trz],0):a.Ob.trz;G[0]=a.V.rox?l(c.F[a.ka.rox],0):a.Ob.rox;G[1]=a.V.roy?l(c.F[a.ka.roy],0):a.Ob.roy;G[2]=
a.V.roz?l(c.F[a.ka.roz],0):a.Ob.roz;b=a.V.sc?c.F[a.ka.sc]:a.Ob.sc;if(a.V["try"]||a.V.trz)F[1]=-M[1],M[1]=M[2],M[2]=F[1];if(a.V.roy||a.V.roz)F[1]=-G[1],G[1]=G[2],G[2]=F[1];z.euler_to_quat(G,B);I.set_sep(M,b,B,a.kb.Xe);a.kb.po=a.jf.space_type;switch(a.kb.po){case 0:L.get_tsr(e,a.kb.Hg);break;case 1:L.get_tsr_rel(e,a.kb.Hg);break;case 2:L.get_tsr_rel(e,a.kb.Hg),I.multiply(a.kb.Hg,a.kb.Xe,a.kb.Xe)}b=a.V.dur?l(c.F[a.ka.dur],0):a.Ob.dur;if(0==b){d(e,a.kb.Xe,a.kb.po);c.W=a.ja;break}a.state=0;var h=f.animate(0,
1,1E3*b,function(b){I.interpolate(a.kb.Hg,a.kb.Xe,z.smooth_step(b),a.kb.il);d(e,a.kb.il,a.kb.po);1==b&&(a.state=1)});break;case 1:f.clear_animation(h),a.state=-1,c.W=a.ja}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=t.Qb(t.hc,a.ic.id0,0);void 0==a.V.not_wait&&(a.V.not_wait=!0);break;case 2:switch(P.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.od){var f=b.od[d].ae.W;-1!=f&&(f=b.od[d].G[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.obj==a.obj&&(f.state=
1))}a.V.not_wait||(c.md=!0);P.play_def(a.obj);a.state=0;break;case 0:a.V.not_wait&&(c.W=a.ja,a.state=-1);break;case 1:a.V.not_wait||(c.md=!1);c.W=a.ja;a.state=-1;break;default:z.Z("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=t.Qb(t.hc,a.ic.id0,0);break;case 2:P.stop(a.obj),c.W=a.ja}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=g(a);break;case 2:D.stop(a.obj,D.SLOT_ALL),a.V.rst&&D.set_first_frame(a.obj,D.SLOT_ALL),c.W=a.ja}},STOP_TIMELINE:function(a,
b,c,d){switch(b.state){case 2:a.V.rst&&k.kx(d),k.vs(),c.W=a.ja}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:b={};for(var d in a.ka){var f=a.ka[d];b[f]=c.F[f]}H.log(a.jf.msg,JSON.stringify(b));c.W=a.ja}},STRING:function(a,b,c){switch(b.state){case 2:b=a.V.id0?l(c.F[a.ka.id0],1):a.ro.id0;var d=a.V.id1?l(c.F[a.ka.id1],1):a.ro.id1;switch(a.Ob.sop){case 0:c.F[a.ka.dst]=b+d;break;case 1:c.F[a.ka.dst]=b.indexOf(d);break;case 2:c.F[a.ka.dst]=b.replace(d,a.V.id2?l(c.F[a.ka.id2],1):a.ro.id2);break;
case 3:c.F[a.ka.dst]=b.substring(0,b.indexOf(d));c.F[a.ka.dst1]=b.substring(b.indexOf(d)+1,b.length);""==c.F[a.ka.dst]&&(c.F[a.ka.dst]=c.F[a.ka.dst1],c.F[a.ka.dst1]="");break;case 4:switch(a.Ob.cnd){case 5:c.F[a.ka.dst]=b==d?1:0;break;case 4:c.F[a.ka.dst]=b!=d?1:0;break;case 3:c.F[a.ka.dst]=b<d?1:0;break;case 2:c.F[a.ka.dst]=b>d?1:0;break;case 1:c.F[a.ka.dst]=b<=d?1:0;break;case 0:c.F[a.ka.dst]=b>=d?1:0}}c.W=a.ja}}};a.DE=function(a,b){var c={Jc:b,BG:a.name,state:0,Kh:null,wa:a,Xp:null,od:[],Ml:[]};
a.UJ=c;q(a,c)};a.update=function(a,b){var c=k.pE();if(!(0>=c))for(var d=0;d<O.length;d++)for(var f=d,e=a,h=b,g=c,m=O[f],l=0;l<O[f].od.length;l++){m.Xp=O[f].od[l];var r=O[f].od[l],n=m,q=e,t=h,u=g,x=r.G;if(x.length){for(var w=0;w<x.length;w++)x[w].$n=!1;for(w=0;w<x.length;w++){if(0<=r.ae.W)var p=x[r.ae.W];else break;if(p.$n)break;if(p.mute)if("ENTRYPOINT"==p.type)break;else r.ae.W=p.ja,p.$n=!0;else p.Ow(p,n,r.ae,q,t,u),p.$n=!0}}}};a.cleanup=function(){O=[]}};b4w.module.__nla=function(a,p){function d(){return{type:"CLIP",Y:0,pa:0,Ef:!1,paused:!1,Id:"",jk:"",qc:0,Rf:0,Ug:0,Iu:0,Hu:0,ky:!1,scale:1,repeat:1,wt:0}}function b(a,c){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var f=0;f<d.length;f++)c.push(d[f])}d=a.nodes;for(f=0;f<d.length;f++){var e=d[f];e.node_group&&(e=e.node_group.node_tree)&&b(e,c)}}function c(a,b){var c=Math.round(a)-b.Y;b.fi&&(c%=b.Ni,0>c&&(c+=b.Ni));return b.bb+c}function n(a,b){var c=(b-m)*C.Yb()+a.bb;c>a.Y?(c-=a.Y,
a.cyclic&&(c%=a.pa-a.Y+1),c+=a.Y):c=a.Y;return c}function g(a,b){a=v.clamp(a,b.Y,b.pa);var c=a==b.pa?b.wt:b.Rf+(a-b.Y)%((b.Ug-b.Rf)*b.scale)/b.scale;b.ky&&(c=b.Ug-c+b.Rf);return c}function q(a,b){for(var c=[],f=0;f<a.length;f++){var e=a[f].strips;if(e)for(var g=0;g<e.length;g++){var k=e[g],m=d();m.type=k.type;m.Y=k.frame_start;m.pa=k.frame_end;m.qc=b;m.Rf=k.action_frame_start;m.Ug=k.action_frame_end;m.ky=k.use_reverse;m.scale=k.scale;m.repeat=k.repeat;k.action&&(m.Id=k.action.name,m.jk=k.action.uuid);
c.push(m)}}return c}function l(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function t(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function e(a,b){var c=z.get_active();c.S&&(c.S.bb-=n(c.S,
b)-a,c.S.Li=!0)}var H=p("__animation");p("__camera");p("__controls");p("__config");p("__lights");p("__loader");var k=p("__objects"),r=p("__obj_util"),u=p("__print"),z=p("__scenes"),D=p("__sfx"),y=p("__textures"),C=p("__time"),v=p("__util"),f=[],m=-1;a.Ig=function(a,c){var f;f=null;for(var e=c.B.length-1;0<=e;e--){var g=c.B[e];if(g.wa.b4w_use_nla&&(f=g,g.wa.st))break}if(f){f.vw=!0;var k=0;if((e=a.animation_data)&&e.nla_tracks.length){var m=e.nla_tracks;if(r.is_armature(c)||r.is_camera(c)||r.is_mesh(c)||
r.is_empty(c)||r.is_lamp(c)||r.is_speaker(c)||r.is_world(c))m=q(m,k),m.length&&(c.Vd=c.Vd.concat(m),k++)}l(a)&&(m=a.data.animation_data.nla_tracks,m=q(m,k),m.length&&(c.Vd=c.Vd.concat(m),k++));if(r.is_mesh(c))for(g=a.data.materials,e=0;e<g.length;e++){var n=g[e];if(n.use_nodes&&n.node_tree&&(m=[],b(n.node_tree,m),m=q(m,k),m.length)){for(var n=k,t=m,u=H.RD(),p=[],z=0,F=0;F<t.length;F++){var y=t[F];""!=y.jk?y=v.keysearch("uuid",y.jk,u):(y=y.Id,y=v.keysearch("name",y,u)||v.keysearch("name",y+"_B4W_BAKED",
u));if(y){var y=y.fcurves,D=[],C;for(C in y)D.push(C);p.push(D)}}for(F=0;F<p.length;F++){u=!1;for(y=0;y<F;y++)if(v.QA(p[F],p[y])){t[F].qc=t[y].qc;u=!0;break}u||(t[F].qc=k+z++)}k=n+z;c.Vd=c.Vd.concat(m)}}if(!r.is_world(c)){for(e=0;e<a.particle_systems.length;e++)g=a.particle_systems[e],C=g.settings,"EMITTER"==C.type&&C.b4w_allow_nla&&(C=d(),C.type="CLIP",C.Y=f.wa.frame_start,C.pa=f.wa.frame_end+1,C.Id=g.name,C.qc=k,C.Rf=C.Y,C.Ug=C.pa,c.Vd.push(C),k++);g=k+1;for(e=0;e<c.mc.length;e++)m=c.mc[e],m.nA&&
(k=g,C=d(),C.type="CLIP",C.Y=f.wa.frame_start,C.pa=f.wa.frame_end+1,C.Id=m.name,C.qc=k,C.Rf=C.Y,C.Ug=C.pa,c.Vd.push(C))}}};a.zI=function(a,b,c){a.S||(a.S={Y:a.frame_start,pa:a.frame_end,bb:0,nl:-1,Al:a.frame_end,Bl:a.frame_start,Zj:null,cyclic:b,Za:[],U:[],BG:a.name,hg:!1,Li:!1,Rr:!0});b=a.S;for(var e=k.mE(a,c),g=0;g<e.length;g++){var m=e[g];if(m.Vd.length){for(var l=0;l<m.B.length;l++){var r=m.B[l];r.wa==a&&r.vw&&b.Za.push(m)}for(var l=m.Vd,r=b,n=m.name,q=0;q<l.length;q++){var t=l[q];r.Y>t.pa||r.pa<
t.Y?(u.warn("NLA: Strip is out of scene range: "+(n+" ["+t.Y+":"+t.pa+"]")),l.splice(q,1),q--):t.Id||"CLIP"!=t.type||(u.warn('NLA: no action in strip for object "'+n+'".'),l.splice(q,1),q--)}m=m.Vd;l=b;for(r=0;r<m.length;r++){for(var n=m[r],q=l.Y,t=l.pa+1,p=0;p<m.length;p++){var F=m[p];n.qc==F.qc&&(F.pa<=n.Y&&(q=n.Y),F.Y>=n.pa&&(t=Math.min(t,F.Y)))}n.Iu=q;n.Hu=t;n.wt=0===n.repeat%1?n.Ug:n.Rf+n.repeat%1*(n.Ug-n.Rf)}}}a=a.k.ak;for(g=0;g<a.length;g++)e=a[g].k,e.Ho&&(e.ha||e.jc)&&e.Kf==c&&(m=d(),m.type=
"VIDEO",e.fi?(m.Y=0,m.pa=b.pa):(m.Y=v.clamp(e.Y,0,b.pa),m.pa=v.clamp(e.Y+e.Ni,0,b.pa)),m.Id=a[g].name,b.U.push(e));f.push(b)};a.start=function(){m=0};a.pE=function(){return m};a.bL=function(a){return a.S?a.S.bb:null};a.TL=function(a,b){return a.S?(a.S.bb=b,!0):!1};a.update=function(a,b){if(!(0>m)){0==m&&(m=a);for(var d=0;d<f.length;d++){var k=f[d];k.hg&&(k.bb-=C.Yb()*b);var l=n(k,a);if((!k.hg||k.Li)&&l>=k.Al)if(k.cyclic){var l=k,r=a;l.Zj&&l.Zj();e(l.Bl,r);l.Rr=!0;l=n(l,r)}else{var r=k,q=l;r.hg=!0;
r.bb-=q-r.Al;r.Zj&&r.Zj()}if(!k.hg||k.Li){for(var r=k,q=l,t=0;t<r.Za.length;t++){for(var u=r.Za[t],p=u.Vd,z=0;z<p.length;z++){var M=p[z];"SOUND"==M.type&&q<r.nl-1E-6&&(M.Ef=!1)}for(z=0;z<p.length;z++)switch(M=p[z],M.type){case "CLIP":if(M.Iu<=q&&q<M.Hu&&!M.Ef){var F=u,R=M;""!=R.jk?H.KA(F,R.jk,R.qc):H.apply(F,R.Id,R.qc);H.set_behavior(F,H.AB_FINISH_STOP,R.qc);var S=g(R.Y,R);H.set_frame(F,S,R.qc);for(F=0;F<p.length;F++)p[F]!=M&&p[F].qc==M.qc&&(p[F].Ef=!1);M.Ef=!0}M.Ef&&(F=u,R=g(q,M),1E-6<Math.abs(R-
H.bv(F,M.qc))&&H.set_frame(F,R,M.qc));break;case "SOUND":(q<r.nl-1E-6||r.nl<M.Y)&&M.Y<=q&&q<M.pa&&!M.Ef&&(D.play(u,(M.Y-q)/C.Yb(),(M.pa-M.Y)/C.Yb()),M.Ef=!0),r.nl<M.pa&&M.pa<=q&&M.Ef&&(M.Ef=!1)}}r=a;q=k;t=l;for(u=0;u<q.U.length;u++)if(p=q.U[u],p.ha||p.jc){z=y.ty(p);M=p;F=v.clamp(c(t,M),M.bb,M.bb+y.uy(M)-1);M.jc&&(F=y.dJ(M,F),F==M.$r&&F--);M=F;F=y.vy(p);S=R=!1;if(q.Li||q.Rr)S=!0;if(!q.hg){var ha;ha=c(t,p);ha=p.bb<=ha&&ha<=p.bb+y.uy(p);var N=y.wy(p);p.fi&&M==F&&(S=!0);N||z==M||(S=!0);ha&&!N?y.play_video(p.name,
p.Kf):ha&&N?R=!0:!ha&&N&&(p.ha&&z<M?R=!0:y.pause_video(p.name,p.Kf))}S?(y.NG(p.name,M,p.Kf),p.jc&&(p.Bj=y.io(p,r))):R&&y.xy(p)&&(p.ha?y.hy(p):(z=y.io(p,r),z!=p.Bj&&(p.Zh=M,y.gy(p)),p.Bj=z))}k.nl=l}k.Li=!1;k.Rr=!1}}};a.cleanup=function(){f.length=0;m=-1};a.Ot=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||l(a)||t(a)?!0:!1};a.set_frame=e;a.get_frame=function(a){var b=z.get_active();return b.S?n(b.S,a):-1};a.vs=function(){var a=z.get_active();a.S&&(a.S.hg=!0);for(var a=a.S.U,b=0;b<
a.length;b++){var c=a[b];y.pause_video(c.name,c.Kf)}};a.Iw=function(a){var b=z.get_active();b.S&&(b.S.hg=!1,b.S.Zj=a?a:null)};a.get_frame_start=function(){var a=z.get_active();return a.S?a.S.Y:-1};a.get_frame_end=function(){var a=z.get_active();return a.S?a.S.pa:-1};a.is_play=function(){var a=z.get_active();return a.S?!a.S.hg:!1};a.check_nla=function(){var a=z.get_active();return a.S?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=z.get_active();return a.S?0<a.b4w_logic_nodes.length:!1};a.set_range=
function(a,b){var c=z.get_active();if(c.S)c.S.Bl=a,c.S.Al=b;else return!1};a.ds=function(a){var b=z.get_active();b.S&&(b.S.Al=a)};a.aH=function(a){var b=z.get_active();b.S&&(b.S.Bl=a)};a.reset_range=function(){var a=z.get_active();if(a.S)a=a.S,a.Bl=a.Y,a.Al=a.pa;else return!1};a.set_cyclic=function(a){var b=z.get_active();if(b.S)b.S.cyclic=a;else return!1};a.clear_callback=function(){var a=z.get_active();a.S&&(a.S.Zj=null)};a.kx=function(a){var b=z.get_active().S;b&&(b.bb=-(a-m)*C.Yb()+b.Bl,b.Li=
!0)};a.get_frame_end=function(){var a=z.get_active().S;return a?a.pa:null}};b4w.module.__camera=function(a,p){function d(a,b,c,d,f){ma.set_translation(a,b);c&&y(a,b,c);m(a,d);h(a,f)}function b(a,b,c,d,f,e,g,k){var l=a.g;ma.set_translation(a,b);l.pivot.set(c);y(a,b,c);m(a,d);h(a,f);A(a,e);w(a,g);l.use_panning=k}function c(a,b,c,d,f,e,g,h){var k=a.g;ma.set_translation(a,b);k.fb.set(c);y(a,b,c);P(a,d);x(a,f);I(a,e);T(a,g);k.Sk=h}function n(a,b,c){var d=a.g,f=ga.get_trans_view(d.i),e=ga.get_quat_view(d.i),d=Ba;d.set(Z.AXIS_Y);d[3]=0;a=H(a,ca)[1];e=Z.quat_to_dir(e,Z.AXIS_MY,da);
if(!Z.line_plane_intersect(d,-b,f,e,c)||Math.abs(a)<ua)W.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=f[0],c[1]=0,c[2]=f[2];return c}function g(b){b=b.g;if(b.N[0].type==a.Hd)switch(b.Ua){case a.MS_TARGET_CONTROLS:var c=ga.get_trans_view(b.i);b.aj=Y.dist(c,b.pivot);b.bj=b.N[0].top;break;case a.MS_HOVER_CONTROLS:c=ga.get_trans_view(b.i),b.aj=Y.dist(c,b.fb),b.bj=b.N[0].top}}function q(){return{left:new Float32Array([0,
0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),Va:new Float32Array([0,0,0,0]),Eb:new Float32Array([0,0,0,0])}}function l(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:throw"Unknown move style";}}function t(b){var c={type:b,name:"",$L:1,width:0,height:0,je:null,vq:null,Ib:null,Ld:null,Xa:0,rb:0,Va:0,Eb:0,left:0,right:0,
top:0,bottom:0,Lc:Fa.create(),i:new Float32Array(9),Wa:new Float32Array(16),mb:new Float32Array(16),ve:new Float32Array(16),yy:new Float32Array(16),gG:new Float32Array(16),Se:new Float32Array(16),we:ga.Sm(),Ww:ga.Sm(),gs:ga.Sm(),dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,jd:null,dof_on:!1,bw:new Float32Array(3),Zk:q(),Pj:0,$d:0,$b:null,Fk:null,Vp:null,qu:new Float32Array(4),Vn:new Float32Array(4)};c.Lc[0]=c.Lc[2]=45;c.Lc[1]=c.Lc[3]=55;if(b==a.Ub)return c;switch(b){case a.pc:r(c,40,.1,1E3);
break;case a.Hd:r(c,2.5,.1,1E3);break;case a.$e:break;case a.Qf:break;case a.Sg:break;case a.Ab:case a.Hb:case a.nc:case a.oc:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return c}function e(b,c,d){if(b.type!=a.Ab&&b.type!=a.Hb&&b.type!=a.nc&&b.type!=a.oc)throw"set_stereo_params(): wrong camera type";if(b.type==a.Ab||b.type==a.Hb)b.Pj=c;b.$d=d;ha(b,b.Xa);if(sa.la()&&(c=sa.get_active(),b=c.k.kc))for(c=sa.Qi(c).g.N,d=0;d<c.length;d++)ba(c[d],b)}function H(a,
b){var c=ga.get_quat_view(a.g.i);return k(c,b)}function k(a,b){var c=Z.quat_to_dir(a,Z.AXIS_Y,da),d=Z.quat_to_dir(a,Z.AXIS_Z,K),f=-Math.asin(c[1]/Y.length(c)),c=Math.abs(f)>Math.PI/4?Y.scale(d,-Z.sign(f),va):Y.scale(c,-Z.sign(d[1]),va),e=Math.atan(Math.abs(c[0]/c[2]));0<d[1]&&(f=Z.sign(f)*Math.PI-f);d=e;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=f;return b}function r(b,c,d,f,e){switch(b.type){case a.pc:case a.Ab:case a.Hb:b.rb=c;b.Xa=1;break;case a.Hd:b.top=c;b.Xa=1;break;case a.$e:delete b.rb;
b.rb=c;b.Xa=e/c;break;case a.Qf:b.top=c;b.Xa=e/c;break;case a.nc:case a.oc:break;default:W.error("set_frustum(): Unsupported camera type: "+b.type)}b.Va=d;b.Eb=f}function u(b,c){var d=ga.get_trans_view(c.g.i),f=ga.get_quat_view(c.g.i),d=J.fromRotationTranslation(f,d,pa);J.rotateX(d,-Math.PI/2,d);J.invert(d,b.Wa);if(sa.la())var e=sa.get_active(),e=sa.X(e,"STEREO");if(b.type==a.Ab||e&&e.enable_hmd_stereo&&b.type==a.nc)b.Wa[12]+=b.$d/2;else if(b.type==a.Hb||e&&e.enable_hmd_stereo&&b.type==a.oc)b.Wa[12]-=
b.$d/2;if(b.$b){ga.from_mat4(b.Wa,b.Ww);var e=b.$b[0],d=b.$b[1],f=b.$b[2],g=b.$b[3],h=pa;h[0]=1-2*e*e;h[1]=-2*e*d;h[2]=-2*e*f;h[3]=0;h[4]=-2*e*d;h[5]=1-2*d*d;h[6]=-2*d*f;h[7]=0;h[8]=-2*e*f;h[9]=-2*d*f;h[10]=1-2*f*f;h[11]=0;h[12]=-2*e*g;h[13]=-2*d*g;h[14]=-2*f*g;h[15]=1;J.multiply(b.Wa,h,b.Wa);ha(b,b.Xa,!0);e=Ba;d=pa;J.invert(b.Wa,d);J.transpose(d,d);Fa.transformMat4(b.$b,d,e);d=aa;d[0]=(Z.sign(e[0])+b.mb[8])/b.mb[0];d[1]=(Z.sign(e[1])+b.mb[9])/b.mb[5];d[2]=-1;d[3]=(1+b.mb[10])/b.mb[14];Fa.scale(e,
2/(e[0]*d[0]+e[1]*d[1]+e[2]*d[2]+e[3]*d[3]),e);b.mb[2]=e[0];b.mb[6]=e[1];b.mb[10]=e[2]+1;b.mb[14]=e[3]}ga.from_mat4(b.Wa,b.we);oa(b);N(b);ga.copy(c.g.i,b.i)}function z(b,c,d,f){J.lookAt(c,d,f,b.Wa);d=sa.get_active();d=sa.X(d,"STEREO");sa.la()&&(d=sa.get_active(),d=sa.X(d,"STEREO"));if(b.type==a.Ab||d&&d.enable_hmd_stereo&&b.type==a.nc)b.Wa[12]+=b.$d/2;else if(b.type==a.Hb||d&&d.enable_hmd_stereo&&b.type==a.oc)b.Wa[12]-=b.$d/2;ga.from_mat4(b.Wa,b.we);oa(b);N(b);ga.set_trans(c,b.i)}function D(a,b,c){c=
Y.subtract(c,b,da);Y.length(c)&&(Y.normalize(c,c),c=Z.ex(Z.AXIS_MY,c,U),ma.set_rotation(a,c));ma.set_translation(a,b)}function y(a,b,c){var d=a.g,e=f(a);D(a,b,c);e?(b=Y.copy(d.ue,da),Y.negate(b,b),ia.correct_up(a,b,!0)):ia.correct_up(a,d.ue,!0)}function C(a){var b=a.g,c=b.N;if(!c)throw"Wrong object";for(var d=b.fs,f=0;f<d.length;f++){var e=d[f];Y.copy(ga.get_trans_view(b.i),e.bw)}for(f=0;f<c.length;f++)if(e=c[f],u(e,a),Z.cn(e.ve,e.Zk),e.jd&&e.dof_on){var d=ga.get_trans_view(b.i),g=ma.get_translation(e.jd,
da),d=Y.dist(d,g);e.dof_distance=d}}function v(b){var c=b.g;c.Ua==a.MS_TARGET_CONTROLS&&(c.vo=f(b))}function f(a){a=ga.get_quat_view(a.g.i);return 0<Z.quat_to_dir(a,Z.AXIS_Z,da)[1]}function m(b,c){var d=b.g;if(c){d.Ha=d.Ha||{};d.Ha.left=c.left;d.Ha.right=c.right;d.Ha.gj=c.left;d.Ha.zj=c.right;d.Ha.camera_space=Boolean(c.camera_space);var f=b.g;!(d=f.Ha)||f.Ua!=a.MS_EYE_CONTROLS&&f.Ua!=a.MS_TARGET_CONTROLS||(f=H(b,ca),d.camera_space?(d.left+=f[0],d.right+=f[0]):(d.gj-=f[0],d.zj-=f[0]),d.left=Z.angle_wrap_0_2pi(d.left),
d.right=Z.angle_wrap_0_2pi(d.right),d.gj=Z.angle_wrap_0_2pi(d.gj),d.zj=Z.angle_wrap_0_2pi(d.zj))}else d.Ha=null}function h(a,b){var c=a.g;b?(c.ea=c.ea||{},c.ea.down=b.down,c.ea.up=b.up,c.ea.Fi=b.down,c.ea.Xj=b.up,c.ea.camera_space=Boolean(b.camera_space),L(a)):c.ea=null}function x(a,b){var c=a.g;if(!b){var d=H(a,ca);b={down:d[1],up:d[1]}}c.ea=c.ea||{};c.ea.down=b.down;c.ea.up=b.up;L(a);c.Ma&&c.ea&&S(a)}function L(b){var c=b.g,d=c.ea;if(d)switch(c.Ua){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=
H(b,ca);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.Xj-=b[1],d.Fi-=b[1]);d.up=Z.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=Z.angle_wrap_periodic(d.down,-Math.PI,Math.PI);d.Xj=Z.angle_wrap_periodic(d.Xj,-Math.PI,Math.PI);d.Fi=Z.angle_wrap_periodic(d.Fi,-Math.PI,Math.PI);break;case a.MS_HOVER_CONTROLS:d.up=Z.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=Z.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=Z.clamp(d.up,-Math.PI/2,0),d.down=Z.clamp(d.down,-Math.PI/2,0)}}function P(a,b){var c=
a.g;if(!b){var d=ma.qj(a,c.fb);b={min:d,max:d}}c.Ma=c.Ma||{};c.Ma.min=b.min;c.Ma.max=b.max;c.Ma&&c.ea&&S(a)}function A(a,b){var c=a.g;b?(c.Ma=c.Ma||{},c.Ma.min=b.min,c.Ma.max=b.max):c.Ma=null}function w(a,b){var c=a.g;b?(c.Xd=c.Xd||{},c.Xd.min_y=b.min_y,c.Xd.max_y=b.max_y):c.Xd=null}function I(a,b){var c=a.g;b?(c.ec=c.ec||{},c.ec.min=b.min,c.ec.max=b.max):c.ec=null}function T(a,b){var c=a.g;b?(c.fc=c.fc||{},c.fc.min=b.min,c.fc.max=b.max):c.fc=null}function O(b){var c=b.g;if(V.is_camera(b)){var d=
c.N;if(d[0].type===a.Hd){switch(c.Ua){case a.MS_TARGET_CONTROLS:var f=ga.get_trans_view(c.i),f=Y.dist(f,c.pivot),c=f/c.aj*c.bj;break;case a.MS_HOVER_CONTROLS:f=ga.get_trans_view(c.i);f=Y.distance(f,c.fb);c=f/c.aj*c.bj;break;default:c=d[0].top}for(f=0;f<d.length;f++){var e=d[f];e.top=c;ha(e,e.Xa)}C(b)}}}function B(b){var c=b.g,d=c.Ua;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.Ha){var f=c.Ha.left,e=c.Ha.right,g=H(b,ca);(g=d==a.MS_TARGET_CONTROLS?Z.fh(g[0],f,e):Z.fh(g[0],e,f))&&(d==a.MS_TARGET_CONTROLS?
M(b,g,0):G(b,g,0))}c.ea&&(f=c.ea.down,e=c.ea.up,g=H(b,ca),(g=d==a.MS_TARGET_CONTROLS?Z.fh(g[1],e,f):Z.fh(g[1],f,e))&&(d==a.MS_TARGET_CONTROLS?M(b,0,g):G(b,0,g)));if(d===a.MS_TARGET_CONTROLS&&c.Ma){var g=b.g,f=ga.get_trans_view(g.i),e=Y.subtract(f,g.pivot,da),h=Y.length(e);h>g.Ma.max?(Y.scale(e,g.Ma.max/h,e),Y.add(g.pivot,e,f)):h<g.Ma.min&&(h=ga.get_quat_view(g.i),h=Z.quat_to_dir(h,Z.AXIS_MY,K),Y.scale(h,100*g.Ma.min,h),Y.add(e,h,e),Y.scale(e,-g.Ma.min/Y.length(e),e),Y.add(g.pivot,e,f))}}d===a.MS_TARGET_CONTROLS&&
c.Xd&&(c=b.g,g=c.pivot[1],f=Z.clamp(c.pivot[1],c.Xd.min_y,c.Xd.max_y),f!=g&&(g=Y.set(0,f-g,0,da),Y.add(c.pivot,g,c.pivot),c=ga.get_trans_view(c.i),Y.add(c,g,c)));d===a.MS_HOVER_CONTROLS&&(d=b.g,d.ec&&(g=Z.clamp(d.fb[0],d.ec.min,d.ec.max)-d.fb[0],d.fb[0]+=g,c=ga.get_trans_view(d.i),c[0]+=g),d.fc&&(g=Z.clamp(d.fb[2],d.fc.min,d.fc.max)-d.fb[2],d.fb[2]+=g,c=ga.get_trans_view(d.i),c[2]+=g),d=b.g,c=H(b,ca)[1],(d=Z.fh(c,d.ea.up,d.ea.down))&&F(b,0,d))}function G(a,b,c,d,f){var e=a.g,g=b,h=c;if(d||f)a=H(a,
ja),d&&(g=b-a[0]),f&&(h=c-a[1]);if(g||h)b=Q.identity(U),g&&(g=Q.setAxisAngle(e.ue,g,xa),Q.multiply(b,g,b)),e=ga.get_quat_view(e.i),h&&(g=Z.quat_to_dir(e,Z.AXIS_X,da),h=Q.setAxisAngle(g,h,xa),Q.normalize(h,h),Q.multiply(b,h,b)),Q.multiply(b,e,e)}function M(a,b,c,d,f){var e=a.g,g=b,h=c;if(d||f){var k=H(a,ja);d&&(g=b-k[0]);f&&(h=c-k[1])}R(a,a.g.pivot,g,h);a=H(a,ja);a=Z.angle_wrap_periodic(a[1],-Math.PI,Math.PI);e.vo=Math.abs(a)>Math.PI/2}function F(a,b,c,d,f){var e=a.g,g=b,h=c;if(d||f){var k=H(a,ja);
d&&(g=b-k[0]);f&&(h=c-k[1])}e.Sk||(g=0);R(a,e.fb,g,h);h&&S(a)}function R(a,b,c,d){var f=a.g;if(c||d){var e=Q.identity(U);c&&(c=Q.setAxisAngle(Z.AXIS_Y,c,xa),Q.multiply(e,c,e));na(a);a=ga.get_quat_view(f.i);d&&(c=Z.quat_to_dir(a,Z.AXIS_X,da),d=Q.setAxisAngle(c,d,xa),Q.normalize(d,d),Q.multiply(e,d,e));f=ga.get_trans_view(f.i);Z.xG(f,b,e,f);Q.multiply(e,a,a)}}function S(a){var b=a.g,c=H(a,ca)[1],d=a.g;a=d.ea;d=d.Ma;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;
a=ga.get_trans_view(b.i);d=ga.get_quat_view(b.i);d=Z.quat_to_dir(d,Z.AXIS_MY,da);Y.normalize(d,d);Y.scale(d,c,d);Y.subtract(b.fb,d,a)}function ha(b,c,d){switch(b.type){case a.pc:if(!c)throw"No aspect ratio";b.Xa=c;case a.$e:J.perspective(Z.vd(b.rb),b.Xa,b.Va,b.Eb,b.mb);break;case a.Hd:if(!c)throw"No aspect ratio";b.Xa=c;case a.Qf:c=b.top*b.Xa;J.ortho(-c,c,-b.top,b.top,b.Va,b.Eb,b.mb);break;case a.Sg:J.ortho(b.left,b.right,b.bottom,b.top,b.Va,b.Eb,b.mb);break;case a.Ab:case a.Hb:if(!c)throw"No aspect ratio";
b.Xa=c;var f=Math.tan(b.rb*Math.PI/360);c=b.Va*f;var e=b.Xa*b.Pj*f;b.type==a.Ab?(f=e-b.$d/2,e+=b.$d/2):(f=e+b.$d/2,e-=b.$d/2);f=-(b.Va/b.Pj*f);e*=b.Va/b.Pj;J.frustum(f,e,-c,c,b.Va,b.Eb,b.mb);b.left=f;b.right=e;break;case a.nc:case a.oc:sa.la()&&(f=sa.get_active(),(f=sa.X(f,"STEREO"))&&f.enable_hmd_stereo?(c=Math.tan(Z.vd(b.Lc[1])/2),f=Math.tan(Z.vd(b.Lc[2])/2),e=Math.tan(Z.vd(b.Lc[3])/2),b.top=b.Va*Math.tan(Z.vd(b.Lc[0])/2),b.right=b.Va*c,b.bottom=-b.Va*f,b.left=-b.Va*e,J.frustum(b.left,b.right,b.bottom,
b.top,b.Va,b.Eb,b.mb)):(c||(c=b.Xa),J.perspective(Z.vd(b.rb),c,b.Va,b.Eb,b.mb)));break;case a.Ub:return;default:throw"Wrong camera type: "+b.type;}d||(oa(b),N(b))}function N(a){J.copy(a.Wa,a.Se);a.Se[12]=0;a.Se[13]=0;a.Se[14]=0;a.Se[15]=1;J.multiply(a.mb,a.Se,a.Se);J.invert(a.Se,a.Se)}function oa(a){J.copy(a.Wa,a.ve);J.multiply(a.mb,a.ve,a.ve);J.invert(a.ve,a.yy)}function fa(b,c,d,f,e){f||(f=new Float32Array(24));c||(c=b.Va);d||(d=b.Eb);var g,h,k,m,l,r,n,q;switch(b.type){case a.Ub:throw"Extraction from NONE camera is not possible";
case a.pc:case a.$e:g=c*Math.tan(b.rb*Math.PI/360);m=-g;h=g*b.Xa;k=-h;l=d/c*g;q=-l;r=l*b.Xa;n=-r;break;case a.Hd:case a.Qf:k=b.top*b.Xa;g=l=b.top;h=r=k;m=q=-b.top;k=n=-k;break;case a.Sg:g=l=b.top;h=r=b.right;m=q=b.bottom;k=n=b.left;break;case a.Ab:case a.Hb:l=c/b.Va;g=c*Math.tan(b.rb*Math.PI/360);m=-g;h=b.right*l;k=b.left*l;n=d/c;l=g*n;q=-l;r=h*n;n*=k;break;case a.nc:case a.oc:l=c/b.Va;g=b.top*l;m=b.bottom*l;h=b.right*l;k=b.left*l;n=d/c;l=g*n;q=m*n;r=h*n;n*=k;break;default:throw"Wrong camera type: "+
b.type;}f[0]=k;f[1]=m;f[2]=-c;f[3]=h;f[4]=m;f[5]=-c;f[6]=h;f[7]=g;f[8]=-c;f[9]=k;f[10]=g;f[11]=-c;f[12]=n;f[13]=q;f[14]=-d;f[15]=n;f[16]=l;f[17]=-d;f[18]=r;f[19]=l;f[20]=-d;f[21]=r;f[22]=q;f[23]=-d;e&&(c=pa,J.invert(b.Wa,c),Z.yj(f,c,f,0));return f}function na(b){return V.is_camera(b)&&b.g&&b.g.Ua==a.MS_HOVER_CONTROLS}function ba(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Fk){var d=b.csm_num;a.Fk=Array(d);for(var f=0;f<d;f++)a.Fk[f]=new Float32Array(3);a.Vp=new Float32Array(d)}for(d=0;d<c;d++){var f=
0==d?a.Va:E(b,a,d-1),e=E(b,a,d),f=fa(a,f,e,Ja),f=la.gE(f);a.Fk[d].set(f.K);a.Vp[d]=f.Pa;a.qu[d]=Y.length(f.K);a.Vn[d]=ea(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Vn[0]=b.first_cascade_blur_radius}function E(a,b,c){var d=a.csm_num,f=Z.clamp(a.csm_first_cascade_border,b.Va,b.Eb);a=Z.clamp(a.csm_last_cascade_border,b.Va,b.Eb);return Z.clamp(ea(f,a,d,c),b.Va,b.Eb)}function ea(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}
function qa(a,b){b||(b=new Float32Array(3));var c=ga.get_trans_view(a.g.i);Y.copy(c,b);return b}var la=p("__boundings");p("__config");var ia=p("__constraints"),ya=p("__container");p("__mat3");var J=p("__mat4"),V=p("__obj_util"),W=p("__print"),Q=p("__quat"),sa=p("__scenes"),ma=p("__transform"),ga=p("__tsr"),Z=p("__util"),Y=p("__vec3"),Fa=p("__vec4");p("__physics");a.Ub=10;a.pc=20;a.Hd=30;a.$e=40;a.Qf=50;a.Sg=60;a.Ab=70;a.Hb=80;a.nc=90;a.oc=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=
3;a.MS_HOVER_CONTROLS=4;var ua=Math.PI/180/2,ca=new Float32Array(2),ja=new Float32Array(2),da=new Float32Array(3),K=new Float32Array(3),va=new Float32Array(3),U=new Float32Array(4),xa=new Float32Array(4),Ba=new Float32Array(4),aa=new Float32Array(4),pa=new Float32Array(16),Ja=new Float32Array(24);a.oB=function(f,e){var h=e.g,k=f.data;switch(k.type){case "PERSP":var m=t(a.pc);if(k.angle_y)var q=k.angle_y/Math.PI*180;r(m,q,k.clip_start,k.clip_end);break;case "ORTHO":m=t(a.Hd),r(m,k.ortho_scale/2,k.clip_start,
k.clip_end)}m.name=e.name;h.ZH=!1;h.Ua=l(k.b4w_move_style);h.dof_distance=k.dof_distance;q=k.dof_object;h.jd=q?q.oa:null;h.dof_front=k.b4w_dof_front;h.dof_rear=k.b4w_dof_rear;h.dof_power=k.b4w_dof_power;h.N=[m];h.fs=[];h.bm=k.b4w_trans_velocity;h.am=k.b4w_rot_velocity;h.cm=k.b4w_zoom_velocity;var m=e.g.Ua,q=f.data,u=null;m!=a.MS_TARGET_CONTROLS&&m!=a.MS_EYE_CONTROLS||!q.b4w_use_horizontal_clamping||(u={left:q.b4w_rotation_left_limit,right:q.b4w_rotation_right_limit,camera_space:"LOCAL"==q.b4w_horizontal_clamping_type},
m==a.MS_EYE_CONTROLS&&(u.left*=-1,u.right*=-1));var m=u,q=e.g.Ua,u=f.data,U=null;q!=a.MS_TARGET_CONTROLS&&q!=a.MS_EYE_CONTROLS||!u.b4w_use_vertical_clamping?q==a.MS_HOVER_CONTROLS&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=u.b4w_hover_angle_max?(U={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},U.down*=-1,U.up*=-1):W.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(U={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,camera_space:"LOCAL"==u.b4w_vertical_clamping_type},
q==a.MS_TARGET_CONTROLS&&(U.down*=-1,U.up*=-1));var q=U,u=e.g.Ua,U=f.data,aa=null;u==a.MS_TARGET_CONTROLS&&U.b4w_use_target_distance_limits&&U.b4w_distance_min<=U.b4w_distance_max?aa={min:U.b4w_distance_min,max:U.b4w_distance_max}:u===a.MS_HOVER_CONTROLS&&U.b4w_use_zooming&&(U.b4w_distance_min<=U.b4w_distance_max?aa={min:U.b4w_distance_min,max:U.b4w_distance_max}:W.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=aa;U=f.data;aa=null;e.g.Ua==a.MS_HOVER_CONTROLS&&U.b4w_use_horizontal_clamping&&
U.b4w_horizontal_translation_min<=U.b4w_horizontal_translation_max&&(aa={min:U.b4w_horizontal_translation_min,max:U.b4w_horizontal_translation_max});var U=aa,p=f.data,aa=null;e.g.Ua==a.MS_HOVER_CONTROLS&&p.b4w_use_vertical_clamping&&p.b4w_vertical_translation_min<=p.b4w_vertical_translation_max&&(aa={min:p.b4w_vertical_translation_min,max:p.b4w_vertical_translation_max},p=-aa.min,aa.min=-aa.max,aa.max=p);var p=f.data,w=null;e.g.Ua==a.MS_TARGET_CONTROLS&&p.b4w_use_pivot_limits&&(w={min_y:p.b4w_pivot_z_min,
max_y:p.b4w_pivot_z_max});p=w;switch(h.Ua){case a.MS_EYE_CONTROLS:h=ga.get_trans_view(e.g.i);d(e,h,null,m,q);break;case a.MS_TARGET_CONTROLS:h=ga.get_trans_view(e.g.i);b(e,h,k.b4w_target,m,q,u,p,k.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:h=ga.get_trans_view(e.g.i),m=n(e,f.data.b4w_hover_zero_level,K),c(e,h,m,u,q,U,aa,k.b4w_enable_hover_hor_rotation)}B(e);g(e)};a.jH=d;a.lH=b;a.kH=c;a.gl=g;a.$B=q;a.JF=l;a.Nb=t;a.kK=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.Ib);case "DEPTH":return Boolean(a.Ld);
case "SCREEN":return!Boolean(a.Ib)&&!Boolean(a.Ld);default:throw"Wrong attachment type: "+b;}};a.jo=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.Ib=c;break;case "DEPTH":a.Ld=c;break;case "SCREEN":a.Ib=null;a.Ld=null;break;default:throw"Wrong attachment type: "+b;}};a.UK=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.Ib;case "DEPTH":return a.Ld;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.Gn=function(b,c){if(b.type!=a.pc||c!=a.Ab&&c!=a.Hb&&c!=a.nc&&
c!=a.oc)throw"make_stereo(): wrong camera type";b.type=c;e(b,6,.065)};a.lx=e;a.get_camera_angles=H;a.$u=k;a.get_camera_angles_char=function(a,b){H(a,b);b[0]=Z.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.ko=r;a.PG=function(b,c,d,f,e,g,h){switch(b.type){case a.Sg:b.left=c;b.right=d;b.bottom=f;b.top=e;b.Va=g;b.Eb=h;break;default:W.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.g.Ua};a.fH=u;a.VL=z;a.es=function(a,b,c){var d=da;d[0]=
0;d[1]=-1;d[2]=0;Y.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var f=K;f[0]=0;f[1]=0;f[2]=-1;Y.transformQuat(f,c,f);z(a,b,d,f)};a.set_look_at=D;a.XG=y;a.lI=C;a.kI=function(b){var c=b.g;B(b);O(b);switch(c.Ua){case a.MS_TARGET_CONTROLS:var d=ga.get_trans_view(c.i),f=ga.get_quat_view(c.i);ia.yG(d,f,c.pivot);for(var f=c.N,g=0;g<f.length;g++){var h=f[g];h.type!=a.Ab&&h.type!=a.Hb||e(h,Y.dist(d,c.pivot),h.$d)}ia.correct_up(b,c.ue);break;case a.MS_EYE_CONTROLS:b.ib||ia.correct_up(b,c.ue)}v(b)};
a.Ns=v;a.ix=m;a.nx=h;a.hover_set_vertical_limits=x;a.hover_set_distance_limits=P;a.IG=A;a.$G=w;a.RG=I;a.eH=T;a.xI=O;a.rotate_eye_camera=G;a.rotate_target_camera=M;a.rotate_hover_camera=F;a.yL=function(b){switch(b.type){case a.pc:case a.Hd:case a.Ab:case a.Hb:return!0;default:return!1}};a.Xu=function(b){b=b.g.N[0];switch(b.type){case a.pc:case a.$e:case a.Ab:case a.Hb:return Math.PI*b.rb/180;default:return W.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Ff=ha;a.Im=N;a.Bp=
oa;a.gD=fa;a.SA=function(a){a=a.g;var b=la.$c();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.bc=b;var c=la.Rm(1,[0,0,0]);a.dd=c;a.mp=la.mu(1,b);a.op=la.ou(1,b);a.np=la.nu(1,b)};a.is_static_camera=function(b){return V.is_camera(b)&&b.g&&b.g.Ua==a.MS_STATIC};a.is_target_camera=function(b){return V.is_camera(b)&&b.g&&b.g.Ua==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return V.is_camera(b)&&b.g&&b.g.Ua==a.MS_EYE_CONTROLS};a.is_hover_camera=na;a.is_ortho_camera=function(b){return V.is_camera(b)&&
b.g&&b.g.N[0].type==a.Hd};a.Ms=ba;a.BC=E;a.project_point=function(b,c,d){b=b.g.N[0];switch(b.type){case a.pc:case a.$e:case a.Hd:case a.Qf:case a.Ab:case a.Hb:case a.nc:case a.oc:var f=Ba;f.set(c);f[3]=1;Fa.transformMat4(f,b.ve,f);c=-f[1]/f[3];d[0]=(f[0]/f[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;ya.gJ(d[0],d[1],d,b);2<d.length&&(d[2]=(f[2]/Math.abs(f[3])+1)/2);return d;default:return W.error("Non-compatible camera"),d}};a.eE=function(a){return a.g.N[0]};a.Ri=function(b,c){switch(b.type){case a.pc:case a.$e:case a.Ab:case a.Hb:var d=
Math.tan(Z.vd(b.rb)/2);switch(c){case "LEFT":return-d*b.Xa;case "RIGHT":return d*b.Xa;case "TOP":return d;case "BOTTOM":return-d}break;case a.Hd:case a.Qf:switch(c){case "LEFT":return-b.top*b.Xa;case "RIGHT":return b.top*b.Xa;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.Sg:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.nc:case a.oc:switch(c){case "LEFT":return Math.tan(Z.vd(b.Lc[3])/2);case "RIGHT":return Math.tan(Z.vd(b.Lc[1])/
2);case "TOP":return Math.tan(Z.vd(b.Lc[0])/2);case "BOTTOM":return Math.tan(Z.vd(b.Lc[2])/2)}break;default:Z.Z("Unknown camera type")}};a.QE=function(b){switch(b.type){case a.Hd:case a.Qf:case a.Sg:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.pc:case a.$e:case a.Ab:case a.Hb:var d=Z.vd(b.rb);return c?d*b.Xa:d;default:return 0}};a.set_trans_pivot=function(a,b,c){a=a.g;ga.set_trans(b,a.i);Y.copy(c,a.pivot)};a.set_hover_pivot=function(a,b){var c=a.g,d=Y.subtract(b,c.fb,
da),f=ga.get_trans_view(c.i),d=Y.add(d,f,d);ma.set_translation(a,d);Y.copy(b,c.fb)};a.bH=function(a,b){var c=a.g,d=Y.subtract(b,c.pivot,da),f=ga.get_trans_view(c.i),d=Y.add(d,f,d);ma.set_translation(a,d);Y.copy(b,c.pivot)};a.get_eye=qa;a.set_move_style=function(b,d){b.g.Ua=d;b.g.Ha=null;b.g.ea=null;b.g.Ma=null;b.g.ec=null;b.g.fc=null;g(b);switch(d){case a.MS_HOVER_CONTROLS:var f=ga.get_trans_view(b.g.i),e=n(b,0,K);c(b,f,e,null,null,null,null,b.g.Sk);break;case a.MS_TARGET_CONTROLS:f=qa(b,da),e=ga.get_quat_view(b.g.i),
e=Z.quat_to_dir(e,Z.AXIS_MY,K),e=Y.scaleAndAdd(f,e,10,e),Y.copy(e,b.g.pivot)}};a.Qo=function(a){a=a.g;a.Ua=0;Y.set(0,0,0,a.pivot);Y.set(0,0,0,a.fb);a.vo=!1;a.use_panning=!1;a.Ha=null;a.ea=null;a.Ma=null;a.ec=null;a.fc=null;a.Xd=null;a.Sk=!0}};b4w.module.__lights=function(a,p){function d(a){n.scale(a.color,a.Md,a.Bk)}p("__print");var b=p("__tsr"),c=p("__util"),n=p("__vec3"),g=new Float32Array(3);new Float32Array(3);a.VE=function(a,l){var t=a.data,e=l.Oa={name:"",type:t.type,Kw:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Bk:new Float32Array(3),yu:0,ci:0,Pl:0,Vu:!1,kw:!1,Fu:!1,Yj:!0,hi:!0,Md:1,distance:25,IK:"INVERSE_SQUARE"};e.name=l.name;e.Yj=t.use_diffuse;e.hi=t.use_specular;var p=b.get_quat_view(l.g.i),
p=c.quat_to_dir(p,c.AXIS_Y,g);n.normalize(p,p);e.direction.set(p);e.color[0]=t.color[0];e.color[1]=t.color[1];e.color[2]=t.color[2];e.Md=e.yu=t.energy;d(e);e.distance=t.distance;if("POINT"===e.type||"SPOT"===e.type)e.distance=t.distance;"SPOT"===e.type?(e.Pl=t.spot_blend,e.ci=t.spot_size):"POINT"===e.type&&(e.ci=Math.PI/2);e.Vu=t.b4w_generate_shadows;e.Fu=t.b4w_dynamic_intensity};a.jx=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];d(a)};a.UG=function(a,b){a.Pl=b};a.TG=function(a,b){a.distance=
b};a.VG=function(a,b){a.ci=b};a.cs=function(a,b){a.Md=b;d(a)};a.sI=function(a){if("LAMP"!=a.type)throw"Wrong light object";var d=a.Oa;if(d){a=b.get_quat_view(a.g.i);c.quat_to_dir(a,c.AXIS_Y,d.direction);n.normalize(d.direction,d.direction);if("SUN"==d.type){a=Math.acos(n.dot(d.Kw,c.pt));var g=Math.acos(n.dot(d.direction,c.pt));d.kw=Math.floor(a/.025)!=Math.floor(g/.025)?!0:!1}n.copy(d.direction,d.Kw)}}};b4w.module.__scenes=function(a,p){function d(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.ye||!c.ye.length)return c}return null}function b(){if(!yb)throw"No active scene available";return yb}function c(a,b,c){if(!za.Kk||!n(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>za.wb?(d.csm_resolution=za.wb,Za.error("Shadow map texture has unsupported size. Changed to "+za.wb+".")):d.csm_resolution=c.csm_resolution;a=wa.jn(b,za.Xc&&a.b4w_enable_ssao);d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;
d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.le=[];d.Bx=[];d.Du=[];for(b=0;b<a.length;b++)d.le.push(a[b].Oa.type),d.Bx.push(a[b].Oa.ci),d.Du.push(a[b].Oa.distance),"SPOT"!=d.le[b]&&"POINT"!=d.le[b]||!d.enable_csm||(Za.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,
d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function n(a,b,
c){if(0!=b.length&&za.Cj)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,f=!1;a=za.Xc&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var e=c[b];e.b4w_shadow_cast&&(d=!0);e.b4w_shadow_receive&&(f=!0);if((a||d)&&f)return!0}return!1}function g(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Oa.type)return!0;return!1}function q(a){if(!za.shore_smoothing)return!1;a=ya(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}
function l(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(wa.$t(a[b],c[d].settings))return!0;return!1}function t(a){for(var b=ya(a),c=[],d=0;d<b.length;d++){var f=b[d];if(f.b4w_water){for(var e={},g=0;g<a.length;g++)for(var h=a[g],k=h.data.materials,m=0;m<k.length;m++)k[m]==f&&(e.Og=h.location[1]);e.Ac=f.b4w_water_fog_color.slice(0);e.Ac.push(f.b4w_water_fog_density);f.b4w_water_dynamic?(e.Nk=!0,e.waves_height=f.b4w_waves_height,e.waves_length=f.b4w_waves_length,
e.dst_noise_scale0=f.b4w_water_dst_noise_scale0,e.dst_noise_scale1=f.b4w_water_dst_noise_scale1,e.dst_noise_freq0=f.b4w_water_dst_noise_freq0,e.dst_noise_freq1=f.b4w_water_dst_noise_freq1,e.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,e.dir_freq=f.b4w_water_dir_freq,e.dir_noise_scale=f.b4w_water_dir_noise_scale,e.dir_noise_freq=f.b4w_water_dir_noise_freq,e.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,e.dst_min_fac=f.b4w_water_dst_min_fac,e.waves_hor_fac=f.b4w_water_waves_hor_fac):(e.Nk=!1,e.waves_height=
0,e.waves_length=0);e.gf=f.b4w_water_enable_caust;e.qB=f.b4w_water_caust_scale;e.pB=f.b4w_water_caust_brightness;e.rB=new Float32Array([.3,.7]);e.Ag=null;f=f.texture_slots;for(g=0;g<f.length;g++)h=f[g].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(e.Ag=h.image,e.ks=h.image.size[0],e.lr=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,e.Ej=[(h[0]+h[1])/2,(h[2]+h[3])/2],e.Fj=[h[0]-h[1],h[2]-h[3]]);c.push(e)}}if(0<c.length){e=c[0];if(!e.Nk)for(d=0;d<c.length;d++)c[d].Nk&&(e=c[d]);return e}return null}
function e(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var f=a[d];"GROUP"==f.type&&f.node_group&&b(f.node_group.node_tree);"GROUP"==f.type&&"B4W_REFRACTION"==f.node_tree_name&&(c.Fc=!0)}}}var c={Fc:!1};a=ya(a);for(var d=0;d<a.length;d++){var f=a[d];f.b4w_refractive&&(c.Fc=!0);f.node_tree&&b(f.node_tree)}return c}function H(a,b){if(za.El)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;for(var c=[],d=0,f=0;f<b.length;f++){var e=b[f];e.g.Rc&&"CUBE"==e.g.Qe&&d++;if(e.Fl.length){for(var g=
null,h=0;h<c.length;h++)if(c[h]==e){g=h;break}null==g&&c.push(e)}}return{Yw:c,sw:d,Yf:[],Pe:[]}}function k(a,b){var c=a.b4w_sky_settings,d={};d.pG=c.render_sky;d.procedural_skydome=c.procedural_skydome&&b;d.use_as_environment_lighting=c.use_as_environment_lighting;d.Gj=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=
c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.Ec=c.reflexible;d.wc=c.reflexible_only;!b&&c.procedural_skydome&&Za.warn("There is no sun on the scene. Procedural sky won't be rendered");return d}function r(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.BE=a.hemisphere;b.eB=a.blur_depth;b.Nt=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.AG=a.samples;return b}function u(a){if(!(za.Em&&
a.b4w_enable_bloom&&a.k.di))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.VC=a.edge_lum;b.key=a.key;return b}function z(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function D(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function y(a){var b={};a=a.b4w_god_rays_settings;b.Sq=a.intensity;b.ij=
a.max_ray_length;b.Oj=a.steps_per_pass;return b}function C(a){var b={};b.Af=a.b4w_outline_color;b.rl=a.b4w_outline_factor;return b}function v(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function f(a,b){var c=a.light_settings,d={};d.pf=c.environment_energy;d.Ps=c.use_environment_light;d.kq=c.environment_color;
d.Td=a.horizon_color.slice(0);d.ce=a.zenith_color.slice(0);d.XI=a.use_sky_paper;d.WI=a.use_sky_blend;d.YI=a.use_sky_real;d.vx=null;d.ns=null;d.lq=null;if(d.Ps&&"SKY_TEXTURE"==d.kq&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var c=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting){c=a.texture_slots[f];break}c?d.lq=c:(Za.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),
d.Ps=!1)}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=a.texture_slots[f];d.vx=c;d.ns={bB:c.blend_factor,CE:c.horizon_factor,pJ:c.zenith_up_factor,oJ:c.zenith_down_factor,color:c.color,Ra:c.default_value,invert:c.invert,VI:c.use_rgb_to_intensity,cB:c.blend_type,QI:c.use_map_blend,RI:c.use_map_horizon,TI:c.use_map_zenith_up,SI:c.use_map_zenith_down};break}return d}function m(a){var b=a.fog_settings,c={};c.LI=b.use_fog;c.Sq=b.intensity;c.depth=b.depth;c.start=
b.start;c.height=b.height;c.jD=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Ac=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.Pd=new Float32Array([c.Sq,c.depth,c.start,c.height]);return c}function h(a){if(!za.cc)return!1;for(var b=!1,c=!1,d=0;d<a.length;d++){for(var f=a[d],e=f.data.materials,g=0;g<e.length;g++)e[g].b4w_terrain&&(b=!0);f=f.particle_systems;for(g=0;g<f.length;g++)e=f[g].settings,"HAIR"==e.type&&e.b4w_dynamic_grass&&(c=!0);if(b&&c)return!0}return!1}
function x(a,b){if(Uc.outlining_overview_mode)return!0;if(za.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].oa.g.xg)return!0;return!1}else return!1}function L(a,b){if(Uc.outlining_overview_mode)return!0;if(za.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].oa.g.Kb)return!0;return!1}else return!1}function P(a,b){if(za.tf)switch(a.b4w_enable_glow_materials){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,f=0;f<d.length;f++)if(Ca.Zt(d[f]))return!0;return!1}else return!1}function A(a,b){if(za.Fc)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.Fc}else return!1}function w(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var f=c[d],e=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e)return!0}return!1}function I(a,
b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].oa;if(d.anchor&&d.anchor.Bi)return!0}return!1}}function T(a,b,c){var d=pa.Oe(a,b);pa.se(a,d,function(a,b,d){if(d.Bb){switch(d.from){case "COLOR":case "CUBEMAP":a=b.j.Ib;break;case "DEPTH":a=b.j.Ld;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:if(!a)throw"Connection of SCREEN is forbidden";if(a.Fd)throw"Batch texture can't use renderbuffer";ta.bu(c.gc,d.to)&&da.ui(c,a,d.to)}}});for(a=0;a<b.na.length;a++){var d=b.na[a],f=b.Ve[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:if(f.Fd)throw"Batch texture can't use renderbuffer";ta.bu(c.gc,d.to)&&da.ui(c,f,d.to)}}}function O(a,b){return{Jb:!0,hq:[!0,!0,!0,!0,!0,!0],ne:a,I:b}}function B(a,b,c,
d,f,e){function g(a,b){return a==b?0:a>b?1:-1}for(var h=b.g,k=wa.Sa(b,f).T,m=0;m<k.length;m++){var l=k[m];l.Uc||l.wc||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type&&"LINE"!=l.type||!("OPAQUE"==l.hb&&"OPAQUE"==d||"BLEND"==l.hb&&"BLEND"==d||"XRAY"==l.hb&&"XRAY"==d||"NODES_GLOW"==l.type&&"GLOW"==d)||(e||(G(l,a,b,c,d,f),da.Sb(l),M(l)),a.s.push(O(h,l)),T(c,a,l),F(l))}a.s.sort(function(a,b){return a.I&&b.I?-g(a.I.Ja,b.I.Ja)||-g(a.I.Wg,b.I.Wg)||g(a.I.Mh,b.I.Mh):0})}function G(a,b,c,d,f,e){var g=
c.g,h=e.k,k=wa.Sa(c,e),m="NO_SHADOWS";c=V(e,["SHADOW_CAST"]);if(c.length&&a.Vc){switch(f){case "OPAQUE":m="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":m="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":m="NO_SHADOWS";break;case "SHADOW":m="SHADOW_MASK_GENERATION";break;default:throw"Wrong subscene type";}for(var l=0;l<c.length;l++)da.Et(a,e.k.kc)}c=a.zb;ta.L(c,"SHADOW_USAGE",m);a.cc&&(l=ra.Fb(d,"GRASS_MAP"))&&R(a,l,g);if("SHADOW"!=a.type&&"COLOR_ID"!=f||a.$i){l=b.Nn;
ta.L(c,"NUM_LIGHTS",l);ta.L(c,"NUM_LFACTORS",0==l%2?l/2:Math.floor(l/2)+1);ta.L(c,"REFLECTION_PASS",0);ta.L(c,"SSAO_ONLY",0);ta.L(c,"INVERT_FRONTFACING",0);(h=h.Tb)&&b.xe?ta.L(c,"WATER_EFFECTS",1):ta.L(c,"WATER_EFFECTS",0);if(h&&b.gf&&g.gf){ta.L(c,"CAUSTICS",1);if(l=e.k.kc){g=l.le;for(l=f=0;l<g.length;l++)"SUN"==g[l]&&(f=l);ta.L(c,"SUN_NUM",f)}ta.L(c,"CAUST_SCALE",ta.q(b.Ut));ta.L(c,"CAUST_SPEED",ta.q(b.Vt,2));ta.L(c,"CAUST_BRIGHT",ta.q(b.Tt))}else ta.L(c,"CAUSTICS",0);h&&(ta.L(c,"WAVES_HEIGHT",ta.q(h.waves_height)),
ta.L(c,"WAVES_LENGTH",ta.q(h.waves_length)),ta.L(c,"WATER_LEVEL",ta.q(h.Og)));b=k.Yf;k=k.Pe;if(-1!==a.lc.indexOf("u_mirrormap"))ta.L(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Rc&&b)b=b.j.Ib,da.ui(a,b,"u_cube_reflection"),ta.L(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Rc&&k)for(l=0;l<k.length;l++)b=k[l].j.Ib,da.ui(a,b,"u_plane_reflection"),ta.L(c,"REFLECTION_TYPE","REFL_PLANE");else ta.L(c,"REFLECTION_TYPE","REFL_NONE");(k=ra.Fb(d,"SKY"))?a.Nw?(b=k.j.Ib,da.ui(a,b,"u_sky")):za.Zn?(a.fd=k.fd,
ta.L(c,"PROCEDURAL_FOG",1)):ta.L(c,"PROCEDURAL_FOG",0):ta.L(c,"PROCEDURAL_FOG",0);b=e.k.at;b.Ps&&(ta.L(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.kq?(b=b.lq?da.VD(b.lq,!1):k.j.Ib,ta.L(c,"SKY_TEXTURE",1),da.ui(a,b,"u_sky_texture")):"SKY_COLOR"==b.kq&&ta.L(c,"SKY_COLOR",1));b=e.k.Hy;b.LI&&(ta.L(c,"USE_FOG",1),ta.L(c,"FOG_TYPE",b.jD));a.Gl&&a.Ja?(za.Kk&&ta.L(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.$i||"NODES_GLOW"==a.type?(ta.L(c,"REFRACTIVE",1),e.k.Fc?ta.L(c,"USE_REFRACTION",1):ta.L(c,
"USE_REFRACTION",0)):e.k.Fc?ta.L(c,"REFRACTIVE",1):ta.L(c,"REFRACTIVE",0)):(ta.L(c,"REFRACTIVE",0),ta.L(c,"USE_REFRACTION",0),ta.L(c,"USE_REFRACTION_CORRECTION",0));a.Ng&&(za.shore_smoothing&&a.Po&&ra.Fb(d,"DEPTH_PACK")?ta.L(c,"SHORE_SMOOTHING",1):ta.L(c,"SHORE_SMOOTHING",0),a.water_dynamic&&h&&h.waves_height?ta.L(c,"DYNAMIC",1):ta.L(c,"DYNAMIC",0));"PARTICLES"==a.type&&(ta.L(c,"SIZE_RAMP_LENGTH",a.Ba.aM),ta.L(c,"COLOR_RAMP_LENGTH",a.Ba.hu));if(!a.Ke)for(a=a.U,d=0;d<a.length;d++)if(b=a[d],"SCENE"==
b.source)for(c=0;c<Ia.length;c++)for(k=Ia[c],h=Ia[c].ye,l=0;l<h.length;l++)h[l].k==b&&pa.n(Mb,k,e,null)}}function M(a){var b=a.gc.attributes,c=a.P.xb,d;for(d in b)c[d]||$a.Z('missing data for "'+d+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(b=ta.rE(a.gc.Us),10<b&&("MAIN"==a.type&&Za.warn("Varying limit exceeded for main shader - "+b+', materials: "'+a.pd.join(", ")+'"'),"MAIN"==a.type&&a.$i||"NODES_GLOW"==a.type))d=c=0,a.ii&&(c=$a.cl(a.ii)),a.ac&&(d=$a.cl(a.ac)),Za.warn("Varying limit exceeded for node shader - "+
b+", uv: "+c+", vc: "+d+', materials: "'+a.pd.join(", ")+'"')}function F(a){8<a.U.length&&Za.warn(a.type,"too many textures used - "+a.U.length+' (max 8), materials "'+a.pd.join(", ")+'"')}function R(a,b,c){a.Kc=b.Kc;var d=b.Kc[0],f=b.Kc[1],e=b.Kc[2];c=c.bc;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);e=0==e?c:Math.max(e,c);b.Kc[2]=e;b=b.j;va.ko(b,e/2,-f,-d,e/2);va.Ff(b);d=a.Hq||0;d=0==d?c:Math.max(d,c);a.Hq=d}function S(a){la(a);var b=W(a,"MAIN_OPAQUE"),c=!0,d=a.k.kc;pa.ba(a.k.jb,function(f,e){"SHADOW_CAST"===
e.type&&(N(e,a,b.j,e.s,d,c),c=!1)})}function ha(a){pa.ba(a.k.jb,function(a,b){"OUTLINE"===b.type&&(b.iq=1)})}function N(a,b,c,d,f,e){if(0!=d.length){var g=a.j,h=Xa.Ui(c.i,Hc);Xa.set_trans(h,g.i);Xa.copy(c.we,g.gs);if("SUN"===f.le[a.qe]||"HEMI"===f.le[a.qe]){h=Bc;K.$c(h);for(var k=0;k<d.length;k++){var m=d[k].ne;0==k?K.Om(m.Cb,h):K.Gu(h,m.Cb)}d=K.fD(h,lb);$a.yj(d,g.Wa,d);if(f.enable_csm){b=Qa.copy(c.Fk[a.Up],Hc);f=X.invert(c.Wa,$c);$a.yj(b,f,b);$a.yj(b,g.Wa,b);a=c.Vp[a.Up];if(e)for(ob=0,Ua=-Infinity,
e=2;e<d.length;e+=3)ob=Math.min(ob,d[e]),Ua=Math.max(Ua,d[e]);e=Bc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=Ua;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=ob}else{c=e=Bc;f=Ib;f.set(d);d=Cc/9;h=X.identity($c);X.rotate(h,d,$a.AXIS_MZ,h);for(var m=k=-1,l=0;10>l;l++){var r=K.ZA(f,vb),n=(r.max_x-r.min_x)*(r.max_y-r.min_y);if(-1==k||n<k)k=n,m=l,K.Om(r,c);$a.yj(f,h,f)}c=m*d;0<c&&(d=X.identity($c),X.rotate(d,c,$a.AXIS_MZ,d),X.multiply(d,g.Wa,g.Wa),Xa.from_mat4(g.Wa,g.we));c=e.max_x-e.min_x;d=e.max_y-e.min_y;c&&d&&
(f=Math.abs(c-d)/2,2<c/d?(e.max_y+=f,e.min_y-=f):2<d/c&&(e.max_x+=f,e.min_x-=f));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;oa(a,b.k.jb)}va.PG(g,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);va.Ff(g);$a.cn(g.ve,g.Zk)}else"SPOT"!==f.le[a.qe]&&"POINT"!==f.le[a.qe]||va.Ff(g,g.Xa)}}function oa(a,b){for(var c=a.j,d=ra.kE(b,a),f=0;f<d.length;f++){var e=d[f];if("MAIN_OPAQUE"==e.type||"SHADOW_RECEIVE"==e.type||"MAIN_BLEND"==e.type||"MAIN_XRAY"==e.type)if(za.Fn)e.Qs.set(c.we,
9*a.qe);else{var g=Xa.get_trans_view(c.we),h=Xa.get_scale(c.we),k=Xa.get_quat_view(c.we);Hb.set(g[0],g[1],g[2],h,Ic);e.Ko.set(Ic,4*a.qe);e.Jo.set(k,4*a.qe)}}}function fa(a,b,c,d,f){for(var e=b.g,g=wa.Sa(b,d).T,h=0;h<g.length;h++){var k=g[h];"COLOR_ID"==k.type&&(f||(G(k,a,b,c,"COLOR_ID",d),da.Sb(k),M(k)),"COLOR_PICKING"==a.type&&"COLOR_ID"==k.hb||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==k.hb)&&(f||(da.va(k,"USE_OUTLINE",0),da.Sb(k),M(k)),a.s.push(O(e,k)))}}function na(a,b,c,d,f){d||(f.cc&&(d=
ra.Fb(c,"GRASS_MAP"))&&R(f,d,b),da.Sb(f),M(f));a.s.push(O(b,f));T(c,a,f);F(f)}function ba(a,b){E(a,b);for(var c=0;c<a.B.length;c++)for(var d=ka.Ga(a.B[c].wa,"ALL",-1),f=0;f<d.length;f++)d[f].parent==a&&ba(d[f],b)}function E(a,b){a.g.xh=b;if(wa.is_lamp(a))for(var c=0;c<a.B.length;c++)for(var d=a.B[c],f=V(d.wa,xb),e=0;e<f.length;e++)qa(a,d,f[e])}function ea(a,b){for(var c=V(b,xb),d=a.Oa,f=a.g,e=wa.Sa(a,b),g=e.Ch,h=Xa.get_trans_view(f.i),f=Xa.get_quat_view(f.i),k=0;k<c.length;k++){var m=c[k];m.Bn.set(h,
3*g);m.dr.set(d.direction,3*g);m.An.set(d.Bk,3*g);switch(d.type){case "SUN":m.Mx.set(f);m.Lx=d.Bk;"SKY"===m.type?(m.Ln=d.kw,Qa.copy(d.direction,m.ys),ia(b,m)):Qa.copy(d.direction,m.ys);break;case "HEMI":case "POINT":case "SPOT":break;default:Za.error("Unknown light type: "+d.type+'".')}qa(a,e,m);for(var l=0;l<m.s.length;l++){var r=m.s[l].I;r.fj&&da.SG(r,a)}}c=W(b,"MAIN_OPAQUE").j;e=e.hs;d=b.k.kc;for(k=0;k<e.length;k++)m=e[k],va.es(m.j,h,f),N(m,b,c,m.s,d,!0),oa(m,b.k.jb)}function qa(a,b,c){var d=a.g;
a=a.Oa;b=b.Ch;var f=Dc;f[0]=a.Yj&&!d.xh?1:0;f[1]=a.hi&&!d.xh?1:0;c.er.set(f,2*b);c.ia=!0}function la(a){var b=ka.Ga(a,"LAMP",ka.DATA_ID_ALL),b=wa.jn(b,za.Xc&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],f=d.g,e=Xa.Ui(f.i,Hc),f=Xa.gv(f.i,Zc),g=0;g<d.B.length;g++){var h=d.B[g],k=h.hs;if(h.wa==a)for(h=0;h<k.length;h++)va.es(k[h].j,e,f)}}function ia(a,b){oc.Gi(b);if(b.Ln)for(var c=V(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),d=0;d<c.length;d++)for(var f=c[d].s,
e=0;e<f.length;e++){var g=f[e];g.Jb&&(g=g.I,da.uB(g)&&oc.gI(g))}}function ya(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,f=0;f<d.materials.length;f++){var e=d.materials[f];-1==b.indexOf(e)&&b.push(e)}return b}function J(a,b,c){for(var d=a.k,f=a.Tg.g.N,e=0;e<f.length;e++){var g=f[e];va.Ff(g,b/c);d.kc&&va.Ms(g,d.kc)}d.kc&&(d.Mn=!0,W(a,"SHADOW_RECEIVE").ia=!0,W(a,"MAIN_BLEND").ia=!0);var h=d.jb;ra.XH(h,function(d,f,e){if(d.Tl){var g=d.$h*b,k=d.Kl*c;if(f)for(f=0;f<e.na.length;f++)e.na[f]==
d&&Ha.resize(d.xa,g,k);else switch(Ha.ej(d.xa)&&Ha.resize(d.xa,g,k),d=e.j,d.width=g,d.height=k,e.type){case "DOF":Q(a,{dof_power:e.j.dof_power,dof_on:e.j.dof_on});break;case "GLOW_COMBINE":ma(a,{small_glow_mask_width:e.small_glow_mask_width,large_glow_mask_width:e.large_glow_mask_width});break;case "BLOOM":sa(a,{bloom_blur:e.bloom_blur});break;case "OUTLINE":e=ra.ab(h,e,"POSTPROCESSING");g=ra.ab(h,e,"POSTPROCESSING");k=ra.ab(h,g,"POSTPROCESSING");d=ra.ab(h,k,"POSTPROCESSING");ra.xd(e,1/b,1/c);ra.xd(g,
1/b,1/c);ra.xd(k,1/b,1/c);ra.xd(d,1/b,1/c);break;default:ra.xd(e,1/b,1/c)}}})}function V(a,b){for(var c=[],d=0;d<b.length;d++){var f=b[d];pa.ba(a.k.jb,function(a,b){b.type==f&&c.push(b)})}return c}function W(a,b){return ra.Fb(a.k.jb,b)}function Q(a,b){var c=W(a,"DOF");if(!c)return Za.error("DOF is not enabled on the scene. Check camera settings"),0;var d=a.k.jb;"boolean"==typeof b.dof_on&&(c.j.dof_on=b.dof_on);"number"==typeof b.dof_distance&&(c.j.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&
(c.j.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(c.j.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){c.j.dof_power=b.dof_power;var f=ra.ab(d,c,"POSTPROCESSING"),d=ra.ab(d,f,"POSTPROCESSING");ra.yc(f,c.j.dof_power);ra.xd(f,1/c.j.width,1/c.j.height);ra.yc(d,c.j.dof_power);ra.xd(d,1/c.j.width,1/c.j.height)}}function sa(a,b){var c=W(a,"LUMINANCE_TRUNCED"),d=W(a,"BLOOM");if(!c||!d)return Za.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,
c.ia=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.ia=!0);if("number"==typeof b.bloom_blur){var f=a.k.jb,c=ra.ab(f,d,"BLOOM_BLUR"),f=ra.ab(f,c,"BLOOM_BLUR");d.bloom_blur=b.bloom_blur;ra.yc(c,b.bloom_blur);ra.xd(c,1/d.j.width,1/d.j.height);ra.yc(f,b.bloom_blur);ra.xd(f,1/d.j.width,1/d.j.height)}}function ma(a,b){var c=W(a,"GLOW_COMBINE");if(!c)return Za.error("Glow is not enabled on the scene"),null;for(var d=a.k.jb,f=ra.iE(d,c),e=0;e<f.length;++e){var g=f[e];if("POSTPROCESSING"===
g.type&&"GLOW_MASK_LARGE"===g.hb)var h=g;if("POSTPROCESSING"===g.type&&"GLOW_MASK_SMALL"===g.hb)var k=g}f=ra.ab(d,h,"POSTPROCESSING");d=ra.ab(d,k,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.ia=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.ia=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ra.yc(k,b.small_glow_mask_width),ra.xd(k,1/c.j.width,
1/c.j.height),k.ia=!0,ra.yc(d,b.small_glow_mask_width),ra.xd(d,1/c.j.width,1/c.j.height),d.ia=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ra.yc(h,b.large_glow_mask_width),ra.xd(h,1/c.j.width,1/c.j.height),h.ia=!0,ra.yc(f,b.large_glow_mask_width),ra.xd(f,1/c.j.width,1/c.j.height),f.ia=!0)}function ga(a,b,c){var d=a.k,f=d.Tb;if(!f.Nk)return f.Og;var e=f.waves_height,g=f.waves_length,h=f.Og,k=Qa.length(d.Lf);a=W(a,"MAIN_OPAQUE").time;k&&(a*=k);var m=
Dc;m[0]=20/g*(b-.25*a);m[1]=20/g*(c-.25*a);k=$a.Wt(m);m[0]=17/g*(c+.1*a);m[1]=17/g*(b+.1*a);var m=$a.Wt(m),k=k+m-1,l=f.dst_noise_scale0,m=f.dst_noise_scale1,r=f.dst_noise_freq0,n=f.dst_noise_freq1,q=Dc;q[0]=l*(b+r*a);q[1]=l*(c+r*a);l=$a.os(q);q[0]=m*(c-n*a);q[1]=m*(b-n*a);m=$a.os(q);m*=e*l;if(f.Ag)if(n=(b-f.Ej[0])/f.Fj[0],q=(f.Ej[1]+c)/f.Fj[1],n+=.5,q+=.5,1<n||0>n||1<q||0>q)f=m;else{var d=$a.Yu(d.js,f.ks,n,q),q=f.dir_freq,t=f.dir_noise_scale,u=f.dir_noise_freq,l=f.dir_min_noise_fac,n=f.dst_min_fac,
r=g/f.lr/Math.PI;c=[t/g*(b+u*a),t/g*(c+u*a)];b=Math.sqrt(d);f=e*Math.max(d,f.dir_min_shore_fac)*Math.sin(b/r+q*a)*Math.max($a.os(c),l);e=Math.max(b,n);f=f*(1-e)+m*e;k*=d}else f=m;return h+(f+.05*k)}function Z(a,b){a.kl&&"POSTPROCESSING"==a.type&&b.Jb!=a.Jb&&(a.Jb=b.Jb);b.Jb||"OUTLINE"!=a.type||(a.iq=0)}function Y(a,b,c,d){var f=pa.Da(a,b);va.jo(f.j,c,d);f.jp=!0;pa.Fg(a,b,function(b,f,e){e.Bb&&e.from==c&&ra.EB(e)&&Fa(a,b,e.to,d)});pa.se(a,b,function(b,f,e){e.Bb&&e.from==c&&e.from==e.to&&Y(a,b,c,d)})}
function Fa(a,b,c,d){a=pa.Da(a,b).s;for(b=0;b<a.length;b++)da.tG(a[b].I,d,c)}function ua(a){var b=W(a,"GRASS_MAP");if(b){var c=b.j,d=a.Tg.g;a=Xa.get_trans_view(d.i);var f=Hc;f[0]=0;f[1]=-b.Kc[2]/2;f[2]=0;b=Xa.get_quat_view(d.i);Qa.transformQuat(f,b,f);f[0]+=a[0];f[1]=0;f[2]+=a[2];b=Zc;b[0]=0;b[1]=0;b[2]=0;b[3]=1;va.es(c,f,b)}}function ca(a,b){pa.ba(a,function(c,d){if("MOTION_BLUR"==d.type){if(!d.na[0]||!d.Ve[0])throw"Wrong MOTION_BLUR subscene";var f=d.na[0],e=d.Ve[0];d.Ve[0]=d.j.Ib;pa.Fg(a,c,function(b,
c,d){d.Bb&&Fa(a,b,d.to,e)});Y(a,c,f.from,e);Fa(a,c,f.to,d.Ve[0]);d.jw=Math.exp(-b/d.mb_factor)}})}function ja(a){return a.k.Lf}var da=p("__batch"),K=p("__boundings"),va=p("__camera");p("__compat");var U=p("__config"),xa=p("__container");p("__constraints");var Ba=p("__debug"),aa=p("__geometry"),pa=p("__graph"),Ja=p("__hud");p("__lights");var X=p("__mat4"),Ca=p("__nodemat"),ka=p("__objects"),wa=p("__obj_util"),Da=p("__physics"),mb=p("__prerender"),Ac=p("__primitives"),Za=p("__print"),oc=p("__renderer"),
ra=p("__scenegraph"),ic=p("__sfx"),ta=p("__shaders"),Ha=p("__textures"),Xa=p("__tsr"),$a=p("__util"),Qa=p("__vec3"),Hb=p("__vec4"),za=U.p,Uc=U.Kb,ec=U.Aj,pc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE OUTLINE_MASK WIREFRAME".split(" ");a.MJ=pc;var xb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED SHADOW_RECEIVE SHADOW_CAST COLOR_PICKING COLOR_PICKING_XRAY OUTLINE_MASK".split(" "),
fc="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Rc="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),Qc="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),qc=null,yb=null,Ia=[],Mb=null,Cc=Math.PI/2,Dc=new Float32Array(2),Hc=new Float32Array(3),Zc=new Float32Array(4),Ic=new Float32Array(4),
$c=new Float32Array(16),lb=new Float32Array(24),Ib=new Float32Array(24),Bc=K.$c(),vb=K.$c(),ob=0,Ua=-Infinity;a.wK=function(){return{}};a.set_active=function(a){yb=a;ic.GG(a)};a.fG=function(a,b){var c=a.k,d=ra.mC(c.jb);if(a==b){J(a,xa.tE(),xa.sE());for(var f=0;f<d.length;f++)a.k.Vh.push(d[f])}else for(f=a.ye[0],J(a,f.k.ai,f.k.ai),f=0;f<d.length;f++)b.k.Vh.push(d[f]);d=V(a,Rc);for(f=0;f<d.length;f++)d[f].Lf.set(c.Lf);for(f=0;f<c.Vh.length;f++)"SHADOW_CAST"==c.Vh[f].type&&oc.Gi(c.Vh[f])};a.Ti=function(){qc||
(qc=d(Ia));return qc};a.dn=d;a.get_active=b;a.la=function(){return yb?!0:!1};a.Qi=function(a){return a.Tg};a.Pi=function(){return Ia};a.hv=function(){if(1==Ia.length)return Ia;for(var a=0;a<Ia.length;a++){var b=Ia[a].k.jb;pa.ba(b,function(b,c){for(var d=0;d<c.s.length;d++){for(var f=c.s[d].I.U,e=null,g=0;g<f.length;g++)if("SCENE"==f[g].source&&f[g].ps==Ia[a].name&&"COPY"!=c.type){Za.error('Texture-scene loop detected. A scene is rendered to texture "'+f[g].name+'" yet this texture belongs to the same scene.');
pa.Oe(Mb,Ia[a]);e=c.s[d].I;break}e&&(e.U=[],e.lc=[],da.fI(e,null),da.Sb(e))}})}for(var c=[],a=0;a<Ia.length;a++)if(b=Ia[a],!b.ye.length){b=pa.Oe(Mb,b);pa.ZC(Mb,b);b=pa.so(Mb,b,pa.hm);b=pa.Is(b);pa.ba(b,function(a,b){c.push(b)});break}return c};a.wA=function(a,b,d,n,p){a.ye=a.ye||[];a.S=null;var aa=a.k,J=a.Tg.g;aa.ak=[];var X=a.world;aa.WE=d.length;aa.di=g(d);aa.oo=k(X,aa.di);aa.at=f(X,aa.oo);aa.Hy=m(X);aa.oA=I(a,p);J.N[0].type!=va.pc&&"HMD"==za.stereo?(Za.warn("Head-mounted display stereo is disabled for the non-perspective camera"),
p=!1):p="HMD"==za.stereo;aa.xv=p;J.N[0].type!=va.pc&&"ANAGLYPH"==za.stereo?(Za.warn("Anaglyph stereo is disabled for the non-perspective camera"),p=!1):p="ANAGLYPH"==za.stereo;aa.anaglyph_use=p;aa.vg=H(a,b);aa.dB=u(a);aa.EF=z(a);aa.sB=D(a);aa.vE=y(a);aa.SF=C(a);aa.dg=v(a);aa.Ei=za.Ei&&(0<J.dof_distance||J.jd);aa.Jh=za.Jh&&a.b4w_enable_motion_blur;aa.yi=za.yi&&a.b4w_enable_color_correction;aa.antialiasing=za.antialiasing&&1==za.Cc&&"NONE"!=a.b4w_antialiasing_quality;aa.Xc=za.Xc&&a.b4w_enable_ssao;
aa.Vi=za.Vi&&a.b4w_enable_god_rays&&aa.di;aa.NC=za.Kk;aa.kn=a.b4w_glow_settings.render_glow_over_blend;aa.GH=r(a);p=e(n);aa.AF=p;aa.Fc=A(a,p);aa.kc=c(a,d,n);aa.Tb=t(n);aa.Nf=w(n);aa.sH=l(n);aa.shore_smoothing=q(n);aa.cc=h(n);aa.MB=x(a,n);aa.outline=L(a,n);aa.tf=P(a,n);switch(a.b4w_reflection_quality){case "LOW":aa.mh=ec.ru;aa.Sh=ec.Gw;break;case "MEDIUM":aa.mh=ec.DC;aa.Sh=ec.bG;break;case "HIGH":aa.mh=ec.CC;aa.Sh=ec.aG;break;default:aa.mh=ec.ru,aa.Sh=ec.Gw}if(xa.ME())Za.log("%cENABLE HIDPI MODE",
"color: #00a"),aa.tt="AA_QUALITY_LOW",aa.Tc=1,za.Cc=1;else if(1<za.Cc)Za.log("%cENABLE MSAA RENDERING: "+za.Cc+"x","color: #00a"),aa.Tc=1;else{aa.tt="AA_QUALITY_"+a.b4w_antialiasing_quality;switch(a.b4w_antialiasing_quality){case "LOW":aa.antialiasing&&(aa.Tc=1);break;case "MEDIUM":za.quality==U.P_LOW||za.quality==U.P_HIGH?aa.Tc=1:za.quality==U.P_ULTRA&&(aa.Tc=1.33);break;case "HIGH":za.quality==U.P_LOW?aa.Tc=1:za.quality==U.P_HIGH?aa.Tc=1.33:za.quality==U.P_ULTRA&&(aa.Tc=2);break;case "NONE":za.quality==
U.P_LOW||za.quality==U.P_HIGH?aa.Tc=1:za.quality==U.P_ULTRA&&(aa.Tc=2)}za.quality==U.P_CUSTOM&&(aa.Tc=1)}d=a.ye.sort(function(a,b){return b.k.ai-a.k.ai});aa.jb=ra.lC(aa,J,d);aa.Vh=[];aa.Mn=!1;aa.qr=!1;aa.rr=!1;aa.Lf=new Float32Array(3);Ia.push(a);Mb||(Mb=pa.create());pa.v(Mb,a);for(aa=0;aa<b.length;aa++)wa.Wr(b[aa],!0,a);a=xa.get_container();xa.resize(a.clientWidth,a.clientHeight,!0)};a.xA=function(a,b,c){for(var d=0;d<b.length;d++)b[d].k&&b[d].k.ml&&(b[d].k.Kf=c,a.k.ak.push(b[d]))};a.dv=function(a){return a.k.jb};
a.Tu=function(a){pa.ba(a,function(b,c){var d=null;switch(c.type){case "POSTPROCESSING":d=da.Tp(c.Yn);break;case "SSAO":d=da.sC(c);break;case "SSAO_BLUR":d=da.tC(c);break;case "DEPTH_PACK":d=da.YB();break;case "GOD_RAYS":ra.ab(a,c,"RESOLVE")||ra.ab(a,c,"WIREFRAME")||ra.ab(a,c,"MAIN_BLEND")||ra.ab(a,c,"GOD_RAYS");d=da.bC(c.Bw,c.Ng,c.Oj);break;case "GOD_RAYS_COMBINE":ra.ab(a,c,"RESOLVE")||ra.ab(a,c,"WIREFRAME")||ra.ab(a,c,"MAIN_BLEND");ra.ab(a,c,"GOD_RAYS");d=da.cC();break;case "MOTION_BLUR":d=da.gC();
break;case "DOF":var d=da.ZB(),f=ra.ab(a,c,"POSTPROCESSING"),e=ra.ab(a,f,"POSTPROCESSING");ra.yc(f,c.j.dof_power);ra.yc(e,c.j.dof_power);break;case "OUTLINE":var d=da.hC(),f=ra.ab(a,c,"POSTPROCESSING"),e=ra.ab(a,f,"POSTPROCESSING"),g=ra.ab(a,e,"POSTPROCESSING"),h=ra.ab(a,g,"POSTPROCESSING");ra.yc(e,c.sp);ra.yc(f,c.sp);ra.yc(h,c.pq*c.rl);ra.yc(g,c.pq*c.rl);break;case "GLOW_COMBINE":d=da.aC();break;case "COMPOSITING":d=da.WB();break;case "ANTIALIASING":d=da.RB(c);break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=
da.qC(c.type);break;case "STEREO":d=da.uC(c.hb);break;case "SKY":d=da.kC();break;case "LUMINANCE":d=da.dC();break;case "AVERAGE_LUMINANCE":d=da.SB();break;case "LUMINANCE_TRUNCED":d=da.eC();break;case "BLOOM_BLUR":d=da.TB();break;case "BLOOM":d=ra.ab(a,c,"BLOOM_BLUR");f=ra.ab(a,d,"BLOOM_BLUR");ra.yc(d,c.bloom_blur);ra.yc(f,c.bloom_blur);d=da.UB();break;case "VELOCITY":d=da.yC();break;case "ANCHOR_VISIBILITY":d=da.QB();break;case "PERFORMANCE":d=da.iC()}d&&(f=O(wa.lh("NONE"),d),M(d),c.s.push(f),T(a,
c,d),F(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":case "LINE":var d=a.k.jb,f=b.g;!ra.Fb(d,"SHADOW_CAST")&&f.Vc&&(f.Vc=!1);f=V(a,pc);c&&b.gi&&Da.append_object(b,a);for(var e=0;e<f.length;e++){var g=f[e],h=b,k=d,m=a,l=c;switch(g.type){case "MAIN_OPAQUE":B(g,h,k,"OPAQUE",m,l);break;case "MAIN_BLEND":B(g,h,k,"BLEND",m,l);break;case "MAIN_XRAY":B(g,h,k,"XRAY",m,l);break;case "MAIN_GLOW":B(g,h,k,"GLOW",m,l);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var r=h.g,n=
wa.Sa(h,m).T,q=0;q<n.length;q++){var t=n[q];if(("MAIN"==t.type||"PARTICLES"==t.type||"LINE"==t.type)&&"REFLECT"==t.hb){if("MAIN_PLANE_REFLECT"==g.type){var u;a:{u=m.k.vg.Pe;for(var U=0;U<u.length;U++)for(var aa=0;aa<u[U].length;aa++)if(u[U][aa]==g){u=U;break a}u=null}if(u==r.td)continue}else{a:{if(m.k.vg)for(u=m.k.vg.Yf,U=0;U<u.length;U++)if(u[U]==g){u=U;break a}u=null}if(u==r.Kd)continue}l||(G(t,g,h,k,"REFLECT",m),u=t.zb,ta.L(u,"WATER_EFFECTS",0),ta.L(u,"REFLECTION_PASS",1),ta.L(u,"TEXTURE_NORM",
0),"MAIN_PLANE_REFLECT"==g.type&&ta.L(u,"INVERT_FRONTFACING",1),da.Sb(t),M(t));g.s.push(O(r,t))}}break;case "SHADOW_RECEIVE":r=wa.Sa(h,m).T;for(n=0;n<r.length;n++)q=r[n],"SHADOW"==q.type&&"RECEIVE"==q.hb&&(l||(G(q,g,h,k,"SHADOW",m),da.Sb(q),M(q)),g.s.push(O(h.g,q)),T(k,g,q),F(q));break;case "SHADOW_CAST":r=!1;n=h.g;h=wa.Sa(h,m).T;q=ra.Fb(k,"GRASS_MAP");for(t=0;t<h.length;t++)u=h[t],"SHADOW"==u.type&&"CAST"==u.hb&&(r=!0,l||(U=g.Nn,da.va(u,"NUM_LIGHTS",U),da.va(u,"NUM_LFACTORS",0==U%2?U/2:Math.floor(U/
2)+1),ta.L(u.zb,"SHADOW_USAGE","SHADOW_CASTING"),u.cc&&q&&R(u,q,n),da.va(u,"SHADOW_TEX_RES",ta.q(m.k.kc.csm_resolution)),da.Sb(u),M(u)),g.s.push(O(n,u)));r&&(h=m.k.kc,l=ra.Fb(k,"MAIN_OPAQUE"),N(g,m,l.j,g.s,h,!0));break;case "COLOR_PICKING":fa(g,h,k,m,l);break;case "COLOR_PICKING_XRAY":fa(g,h,k,m,l);break;case "OUTLINE_MASK":k=h.g;h=wa.Sa(h,m).T;for(m=0;m<h.length;m++)r=h[m],"COLOR_ID"==r.type&&"OUTLINE"==r.hb&&(l||(da.va(r,"USE_OUTLINE",1),da.Sb(r),M(r)),g.s.push(O(k,r)));break;case "GRASS_MAP":k=
h.g;h=wa.Sa(h,m).T;for(m=0;m<h.length;m++)r=h[m],"GRASS_MAP"==r.type&&(l||(da.Sb(r),M(r)),g.s.push(O(k,r)),r=g.j,u=k.Cb,n=g.Kc[0],q=g.Kc[1],t=g.Kc[2],0==n&&0==q?(n=u.min_y,q=u.max_y):(n=Math.min(n,u.min_y),q=Math.max(q,u.max_y)),u=1E-4*(q-n),g.Kc[0]=n-u,g.Kc[1]=q+u,va.ko(r,t/2,-q,-n,t/2),va.Ff(r));break;case "WIREFRAME":for(r=h.g,h=wa.Sa(h,m).T,m=0;m<h.length;m++)n=h[m],"WIREFRAME"==n.type&&na(g,r,k,l,n)}}break;case "LAMP":ea(b,a),ka.vH(a)}wa.Wr(b,!0,a)};a.Xr=function(a){a.k.Mn=!0};a.BI=function(a,
b){var c=a.g.N[0];pa.ba(b,function(a,b){if("SHADOW_CAST"===b.type){var d=Xa.get_trans_view(c.i);Xa.set_trans(d,b.j.i);Xa.copy(c.we,b.j.gs)}})};a.lM=oa;a.aE=function(a,b){for(var c=a.k.kc,d=new Float32Array(c.csm_num),f=0;f<c.csm_num;f++)d[f]=va.BC(c,b,f);return d};a.WJ=na;a.Xt=ba;a.tk=E;a.is_hidden=function(a){return a.g.xh};a.nG=function(a,b,c){b=b.g;a=V(a,pc);for(var d=0;d<a.length;d++)for(var f=a[d].s,e=f.length-1;0<=e;e--){var g=f[e];g.ne==b&&(g.I&&c&&aa.du(g.I.P),f.splice(e,1))}};a.rI=function(a,
b){for(var c=a.Oa,d=wa.Sa(a,b).Ch,f=V(b,xb),e=0;e<f.length;e++){var g=f[e];g.An.set(c.Bk,3*d);g.ia=!0}};a.Fo=ea;a.cleanup=function(){for(var a=0;a<Ia.length;a++){var b=Ia[a];pa.ba(b.k.jb,function(a,b){if("SINK"!=b.type){var c=b.j;oc.qG(c.je,c.Ib,c.Ld,c.width,c.height);for(var c=b.s,d=0;d<c.length;d++){var f=c[d].I;f&&da.LB(f)}}});b.k.jb=[];b.k.Vh=[]}yb=qc=null;Ia.length=0;Mb=null};a.cw=function(a,b,c){a=va.gD(a,a.Va,a.Eb,null,!0);var d=Ac.HD(a);a=wa.lh("DYNAMIC");a.Cb=a.bc={max_x:1E12,min_x:-1E12,
max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Wb=a.dd=K.aB();var f=a.Wb.Pa;a.Uf=a.ef=K.Qm([f,0,0],[0,f,0],[0,0,f],a.Wb.K);c=da.pC(d,c);b.s.push(O(a,c))};a.dL=function(a){return[a.frame_start,a.frame_end]};a.ox=function(a,b,c){xa.mH(a,b,c);yb&&J(yb,a,b)};a.WL=J;a.Kx=V;a.X=W;a.get_environment_colors=function(a){a=W(a,"MAIN_OPAQUE");var b=a.Td,c=a.ce,d=[],f=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];f[0]=c[0];f[1]=c[1];f[2]=c[2];return[a.pf,d,f]};a.set_environment_colors=function(a,b,c,d){a=V(a,xb);for(var f=
0;f<a.length;f++){var e=a[f];e.Td.set(c);e.ce.set(d);e.pf=b;e.ia=!0}};a.get_sky_params=function(a){if(a=W(a,"SKY")){var b={};b.color=Array(3);Qa.copy(a.Gj,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=
a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=W(a,"SKY");c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.Gj.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),
"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&
(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.ia=!0,c.Ln=!0,ia(a,c))};a.$K=function(a){return V(a,fc)[0].Pd[0]};a.YK=function(a){return V(a,fc)[0].Pd[1]};a.aL=function(a){return V(a,fc)[0].Pd[2]};a.ZK=function(a){return V(a,fc)[0].Pd[3]};a.LG=function(a,b){for(var c=V(a,fc),d=0;d<c.length;d++){var f=c[d];f.Pd[0]=b;f.ia=!0}};a.JG=function(a,b){for(var c=V(a,fc),d=0;d<c.length;d++){var f=c[d];f.Pd[1]=b;f.ia=!0}};a.MG=function(a,
b){for(var c=V(a,fc),d=0;d<c.length;d++){var f=c[d];f.Pd[2]=b;f.ia=!0}};a.KG=function(a,b){for(var c=V(a,fc),d=0;d<c.length;d++){var f=c[d];f.Pd[3]=b;f.ia=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=V(a,fc)[0].Ac;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=V(a,fc),d=0;d<c.length;d++){var f=c[d];f.Ac.set(b);f.ia=!0}};a.get_ssao_params=function(a){var b=W(a,"SSAO");a=W(a,"SSAO_BLUR");if(!b)return null;var c=b.s[0].I,d={};d.ssao_quality=
da.dc(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.Nt=a.ssao_blur_discard_value;d.radius_increase=b.Kj;d.influence=b.Jj;d.dist_factor=b.Ij;d.ssao_only=b.ssao_only;d.ssao_white=da.dc(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=W(a,"SSAO"),d=W(a,"SSAO_BLUR");if(!c)return Za.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var f=c.s[0].I;da.va(f,"SSAO_QUALITY",b.ssao_quality);da.Sb(f,!0)}"number"==
typeof b.ssao_hemisphere&&(f=c.s[0].I,da.va(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),da.Sb(f,!0));"number"==typeof b.ssao_blur_depth&&(f=d.s[0].I,da.va(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),da.Sb(f,!0));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.Kj&&(c.Kj=b.Kj);"number"==typeof b.Jj&&(c.Jj=b.Jj);"number"==typeof b.Ij&&(c.Ij=b.Ij);if("number"==typeof b.ssao_only){c=W(a,"MAIN_OPAQUE");c.ssao_only=b.ssao_only;for(var e=0;e<c.s.length;e++)f=
c.s[e].I,da.va(f,"SSAO_ONLY",b.ssao_only),da.Sb(f,!0)}"number"==typeof b.ssao_white&&(f=c.s[0].I,da.va(f,"SSAO_WHITE",b.ssao_white),da.Sb(f,!0));c.ia=!0;d.ia=!0};a.get_dof_params=function(a){a=W(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.j.dof_distance;b.dof_front=a.j.dof_front;b.dof_rear=a.j.dof_rear;b.dof_power=a.j.dof_power;b.jd=a.j.jd;return b};a.set_dof_params=Q;a.get_god_rays_params=function(a){var b=V(a,["GOD_RAYS"]);a=W(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var c={};c.god_rays_max_ray_length=
b[0].ij;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=da.dc(b[0].s[0].I,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=V(a,["GOD_RAYS"]),d=W(a,"GOD_RAYS_COMBINE");if(!c||!d)return Za.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,e=0;e<c.length;e++)c[e].ij=f,c[e].bo=f/c[e].Oj/(e+1),c[e].ia=!0;if("number"==
typeof b.god_rays_steps)for(var g=ta.q(b.god_rays_steps,1),f=c[0].ij,e=0;e<c.length;e++){c[e].Oj=g;c[e].bo=f/g/(e+1);c[e].ia=!0;var h=c[e].s[0].I;da.va(h,"STEPS_PER_PASS",g);da.Sb(h,!0)}d.ia=!0};a.get_bloom_params=function(a){var b=W(a,"LUMINANCE_TRUNCED");a=W(a,"BLOOM");if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=sa;a.get_glow_material_params=function(a){a=W(a,"GLOW_COMBINE");if(!a)return null;var b=
{};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=ma;a.get_wind_params=function(a){a=ja(a);var b=Qa.length(a);if(0==b)return null;var c={};c.wind_dir=180*Math.atan2(a[0],a[2])/Math.PI;c.wind_strength=b;return c};a.DG=function(a){a.k.qr=!0};a.get_water_surface_level=ga;a.get_water_mat_params=function(a,b){var c=a.k.Tb,
d=W(a,"MAIN_OPAQUE");d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.xe&&(b.water_fog_density=d.xe[3],c=b.water_fog_color=[],c[0]=d.xe[0],c[1]=d.xe[1],c[2]=d.xe[2]))};a.set_water_params=function(a,b){var c=a.k.Tb;if(!c)return Za.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&
(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&
(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Nk=b.water_dynamic);for(var d=V(a,Qc),f=0;f<d.length;f++){var e=d[f];"number"==typeof b.water_fog_density&&c.Ac&&(e.xe[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Ac&&e.xe.set(b.water_fog_color);"number"==typeof b.waves_height&&(e.Vs=b.waves_height);"number"==typeof b.waves_length&&(e.Ws=b.waves_length);e.ia=!0}};a.get_shore_dist=function(a,b,c){var d=
a.k.Tb;if(!d.Ag)return 100;var f=d.lr;a=d.Og;var e=(b[0]-d.Ej[0])/d.Fj[0],g=(d.Ej[1]+b[2])/d.Fj[1],e=e+.5,g=g+.5;if(1<e||0>e||1<g||0>g)b=1;else return d=f*$a.Yu(yb.k.js,d.ks,e,g),b=(a-b[1])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,c){for(var d=b().Tg.g,f=0;f<Ia.length;f++){var e=Ia[f],g=e.k.jb,h=e.k;if(h.Tb)var k=Xa.get_trans_view(d.i),m=k[1]-ga(e,k[0],k[2]);for(k=0;k<h.ak.length;k++){var l=h.ak[k].k,r=l.ha,n=l.jc;if(!(e.b4w_use_nla&&l.Ho||!r&&!n)&&Ha.wy(l)){var q=Ha.ty(l),t=Ha.vy(l);r&&za.gg&&
(t-=5);var u=Ha.eJ(l);q>=u&&l.fi||q<t?(Ha.reset_video(l.name,l.Kf),n&&(l.Bj=Ha.io(l,a))):q>=u&&!l.fi?Ha.pause_video(l.name,l.Kf):Ha.xy(l)&&(r?Ha.hy(l):(r=Ha.io(l,a),r!=l.Bj&&(Ha.gy(l),l.Zh++),l.Bj=r))}}pa.ba(g,function(b,c){-1<Rc.indexOf(c.type)&&(c.time=a);h.Tb&&(c.Dp=m)})}for(f=0;f<Ia.length;f++)if(e=Ia[f],h=e.k,g=h.jb,d=h.Vh,d.length)for(h.Mn&&(S(e),h.Mn=!1),h.qr&&(ua(e),h.qr=!1),h.rr&&(ha(e),h.rr=!1),h.Jh&&ca(g,c),e=ra.Fb(g,"OUTLINE_MASK"),k=0;k<d.length;k++)g=d[k],mb.Hr(g),e&&Z(g,e),oc.Gi(g);
za.show_hud_debug_info&&Ja.qH(Ia,c)};a.uG=function(a){a.k.rr=!0};a.Bq=function(a){var b=[];pa.ba(a.k.jb,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=W(yb,"MAIN_BLEND"),b=yb;return a||b.k.Tb?a.Dp:null};a.get_object_data_id=function(a){return a.g.Jc};a.fy=function(a){pa.ba(a.k.jb,function(a,b){b.ia=!0})};a.hH=function(a,b){a.Jb=b!=Ba.WM_NONE;for(var c=0;c<a.s.length;c++)a.s[c].I.wireframe_mode=b;a.Ja=b==Ba.WM_TRANSPARENT_WIREFRAME;a.ia=!0};a.gH=function(a,b){for(var c=
0;c<a.s.length;c++)a.s[c].I.wireframe_edge_color=b,a.ia=!0};a.qI=function(a,b){var c=b.Ii,d=a.k.Lf;if(c&&"WIND"==c.type&&d){var f=Xa.get_quat_view(b.g.i);$a.quat_to_dir(f,$a.AXIS_Y,d);Qa.normalize(d,d);Qa.scale(d,c.Hx,d);c=V(a,Rc);for(f=0;f<c.length;f++)c[f].Lf.set(d)}};a.WF=function(a,b,c){var d=W(a,"COLOR_PICKING");if(d)return b=xa.Fp(b,c,Dc,d.j),mb.Hr(d),oc.Gi(d),(a=W(a,"COLOR_PICKING_XRAY"))?(mb.Hr(a),oc.Gi(a),d=a.j):d=d.j,b[1]=d.height-b[1],oc.Vw(d.je,b[0],b[1]);Za.error("Object Selection is not available on the scene");
return null};a.set_outline_color=function(a){var c=b();if(c=W(c,"OUTLINE"))c.Af.set(a),c.ia=!0};a.iL=ja;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.ay=function(a,b){var c=Hc;Qa.negate(b,c);for(var d=0;6>d;d++){var f=a.Gk[d],e=a.Wp[d],g=a.j;X.translate($a.Sy[d],c,f);X.multiply(g.mb,f,g.ve);$a.cn(g.ve,e)}};a.dy=function(a,b,c){$a.UH(b,c,$a.AXIS_Y,a.j.$b)};a.UA=function(a,b,c){var d=a.k.kc,f=a.k.vg;
c=wa.jn(c,za.Xc&&a.b4w_enable_ssao);for(var e=0;e<b.length;e++){var g=b[e],h=wa.Sa(g,a);if(f)if(null!=g.g.td){var k=f.Pe;k.length&&(g=g.g.td,h.Pe=k[g])}else null!=g.g.Kd&&(k=f.Yf,k.length&&(g=g.g.Kd,h.Yf=k[g]))}for(e=0;e<c.length;e++)if(h=wa.Sa(c[e],a),d)for(b=V(a,["SHADOW_CAST"]),f=0;f<b.length;f++)e==b[f].qe&&h.hs.push(b[f])};a.marker_frame=function(a,b){return a.timeline_markers[b]}};b4w.module.__physics=function(a,p){function d(a,b){for(var c=a.fe,f=0;f<c.length;f++)c[f].oe.Xl&&b.push(c[f]),d(c[f],b)}function b(a,b,c){for(var d=a.tb.s,e=0;e<d.length;e++)for(var g=d[e].o,h=0;h<g.Ic.length;h++){var k=g.Ic[h];"ANY"!=k.Ya&&c!=k.Ya||f(k,a,b)}}function c(a,b,c){if(G.un(a))switch(b){case G.az:var d=n(a);d.tb.Gy=!0;G.C(a,G.Iz,Date.now()-performance.now(),ba.me,ba.Ap?E.Ou:0);break;case G.bz:F.ir("URANIUM:",c.slice(1));break;case G.Xy:F.error(c);break;case G.Yy:B.fbmsg.apply(this,c.slice(1));
break;case G.gz:var f=g(c.A);if(f){a=c.trans;d=c.quat;b=c.Le;var e=c.ze,f=f.o;f.Tm=c.time;N.set_sep(a,1,d,f.Yp);fa.copy(b,f.Le);fa.copy(e,f.ze)}break;case G.dz:(a=g(c.Gp))&&N.set_sep(c.trans,1,c.quat,a.l.zl[c.Jr]);break;case G.Zy:if(d=g(c[1]))a=c[4],d=d.Od.Fm[c[2]],ha.set_translation(d,c[3]),ha.set_rotation(d,a),ha.m(d);break;case G.hz:if(f=g(c[1]))f.l.speed=c[2];break;case G.Ty:d=n(a);q(d,c.ah,c.bh,c.result,null,null,0);break;case G.Vy:d=n(a);q(d,c.ah,c.bh,c.result,c.jh,c.coll_norm,c.coll_dist);
break;case G.Uy:if(f=g(c[1]))a=f.o,a.ih&&a.ih(c[2]);break;case G.ht:case G.ez:d=n(a);if(a=d.tb.tg[c.id])if(d=g(c.wi),b==G.ht)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var e=c.hit_time,f=c.hit_pos,h=a.callback;f?h(a.id,b,d,e,f,c.hit_norm):h(a.id,b,d,e)}break;case G.fz:x(id);break;case G.cz:a=la.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case G.$y:qa=
c[1];break;case G.Wy:a=la.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:F.error("Wrong message: "+b)}}function n(a){for(var b=0;b<la.length;b++)if(la[b]==a)return ia[b]}function g(a){return ya[a]||null}function q(a,b,c,d,f,e,h){a=a.tb.s;for(var k=0;k<a.length;k++)for(var m=a[k].o,r=0;r<m.Ic.length;r++){for(var n=m.Ic[r],q=n.qg,t=!1,u=0;u<q.length;u++){var p=q[u];if(p[0]===b&&p[1]===c){n.sl[u]=d;t=!0;break}}t&&(q=l(n),f&&n.tp!=b&&(t=f,u=e,p=h,t[0]+=u[0]*p,t[1]+=u[1]*
p,t[2]+=u[2]*p,u[0]*=-1,u[1]*=-1,u[2]*=-1),n.callback(q,q?n.tp==b?g(c):g(b):null,f,e,h))}}function l(a){a=a.sl;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function t(){W.body++;return W.body}function e(a){var b=V.indexOf(a);return-1==b?(V.push(a),V.length-1):b}function H(a){return{A:a,Me:0,vn:!1,Bg:!0,Mc:!1,is_character:!1,KE:!1,Nm:null,Ya:"",yk:0,qK:{},Ic:[],ih:null,Tm:0,Yp:new Float32Array([0,0,0,1,0,0,0,1]),Le:new Float32Array(3),ze:new Float32Array(3),Hm:new Float32Array(3),pk:new Float32Array(4)}}
function k(a,b){switch(a){case "BOX":var c=b.bc;break;case "CYLINDER":c=b.op;break;case "CONE":c=b.np;break;case "SPHERE":c=b.dd;break;case "CAPSULE":c=b.mp}return c}function r(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.K&&(b.center=
a.K);"number"===typeof a.Pa&&(b.radius=a.Pa);"number"===typeof a.height&&(b.height=a.height);return b}function u(a,b,c,d,f){var e=N.get_trans_view(a.g.i),g=N.invert(b.g.i,ma),h=new Float32Array(3);N.transform_vec3(e,g,h);switch(b.l.type){case 10:b=b.Zc;a=a.g.bc;G.C(f,G.lz,c,h,b.PH,b.Sr,(a.max_y-a.min_y)/2,d);break;case 20:G.C(f,G.kz,c,h,a.gM)}}function z(a){return a.o&&a.o.Nm}function D(a,b,c,d,f,e,g,h,k,m){var l;W.ib++;l=W.ib.toString(16);var r=b.o.A;G.C(y(r),G.sz,l,a,h,r,c,d,f.o.A,e,g,k,m);b.o.Nm=
l}function y(a){for(var b=0;b<ia.length;b++)for(var c=ia[b].tb.s,d=0;d<c.length;d++)if(c[d].o.A==a)return la[b];return null}function C(a){var b=a.o;if(b=b?0===b.Me?!0:!0===b.vn?!0:!1===b.Bg?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=N.get_trans_view(a.g.i),c=N.get_quat_view(a.g.i),b=b[0]!=a.o.Hm[0]||b[1]!=a.o.Hm[1]||b[2]!=a.o.Hm[2]||c[0]!=a.o.pk[0]||c[1]!=a.o.pk[1]||c[2]!=a.o.pk[2]||c[3]!=a.o.pk[3];if(b){var b=a.o,d=a.g,c=N.get_trans_view(d.i),d=N.get_quat_view(d.i);fa.copy(c,b.Hm);
R.copy(d,b.pk);var f=G.fv(G.km);f.A=b.A;f.trans=c;"DYNAMIC"==b.type?R.identity(f.quat):f.quat=d;G.C(y(b.A),G.km)}a=a.fe;for(b=0;b<a.length;b++)C(a[b])}function v(a,b,c,d,f){f=f||new Float32Array(3);a=N.get_quat_view(a.g.i);f[0]=b;f[1]=c;f[2]=d;fa.transformQuat(f,a,f)}function f(a,b,c){var d=a.qg,f=a.sl,e=a.tp,g=[],h=a.Ya;if(!g)throw"At least one destination required";for(var k=0;k<b.tb.s.length;k++){var l=b.tb.s[k];if("ANY"==h||l.o.Ya==h)l=l.o.A,g&&-1==g.indexOf(l)&&g.push(l)}for(b=0;b<g.length;b++)h=
g[b],e<h&&!m(d,e,h)?(d.push([e,h]),f.push(!1)):e>h&&!m(d,h,e)&&(d.push([h,e]),f.push(!1));G.C(c,G.jz,e);G.C(c,G.rz,d,a.Fe)}function m(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function h(a){a.o&&a.o.ih&&(a=a.o,G.C(y(a.A),G.Ez,a.A),a.ih=null)}function x(a){var b=P(a),c=L(a).tb;c.tg[a]&&(delete c.tg[a],c.Mr.splice(c.Mr.indexOf,1),G.C(b,G.Nz,a))}function L(a){for(var b=0;b<ia.length;b++){var c=ia[b];if(c.tb.tg[a])return c}return null}function P(a){for(var b=0;b<ia.length;b++)if(ia[b].tb.tg[a])return la[b];
return null}function A(a,b,c){if(b.Nj){a=a.o.A;var d=b.Hi*b.Uk,f=b.nk*b.ok,e=-b.Lj*b.Mj*2*Math.PI/b.Ql;b.jl&&(e*=-1);switch(b.type){case 10:G.C(c,G.$z,a,d,f,e);break;case 20:G.C(c,G.Zz,a,d,f,e)}}}function w(a){return a.Mc&&"CHASSIS"==a.Zc.Oc}function I(a){return a.Mc&&"HULL"==a.Zc.Oc}function T(a){return a.Bh&&"MAIN_BODY"==a.Ji.Oc}var O=p("__config");p("__constraints");var B=p("__debug"),G=p("__ipc");p("__mat4");var M=p("__obj_util"),F=p("__print"),R=p("__quat");p("__renderer");var S=p("__scenes"),
ha=p("__transform"),N=p("__tsr"),oa=p("__util"),fa=p("__vec3"),na=p("__version"),ba=O.o,E=O.p,ea=O.Ae,qa=0,la=[],ia=[],ya={},J=[],V=["ANY"],W={body:0,ib:0,Tw:0},Q=new Float32Array(3);new Float32Array(4);var sa=new Float32Array(4);new Float32Array(16);var ma=N.create(),ga=N.create();a.FE=function(a){a.tb={Gy:!1,s:[],tg:{},Mr:[]};var b=ba.Vl;ea.Ir&&(b+=na.timestamp());F.log("%cLOAD PHYSICS","color: #0a0",ba.$l?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ba.me);F.log("%cPHYSICS PATH",
"color: #0a0",b);var d=G.zC(b,!ba.$l);G.WA(d,c);la.push(d);ia.push(a);ba.ping&&setInterval(function(){G.C(d,G.Kz,performance.now())},1E3)};a.GB=function(a){return a.tb?a.tb.Gy:!0};a.cleanup=function(){for(var a=0;a<la.length;a++)G.terminate(la[a]);la.length=0;ia.length=0;ya={};J.length=0;V.length=0;for(var b in W)W[b]=0};a.append_object=function(a,c){if(!a.g)throw"No object render: "+a.name;var f;a:{for(var g=0;g<ia.length;g++)if(ia[g]==c){f=la[g];break a}f=void 0}var h=[];a.oe.Xl&&d(a,h);var m=c.tb.s;
if(w(a)||I(a)||a.is_character||T(a)||a.gi){var l,n=a,q=f,U=n.g,p=n.oe,x=p.Wn,aa=t();if("CAMERA"==n.type)var v=p.Os?p.Km:"BOX",Ja=k(v,U),X=U.Yk,y=U.Pk,X=.5,y=0;else if("EMPTY"==n.type)v="EMPTY",Ja=null,y=X=0;else{var v=p.Os?p.Km:"BOX",Ja=k(v,U),ka=N.get_scale(U.i);if(1!=ka){var V=Ja;switch(v){case "BOX":V.min_x*=ka;V.max_x*=ka;V.min_y*=ka;V.max_y*=ka;V.min_z*=ka;V.max_z*=ka;break;case "CYLINDER":case "CONE":case "CAPSULE":V.height*=ka;V.Pa*=ka;break;case "SPHERE":V.Pa*=ka}}X=U.Yk;y=U.Pk}var W=N.get_trans_view(U.i),
B=N.get_quat_view(U.i),Q=p.Zl,C=p.ly,L=p.Me,O=p.py,S=p.oy,E=p.$p,P=p.Ur,ha=n.Ya,qa=e(ha),fa=p.zk,ba=p.xk,ea=p.Ak,na=U.dd.Pa,ec=r(Ja),pc=n.Pm,xb;var fc=v;if(h.length){var Rc=[],Qc={};Qc.quat=new Float32Array([0,0,0,1]);Qc.trans=new Float32Array(3);Qc.worker_bounding=ec;Qc.bounding_type=fc;Rc.push(Qc);var qc=N.invert(U.i,ma),yb=N.get_quat_view(U.i);R.invert(yb,sa);for(var Ia=0;Ia<h.length;Ia++){var Mb={},Cc=h[Ia],Dc=Cc.oe.Km,Hc=new Float32Array(4),Zc=new Float32Array(3),Ic=N.get_trans_view(Cc.g.i),
$c=N.get_quat_view(Cc.g.i);N.transform_vec3(Ic,qc,Zc);R.multiply(sa,$c,Hc);Mb.trans=Zc;Mb.quat=Hc;Mb.bounding_type=Dc;Mb.worker_bounding=r(k(Dc,Cc.g));Rc.push(Mb)}xb=Rc}else xb=[];G.C(q,G.oz,aa,W,B,x,Q,C,L,O,S,E,P,qa,fa,ba,ea,v,ec,na,X,y,xb,pc);ya[aa]=n;J.push(n);var lb=H(aa);lb.type=x;lb.Me=L;lb.vn=Q;lb.Ya=ha;lb.yk=qa;l=lb;a.o=l;var Ib={I:null,o:l};m.push(Ib);b(c,f,l.Ya)}else for(var Bc=M.Sa(a,c).T,vb=0;vb<Bc.length;vb++){var ob=Bc[vb],Ua;if(Ua="PHYSICS"==ob.type){var Ra;a:{for(var jc=c.tb.s,db=
0;db<jc.length;db++){var zb=jc[db].I;if(zb&&zb.id==ob.id){Ra=!0;break a}}Ra=!1}Ua=!Ra}if(Ua)if(ob.Bd.fa)if(ob.Ng&&c.k.Tb){var ab=ob,Ka=c,eb=f,bb=Ka.k.Tb;G.C(eb,G.xz,bb.Og);if(ab.kJ){var La={};La.dst_noise_scale0=ab.dst_noise_scale0;La.dst_noise_scale1=ab.dst_noise_scale1;La.dst_noise_freq0=ab.dst_noise_freq0;La.dst_noise_freq1=ab.dst_noise_freq1;La.dir_min_shore_fac=ab.dir_min_shore_fac;La.dir_freq=ab.dir_freq;La.dir_noise_scale=ab.dir_noise_scale;La.dir_noise_freq=ab.dir_noise_freq;La.dir_min_noise_fac=
ab.dir_min_noise_fac;La.dst_min_fac=ab.dst_min_fac;La.waves_hor_fac=ab.waves_hor_fac;var Ea=bb.waves_height,Jb=bb.waves_length;bb.Ag?G.C(eb,G.jt,La,bb.Fj[0],bb.Fj[1],bb.Ej[0],bb.Ej[1],bb.lr,Ea,Jb,bb.ks,Ka.k.js):G.C(eb,G.jt,La,0,0,0,0,0,Ea,Jb,0,null)}}else{var Ga;if(ob.Zl){var rc=a,fb=ob,sc=f,tc=t(),gc=fb.Bd,Vc=gc.D[0].a_position,Ec=gc.Ia||null,Vb=fb.Ya,Wb=e(Vb),Ab=fb.zk,Jc=fb.xk,nb=fb.Ak,Bb=N.get_trans_view(rc.g.i);G.C(sc,G.uz,tc,Vc,Ec,Bb,Wb,Ab,Jc,nb);var gb=H(tc);gb.vn=!0;gb.Ya=Vb;gb.yk=Wb;Ga=gb}else{var Cb=
a,Na=ob,hb=f,wb=t(),Lb=Na.Bd,Kc=Lb.D[0].a_position,Rb=Lb.Ia||null,Kb=N.get_trans_view(Cb.g.i),pb=Na.Yk,Lc=Na.Pk,qb=Na.Ya,Db=e(qb);G.C(hb,G.wz,wb,Kc,Rb,Kb,pb,Lc,Db,Na.zk,Na.xk,Na.Ak);var Xb=H(wb);Xb.Ya=qb;Xb.yk=Db;Ga=Xb}l=Ga;Ib={I:ob,o:l};m.push(Ib);b(c,f,l.Ya)}else F.error("Object "+a.name+" has collision material with no assigned vertices")}if(w(a)||I(a)){var Ma=a,Ya=f,Wa=Ma.o.A;w(Ma)?(Ma.l.type=10,G.C(Ya,G.pz,Wa,Ma.l.zs,Ma.l.Bs,Ma.l.As,Ma.l.$s,Ma.l.mr)):I(Ma)&&(Ma.l.type=20,G.C(Ya,G.nz,Wa,Ma.l.th,
Ma.l.mi,Ma.l.ni));if(Ma.l.Uh){var Va=Ma.l.Uh;switch(Ma.l.type){case 10:u(Va[1],Ma,Wa,!0,Ya);u(Va[0],Ma,Wa,!0,Ya);u(Va[3],Ma,Wa,!1,Ya);u(Va[2],Ma,Wa,!1,Ya);break;case 20:for(var Aa=0;Aa<Va.length;Aa++)u(Va[Aa],Ma,Wa,!1,Ya)}}A(a,a.l,f)}else if(a.is_character){var Yb=f,rb=a.g,Sb=a.o,Sa=rb.bc.max_y-rb.bc.min_y,kc=Sb.A,sb=a.Yt,tb=sb.jJ,Nb=sb.zG,hc=sb.HH,Ob=sb.UE,uc=sb.lJ,Tb=oa.PC(a);G.C(Yb,G.qz,kc,Tb,Sa,tb,Nb,hc,Ob,uc);Sb.is_character=!0}else if(T(a)){var Pb=a,Eb=f,Oa=Pb.o.A;G.C(Eb,G.tz,Oa,Pb.Od.th,Pb.Od.mi,
Pb.Od.ni);if(Pb.Od.Fm)for(var Ta=Pb.Od.Fm,ib=0;ib<Ta.length;ib++){var bc=Ta[ib],Zb=N.get_trans_view(bc.g.i),Fb=N.invert(Pb.g.i,ma),cc=new Float32Array(3);N.transform_vec3(Zb,Fb,cc);G.C(Eb,G.mz,Oa,cc,bc.fB)}Pb.o.KE=!0}for(vb=0;vb<J.length;vb++)if(a=J[vb],a.o){var jb=a;if(!z(jb))for(var Qb=0;Qb<jb.Fr.length;Qb++){var kb=jb.Fr[Qb],lc=kb.target,vc=kb.XF;if(lc.o){var mc=new Float32Array([kb.YF,kb.ZF,kb.$F]),dc,wc=new Float32Array([kb.Be,kb.Ce,kb.De]);dc=oa.euler_to_quat(wc,new Float32Array(4));var $b=
N.identity(ma),$b=N.set_trans(mc,$b),$b=N.set_quat(dc,$b),Sc=N.multiply(jb.g.i,$b,ma),Fc=N.invert(lc.g.i,ga),Mc=N.multiply(Fc,Sc,Fc),Gb=N.get_trans_view(Mc),nc=N.get_quat_view(Mc),cb=kb,Pa={};Pa.use_limit_x=cb.MI;Pa.use_limit_y=cb.NI;Pa.use_limit_z=cb.OI;Pa.use_angular_limit_x=cb.HI;Pa.use_angular_limit_y=cb.II;Pa.use_angular_limit_z=cb.JI;Pa.limit_max_x=cb.dF;Pa.limit_min_x=cb.gF;Pa.limit_max_y=cb.eF;Pa.limit_min_y=cb.hF;Pa.limit_max_z=cb.fF;Pa.limit_min_z=cb.iF;Pa.limit_angle_max_x=cb.YE;Pa.limit_angle_min_x=
cb.aF;Pa.limit_angle_max_y=cb.ZE;Pa.limit_angle_min_y=cb.bF;Pa.limit_angle_max_z=cb.$E;Pa.limit_angle_min_z=cb.cF;D(vc,jb,mc,dc,lc,Gb,nc,Pa,null,null)}}}};a.lD=g;a.update=function(a,b){for(var c=0;c<la.length;c++){var d=la[c],f=a;d&&G.Ev(d)&&G.C(d,G.aA,f,b);for(var e=0;e<J.length;e++){var g=J[e],h=g.o;if(h.Bg&&h.Tm){var k=G.Ev(d)?f-h.Tm:performance.now()/1E3-h.Tm,k=Math.min(k,10/ba.me),k=k-1/ba.me;E.LF&&(k=0);var m=ma;N.GE(h.Yp,k,h.Le,h.ze,ma);ha.set_tsr(g,m);ha.m(g);C(g);if(g.l)for(var h=g,k=h.l.Uh,
m=h.g.i,l=ma,r=0;r<k.length;r++){var n=k[r];N.multiply(m,h.l.zl[r],l);ha.set_tsr(n,l);ha.m(n)}g.l&&g.l.Nj&&(l=g,k=l.l,h=k.Nj)&&(r=l.l.Ex,N.multiply(l.g.i,l.l.Fx,h.g.i),m=Q,N.transform_dir_vec3(r,l.g.i,m),l=sa,R.setAxisAngle(m,-k.Lj*k.Mj*2*Math.PI,l),k=N.get_quat_view(h.g.i),R.multiply(l,k,k),ha.m(h));g.l&&g.l.ss&&(l=g,k=l.l,h=k.ss)&&(r=l.l.zx,N.multiply(l.g.i,l.l.Ax,h.g.i),m=Q,N.transform_dir_vec3(r,l.g.i,m),l=sa,r=Math.abs(k.speed)*k.Nl,r>k.jj&&(r=k.jj),R.setAxisAngle(m,-r,l),k=N.get_quat_view(h.g.i),
R.multiply(l,k,k),R.normalize(k,k),ha.m(h));g.l&&g.l.Cs&&(m=g,h=m.l,g=h.Cs)&&(l=m.l.Ox,N.multiply(m.g.i,m.l.Px,g.g.i),k=Q,N.transform_dir_vec3(l,m.g.i,k),m=sa,R.setAxisAngle(k,-Math.abs(h.Hi)*h.Jk,m),h=N.get_quat_view(g.g.i),R.multiply(m,h,h),R.normalize(h,h),ha.m(g))}}G.cG(d);d=ia[c];(f=d.k.Tb)&&0<f.waves_height&&(d=S.X(d,"MAIN_OPAQUE"),f=fa.length(d.Lf),G.C(la[c],G.Yz,d.time*f))}};a.QD=function(){return ia[0]};a.pause=function(){for(var a=0;a<la.length;a++)G.C(la[a],G.Jz)};a.resume=function(){for(var a=
0;a<la.length;a++)G.C(la[a],G.Oz)};a.enable_simulation=function(a){a=a.o;if(!a)throw"No object physics";if(!a.Bg){var b=a.A,c=y(b);a.Bg=!0;G.C(c,G.Hz,b)}};a.disable_simulation=function(a){a=a.o;if(!a)throw"No object physics";if(a.Bg){var b=a.A,c=y(b);a.Bg=!1;G.C(c,G.Gz,b)}};a.eo=function(a){return Boolean(a.tb)};a.R=function(a){return Boolean(a.o)};a.has_dynamic_physics=function(a){return(a=a.o)&&a.Bg&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Me&&0==a.vn?!0:!1};a.has_simulated_physics=function(a){return(a=
a.o)&&a.Bg?!0:!1};a.set_gravity=function(a,b){var c=a.o.A;G.C(y(c),G.Xz,c,b)};a.zE=z;a.apply_constraint=D;a.clear_constraint=function(a){a=a.o;G.C(y(body_a),G.Mz,a.Nm);a.Nm=null};a.pull_to_constraint_pivot=function(b,c,d,f,e,g){c=N.set_sep(c,1,d,ma);e=N.set_sep(e,1,g,ga);N.invert(c,c);N.multiply(e,c,c);ha.get_tsr(f,e);N.multiply(e,c,c);ha.set_tsr(b,c);ha.m(b);f=N.get_trans_view(b.g.i);e=N.get_quat_view(b.g.i);a.set_transform(b,f,e)};a.set_transform=function(a,b,c){var d=a.o,f=N.get_trans_view(a.g.i);
a=N.get_quat_view(a.g.i);N.set_sep(f,1,a,d.Yp);f=G.fv(G.km);f.A=d.A;f.trans=b;f.quat=c;G.C(y(d.A),G.km)};a.sync_transform=C;a.apply_velocity=function(a,b,c,d){v(a,b,c,d,Q);a=a.o.A;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(Q[0]),e=Math.abs(Q[1]),g=Math.abs(Q[2]);Q[0]=f?Q[0]/f*Math.max(f,b):0;Q[1]=e?Q[1]/e*Math.max(e,c):0;Q[2]=g?Q[2]/g*Math.max(g,d):0;G.C(y(a),G.lt,a,Q[0],Q[1],Q[2])};a.apply_velocity_world=function(a,b,c,d){a=a.o.A;G.C(y(a),G.lt,a,b,c,d)};a.apply_force=function(a,b,c,
d){v(a,b,c,d,Q);a=a.o.A;G.C(y(a),G.yz,a,Q[0],Q[1],Q[2])};a.apply_torque=function(a,b,c,d){v(a,b,c,d,Q);a=a.o.A;G.C(y(a),G.Az,a,Q[0],Q[1],Q[2])};a.set_character_move_dir=function(a,b,c){a=a.o.A;G.C(y(a),G.Rz,a,b,c)};a.set_character_move_type=function(a,b){var c=a.o.A;G.C(y(c),G.Sz,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.o.A;G.C(y(c),G.Wz,c,b)};a.set_character_run_velocity=function(a,b){var c=a.o.A;G.C(y(c),G.Uz,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.o.A;G.C(y(c),
G.Pz,c,b)};a.character_jump=function(a){a=a.o.A;G.C(y(a),G.Cz,a)};a.character_rotation_inc=function(a,b,c){a=a.o.A;G.C(y(a),G.Dz,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.o.A;G.C(y(a),G.Tz,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.o.A;G.C(y(c),G.Qz,c,b)};a.set_character_rotation_v=function(a,b){var c=a.o.A;G.C(y(c),G.Vz,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.o,g=e.A;b=b||"ANY";for(var h=0;h<e.Ic.length;h++)if(a=e.Ic[h],a.Ya==b&&a.callback==c)return;a={tp:g,
Fe:d||!1,Ya:b,callback:c,qg:[],sl:[]};e.Ic.push(a);b=y(g);f(a,n(b),b)};a.remove_collision_test=function(a,b,c){a=a.o;for(var d=y(a.A),f=n(d),e=0;e<a.Ic.length;e++){var g=a.Ic[e];if(g.Ya==b&&g.callback==c){if(l(g)){var h=fa.set(0,0,0,Q);g.callback(!1,null,h,h,0)}a.Ic.splice(e,1);e--;for(var h=d,g=g.qg,k=f.tb.s,m=0;m<k.length;m++)for(var r=k[m].o,q=0;q<r.Ic.length;q++)for(var t=r.Ic[q],u=0;u<t.qg.length;u++)for(var p=t.qg[u],w=0;w<g.length;w++){var x=g[w];p[0]==x[0]&&p[1]==x[1]&&(g.splice(w,1),w--)}g.length&&
G.C(h,G.kt,g)}}};a.apply_collision_impulse_test=function(a,b){a.o&&a.o.ih&&h(a);var c=a.o;G.C(y(c.A),G.zz,c.A);c.ih=b};a.clear_collision_impulse_test=h;a.append_ray_test=function(a,b,c,d,f,g,h,k,m){var l;W.Tw++;l=W.Tw;d=d||"ANY";a={id:l,A:a?a.o.A:0,from:new Float32Array(b),to:new Float32Array(c),Ya:d,yk:e(d),It:g,jB:h,Fe:k,pn:m,callback:f};b=y(a.A)||la[0];c=n(b).tb;l=a.id;c.tg[l]=a;c.Mr.push(a);G.C(b,G.vz,a.id,a.A,a.from,a.to,a.yk,a.It,a.jB,a.Fe,a.pn);return l};a.remove_ray_test=x;a.change_ray_test_from_to=
function(a,b,c){var d=P(a),f=L(a).tb.tg[a];f&&!f.It&&(f.from.set(b),f.to.set(c),G.C(d,G.Bz,a,b,c))};a.Lv=function(a){return L(a).tb.tg[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.l;c.Hi=b;A(a,c,y(a.o.A))};a.vehicle_steer=function(a,b){var c=a.l;c.Lj=b;A(a,c,y(a.o.A))};a.vehicle_brake=function(a,b){var c=a.l;c.nk=b;A(a,c,y(a.o.A))};a.is_vehicle_chassis=w;a.is_vehicle_hull=I;a.JE=function(a){if(!a.Mc)return!1;a=a.Zc.Oc;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||
"WHEEL_BACK_RIGHT"==a?!0:!1};a.HE=function(a){return a.Mc?"BOB"==a.Zc.Oc?!0:!1:!1};a.LE=function(a){return a.Bh?"BOB"==a.Ji.Oc?!0:!1:!1};a.Nv=function(a){return a.Mc&&"STEERING_WHEEL"==a.Zc.Oc?!0:!1};a.Mv=function(a){return a.Mc&&"SPEEDOMETER"==a.Zc.Oc?!0:!1};a.Ov=function(a){return a.Mc&&"TACHOMETER"==a.Zc.Oc?!0:!1};a.get_vehicle_speed=function(a){return a.l.speed};a.nJ=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};
a.is_character=function(a){return a.is_character};a.zL=T;a.fE=function(){return qa};a.IC=function(){for(var a=0;a<la.length;a++)G.C(la[a],G.Fz)};a.mG=function(a){var b=J.indexOf(a);-1==b&&F.error("Object "+a.name+" doesn't have bounding physics");for(var c=a.o.A,d=y(c),f=n(d),e=f.tb.s,g=[],k=0;k<e.length;k++)for(var m=e[k].o,r=0;r<m.Ic.length;r++)for(var q=m.Ic[r],t=0;t<q.qg.length;t++){var u=q.qg[t],p=q.sl[t];if(u[0]==c||u[1]==c)q.qg.splice(t,1),q.sl.splice(t,1),t--,p&&!l(q)&&(p=fa.set(0,0,0,Q),
q.callback(!1,null,p,p,0)),g.push(u)}g.length&&G.C(d,G.kt,g);a.o&&a.o.ih&&h(a);delete ya[c];J.splice(b,1);a=f.tb.s;for(b=0;b<a.length;b++)a[b].o.A==c&&(a.splice(b,1),b--);G.C(d,G.Lz,c)}};b4w.module.__data=function(a,p){function d(a,b){ra[b.id]=null;ic[b.id]=null}function b(a,b,c){var d;a instanceof ArrayBuffer&&(a=sa.lv(a));d=a.width;a=a.height;K.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(ta)&&c&&K.warn("image",b,"is not from app root.")}function c(a,b,c,d,f,e){d=b.qf;if(!d)throw"Nothing requested";J.enqueue([{id:d,type:J.AT_JSON,url:d}],function(d,e,g,h){if(d){K.log("%cLOAD METADATA","color: #616",h);e=ka.Gx(d.b4w_format_version);
switch(ka.qy(e,Da.Ih)){case -1:e[0]<Da.Ih[0]?ka.Z("JSON version is too old relative to B4W engine: "+ka.Lg(e)+", required: "+ka.Lg(Da.Ih)+". Reexport scene with the latest B4W addon to fix it."):K.warn("JSON version is a bit old relative to B4W engine: "+ +ka.Lg(e)+", required: "+ka.Lg(Da.Ih)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:e[0]>Da.Ih[0]?ka.Z("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
K.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Da.hr=e;for(var k in d)a[k]=d[k];b.Ta&&(Ha=xa.dn(a.scenes));(d=a.binaries[0].binfile)?b.Kt=d:(ga.no(b,"load_binaries"),ga.no(b,"prepare_bindata"));Da.gg||ga.no(b,"mobile_media_start");Da.antialiasing&&Da.smaa||ga.no(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Ta&&"PRIMARY"==k.type||"ALL"==k.type)&&
K.cD(k.text);if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Ta&&"PRIMARY"==k.type||"ALL"==k.type)&&K.dD(k.text);f(b,c)}else ga.ut(b)},null,function(a){e(b,c,a)})}function n(a,b,c,d,f,e){d=ea(b.qf)+b.Kt;if(!d)throw"Binary data is missing";J.enqueue([{id:d,type:J.AT_ARRAYBUFFER,url:d}],function(d,e,g,h){d?(K.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,d=l(d),e=ka.Gx(a.b4w_format_version),d[0]!=e[0]&&ka.Z("BIN version does not match to JSON version: "+
ka.Lg(d)+", required: "+ka.Lg(Da.Ih)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=e[1]&&K.warn("BIN version does not match to JSON version: "+ +ka.Lg(d)+", required: "+ka.Lg(Da.Ih)+". Some compatibility issues can occur. Reexport scene to fix it."),f(b,c)):ga.ut(b)},null,function(a){e(b,c,a)})}function g(a,b,c,d,f){aa.DB()&&f(b,c)}function q(a,b,c,d,f){d=a.bin_data;var e=a.binaries[0],g=a.objects,h=a.meshes;a=a.actions;for(var k=ka.AB(),m=l(d),m=5<=m[0]&&4<m[1]?12:0,r=["indices"],
n=["normal","tangent"],q=["color","group"],u=["position","texcoord","texcoord2"],U=0;U<h.length;U++)for(var aa=h[U].submeshes,p=0;p<aa.length;p++)for(var w in aa[p]){var x=aa[p][w][1];if(-1!=r.indexOf(w)){var J=4*aa[p][w][0]+e["int"]+m,v=aa[p],X=w,z=d;if(k)var F=new Uint32Array(z,J,x);else for(var F=new Uint32Array(x),z=new DataView(z),Ja=0;Ja<x;Ja++)F[Ja]=z.getUint32(J+4*Ja,!0);v[X]=F}else if(-1!=u.indexOf(w))J=4*aa[p][w][0]+e["float"]+m,aa[p][w]=t(d,J,x,k);else if(-1!=n.indexOf(w)){J=2*aa[p][w][0]+
e["short"]+m;v=aa[p];X=w;z=d;F=new Float32Array(x);z=new DataView(z);for(Ja=0;Ja<x;Ja++)F[Ja]=z.getInt16(J+2*Ja,!0)/32767;v[X]=F}else if(-1!=q.indexOf(w)){J=2*aa[p][w][0]+e.ushort+m;v=aa[p];X=w;z=d;F=new Float32Array(x);z=new DataView(z);for(Ja=0;Ja<x;Ja++)F[Ja]=z.getUint16(J+2*Ja,!0)/65535;v[X]=F}}for(w=0;w<g.length;w++)for(h=g[w].particle_systems,r=0;r<h.length;r++)n=h[r],n.transforms=t(d,4*n.transforms[0]+e["float"]+m,n.transforms[1],k);for(g=0;g<a.length;g++){w=a[g];h=w.fcurves;r=w.frame_range;
q=r[0];u=r[1];U=ya.UD(q,u);r=null;0>U&&(U=0);var p=aa=!1,pa;for(pa in h)aa|=-1<pa.indexOf("rotation_euler"),p|=-1<pa.indexOf("rotation_quaternion");n=[];for(pa in h)if(aa&&p&&-1<pa.indexOf("rotation_euler"))delete h[pa];else{var x=h[pa],A;for(A in x)J=x[A],v=t(d,e["float"]+4*J.bin_data_pos[0]+m,J.bin_data_pos[1],k),X=new Float32Array(U),null===r&&(r=new Int8Array(U)),ya.OA(J,v,X,r,q,u),J.bd=X;-1<pa.indexOf("rotation_euler")&&(ya.kD(h[pa]),n.push(pa))}for(q=0;q<n.length;q++)u=n[q],U=u.replace("euler",
"quaternion"),h[U]=h[u],delete h[u];w.hA=r}f(b,c)}function l(a){var b=new Uint8Array(a,0,4),c=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<b.length;d++)if("B4WB"[d]!=String.fromCharCode(b[d])){c=5;a=4;break}return[c,a]}function t(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var f=0;f<c;f++)d[f]=a.getFloat32(b+4*f,!0)}return d}function e(a,b,c,d,e){var g=a.cameras,h=a.groups,k=a.materials,l=a.meshes,n=a.node_groups,q=a.objects,
t=a.particles,u=a.scenes,U=a.speakers,aa=a.lamps,p=a.textures,w=a.worlds;n||(K.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);for(var x="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),J={},v=0;v<x.length;v++)for(var X=a[x[v]],z=0;z<X.length;z++){var F=X[z];J[F.uuid]=F}for(var A=0;A<u.length;A++){for(var V=u[A],y=V.objects,W=0;W<y.length;W++)m(y,W,J);V.camera&&
m(V,"camera",J);V.world&&m(V,"world",J)}for(A=0;A<h.length;A++)for(var Ca=h[A].objects,W=0;W<Ca.length;W++)m(Ca,W,J);for(A=0;A<q.length;A++){var I=q[A];I.dupli_group&&m(I,"dupli_group",J);I.parent&&m(I,"parent",J);I.dg_parent&&m(I,"dg_parent",J);if(I.animation_data){var B=I.animation_data;B.action&&m(B,"action",J);if(B.nla_tracks)for(W=0;W<B.nla_tracks.length;W++)for(var D=B.nla_tracks[W],Q=0;Q<D.strips.length;Q++)D.strips[Q].action&&m(D.strips[Q],"action",J)}switch(I.type){case "MESH":if(!I.data)throw"mesh not found for object "+
I.name;m(I,"data",J);for(var C=!1,L=I.modifiers,W=0;W<L.length;W++){var wa=L[W];"ARMATURE"==wa.type?(C&&K.warn('Object "'+I.name+'" has more than one armature modifiers. Only the first one will be used.'),C=!0,m(wa,"object",J)):"CURVE"==wa.type&&m(wa,"object",J)}var R=I.particle_systems;if(R)for(W=0;W<R.length;W++)m(R[W],"settings",J);break;case "ARMATURE":m(I,"data",J);for(var O=I.pose.bones,S=I.data.bones,W=0;W<O.length;W++){var Da=O[W];Da.bone=S[Da.bone];var E=Da.constraints;if(E)for(Q=0;Q<E.length;Q++){var Za=
E[Q];Za.target&&m(Za,"target",J)}for(var M=Da.parent_recursive,Q=0;Q<M.length;Q++)M[Q]=O[M[Q]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":m(I,"data",J)}if(E=I.constraints)for(W=0;W<E.length;W++)Za=E[W],Za.target&&m(Za,"target",J);var N=I.lod_levels;if(N)for(W=0;W<N.length;W++){var T=N[W];T.object&&m(T,"object",J)}}for(A=0;A<l.length;A++)for(var sa=l[A].materials,W=0;W<sa.length;W++)m(sa,W,J);for(A=0;A<k.length;A++){for(var ma=k[A],mb=ma.texture_slots,W=0;W<mb.length;W++)m(mb[W],"texture",
J);var P=ma.node_tree;P&&f(P,J)}for(A=0;A<n.length;A++)(P=n[A].node_tree)&&f(P,J);for(A=0;A<p.length;A++){var ra=p[A],Z=ra.type;"IMAGE"!=Z&&"ENVIRONMENT_MAP"!=Z||m(ra,"image",J)}for(A=0;A<g.length;A++){var ha=g[A];ha.dof_object&&m(ha,"dof_object",J)}for(A=0;A<U.length;A++){var ga=U[A];ga.sound&&m(ga,"sound",J);if(ga.animation_data&&(B=ga.animation_data,B.action&&m(B,"action",J),B.nla_tracks))for(W=0;W<B.nla_tracks.length;W++)for(D=B.nla_tracks[W],Q=0;Q<D.strips.length;Q++)D.strips[Q].action&&m(D.strips[Q],
"action",J)}for(A=0;A<t.length;A++){for(var qa=t[A],mb=qa.texture_slots,W=0;W<mb.length;W++)m(mb[W],"texture",J);qa.dupli_group&&m(qa,"dupli_group",J);qa.dupli_object&&m(qa,"dupli_object",J)}for(A=0;A<aa.length;A++){var Y=aa[A];if(Y.animation_data&&(B=Y.animation_data,B.action&&m(B,"action",J),B.nla_tracks))for(W=0;W<B.nla_tracks.length;W++)for(D=B.nla_tracks[W],Q=0;Q<D.strips.length;Q++)D.strips[Q].action&&m(D.strips[Q],"action",J)}for(A=0;A<w.length;A++){var la=w[A];if(mb=la.texture_slots)for(W=
0;W<mb.length;W++)m(mb[W],"texture",J);if(la.animation_data&&(B=la.animation_data,B.action&&m(B,"action",J),B.nla_tracks))for(W=0;W<B.nla_tracks.length;W++)for(D=B.nla_tracks[W],Q=0;Q<D.strips.length;Q++)D.strips[Q].action&&m(D.strips[Q],"action",J)}va.wB(a);for(var ta=a.textures,oc=b.Ta?a.scenes[0].b4w_anisotropic_filtering:Ha.b4w_anisotropic_filtering,fa=0;fa<ta.length;fa++)b.Ta||"SCENE"!=ta[fa].b4w_source_type||(ta[fa].b4w_source_id=""),pa.vC(ta[fa],oc,a.scenes,b.id);for(var ia={},ba=a.objects,
oa=0;oa<ba.length;oa++){var ea=ba[oa];if("MESH"===ea.type&&!ea.particle_systems.length)for(var Qa=ea.data,na=Qa.name,Hb=Qa.submeshes,Fa=Qa.materials,Xa=0;Xa<Hb.length;Xa++)0!==Hb[Xa].base_length||ia[na]||(Fa[Xa]&&K.warn('material "'+Fa[Xa].name+'" is not assigned to any face (object "'+ea.name+'").'),ia[na]=!0)}for(var ua=a.meshes,ja=0;ja<ua.length;ja++){var za=ua[ja];za.materials.length||za.uv_textures.length&&K.warn('mesh "'+za.name+'" has a UV map but has no exported material.')}a.materials.push(va.fC());
for(var $a=a.meshes,Uc=ka.keysearch("name","DEFAULT",a.materials),pc=0;pc<$a.length;pc++){var xb=$a[pc];0==xb.materials.length&&xb.materials.push(Uc)}for(var Tb=a.actions,Pb=b.id,Eb=0;Eb<Tb.length;Eb++){var Oa=Tb[Eb];Oa.iA=Pb;ya.qA(Oa)}for(var Ta=a.scenes,ib=0;ib<Ta.length;ib++){for(var bc=Ta[ib],Zb=[],Fb=[],cc=Ta[ib].objects,jb=0;jb<cc.length;jb++){var Qb=cc[jb];G(cc,Qb,Zb,Fb);var kb=Qb.dupli_group;if(kb)for(var lc=kb.objects,vc=0;vc<lc.length;vc++)G(lc,lc[vc],Zb,Fb)}for(jb=0;jb<Fb.length;jb++)for(var mc=
Fb[jb],dc=[bc],wc=0;wc<dc.length;wc++){for(var $b=dc[wc].objects,Sc=0;Sc<$b.length;Sc++){var Fc=$b[Sc].dupli_group;if(Fc){var Mc=Fc.objects,Gb=Mc.indexOf(mc);-1<Gb&&Mc.splice(Gb,1)}}var Gb=$b.indexOf(mc);-1<Gb&&$b.splice(Gb,1)}for(jb=0;jb<Zb.length;jb++)ka.JA(Zb[jb][0],Zb[jb][1])}!b.Ta&&1<a.scenes.length&&(a.scenes=[xa.dn(a.scenes)],K.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var nc=b.Ta?Ha:xa.dn(a.scenes);Ja.OG(Ha.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ha),
1),a.scenes.unshift(Ha));for(var cb=0;cb<a.scenes.length;cb++){var Pa=a.scenes[cb];Pa.k={};Pa.st=Pa==nc;Pa.jA=b.Ta;Ac.enabled&&Pa.b4w_enable_physics&&(b.Ta||!da.eo(Ha)&&Pa==xa.dn(a))&&da.FE(Pa);b.Ta?Pa.b4w_enable_audio&&Ba.Gt(Pa):Pa.b4w_enable_audio&&!Ha.ya&&Ba.Gt(Ha)}for(var ac=0;ac<a.scenes.length;ac++){for(var xc=a.scenes[ac],yc=H(xc),pd=0;pd<yc.length;pd++){var Ub=yc[pd];ca.xB(Ub,xc,a)&&(Ub.Vb||(Ub.Vb=[]),Ub.Vb.push(b.Ta?xc:Ha))}for(var ud=yc,qd=0;qd<ud.length;qd++){var Nc=ud[qd];if(Nc.Vb&&"WORLD"!=
Nc.type)for(var rd=Nc.particle_systems,ad=0;ad<rd.length;ad++){var Oc=rd[ad].settings;if("HAIR"==Oc.type)if("OBJECT"==Oc.render_type){var bd=Oc.dupli_object;bd.Vb||(bd.Vb=Nc.Vb.slice())}else if("GROUP"==Oc.render_type)for(var vd=Oc.dupli_group,Wc=0;Wc<vd.objects.length;Wc++)bd=vd.objects[Wc],bd.Vb||(bd.Vb=Nc.Vb.slice())}}}for(var cd=a.scenes,dd=[],ub=0;ub<cd.length;ub++)r(cd[ub].objects,0,b.Ta,dd);ic[b.id]=[];for(ub=0;ub<dd.length;ub++)for(var Xc=dd[ub],Gc=0;Gc<Xc.length;Gc++)for(var Yc=Xc[Gc],ed=
0;ed<Yc.length;ed++)ic[b.id].push(Yc[ed]);for(var Tc=a.particles,ub=0;ub<Tc.length;ub++){var Pc=Tc[ub].dupli_object;Pc&&(Pc.rt=!0,ic[b.id].push(Pc));var ld=Tc[ub].dupli_group;if(ld)for(var fd=ld.objects,Gc=0;Gc<fd.length;Gc++)Pc=fd[Gc],Pc.rt=!0,ic[b.id].push(Pc)}for(var gd=ic[b.id],ub=gd.length-1;0<=ub;ub--)gd[ub].Vb||gd.splice(ub,1);for(var md=ic[b.id],ac=0;ac<md.length;ac++)if(Ub=md[ac],!b.Ta&&Ub.parent&&-1<ec.indexOf(Ub.parent.type)&&(Ub.parent=""),"MESH"==Ub.type){var hd=va.MA(Ub);hd&&(a.meshes.push(hd),
Ub.data=hd)}for(var sd=0;sd<a.scenes.length;sd++){var nd=a.scenes[sd],jd=nd.world;jd.Vb||(jd.Vb=[]);jd.Vb.push(b.Ta?nd:Ha)}for(var od=0;od<a.scenes.length;od++){var zc=a.scenes[od];if(zc.b4w_use_logic_editor){var kd=H(zc);va.TA(kd,zc)}}e(b,c)}function H(a){var b=[];k(a.objects,"ALL",b);return b}function k(a,b,c){for(var d=0;d<a.length;d++){var f=a[d];"ALL"!=b&&b!=f.type||c.push(f);(f=f.dupli_group)&&k(f.objects,b,c)}}function r(a,b,c,d){d[b]=d[b]||[];for(var f=d[b],e=0;e<a.length;e++){var g=a[e],
h=la(g);f[h]=f[h]||[];(c||-1==ec.indexOf(g.type))&&-1==f[h].indexOf(g)&&f[h].push(g);(g=g.dupli_group)&&r(g.objects,b+1,c,d)}}function u(a,b,c){var d=[];a=ic[a];for(var f=0;f<a.length;f++){var e=a[f];if(e.type==c||"ALL"==c)for(var g=0;g<e.Vb.length;g++)b==e.Vb[g]&&d.push(e)}return d}function z(a,b,c,d,f){var e=ic[b.id],g=a.worlds;d=b.id;for(var h=0;h<e.length;h++){for(var k=e[h],m=ja.Ai(k.name,k.type,k.origin_name),l=0;l<k.Vb.length;l++)ja.ti(m,k.Vb[l]);k.oa=m;ca.Ig(k,m);m.g.Jc=d;m.ll=k.rt||!1}for(d=
0;d<g.length;d++){h=g[d];k=ja.Ai(h.name,"WORLD",h.name);for(m=0;m<h.Vb.length;m++)ja.ti(k,h.Vb[m]);h.oa=k;ca.FI(h,k)}d=ca.get_all_objects(b.id);for(h=0;h<e.length;h++)k=e[h],m=k.oa,Y.Ig(k,m);for(h=0;h<g.length;h++)k=g[h],Y.Ig(k,k.oa);if(b.Ta)for(g=b.id,h=0;h<a.scenes.length;h++)for(var k=a.scenes[h],m=0,l=ca.Ga(k,"LAMP",g),r=0;r<l.length;r++)ja.Sa(l[r],k).Ch=m++;for(h=0;h<e.length;h++)k=e[h],m=k.oa,m.ll||(ca.vI(k,m),X.m(m));for(a=0;a<e.length;a++)if(g=e[a],h=g.oa,ja.is_mesh(h)&&(k=g.lod_levels.length))for(m=
h,l=0;l<k;l++)if(r=g.lod_levels[l].object){r=r.oa;r.g.Fh=h.g.Fh;m.g.ig=g.lod_levels[l].distance;r.g.ol=g.lod_levels[l].distance;if(g.lod_levels[l+1])r.g.ig=g.lod_levels[l+1].distance;else{r.g.zn=!0;r.g.ig=1E6;break}m.g.zn=!1;m=r}else{m.g.zn=!0;m.g.ig=g.lod_levels[l].distance;break}for(e=0;e<d.length;e++)if(a=d[e],"MESH"==a.type&&(g=a.xm)){var g=g.g,h=a.g.xi,k=[],n;for(n in h)m=h[n],k.push(4*m.cq,4*m.Vf);g.hw.push(k);g.mo.push(a.g)}e=n=-1;a=ya.ev();for(g=0;g<d.length;g++)h=d[g],k=h.g,ja.is_mesh(h)&&
k.dj&&(h=k.yf,h>n&&(n=h),a>=h&&h>e&&(e=h));for(g=0;g<d.length;g++)h=d[g],k=h.g,ja.is_mesh(h)&&k.dj&&(k.Xk=!0,n<a?k.yf=n:k.yf<=a?k.yf=e:(K.warn('too many bones for "'+h.name+'" / '+k.yf+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.yf=n,k.Xk=!1),k.Xk=k.Xk&&!Za.Pu);for(n=0;n<d.length;n++)if(e=d[n],e.Mc)if(a=e.Zc,"CHASSIS"==a.Oc){e.l={};e.l.Uk=a.Uk;e.l.ok=a.ok;e.l.zs=a.zs;e.l.Bs=a.Bs;e.l.As=a.As;e.l.$s=a.$s;e.l.Sr=a.Sr;e.l.mr=a.mr;e.l.Hi=0;
e.l.nk=1;e.l.Lj=0;e.l.speed=0;e.l.Uh=[];e.l.zl=[];e.l.Nj=null;h=(g=ja.get_dg_parent(e))?ja.Dq(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.Mc&&(m=k.Zc,da.JE(k)&&a.name==m.name?(m=da.nJ(k.Zc.Oc),e.l.Uh[m]=k,e.l.zl[m]=new Float32Array(8)):da.Nv(k)&&a.name==m.name?(e.l.Nj=k,e.l.Mj=m.Mj,e.l.Ql=m.Ql,e.l.jl=m.jl,m=Ca.invert(e.g.i,Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Fx=k,m=new Float32Array([1,0,0]),Ca.transform_dir_vec3(m,k,m),e.l.Ex=m):da.Mv(k)&&a.name==m.name?(e.l.ss=k,e.l.Nl=m.Nl,e.l.jj=m.jj,m=Ca.invert(e.g.i,
Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Ax=k,m=new Float32Array([1,0,0]),Ca.transform_dir_vec3(m,k,m),e.l.zx=m):da.Ov(k)&&a.name==m.name&&(e.l.Cs=k,e.l.Jk=m.Jk,m=Ca.invert(e.g.i,Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Px=k,m=new Float32Array([1,0,0]),Ca.transform_dir_vec3(m,k,m),e.l.Ox=m));if(4!=e.l.Uh.length)throw"Not enough wheels for chassis "+e.name;}else if("HULL"==a.Oc)for(e.l={},e.l.Uh=[],e.l.zl=[],e.l.Uk=a.Uk,e.l.ok=a.ok,e.l.th=a.th,e.l.mi=a.mi,e.l.ni=a.ni,e.l.Hi=0,e.l.nk=1,e.l.Lj=0,e.l.speed=
0,e.l.Nj=null,h=(g=ja.get_dg_parent(e))?ja.Dq(g,d):d,g=0;g<h.length;g++)k=h[g],k.Mc&&(m=k.Zc,da.HE(k)&&a.name==m.name?(e.l.Uh.push(k),e.l.zl.push(new Float32Array(8))):da.Nv(k)&&a.name==m.name?(e.l.Nj=k,e.l.Mj=m.Mj,e.l.Ql=m.Ql,e.l.jl=m.jl,m=Ca.invert(e.g.i,Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Fx=k,m=new Float32Array([1,0,0]),Ca.transform_dir_vec3(m,k,m),e.l.Ex=m):da.Mv(k)&&a.name==m.name?(e.l.ss=k,e.l.Nl=m.Nl,e.l.jj=m.jj,m=Ca.invert(e.g.i,Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Ax=k,m=new Float32Array([1,
0,0]),Ca.transform_dir_vec3(m,k,m),e.l.zx=m):da.Ov(k)&&a.name==m.name&&(e.l.Cs=k,e.l.Jk=m.Jk,m=Ca.invert(e.g.i,Ca.create()),k=Ca.multiply(m,k.g.i,m),e.l.Px=k,m=new Float32Array([1,0,0]),Ca.transform_dir_vec3(m,k,m),e.l.Ox=m));for(n=0;n<d.length;n++)if(e=d[n],e.Bh&&(a=e.Ji,"MAIN_BODY"==a.Oc))for(e.Od={},e.Od.th=a.th,e.Od.mi=a.mi,e.Od.ni=a.ni,e.Od.Fm=[],g=(g=ja.get_dg_parent(e))?ja.Dq(g,d):d,h=0;h<g.length;h++)k=g[h],k.Bh&&(m=k.Ji,da.LE(k)&&a.name==m.name&&(e.Od.Fm.push(k),k.fB=k.Ji.Nx));f(b,c)}function D(a,
b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];e.Tg=e.camera.oa}for(d=0;d<a.scenes.length;d++){var e=b.Ta?a.scenes[d]:Ha,g=b.Ta?ca.Ga(e,"LAMP",b.id):ca.Ga(e,"LAMP",0),h=ca.Ga(e,"ALL",b.id),k=u(b.id,e,"MESH"),m=u(b.id,e,"EMPTY");b.Ta&&xa.wA(e,h,g,k,m);for(var l=0;l<m.length;l++)ca.by(m[l].oa);h=[];xa.set_active(e);V.MD(e,k,g,h);l=u(b.id,e,"LINE");V.LD(e,l);m=xa.dv(e);if(b.Ta){l=e.k.oo;if(l.pG||l.procedural_skydome)l=V.OD(e,l),h.push(l);xa.Tu(m)}for(l=0;l<k.length;l++)V.pu(k[l].oa,m,e);for(l=
0;l<h.length;l++)V.pu(h[l],m,e),ca.PF(h[l]);h=ca.Ga(e,"ALL",b.id);xa.UA(e,h,g);for(l=0;l<h.length;l++)e=h[l],e.g.te&&ca.update_boundings(e)}xa.xA(Ha,a.textures,b.id);b.Ta&&Ha.k.ak.length&&(b.Lq=!0);d=a.materials;if(mb.aq&&Da.jy)for(a=0;a<d.length;a++){k=d[a];l=k.texture_slots;for(e=0;e<l.length;e++)if(h=l[e],m=h.texture,"IMAGE"==m.type||"ENVIRONMENT_MAP"==m.type)g=m.image,g.ad||(-1<g.filepath.indexOf(".dds")?g.ad=!0:(g.ad=!m.b4w_disable_compression&&!h.use_map_normal&&"ENVIRONMENT_MAP"!=m.type&&!m.b4w_shore_dist_map&&
"MOVIE"!=g.source,g.ad&&(g.filepath+=".dds")));if(e=k.node_tree)for(k=e.nodes,e=0;e<k.length;e++)g=k[e],"TEXTURE"==g.type&&(l=g.texture)&&(g=l.image)&&!g.ad&&(g.ad=l.k.sm&&!l.b4w_disable_compression&&"MOVIE"!=g.source&&"ENVIRONMENT_MAP"!=l.type,g.ad&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)e=a[d],e.ad=Boolean("FILE"==e.source&&-1<e.filepath.indexOf(".dds"));f(b,c)}function y(a,b,c,d,f){d=a.groups;for(var e=a.objects,g={},h={},k={},m={},l=0;l<d.length;l++){var r=d[l];g[r.uuid]=
r;k[r.uuid]=r}for(l=0;l<e.length;l++)r=e[l],h[r.uuid]=r,m[r.uuid]=r;a=a.scenes;for(l=0;l<a.length;l++)C(a[l].objects,null,m,k);for(var n in k)n in g||d.push(k[n]);for(n in m)n in h||e.push(m[n]);f(b,c)}function C(a,b,c,d){for(var f=[],e=0;e<a.length;e++){var g=a[e],h=c[g.uuid];if(g=h.proxy){b&&-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var k=c[g.uuid],m=k.constraints,g=0;g<m.length;g++){var l=ka.hh(m[g]);l.name+="_CLONE";h.constraints.push(l)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||
(h.animation_data&&(k.animation_data=ka.hh(h.animation_data)),k.b4w_use_default_animation=h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(e=0;e<f.length;e++)h=ka.hE(a,f[e]),-1<h&&a.splice(h,1);f={};if(b)for(e=0;e<a.length;e++)g=a[e],h=c[g.uuid],m=ka.hh(h),h="origin_name"in h?h.origin_name:h.name,m.name=ja.Su(b.name,h),m.origin_name=h,m.dg_parent={uuid:b.uuid},v(m),c[m.uuid]=m,f[g.uuid]=
m.uuid,g.uuid=m.uuid;for(e=0;e<a.length;e++)g=a[e],h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,m=d[g.uuid],k=ka.hh(m),k.name=ka.Wj(m.name+"_CLONE"),k.uuid=Z.wv("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,C(k.objects,h,c,d));if(b)for(e=0;e<a.length;e++){g=a[e];h=c[g.uuid];h.parent&&h.parent.uuid in f?h.parent.uuid=f[h.parent.uuid]:h.parent&&(K.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);m=h.constraints;for(g=0;g<m.length;g++)b=m[g],b.target&&b.target.uuid in
f&&(b.target.uuid=f[b.target.uuid]);if(b=h.pose)for(d=b.bones,g=0;g<d.length;g++)if(m=d[g].constraints)for(k=0;k<m.length;k++)b=m[k],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var r in f)Xa[r]=f[r]}function v(a){a.uuid=Z.wv("Object"+a.name)}function f(a,
b){for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];"TEXTURE"==f.type&&f.texture&&m(f,"texture",b);"LAMP"==f.type&&f.lamp&&(f.lamp.uuid in Xa&&(f.lamp.uuid=Xa[f.lamp.uuid]),b[f.lamp.uuid]||(f.lamp=null));"GROUP"==f.type&&f.node_group&&m(f,"node_group",b)}f=a.links;for(d=0;d<f.length;d++){var e=f[d];h(e,"from_node",c);h(e,"to_node",c);x(e,"from_socket",e.from_node.outputs);x(e,"to_socket",e.to_node.inputs)}if(c=a.animation_data)if(c.action&&m(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(f=
c.nla_tracks[d],e=0;e<f.strips.length;e++)f.strips[e].action&&m(f.strips[e],"action",b)}function m(a,b,c){(c=c[a[b].uuid])||K.error("Dangling link found:",b,a);a[b]=c}function h(a,b,c){c=ka.keysearch("name",a[b].name,c);a[b]=c}function x(a,b,c){c=ka.keysearch("identifier",a[b].identifier,c);a[b]=c}function L(a,c,d,f,e,g){f=ea(c.qf);for(var h=a.images,k={},m=[],l=0;l<h.length;l++){var r=h[l],n=r.uuid;if("FILE"===r.source||"MOVIE"===r.source){var q=A(r,a.textures);if(!q.length)K.warn("image ",r.name,
" has no users.");else if(!q[0].b4w_shore_dist_map){q=ka.pl(f+r.filepath);if("FILE"===r.source){var t=r.ad?J.AT_ARRAYBUFFER:J.AT_IMAGE_ELEMENT;mb.nr&&Da.Go&&(q=J.Ol(q),"dds"==q[1]?(q=J.Ol(q[0]),q=q[0]+".min50."+q[1]+".dds"):q=q[0]+".min50."+q[1])}else"MOVIE"===r.source&&(Da.Jl?(q=J.Ol(q),q=q[0]+".altconv.seq",t=J.fm):(q=J.Ol(q),t=Ba.detect_video_container(q[1]),q=t!=q[1]?q[0]+".altconv."+t:q[0]+"."+t,t=J.gm));m.push({id:n,type:t,url:q});k[n]=r}}}if(m.length){var u=0;J.enqueue(m,function(f,e,h,l){if(f){if(h==
J.gm||h==J.fm){if(h==J.gm)var r=f.videoWidth,n=f.videoHeight;else r=f.images[0].width,n=f.images[0].height;K.log("%cLOAD VIDEO "+r+"x"+n,"color: #"+(2048<r||2048<n?"a00":1024<r||1024<n?"aa0":"0a0"),l);-1==l.indexOf(ta)&&K.warn("video",l,"is not from app root.")}else b(f,l,!0);e=k[e];l=A(e,a.textures);for(r=0;r<l.length;r++){var n=l[r],q=n.image.filepath;h==J.fm?(n.k.Zr=f.rf,pa.Ul(n.k,f.images,e.ad,q,c.id)):pa.Ul(n.k,f,e.ad,q,c.id)}}f=++u/m.length;g(c,d,f)},function(){K.log("%cLOADED ALL IMAGES","color: #0a0");
e(c,d)})}else e(c,d)}function P(a,b,c,d,f){a=xa.hv();for(d=0;d<a.length;d++){var e=a[d];if(e.b4w_use_nla){var g=e.b4w_nla_cyclic;e.b4w_use_logic_editor&&(g=!1);Y.zI(e,g,b.id)}}f(b,c)}function A(a,b){for(var c=[],d=0;d<b.length;d++){var f=b[d];f.image===a&&c.push(f)}return c}function w(a,b,c,d,f,e){a=ea(b.qf);var g=[],h={};d=ca.get_all_objects(b.id);for(var k=0;k<d.length;k++){var m=d[k];if(I(m)){var l=m.H.Jg;"BACKGROUND_MUSIC"==Ba.Gq(m)?(l=ka.yq(),b.Jq=!0):"NONE"!=Ba.Gq(m)&&Da.Pq&&(b.Oq=!0);if(!(l in
h)){h[l]=[];var r=ka.pl(a+m.H.qf);switch(Ba.yx(m)){case Ba.To:var n=J.AT_AUDIOBUFFER;break;case Ba.bt:n=J.AT_AUDIO_ELEMENT}var r=J.Ol(r),q=Ba.detect_audio_container(r[1]),r=q!=r[1]?r[0]+".altconv."+q:r[0]+"."+q;g.push({id:l,type:n,url:r})}h[l].push(m)}}if(g.length){var t=0;J.enqueue(g,function(a,d,f,k){if(a)for(K.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(ta)&&K.warn("sound",k,"is not from app root."),d=h[d],f=0;f<d.length;f++)Ba.DI(d[f],a);a=++t/g.length;e(b,c,a)},function(){K.log("%cLOADED ALL SOUNDS",
"color: #0aa");f(b,c)})}else f(b,c)}function I(a){return ja.is_speaker(a)&&Ba.yx(a)!=Ba.dt}function T(a,b,c){a=ca.Ga(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];ja.is_speaker(d)&&(Ba.is_cyclic(d)||c)&&Ba.play_def(d)}}function O(a,b){for(var c=a.k.ak,d=0;d<c.length;d++){var f=c[d].k;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=f.Kf||(pa.reset_video(f.name,b),pa.play_video(f.name,b))}}function B(a,b,c,d,f){Y.start();K.log("%cSTART NLA","color: #0a0");f(b,c)}function G(a,b,c,d){if(b.lod_levels&&
b.lod_levels.length)for(var f=b.lod_levels.length,e=0;e<f;e++){var g=b.lod_levels[e],h=g.object;if(h){var k=ka.wk(h);k.name=b.name+"_LOD_"+String(e+1);v(k);k.lod_levels=[];c.push([a,k]);d.push(h);g.object=k}}}function M(a,b,c,d,f){d=!0;for(var e=0;e<a.scenes.length;e++)if(!da.GB(a.scenes[e])){d=!1;break}d&&(f(b,c),K.log("%cPHYSICS READY","color: #0a0"))}function F(a,b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];if(b.Ta)var g=da.eo(e);else g=da.eo(Ha)||da.eo(e),e=Ha;if(Ac.enabled&&g)for(g=
0;g<pc.length;g++)for(var h=ca.Ga(e,pc[g],b.id),k=0;k<h.length;k++){var m=h[k];m.g.Jc==b.id&&(da.append_object(m,e),b.$v&&da.R(m)&&da.disable_simulation(m))}}f(b,c)}function R(a,c,d,f,e){var g={};f=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var m=h[k];if(m.k.Tb&&(m=m.k.Tb.Ag)&&"FILE"===m.source){var l=m.uuid,r=ka.pl(ea(c.qf)+m.filepath);f.push({id:l,type:m.ad?J.AT_ARRAYBUFFER:J.AT_IMAGE_ELEMENT,url:r});g[l]=m}}f.length?J.enqueue(f,function(d,f,e,k){if(d){b(d,k,!0);f=g[f];k=A(f,a.textures);for(e=
0;e<k.length;e++){var m=k[e];pa.Ul(m.k,d,f.ad,m.image.filepath,c.id)}for(e=0;e<h.length;e++)if(k=h[e],k.k.Tb&&(m=k.k.Tb.Ag,m===f)){var l=d,r=document.createElement("canvas"),m=f.size[0],n=f.size[1];r.width=m;r.height=n;r=r.getContext("2d");r.drawImage(l,0,0);l=r.getImageData(0,0,m,n).data;r=new Float32Array(4);r[0]=1/16581375;r[1]=1/65025;r[2]=1/255;r[3]=1;for(var m=m*n,n=new Float32Array(m),q=0;q<m;q++)n[q]=r[1]*l[4*q+2]+r[2]*l[4*q+3];k.k.js=n}}else for(f=g[f],e=0;e<h.length;e++)k=h[e],m=k.k.Tb.Ag,
m===f&&(k.k.Tb.Ag=null,K.warn("image",m.filepath," was not found. Disabling water shore effects."))},function(){e(c,d)}):e(c,d)}function S(a,c,d,f,e){f=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var k=xa.X(f,g[h]);k&&a.push(k)}if(a.length){f=[];h=J.AT_IMAGE_ELEMENT;f.push({id:"SEARCH_TEXTURE",type:h,qf:W.Dc.smaa_search_texture_path});f.push({id:"AREA_TEXTURE",type:h,url:W.Dc.smaa_area_texture_path});
for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.na;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var m=g.xa;else if("u_area_tex"==g.to)var l=g.xa;break}f.length?J.enqueue(f,function(a,d,f,e){a&&(b(a,e,!1),d="SEARCH_TEXTURE"==d?m:l,d.source="IMAGE",d.fK=!0,pa.Ul(d,a,-1!=e.indexOf(".dds")?1:0,e,c.id),pa.bs(d,pa.u,pa.u))},function(){e(c,d)}):e(c,d)}else e(c,d)}function ha(a,b,c,d){for(c=0;c<a.scenes.length;c++){var f=a.scenes[c];b.Ta||(f=Ha);for(var e=ca.Ga(f,
"LAMP",b.id),g=0;g<e.length;g++){var h=e[g];h.g.Jc==b.id&&d.ap.push({wa:f,obj:h})}e=ca.Ga(f,"ALL",b.id);for(g=0;g<e.length;g++)h=e[g],"LAMP"!=h.type&&h.g.Jc==b.id&&(b.$v&&ja.is_mesh(h)&&xa.tk(h,!0),d.ap.push({wa:f,obj:h}))}}function N(a,b,c,d,f,e){var g=d.ap;f=d.tw;if(g.length){a=g[f].obj;var h=g[f].wa;f=ja.Sa(a,h);xa.append_object(h,a,!1);a.anchor&&ia.append(a);d=++d.tw/g.length;g=f.Yf;if(null!=a.g.Kd&&g){var k=wa.copy(a.g.Wb.K,$a);xa.ay(g,k)}g=a.Fl;if(g.length&&h.k.vg)for(h=Ca.get_trans_view(a.g.i),
a=Ca.get_quat_view(a.g.i),f=f.Pe,k=0;k<f.length;k++)xa.dy(f[k],h,a),ja.ey(g,f[k].j.$b)}else d=1;e(b,c,d)}function oa(a,b,c,d,f){if(b.Ta){d=xa.Ti();var e=xa.hv();for(a=0;a<e.length;a++){var g=e[a];xa.fG(g,d);g.b4w_use_logic_editor&&Fa.DE(g,b.id)}xa.set_active(d)}else xa.fy(Ha);d=ca.get_all_objects(b.id);ca.wI(d);for(e=0;e<d.length;e++)for(g=d[e],a=0;a<g.B.length;a++)for(var h=g.B[a].T,k=0;k<h.length;k++)null==h[k].gc&&h.splice(k--,1);f(b,c)}function fa(a,b,c,d,f){if(b.Ta)for(d=0;d<a.scenes.length;d++)O(a.scenes[d],
b.id),T(a.scenes[d],b.id);else O(Ha,b.id),T(Ha,b.id);f(b,c)}function na(a,b,c,d,f){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;Da.media_auto_activation&&(b.Lq||b.Jq||b.Oq)?Qa||ba(a,f,b,c):f(b,c)}function ba(a,b,c,d){function f(){if(!h){h=!0;c.Lq&&(pa.play(),pa.pause(),pa.reset());if(c.Jq){if(c.Ta)for(var e=0;e<a.scenes.length;e++)T(a.scenes[e],c.id,!0);else T(Ha,c.id,!0);Ba.pause()}c.Oq&&Ba.Hw();E();b(c,d)}}var e=xb.parentElement;za=e.style.zIndex;e.style.zIndex="999";Qa=document.createElement("div");
Qa.style.position="relative";Qa.style.height="88px";Qa.style.width="88px";var g=Math.round(xb.offsetWidth/2-44);Qa.style.top=Math.round(xb.offsetHeight/2-44).toString()+"px";Qa.style.left=g.toString()+"px";Qa.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Qa.style.backgroundSize="88px";Hb=document.createElement("div");Hb.style.position="relative";Hb.style.height=xb.offsetHeight.toString()+"px";Hb.style.width=xb.offsetWidth.toString()+"px";Hb.style.background="rgba(0, 0, 0, 0.5)";Hb.style.zIndex="999";e.appendChild(Hb);Hb.appendChild(Qa);Qa.addEventListener("touchstart",f,!1);Qa.addEventListener("click",f,!1);var h=!1}function E(){if(Qa){var a=xb.parentElement;a.style.zIndex=za;Hb.removeChild(Qa);a.removeChild(Hb);Qa=Hb=null;za=0}}function ea(a){(a=
a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function qa(a,b,c){ya.is_animated(b)&&ya.remove(b);ca.clear_outline_anim(b);Q.check_sensor_manifold(b)&&Q.remove_sensor_manifold(b);da.R(b)&&da.mG(b);xa.nG(a,b,c);ja.is_speaker(b)&&Ba.xH(b);ia.is_anchor(b)&&ia.remove(b)}function la(a){var b=ya.Zu(a);return(a=b&&b.parent==a?null:a.parent||b)?1+la(a):0}var ia=p("__anchors"),ya=p("__animation"),J=p("__assets"),V=p("__batch");p("__camera");var W=p("__config"),Q=p("__controls"),sa=p("__dds"),ma=p("__extensions");
p("__lights");var ga=p("__loader");p("__mat4");var Z=p("__md5"),Y=p("__nla"),Fa=p("__logic_nodes"),ua=p("__nodemat"),ca=p("__objects"),ja=p("__obj_util"),da=p("__physics"),K=p("__print"),va=p("__reformer"),U=p("__renderer"),xa=p("__scenes"),Ba=p("__sfx"),aa=p("__shaders"),pa=p("__textures"),Ja=p("__time"),X=p("__transform"),Ca=p("__tsr"),ka=p("__util"),wa=p("__vec3"),Da=W.p,mb=W.Ae,Ac=W.o,Za=W.Yg,oc=W.H,ra=null,ic=null,ta="",Ha=null,Xa={},$a=new Float32Array(3),Qa=null,Hb=null,za=0,Uc=!1,ec=["LAMP",
"CAMERA"],pc=["MESH","CAMERA","EMPTY"],xb=null;a.is_primary_loaded=function(a){return ga.is_primary_loaded(a)};a.update=function(){ga.AI(ra)};a.iH=function(a){xb=a};a.tI=function(a,b){if(Qa){Hb.style.height=b.toString()+"px";Hb.style.width=a.toString()+"px";var c=Math.round(a/2-44);Qa.style.top=Math.round(b/2-44).toString()+"px";Qa.style.left=c.toString()+"px"}};a.load=function(a,b,f,h,k){var m={load_main:{lb:ga.Qg,ub:!1,J:[],vb:!1,yb:500,Lb:!1,Db:c},duplicate_objects:{lb:ga.Hc,ub:!1,J:["load_main"],
vb:!1,yb:50,Lb:!1,Db:y},load_binaries:{lb:ga.Qg,ub:!1,J:["load_main"],vb:!1,yb:500,Lb:!1,Db:n},wait_for_shaders:{lb:ga.Hc,ub:!1,J:[],vb:!1,yb:50,Lb:!0,Wf:g},prepare_bindata:{lb:ga.Hc,ub:!1,J:["duplicate_objects","load_binaries"],vb:!1,yb:100,Lb:!1,Db:q},prepare_bpy_data:{lb:ga.Hc,ub:!1,J:["duplicate_objects","prepare_bindata"],vb:!1,yb:100,Lb:!1,Db:e},process_objects:{lb:ga.Hc,ub:!1,J:["prepare_bpy_data"],vb:!1,yb:150,Lb:!1,Db:z},process_scenes:{lb:ga.Hc,ub:!1,J:["process_objects","wait_for_shaders"],
vb:!1,yb:300,Lb:!1,Db:D},load_smaa_textures:{lb:ga.Qg,ub:!1,J:["process_scenes"],vb:!1,yb:30,Lb:!0,Db:S},load_shoremap:{lb:ga.Qg,ub:!1,J:["process_scenes"],vb:!1,yb:30,Lb:!0,Db:R},load_textures:{lb:ga.Qg,ub:!0,J:["process_scenes"],vb:!0,yb:500,Lb:!1,Db:L},update_scenes_nla:{lb:ga.Hc,ub:!1,J:["process_scenes","load_textures"],vb:!1,yb:50,Lb:!1,Db:P},wait_physics_workers:{lb:ga.Hc,ub:!1,J:["load_shoremap"],vb:!1,yb:20,Lb:!1,Wf:M},add_physics_objects:{lb:ga.Hc,ub:!1,J:["wait_physics_workers"],vb:!1,
yb:50,Lb:!1,Db:F},add_objects:{lb:ga.Hc,ub:!1,J:["add_physics_objects"],vb:!1,yb:600,Lb:!1,Db:ha,Wf:N,qk:oa,rk:{ap:[],tw:0}},load_speakers:{lb:ga.Qg,ub:!0,J:["add_objects"],vb:!0,yb:100,Lb:!1,Db:w},mobile_media_start:{lb:ga.Hc,ub:!1,J:["load_textures","update_scenes_nla","load_speakers"],vb:!0,yb:5,Lb:!1,Db:na,Wf:na},synchronize_media:{lb:ga.Hc,ub:!0,J:["mobile_media_start"],vb:!0,yb:50,Lb:!1,Db:fa},start_nla:{lb:ga.Hc,ub:!0,J:["mobile_media_start"],vb:!1,yb:5,Lb:!0,Db:B}},l=ga.kv();l||(l=ga.nC(),
ra={},ic={},Xa={});ra[l.We.length]={};return ga.wC(m,a,b,f,d,h||oc.Ht,Da.do_not_load_resources,k)};a.unload=function(a){var b=ga.kv();if(!b||!b.We.length||a&&!ga.RH(b.We[a]))K.error("Unable to unload data!");else{if(0==a)K.log("%cUNLOAD ALL","color: #00a"),ia.cleanup(),ya.cleanup(),Ba.cleanup(),Y.cleanup(),xa.cleanup(),ga.cleanup(),da.cleanup(),ca.cleanup(),ka.cleanup(),U.cleanup(),ua.cleanup(),aa.cleanup(),Q.cleanup(),ma.cleanup(),J.cleanup(),pa.cleanup(),Fa.cleanup(),ic=null,Xa={},ra=Ha=null,Uc=
!1;else{K.log("%cUNLOAD DATA "+a,"color: #00a");ya.lG(a);for(var b=xa.Pi(),c=0;c<b.length;c++)for(var d=b[c],f=ca.Ga(d,"ALL",a),e=f.length-1;0<=e;e--){var g=f[e];qa(d,g,!0);ca.remove_object(g)}}E()}};a.eG=qa;a.set_debug_resources_root=function(a){ta=a};a.activate_media=function(){Uc||Da.media_auto_activation||(pa.play(),pa.pause(),pa.reset(),T(Ha,ca.DATA_ID_ALL,!0),Ba.pause(),Da.Pq&&Ba.Hw(),Uc=!0)}};b4w.module.__batch=function(a,p){function d(a){a={type:a,hb:"",id:0,oG:0,rj:"",U:[],lc:[],pd:[],Ck:[],ii:null,ac:{},gc:null,zb:{$j:null,Mi:null,bg:[],mg:[]},ym:[],NL:null,P:null,te:!1,nh:!1,uu:!1,wireframe_mode:0,num_vertices:0,num_triangles:0,Qv:0,Rv:0,mv:0,Hq:0,Kc:new Float32Array(3),fd:new Float32Array(16),Wg:!1,Ja:!1,fu:!1,ra:!1,Nf:!1,nb:!1,Ed:!1,He:!1,zd:!1,Uc:!1,Vc:!1,Ec:!1,wc:!1,Rc:!1,cc:!1,Nw:!1,nf:ea.ek,Pf:ea.af,Ep:!1,Ke:!1,iG:"",YL:"",ov:!1,sv:0,pv:0,tv:0,uv:0,rv:new Float32Array(3),qv:new Float32Array(3),
Iq:!1,bf:0,of:0,ag:1,reflect_factor:0,bi:0,qs:1,parallax_scale:0,$f:0,Sf:1,pw:0,or:0,Mh:0,Zw:0,hd:Array(2),Wc:new Float32Array(3),Eg:new Float32Array(3),Te:new Float32Array(3),vc:new Float32Array(4),ke:new Float32Array(4),fj:null,$q:null,Yq:null,Xq:null,Zq:null,$i:!1,Ng:!1,water_dynamic:!1,Po:!1,Ay:!1,By:0,Cy:0,zy:0,bk:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,Nu:new Float32Array(2),Mu:new Float32Array(2),sq:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),
Lh:null,Gl:!1,Ba:null,Cn:0,Sn:!1,Cr:null};a.vc[3]=1;a.fu=!0;a.ra=!0;a.Cn=1;return a}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.hb=a.Ja?a.Nf?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.hb=a.Uc?"CAST":"RECEIVE";break;case "COLOR_ID":a.hb=a.Nf?"COLOR_ID_XRAY":"COLOR_ID"}}function c(a){var b=a.P;a.P=null;var c=ia.zi(a);a.P=b;c.P=b;return c}function n(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],e=f.oa.g,g=fa.$c();fa.Om(e.vi,g);var h=f.data.b4w_bounding_cylinder_radius,
k=f.data.b4w_bounding_sphere_radius,m=f.data.b4w_bounding_sphere_center,r=f.data.b4w_bounding_ellipsoid_axes,n=f.data.b4w_bounding_ellipsoid_center;if(e.ee){var h=Math.max(Math.abs(g.max_x),Math.abs(g.min_x)),k=Math.max(Math.abs(g.max_y),Math.abs(g.min_y)),t=Math.max(Math.abs(g.max_z),Math.abs(g.min_z)),t=Math.sqrt(h*h+k*k+t*t),h=Math.sqrt(h*h+k*k);g.max_x=g.max_y=g.max_z=t;g.min_x=g.min_y=g.min_z=-t;k=t;m[0]=m[1]=m[2]=0;r[0]=r[1]=r[2]=t;n[0]=n[1]=n[2]=0}e.bc=g;t=fa.wp(g,e.i);e.Cb=t;l(e,h,h,g);g=
fa.Rm(k,m);e.dd=g;g=fa.yp(g,e.i);e.Wb=g;r=fa.Qm([r[0],0,0],[0,r[1],0],[0,0,r[2]],n);e.ef=r;r=fa.xp(r,e.i);e.Uf=r;c=c.concat(q(f,e,b))}return c}function g(a,b,c){for(var d=[],f=[],e={},g=0;g<a.length;g++){var h=a[g],k=h.oa.g,m=fa.$c();fa.Om(k.vi,m);var l=fa.wp(m,k.i),r=fa.Rm(h.data.b4w_bounding_sphere_radius,h.data.b4w_bounding_sphere_center),n=fa.yp(r,k.i),t=h.data.b4w_bounding_ellipsoid_axes,t=fa.Qm([t[0],0,0],[0,t[1],0],[0,0,t[2]],h.data.b4w_bounding_ellipsoid_center),u=fa.xp(t,k.i);k.bc=m;k.Cb=
l;k.dd=r;k.Wb=n;k.ef=t;k.Uf=u;m={};m.zd=k.zd;m.Uc=k.Uc;m.Vc=k.Vc;m.xg=k.xg;m.Qn=k.Qn;m.Kb=k.Kb;m.Pn=k.Pn;m.sj=k.sj;m.Ec=k.Ec;m.wc=k.wc;m.Rc=k.Rc;m.Kd=k.Kd;m.td=k.td;m.Qe=k.Qe;m.gf=k.gf;m.Gd=k.Gd;m.wf=k.wf;m.uc=k.uc;m.ee=k.ee;m.mk=k.mk;m.lk=k.lk;m.cc=k.cc;m.ph=k.ph;m.Xm=k.Xm;m.xf=k.xf;m.Hh=k.Hh;m.Hn=k.Hn;m.qd=k.qd;m.Gh=k.Gh;m.In=k.In;m.He=k.He;l=k.Wb.K;m.xE=0==c?[0,0]:[Math.floor(l[0]/c),Math.floor(l[2]/c)];m.ig=k.ig;m.ol=k.ol;m.Fh=k.Fh;m.Di=k.Di;k=JSON.stringify(m);e[k]=e[k]||[];e[k].push(h)}for(var p in e){m=
JSON.parse(p);c=e[p];var h=ia.lh("STATIC"),w;for(w in m)h[w]=m[w];h.Jc=a[0].oa.g.Jc;h.Ye=0;h.Mf=0;h.mf=0;h.lf=0;h.ff=0;h.xh=!1;for(g=0;g<c.length;g++)k=c[g].oa,0==g?(h.Cb=Y.za(k.g.Cb),h.Wb=Y.za(k.g.Wb),h.ef=Y.za(k.g.ef),h.Uf=Y.za(k.g.Uf)):(fa.Gu(h.Cb,k.g.Cb),fa.bD(h.Wb,k.g.Wb));h.bc=Y.za(h.Cb);h.dd=Y.za(h.Wb);f.push({g:h,iB:c})}for(a=0;a<f.length;a++)for(e=f[a].g,g=f[a].iB,p=0;p<g.length;p++){w=g[p];c=w.oa.g;h=q(w,e,b);k=Z.create();c.ee&&!c.rp?(m=Z.get_trans_view(c.i),Z.set_trans(m,k)):Z.copy(c.i,
k);m={};if(e.Gd||e.ee)m.au_center_pos=[k[0],k[1],k[2]];e.Gd&&(m.au_wind_bending_amp=[c.Ye],m.au_wind_bending_freq=[w.b4w_wind_bending_freq],m.au_detail_bending_amp=[w.b4w_detail_bending_amp],m.au_detail_bending_freq=[w.b4w_detail_bending_freq],m.au_branch_bending_amp=[w.b4w_branch_bending_amp]);for(l=0;l<h.length;l++)t=h[l].g,r=h[l].Bd,n=h[l].I,t.wn?t.ee?ea.JH(r,k):ea.Jx(r,k):("COLOR_ID"==n.type&&(h[l].g=c,n.rj=w.uuid,x(n,c),t=G(c),B(n,t)),r=ea.Jx(r,k),ea.IH(r,m));d=d.concat(h)}return d}function q(a,
b,c){var f=[],g=t(c,b,!b.Di,!1),h=G(b),k=a.data,m=k.materials,l=Array(m.length),r=sa.Fb(c,"MAIN_OPAQUE"),n=!1;r&&(n=r.Bn.length?!0:!1);for(var q=0;q<g.length;q++)for(var u=g[q],p=0;p<m.length;p++){var J=m[p];if(("LENS_FLARES"!=J.name||n)&&!ea.vv(k,p)){var v=d(u);"COLOR_ID"==u&&(v.Ep=!(a.b4w_do_not_render||J.b4w_do_not_render));"MAIN"==u&&(l[p]=v);if(O(v,J)){"SHADOW"==u&&l[p]&&(v.Ed=l[p].Ed);v.nf=b.te||b.He?ea.im:ea.ek;x(v,b);for(var z=v,F=a.particle_systems,A=0;A<F.length;A++){var V=F[A].settings.b4w_vcol_from_name,
y=F[A].settings.b4w_vcol_to_name;""!==V&&""!==y&&(z.ac[V]={vh:!1,src:[{name:V,Ud:7}]})}"DYNAMIC"==b.type&&(v.rj=a.uuid);B(v,h);var H=ea.Ju(k,p,v.Ck,b.xi,v.ac,v.ii);"LENS_FLARES"==J.name&&(H=ya.dG(H));f.push({I:v,Bd:H,Nc:[J.name],g:b,wd:[a]})}}}var I=a.particle_systems;if(0<I.length&&f.length){for(var D=!1,Q=!1,q=0;q<I.length;q++){var C=I[q],L=C.settings;L.use_render_emitter&&(D=!0);"HAIR"!=L.type||"OBJECT"!=L.render_type&&"GROUP"!=L.render_type&&C.transforms.length||(Q=!0);if(D&&Q)break}var R=f[0].I.ac,
S;if(Q){var E;if(1<m.length){for(var M={},N=0;N<I.length;N++){var P=I[N].settings;if("HAIR"==P.type&&("OBJECT"==P.render_type||"GROUP"==P.render_type)){var K=P.b4w_vcol_from_name,ha=P.b4w_vcol_to_name;""!==K&&""!==ha&&(M[K]=Y.za(R[K]))}}"a_bending_col_main"in R&&(M.a_bending_col_main=Y.za(R.a_bending_col_main));"a_bending_col_detail"in R&&(M.a_bending_col_detail=Y.za(R.a_bending_col_detail));E=ea.Ku(k,[],M)}else E=f[0].Bd;S=E}else S=null;for(var ga,qa=S,la=a.oa,fa=[],oa=a.particle_systems,da=a.data,
na=0;na<oa.length;na++){var ua=oa[na],ja=ua.settings;if(ja.count)if("EMITTER"==ja.type){if("DYNAMIC"==b.type){var va=d("PARTICLES"),ob,Ua=da.materials,Ra=ua.settings.material-1;Ra>=Ua.length&&(ba.warn('Wrong material used for rendering particle system "'+ua.name+'"'),Ra=0);ob=Ua[Ra];"HALO"===ua.settings.render_type&&(va.Iq=!0);e(va,ob);var jc=va,db=a,zb=ua.settings;switch(zb.b4w_billboard_align){case "VIEW":w(jc,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":w(jc,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");
break;case "YZ":w(jc,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":w(jc,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";}w(jc,"BILLBOARD",0);var ab=zb.b4w_enable_soft_particles&&ia.$t(db,zb);zb.b4w_enable_soft_particles&&!ab&&ba.warn('Emitter object "'+db.name+'" has a particle settings "'+zb.name+'", which uses material with incorrect type of alpha.');w(jc,"SOFT_PARTICLES",0<zb.b4w_particles_softness&&ab&&ca.Kk?1:0);w(jc,"SOFT_STRENGTH",ma.q(zb.b4w_particles_softness));
ma.L(jc.zb,"WORLD_SPACE","WORLD"==zb.b4w_coordinate_system?1:0);va.He=!0;va.rj=la.name+"_"+ja.uuid;va.iG=ua.name;B(va,h);ya.EE(va,ua,ob);var Ka=ya.GD(va,da,ua,la.g.i);ya.yI(Ka,va,ja.count);va.UI&&x(va,la.g);fa.push({I:va,Bd:Ka,Nc:[ob.name],g:b,wd:[a]})}}else if("HAIR"==ja.type){var eb=Y.sn(ua.seed);ja.b4w_dynamic_grass&&(b.ph=!0);var bb=W.au(ca.hr)&&!ja.b4w_initial_rand_rotation&&!ja.b4w_hair_billboard,La=4;bb&&(La=8);if(ua.transforms.length)var Ea=ua.transforms;else for(var Jb=ea.Aq(qa,ja.count,
!1,eb),Ea=new Float32Array(Jb.length*La),Ga=0;Ga<Jb.length;Ga++){var rc=.75+.5*Y.Yd(eb);Ea[Ga*La]=Jb[Ga][0];Ea[Ga*La+1]=Jb[Ga][1];Ea[Ga*La+2]=Jb[Ga][2];Ea[Ga*La+3]=rc;bb&&(Ea[Ga*La+4]=1,Ea[Ga*La+5]=0,Ea[Ga*La+6]=0,Ea[Ga*La+7]=0)}var fb=sa.Fb(c,"GRASS_MAP")?!0:!1;if("OBJECT"==ja.render_type)var sc=[t(c,ja.dupli_object.oa.g,!b.Di,!0)],tc=T(a,b,R,qa,[ja.dupli_object],sc,[Ea],ja,ua,fb,eb,!1),fa=fa.concat(tc);else if("GROUP"==ja.render_type){for(var gc=ja.dupli_group.objects,sc=[],Ga=0;Ga<gc.length;Ga++){var Vc=
t(c,gc[Ga].oa.g,!b.Di,!0);sc.push(Vc)}for(var Ec=!1,Vb=[],Ga=0;Ga<gc.length;Ga++)Vb.push(gc[Ga].oa);if(ja.use_whole_group){for(var Wb,Ab=Ea,Jc=Vb,nb=bb,Bb=La,gb={},Cb=new Float32Array([0,0,0,1]),Na=0;Na<Ab.length;Na+=Bb)for(var hb=0;hb<Jc.length;hb++){var wb=Fa.create(),Lb=Z.get_scale(Jc[hb].g.i),Kc=Z.get_trans_view(Jc[hb].g.i);Fa.scale(Kc,Lb,wb);var Rb=Fa.clone([Ab[Na],Ab[Na+1],Ab[Na+2]]);gb[hb]||(gb[hb]=new Float32Array(Ab.length));nb&&(gb[hb][Na+4]=Cb[0]=Ab[Na+4],gb[hb][Na+5]=Cb[1]=Ab[Na+5],gb[hb][Na+
6]=Cb[2]=Ab[Na+6],gb[hb][Na+7]=Cb[3]=Ab[Na+7],Y.Kr(Cb,Cb),Y.VH(wb,Cb,wb));Fa.add(Rb,wb,Rb);gb[hb][Na]=Rb[0];gb[hb][Na+1]=Rb[1];gb[hb][Na+2]=Rb[2];gb[hb][Na+3]=Ab[Na+3]}Wb=gb;Ec=!0}else{var Kb;if(ja.use_group_count){for(var pb=Ea,Lc=Vb,qb=ja.dupli_weights,Db=eb,Xb=bb,Ma=La,Ya={},Wa=[],Va=0;Va<Lc.length;Va++)for(var Aa=Lc[Va],Yb=Aa.Nh||Aa.name,rb=0;rb<qb.length;rb++){var Sb=qb[rb];Yb==Sb.name&&Wa.push(Sb)}qb.length!=Wa.length&&ba.error("dupli weights match failed");for(Va=0;Va<pb.length;Va+=Ma){for(var Sa,
kc=Wa,sb=[0],tb=0;tb<kc.length;tb++)sb[tb+1]=sb[tb]+kc[tb].count;for(var Nb=sb[sb.length-1]*Y.Yd(Db),hc=0,tb=0;tb<sb.length;tb++)if(Nb>=sb[tb]&&Nb<sb[tb+1]){hc=tb;break}Sa=hc;Ya[Sa]=Ya[Sa]||[];Ya[Sa].push(pb[Va],pb[Va+1],pb[Va+2],pb[Va+3]);Xb&&Ya[Sa].push(pb[Va+4],pb[Va+5],pb[Va+6],pb[Va+7])}for(Sa in Ya)Ya[Sa]=new Float32Array(Ya[Sa]);Kb=Ya}else{for(var Ob=Ea,uc=eb,Tb=bb,Pb=La,Eb=Vb.length,Oa={},Ta=0;Ta<Ob.length;Ta+=Pb){var ib=Math.floor(Eb*Y.Yd(uc));Oa[ib]=Oa[ib]||[];Oa[ib].push(Ob[Ta],Ob[Ta+1],
Ob[Ta+2],Ob[Ta+3]);Tb&&Oa[ib].push(Ob[Ta+4],Ob[Ta+5],Ob[Ta+6],Ob[Ta+7])}for(ib in Oa)Oa[ib]=new Float32Array(Oa[ib]);Kb=Oa}Wb=Kb}tc=T(a,b,R,qa,gc,sc,Wb,ja,ua,fb,eb,Ec);fa=fa.concat(tc)}"INSTANCE"==ja.b4w_wind_bend_inheritance&&la.g.Gd&&ba.warn('Emitter object "'+la.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";}ga=fa;f=D?f.concat(ga):ga}return f}
function l(a,b,c,d){a.op=fa.ou(b,d);a.mp=fa.mu(c,d);a.np=fa.nu(b,d)}function t(a,b,c,d){var f=[];d||(b.xg&&sa.Fb(a,"COLOR_PICKING")||b.Kb&&sa.Fb(a,"OUTLINE_MASK"))&&f.push("COLOR_ID");c&&(f.push("MAIN"),f.push("NODES_GLOW"),sa.Fb(a,"WIREFRAME")&&f.push("WIREFRAME"),sa.Fb(a,"SHADOW_RECEIVE")&&f.push("SHADOW"),sa.Fb(a,"GRASS_MAP")&&f.push("GRASS_MAP"));f.push("PHYSICS");if(b.Uc||b.wc)for(a=null,b.Uc&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","WIREFRAME"]),b.wc&&(b=["COLOR_ID","PHYSICS","SHADOW",
"WIREFRAME"],a=null!==a?Y.PA(a,b):b),b=a,a=0;a<b.length;a++)c=f.indexOf(b[a]),-1!==c&&f.splice(c,1);return f}function e(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)v(a,b,"MAIN");else{r(a,b);c=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Mh=b.offset_z;a.Eg.set([1,1,1]);var d=b.texture_slots;ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc);switch(b.name){case "LENS_FLARES":F(a,
"special_lens_flares.glslv","special_lens_flares.glslf");A(a,"a_position");A(a,"a_texcoord");var f=u(d[0],null);R(a,f);break;default:F(a,"main.glslv","main_stack.glslf");b.use_shadeless||(c=la.Sp(b.uuid,b.name,{Ed:b.use_shadeless,Lk:b.diffuse_shader,Hj:b.specular_shader}),a.zb.mg=la.Mm(c));var e=z("use_map_color_diffuse",d),g=z("use_map_color_spec",d),h=z("use_map_normal",d),m=z("use_map_mirror",d),l=z("use_stencil",d);c=e[0];g=g[0];h=h[0];m=m[0];e=e[1];d=l[0]&&z("use_rgb_to_intensity",d)[0];if(c){switch(c.blend_type){case "MIX":w(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}f=u(c,null);R(a,f,"u_colormap0");a.$f=c.diffuse_color_factor;a.Sf=c.use_map_alpha?c.alpha_factor:0;a.Eg.set(c.scale)}l=c&&c==g;g&&(l||(f=u(g,null),R(a,f,"u_specmap0")),a.bi=g.specular_color_factor);if(h&&(A(a,"a_normal"),A(a,"a_tangent"),a.Sn=!0,f=u(h,null),R(a,f,"u_normalmap0"),a.pw=h.normal_factor,f=h.texture,f.b4w_use_map_parallax&&ca.ul)){var n=ma.q(f.b4w_parallax_steps),
q=ma.q(f.b4w_parallax_lod_dist);w(a,"PARALLAX",1);w(a,"PARALLAX_STEPS",n);w(a,"PARALLAX_LOD_DIST",q);a.parallax_scale=f.b4w_parallax_scale}m&&(f=u(m,null),R(a,f,"u_mirrormap"),a.or=m.mirror_factor);if(m=c&&e&&d?1:0)f=u(e,null),R(a,f,"u_colormap1"),f=u(d,null),R(a,f,"u_stencil0");(f=c||g||h)&&a.Eg.set(f.scale);w(a,"TEXTURE_SPEC",void 0==g?0:1);w(a,"ALPHA_AS_SPEC",l?1:0);w(a,"TEXTURE_STENCIL_ALPHA_MASK",m);A(a,"a_position");A(a,"a_normal");(c||g||h)&&A(a,"a_texcoord");if(b.b4w_water){a.Ng=!0;a.water_dynamic=
b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Ja?(ba.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.Po=!1):a.Po=b.b4w_water_shore_smoothing;F(a,"special_water.glslv","special_water.glslf");m=la.Sp(b.uuid,b.name,{Ed:!1,Lk:b.diffuse_shader,Hj:b.specular_shader});a.zb.mg=la.Mm(m);A(a,"a_position");ca.Dy?(A(a,"a_polyindex"),a.ra=!0,a.wireframe_edge_color=[0,0,0],w(a,"DEBUG_WIREFRAME",1)):w(a,"DEBUG_WIREFRAME",0);l=b.texture_slots;m=z("use_map_normal",l);f=z("use_map_mirror",
l)[0];m.length&&(n=u(m[0]),R(a,n,"u_normalmap0"),a.bk=b.b4w_water_norm_uv_velocity);w(a,"NUM_NORMALMAPS",m.length);a.Lh=Array(m.length);for(n=0;n<m.length;n++)a.Lh[n]=new Float32Array(2),a.Lh[n].set([m[n].scale[0],m[n].scale[1]]);f&&(n=u(f),R(a,n,"u_mirrormap"),a.or=f.mirror_factor);f=null;if(ca.Ki)for(n=0;n<l.length;n++){var t=l[n];if(!0===t.texture.b4w_water_foam){f=t;break}}f?(w(a,"FOAM",1),n=u(f),R(a,n,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.Nu.set(f.texture.b4w_foam_uv_freq),a.Mu.set(f.texture.b4w_foam_uv_magnitude),
a.sq[0]=f.scale[0],a.sq[1]=f.scale[1]):w(a,"FOAM",0);for(n=0;n<l.length;n++)if(t=l[n],!0===t.texture.b4w_shore_dist_map){var p=t;break}p&&ca.tm?(p=u(p),R(a,p,"u_shore_dist_map"),w(a,"SHORE_PARAMS",1),p=t.texture.b4w_shore_boundings,w(a,"MAX_SHORE_DIST",ma.q(t.texture.b4w_max_shore_dist)),w(a,"SHORE_MAP_SIZE_X",ma.q(p[0]-p[1])),w(a,"SHORE_MAP_SIZE_Y",ma.q(p[2]-p[3])),w(a,"SHORE_MAP_CENTER_X",ma.q((p[0]+p[1])/2)),w(a,"SHORE_MAP_CENTER_Y",ma.q((p[2]+p[3])/2))):w(a,"SHORE_PARAMS",0);if(b.b4w_generated_mesh&&
ca.Kk)w(a,"GENERATED_MESH",1),a.Ay=!0,a.By=b.b4w_water_num_cascads,a.Cy=b.b4w_water_subdivs,a.zy=b.b4w_water_detailed_dist;else{A(a,"a_normal");if(f||m.length)A(a,"a_texcoord"),A(a,"a_tangent"),a.Sn=!0;w(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var t=ma.q(b.b4w_water_dst_noise_scale0),p=ma.q(b.b4w_water_dst_noise_scale1),m=ma.q(b.b4w_water_dst_noise_freq0),l=ma.q(b.b4w_water_dst_noise_freq1),f=ma.q(b.b4w_water_dir_min_shore_fac),n=ma.q(b.b4w_water_dir_freq),q=ma.q(b.b4w_water_dir_noise_scale),
J=ma.q(b.b4w_water_dir_noise_freq),x=ma.q(b.b4w_water_dir_min_noise_fac),W=ma.q(b.b4w_water_dst_min_fac),V=ma.q(b.b4w_water_waves_hor_fac);w(a,"DST_NOISE_SCALE_0",t);w(a,"DST_NOISE_SCALE_1",p);w(a,"DST_NOISE_FREQ_0",m);w(a,"DST_NOISE_FREQ_1",l);w(a,"DIR_MIN_SHR_FAC",f);w(a,"DIR_FREQ",n);w(a,"DIR_NOISE_SCALE",q);w(a,"DIR_NOISE_FREQ",J);w(a,"DIR_MIN_NOISE_FAC",x);w(a,"DST_MIN_FAC",W);w(a,"WAVES_HOR_FAC",V)}y(a,b);C(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);
a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;w(a,"ABSORB",ma.q(b.b4w_water_absorb_factor));w(a,"SSS_STRENGTH",ma.q(b.b4w_water_sss_strength));w(a,"SSS_WIDTH",ma.q(b.b4w_water_sss_width))}"HALO"===b.type&&(F(a,"halo.glslv","halo.glslf"),H(a,b),a.Ck=["a_position"]);w(a,"TEXCOORD",0);w(a,"NORMAL_TEXCOORD",0);c&&k(a,c,"TEXTURE_COLOR0_CO");e&&k(a,e,"TEXTURE_COLOR1_CO");d&&k(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");g&&k(a,g,"TEXTURE_SPEC_CO");h&&k(a,h,
"TEXTURE_NORM_CO");w(a,"SHADELESS",b.use_shadeless?1:0);a.Ed=b.use_shadeless}c=b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===c?0:1);w(a,"ALPHA_CLIP","CLIP"===c?1:0);w(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(w(a,"VERTEX_COLOR",1),A(a,"a_color")):w(a,"VERTEX_COLOR",0);a.bf=b.ambient;a.ag=b.diffuse_intensity;a.of=b.emit;a.Te.set(b.specular_color);a.qs=b.specular_alpha;y(a,b);C(a,b);b.b4w_wettable?w(a,"WETTABLE",1):w(a,"WETTABLE",0);D(a,b);b.b4w_refractive&&
!a.Ja?(ba.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Gl=!1):a.Gl=b.b4w_refractive;a.Zw=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=v(a,b,"GLOW");break;case "SHADOW":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(r(a,b),a.Ja)c=!1;else{g=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==g?v(a,b,"SHADOW"):(F(a,"shadow.glslv","shadow.glslf"),ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc));A(a,"a_position");
A(a,"a_normal");w(a,"ALPHA","OPAQUE"===g?0:1);a.Eg.set([1,1,1]);if((c=z("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){switch(c.blend_type){case "MIX":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Eg.set(c.scale);w(a,"TEXTURE_COLOR",1);A(a,"a_texcoord");if("IMAGE"==c.texture.k.source||"ENVIRONMENT_MAP"==c.texture.k.source||"CANVAS"==c.texture.k.source)g=u(c),R(a,g,"u_colormap0");"NONE"==c.texture.k.source&&
(g=u(c),R(a,g,"u_colormap0"))}else w(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.Zl=b.b4w_use_ghost,a.Ya=b.b4w_collision_id,a.zk=b.b4w_collision_margin,a.xk=b.b4w_collision_group,a.Ak=b.b4w_collision_mask,a.Yk=b.physics.friction,a.Pk=b.physics.elasticity,c=!0):b.b4w_water?(a.Ng=!0,a.kJ=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,
a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||"HALO"===b.type)c=!1;else{r(a,b);a.Pf=ea.af;a.ra=!0;a.Ja=!1;g=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=
g;b.use_nodes&&"CLIP"==g?v(a,b,"COLOR_ID"):(F(a,"color_id.glslv","color_id.glslf"),ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc));A(a,"a_position");w(a,"ALPHA","OPAQUE"===g?0:1);a.Eg.set([1,1,1]);if((c=z("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){switch(c.blend_type){case "MIX":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Eg.set(c.scale);w(a,"TEXTURE_COLOR",1);A(a,"a_texcoord");
if("IMAGE"==c.texture.k.source||"ENVIRONMENT_MAP"==c.texture.k.source)g=u(c),R(a,g,"u_colormap0");"NONE"==c.texture.k.source&&(g=u(c),R(a,g,"u_colormap0"))}else w(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(r(a,b),a.Ja=!1,a.Pf=ea.af,a.ra=!0,F(a,"grass_map.glslv","grass_map.glslf"),A(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,g=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.ac.a_grass_size={vh:!0,src:[]},c?(a.ac.a_grass_size.src.push({name:c,
Ud:4}),w(a,"DYNAMIC_GRASS_SIZE",1)):w(a,"DYNAMIC_GRASS_SIZE",0),a.ac.a_grass_color={vh:!0,src:[]},g?(a.ac.a_grass_color.src.push({name:g,Ud:7}),w(a,"DYNAMIC_GRASS_COLOR",1)):w(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?c=!1:(F(a,"wireframe.glslv","wireframe.glslf"),A(a,"a_position"),A(a,"a_normal"),A(a,"a_polyindex"),a.ra=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],c=!0);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=
!1;else{c=b.texture_slots;if(a.Iq)F(a,"particle_system.glslv","particle_system_stack.glslf"),w(a,"HALO_PARTICLES",1),H(a,b);else{g={Ed:!1,Lk:b.diffuse_shader,Hj:b.specular_shader};if(b.use_nodes){F(a,"particle_system.glslv","particle_system.glslf");v(a,b,"PARTICLES");c=!0;break a}F(a,"particle_system.glslv","particle_system_stack.glslf");g=la.Sp(b.uuid,b.name,g);a.zb.mg=la.Mm(g);if(c=z("use_map_color_diffuse",c)[0]){w(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");
break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.$f=c.diffuse_color_factor;a.Sf=c.use_map_alpha?c.alpha_factor:0;c=u(c);R(a,c)}}ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc);a.bf=b.ambient;a.ag=b.diffuse_intensity;a.of=b.emit;a.Te.set(b.specular_color);a.qs=b.specular_alpha;A(a,"a_position");A(a,"a_normal");c=b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===c?0:1);w(a,"ALPHA_CLIP","CLIP"===c?1:0);w(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);y(a,b);C(a,b);r(a,b);c=b.game_settings.alpha_blend;a.Nf=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Mh=b.offset_z;c=!0}break;default:throw"Wrong batch type: "+a.type;}return c}function H(a,b){var c=b.halo;w(a,"NUM_RINGS",c.ring_count);w(a,"NUM_LINES",c.line_count);w(a,"NUM_STARS",c.star_tip_count);w(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.sv=c.size;a.pv=c.hardness/20;a.rv.set(c.b4w_halo_rings_color);a.qv.set(c.b4w_halo_lines_color);a.tv=1/b.b4w_halo_stars_blend_height;a.uv=b.b4w_halo_stars_min_height;
a.ov=!0}function k(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":w(a,c,"TEXTURE_COORDS_UV_ORCO");w(a,"TEXCOORD",1);break;case "NORMAL":w(a,c,"TEXTURE_COORDS_NORMAL");w(a,"NORMAL_TEXCOORD",1);break;default:w(a,c,0)}}function r(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Ja=!0;a.Pf=ea.qt;a.ra=!0;a.Wg=!1;break;case "ALPHA":a.Ja=!0;a.Pf=ea.af;a.ra=!0;a.Wg=!1;break;case "CLIP":a.Ja=!1;a.Pf=ea.af;a.ra=!0;a.Wg=!0;break;case "ADD":a.Ja=!0;a.Pf=ea.af;a.ra=!1;a.Wg=!1;break;
case "OPAQUE":a.Ja=!1;a.Pf=ea.af;a.ra=!0;a.Wg=!1;break;default:throw Error("Unknown alpha blend mode: "+d);}a.nb=c.use_backface_culling}function u(a,b){var c=a.texture,d=c.k,c=c.image;d&&b&&c&&ga.Ul(d,b,c.ad,c.filepath);return d}function z(a,b){for(var c=[],d=b.length,f=0;f<d;f++){var e=b[f];1==e[a]&&e.texture&&e.texture.k&&c.push(e)}return c}function D(a,b){var c=b.raytrace_transparency;a.ke[0]=c.fresnel;a.ke[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.ke[2]=c.fresnel;
a.ke[3]=1-c.fresnel_factor/5}function y(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:ba.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Wc[0]=b.specular_intensity;a.Wc[1]=c;a.Wc[2]=d}function C(a,b){switch(b.diffuse_shader){case "LAMBERT":a.hd[0]=
0;a.hd[1]=0;break;case "OREN_NAYAR":a.hd[0]=b.roughness;a.hd[1]=0;break;case "FRESNEL":a.hd[0]=b.diffuse_fresnel;a.hd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.hd[0]=b.darkness;a.hd[1]=0;break;case "TOON":a.hd[0]=b.diffuse_toon_size;a.hd[1]=b.diffuse_toon_smooth;break;default:ba.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.hd[0]=0,a.hd[1]=0}}function v(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":F(a,"main.glslv",
"main.glslf");d=!1;break;case "GLOW":F(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":F(a,"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":F(a,"color_id.glslv","color_id.glslf"),d=!1}c=la.NB(b.node_tree,b.uuid,!1,b.name,c);if(!c)return ba.error('Failed to create node graph for material "'+b.name+'", disable nodes'),h(a,b),!0;a.$i=!0;w(a,"NODES",1);w(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);A(a,"a_position");b.use_orco_tex_coord&&A(a,"a_orco_tex_coord");r(a,b);a.Mh=
b.offset_z;var e=b.game_settings.alpha_blend;d?(w(a,"ALPHA",1),w(a,"ALPHA_CLIP",0)):(w(a,"ALPHA","OPAQUE"===e?0:1),w(a,"ALPHA_CLIP","CLIP"===e?1:0));a.Nf=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc);a.of=b.emit;a.bf=b.ambient;D(a,b);b.b4w_wettable?w(a,"WETTABLE",1):w(a,"WETTABLE",0);var g=[],k=[],l=!1;qa.ba(c,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var f=d.data.name,
e=d.data.value;a.ii||(a.ii={});a.ii[e]=f;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":f=d.data.name;a.ac[f]={vh:!0,src:[{name:d.data.value}]};e=0;if("GEOMETRY_VC"==d.type)e=7;else for(var m=0;m<d.Aa.length;m++){var r="RGB".indexOf(d.Aa[m].identifier);-1<r&&(e|=1<<2-r)}a.ac[f].src[0].Ud=e;break;case "TEX_COORD_NO":case "GEOMETRY_NO":A(a,"a_normal");break;case "MATERIAL_BEGIN":A(a,"a_normal");l=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":f=d.data.name;
e=d.data.value;if(!e.k){ba.warn('Wrong texture "'+d.data.value.name+'" in material "'+b.name+'".');h(a,b);break}!1!==e.k.sm&&(e.k.sm="TEXTURE_ENVIRONMENT"!=d.type?!0:!1);R(a,e.k,f);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":w(a,"CALC_TBN_SPACE",1);A(a,"a_normal");A(a,"a_tangent");a.Sn=!0;f=d.data.name;e=d.data.value;e.k.sm=!1;R(a,e.k,f);break;case "LAMP":d.data&&(a.fj=d.data);break;case "B4W_REFRACTION":a.Ja?a.Gl=!0:(a.Gl=!0,ba.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));
break;case "VALTORGB":g.push(d);break;case "CURVE_VEC":case "CURVE_RGB":k.push(d);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.Cr=d.data)}});var n=0,e=d=null,q=g.length+k.length;if(g.length){d=ga.VB(g,ga.Oy);for(var t=0;t<g.length;t++)g[t].La=[["NODE_TEX_ROW",ma.q((n+.5)/q)]],n++}if(k.length)for(e=ga.xC(k,ga.ft),t=0;t<k.length;t++){k[t].La=[["NODE_TEX_ROW",ma.q((n+.5)/q)]];n++;var u=k[t].data.value;"CURVE_RGB"==u.type?(f(u,0,0)&&k[t].La.push(["READ_R",1]),f(u,1,0)&&k[t].La.push(["READ_G",
1]),f(u,2,0)&&k[t].La.push(["READ_B",1]),f(u,3,0)&&k[t].La.push(["READ_A",1])):"CURVE_VEC"==u.type&&(f(u,0,-1)&&k[t].La.push(["READ_R",1]),f(u,1,-1)&&k[t].La.push(["READ_G",1]),f(u,2,-1)&&k[t].La.push(["READ_B",1]))}n=null;d&&e?(n=new Uint8Array(d.length+e.length),n.set(d),n.set(e,d.length)):n=d?d:e;n&&m(a,n,"u_nodes_texture",ga.ft);a.zb.mg=la.Mm(c);l||(a.Ed=!0);return!0}function f(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:
!0}function m(a,b,c,d){var f={texture:ga.Wu("NODE_TEX",null)};b=u(f,{width:d,height:b.length/(4*d),data:b});R(a,b,c)}function h(a,b){switch(a.type){case "SHADOW":F(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":F(a,"color_id.glslv","color_id.glslf");break;default:F(a,"main.glslv","main_stack.glslf")}w(a,"SHADELESS",1);A(a,"a_position");A(a,"a_normal");ua.set(1,0,1,1,a.vc);if(b){var c=b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===c?0:1);w(a,"ALPHA_CLIP","CLIP"===c?1:0);w(a,"VERTEX_COLOR",
0);a.Mh=b.offset_z;r(a,b)}return!0}function x(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.wn?w(a,"AU_QUALIFIER","attribute"):w(a,"AU_QUALIFIER","uniform"),w(a,"STATIC_BATCH",0)):(w(a,"AU_QUALIFIER","attribute"),w(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(E.oE()?w(a,"WIREFRAME_QUALITY",1):w(a,"WIREFRAME_QUALITY",0),a.nh?(w(a,"DEBUG_SPHERE",1),a.uu?w(a,"DEBUG_SPHERE_DYNAMIC",1):w(a,"DEBUG_SPHERE_DYNAMIC",0)):w(a,"DEBUG_SPHERE",0),w(a,"ALPHA",1));b.te&&(a.te=b.te);b.Gd?(""!==b.wf?(a.ac.a_bending_col_main=
{vh:!0,src:[{name:b.wf,Ud:4}]},A(a,"a_bending_col_main"),""!==b.uc.Vv&&""!==b.uc.Uv&&""!==b.uc.zw?(a.ac.a_bending_col_detail={vh:!0,src:[{name:b.uc.Vv,Ud:4},{name:b.uc.Uv,Ud:2},{name:b.uc.zw,Ud:1}]},A(a,"a_bending_col_detail"),A(a,"a_normal"),w(a,"DETAIL_BEND",1)):w(a,"DETAIL_BEND",0),w(a,"MAIN_BEND_COL",1)):w(a,"MAIN_BEND_COL",0),w(a,"WIND_BEND",1)):w(a,"WIND_BEND",0);b.Cm?w(a,"BEND_CENTER_ONLY",1):w(a,"BEND_CENTER_ONLY",0);w(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.rp|0);b.ee?w(a,"BILLBOARD",1):w(a,
"BILLBOARD",0);b.ee&&b.wn?w(a,"HAIR_BILLBOARD",1):w(a,"HAIR_BILLBOARD",0);b.lk?w(a,"BILLBOARD_SPHERICAL",1):w(a,"BILLBOARD_SPHERICAL",0);switch(b.mk){case "RANDOM":w(a,"BILLBOARD_RANDOM",1);w(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":w(a,"BILLBOARD_RANDOM",0);w(a,"BILLBOARD_JITTERED",1);break;default:w(a,"BILLBOARD_RANDOM",0),w(a,"BILLBOARD_JITTERED",0)}b.cc&&ca.tm?w(a,"DYNAMIC_GRASS",1):w(a,"DYNAMIC_GRASS",0);a.cc=b.cc;"PARTICLES"!=a.type&&(a.He=b.He);a.zd=b.zd;a.Uc=b.Uc;a.Vc=b.Vc&&!a.Ed&&
!(a.Ja&&ca.fq);a.Ec=b.Ec;a.wc=b.wc;a.Rc=b.Rc;b.dj?(A(a,"a_influence"),w(a,"SKINNED",1),ca.bp?(w(a,"DISABLE_TANGENT_SKINNING",1),w(a,"FRAMES_BLENDING",0)):(w(a,"DISABLE_TANGENT_SKINNING",0),b.Xk?w(a,"FRAMES_BLENDING",1):w(a,"FRAMES_BLENDING",0)),w(a,"MAX_BONES",b.yf)):(w(a,"SKINNED",0),w(a,"FRAMES_BLENDING",0),w(a,"DISABLE_TANGENT_SKINNING",0));b.mc?(w(a,"VERTEX_ANIM",1),ca.ry?w(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):w(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):w(a,"VERTEX_ANIM",0);if(b.dj&&
b.mc)throw"Skinning and vertex animation are mutually exlusive";b.Xm?w(a,"DISABLE_FOG",1):w(a,"DISABLE_FOG",0);if(a.$i){for(var c=a.zb.mg,d=b.Hh,f=b.Gh,e=0;e<c.length;e++){var g=c[e];switch(g.id){case "VALUE":var h=g.Rn[0];if(h)for(var k=0;k<d.length;k+=2)if(d[k]==h){g.La.push(["VALUE_IND",d[k+1]]);break}break;case "RGB":if(h=g.Rn[0])for(k=0;k<f.length;k+=2)if(f[k]==h){g.La.push(["RGB_IND",f[k+1]]);break}}}w(a,"NUM_VALUES",b.xf.length);w(a,"NUM_RGBS",b.qd.length)}}}function L(a,b,c){if(b.length){for(var d=
ia.jn(b,ca.Xc&&c.b4w_enable_ssao),f=a.zb,e=0,g=0;g<a.zb.mg.length;g++){var h=a.zb.mg[g];if("LIGHTING_LAMP"==h.id){var k=b[e++%b.length],m=k.Oa;"AREA"==m.type&&(k=b[e++%b.length],m=k.Oa);var l=ia.Sa(k,c);if("SPOT"==m.type||"POINT"==m.type)var r=Math.cos(m.ci/2);if("SPOT"==m.type)var n=m.Pl*(1-r);l=l.Ch;k=d.indexOf(k);h.La=[["LAMP_TYPE",m.type],["LAMP_IND",l],["LAMP_LIGHT_FACT_IND",Math.floor(l/2)],["LAMP_FAC_CHANNELS",0==l%2?"rg":"ba"],["LAMP_SPOT_SIZE",ma.q(r||.01)],["LAMP_SPOT_BLEND",ma.q(n||.01)],
["LAMP_LIGHT_DIST",ma.q(m.distance)],["LAMP_SHADOW_MAP_IND",k]]}}if(a.fj){c=0;for(var q in a.fj)c++;a.$q=new Float32Array(3*c);a.Yq=new Float32Array(3*c);a.Xq=new Float32Array(3*c);a.Zq=new Float32Array(4*c);ma.L(f,"NUM_LAMP_LIGHTS",c);for(g=0;g<b.length;g++)P(a,b[g])}}}function P(a,b){if(b.Jg in a.fj){var c=a.fj[b.Jg],d=Z.get_trans_view(b.g.i);a.$q.set(d,3*c);a.Yq.set(b.Oa.direction,3*c);a.Xq.set(b.Oa.Bk,3*c);var d=K,f=b.Oa;d[0]=-1;d[1]=-1;d[2]=-1;d[3]=f.hi?1:0;switch(f.type){case "POINT":d[2]=f.distance;
break;case "SPOT":d[2]=f.distance;var e=d[0]=Math.cos(f.ci/2);d[1]=f.Pl*(1-e)}a.Zq.set(d,4*c)}}function A(a,b){var c=a.Ck;-1==c.indexOf(b)&&c.push(b)}function w(a,b,c){ma.L(a.zb,b,c)}function I(a,b){if("PHYSICS"==a.type)0<b.qa.length&&ea.KH(b,b.D[0]),a.Bd=b;else{var c=a.Pf,d=a.nf;a.ov&&"PARTICLES"!=a.type&&(b=ea.hD(b));a.Ay&&(b=J.ND(a.By,a.Cy,a.zy));c=ea.MH(b,c,d,a.ac);a.P=c;a.He||c.rn||a.te||(c.eg=null,c.zc=null);c=b.D.length;a.num_vertices=b.fa*c;a:switch(a.nf){case ea.ek:case ea.jm:case ea.im:d=
!0;break a;default:d=!1}d?ea.NE(b)?a.num_triangles=b.Ia.length/3*c:a.num_triangles=b.fa/3*c:a.num_triangles=0}}function T(a,b,c,f,e,g,h,k,m,l,r,n){var q=a.oa,t=[],u=k.b4w_dynamic_grass;if(!l&&u)return t;for(var p="INSTANCE"==k.b4w_wind_bend_inheritance,w="INSTANCE"==k.b4w_shadow_inheritance,J="INSTANCE"==k.b4w_reflection_inheritance,v=[],z=[],F=0;F<e.length;F++){var A=e[F].oa.g,y=Y.wk(b);y.ee=k.b4w_hair_billboard;y.mk=k.b4w_hair_billboard_type;y.lk="SPHERICAL"==k.b4w_hair_billboard_geometry;y.cc=
u;y.wn=!0;y.xf=A.xf;y.Hh=A.Hh;y.qd=A.qd;y.Gh=A.Gh;p?(y.Gd=A.Gd,y.em=A.em,y.Mf=A.Mf,y.mf=A.mf,y.wf=A.wf,y.lf=A.lf,y.ff=A.ff,y.Ye=A.Ye,y.uc=A.uc,y.Cm=!1):(y.Gd=q.g.Gd,y.em=q.g.em,y.Mf=q.g.Mf,y.mf=q.g.mf,y.wf=q.g.wf,y.lf=q.g.lf,y.ff=q.g.ff,y.Ye=q.g.Ye,y.uc=q.g.uc,y.Cm=!0);w?(y.zd=A.zd,y.Uc=A.Uc,y.Vc=A.Vc):(y.zd=q.g.zd,y.Uc=q.g.Uc,y.Vc=q.g.Vc);J?(y.Ec=A.Ec,y.wc=A.wc,y.Rc=A.Rc,y.Kd=A.Kd,y.td=A.td,y.Qe=A.Qe):(y.Ec=q.g.Ec,y.wc=q.g.wc,y.Rc=q.g.Rc,y.Kd=q.g.Kd,y.td=q.g.td,y.Qe=q.g.Qe);v.push(y);var H=h[F];
H||(H=new Float32Array);n&&Y.sn(m.seed,r);var I=new Float32Array(3),D=new Float32Array([0,0,0,1]),Q=[],C=W.au(ca.hr)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,L=4;C&&(L=8);for(var R=0;R<H.length;R+=L){I[0]=H[R];I[1]=H[R+1];I[2]=H[R+2];var S=H[R+3]*Z.get_scale(A.i);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var E=new Float32Array([Y.Yd(r),Y.Yd(r),Y.Yd(r)]);Fa.normalize(E,E);break;case "Z":E=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+
k.b4w_rotation_type;}V.setAxisAngle(E,k.b4w_rand_rotation_strength*(2*Math.PI*Y.Yd(r)-Math.PI),D)}else if(C&&(D.set(H.subarray(R+4,R+8)),Y.Kr(D,D),!k.use_whole_group))if(k.use_rotation_dupli){var M=Z.get_quat_view(A.i);V.multiply(D,M,D)}else V.multiply(D,da,D);var N=Z.set_sep(I,S,D,Z.create());Q.push(N)}z.push(Q)}for(var T={},F=0;F<e.length;F++){var sa=e[F],P=g[F],y=v[F],ma={};y.Gd&&(ma.au_wind_bending_amp=[y.Ye],ma.au_wind_bending_freq=[y.Mf],ma.au_detail_bending_freq=[y.mf],ma.au_detail_bending_amp=
[y.lf],ma.au_branch_bending_amp=[y.ff],y.Ye=0,y.Mf=0,y.mf=0,y.lf=0,y.ff=0);var K=G(y),Q=z[F];if(Q.length)for(var ha=sa.data,ga=ha.materials,qa=Array(ga.length),R=0;R<ga.length;R++)if(!ea.vv(ha,R))for(var la=0;la<P.length;la++){var fa=P[la],ia=d(fa),oa=ga[R];"COLOR_ID"==fa&&(ia.Ep=!(sa.b4w_do_not_render||oa.b4w_do_not_render));"MAIN"==fa&&(qa[R]=ia);if(O(ia,oa)){"SHADOW"==fa&&qa[R]&&(ia.Ed=qa[R].Ed);ia.nf=ea.ek;x(ia,y);ia.rj=k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(ia.Qv=k.b4w_hair_billboard_jitter_amp,
ia.Rv=k.b4w_hair_billboard_jitter_freq);u&&(ia.mv=k.b4w_dynamic_grass_scale_threshold);p||(delete ia.ac.a_bending_col_main,delete ia.ac.a_bending_col_detail);B(ia,K);var na=ea.Ju(ha,R,ia.Ck,b.xi,ia.ac,ia.ii),ya=ea.vF(na,ma,Q),ja=ya,ua=Q;ja.O.au_center_pos=new Float32Array(3*ja.fa);for(var va=ua.length,ab=ja.fa/va,Ka=0;Ka<va;Ka++)for(var eb=ua[Ka],bb=3*ab*Ka,La=0;La<ab;La++)ja.O.au_center_pos[bb+3*La]=eb[0],ja.O.au_center_pos[bb+3*La+1]=eb[1],ja.O.au_center_pos[bb+3*La+2]=eb[2];ya=ja;if(y.Gd&&y.Cm){var Ea=
ya,Jb=q.g.i;Ea.O.a_emitter_center=new Float32Array(3*Ea.fa);var Ga=Fa.fromValues(0,0,0);Z.transform_vec3(Ga,Jb,Ga);for(var rc=0;rc<Ea.fa;rc++)Ea.O.a_emitter_center[3*rc]=Ga[0],Ea.O.a_emitter_center[3*rc+1]=Ga[1],Ea.O.a_emitter_center[3*rc+2]=Ga[2];ya=Ea}var fb=k.b4w_vcol_from_name,sc=k.b4w_vcol_to_name,tc=ia,gc=c,Vc=!p,Ec=ha,Vb=[];if(""!==fb&&""!==sc){var Wb,Ab=sc,Jc=tc.ac,nb=[],Bb=void 0;for(Bb in Jc)for(var gb=Jc[Bb].src,Cb=0,Na=0;Na<gb.length;Na++){var hb=gb[Na].Ud;Ab==gb[Na].name&&nb.push(Bb,
hb,Cb);Cb+=Y.Xh(hb)}Wb=nb;if(0<Wb.length)for(var wb=0;wb<Wb.length;wb+=3)Vb.push({Qk:fb,an:7,Tn:Wb[wb],Un:Wb[wb+1],Ym:Wb[wb+2]});else ea.yE(tc.Ck,"a_color")&&sc==Ec.active_vcol_name&&Vb.push({Qk:fb,an:7,Tn:"a_color",Un:7,Ym:0})}Vc&&("a_bending_col_main"in gc&&Vb.push({Qk:"a_bending_col_main",an:4,Tn:"a_bending_col_main",Un:4,Ym:0}),"a_bending_col_detail"in gc&&Vb.push({Qk:"a_bending_col_detail",an:7,Tn:"a_bending_col_detail",Un:7,Ym:0}));for(var Lb=ya,Kc=Q,Rb=f,Kb=Vb,pb=ia.ac,Lc=!1,qb=0;qb<Kb.length;qb++){var Db=
Kb[qb].Qk,Xb=Rb.O[Db];if(Xb&&0<Xb.length){Lc=!0;break}}if(Lc){var Ma,Ya=q.g.bc,Wa=Rb.D[0].a_position,Va=Kc,Aa=T,Yb=new Float32Array(3),rb=new Float32Array(3),Sb=new Uint32Array(Va.length);if(!("verts_indices"in Aa)){Aa.hf=new Float32Array(3);Aa.df=new Float32Array(3);Aa.Ss=new Uint32Array(Wa.length/3);Aa.ql=new Uint32Array(Wa.length/3);Aa.hf[0]=(Ya.max_x-Ya.min_x)/20;Aa.hf[1]=(Ya.max_y-Ya.min_y)/20;Aa.hf[2]=(Ya.max_z-Ya.min_z)/20;Aa.df[0]=Ya.min_x;Aa.df[1]=Ya.min_y;Aa.df[2]=Ya.min_z;for(var Sa=0;Sa<
Wa.length/3;Sa++){var kc=Y.trunc((Wa[3*Sa]-Aa.df[0])/Aa.hf[0]),sb=Y.trunc((Wa[3*Sa+1]-Aa.df[1])/Aa.hf[1]),tb=Y.trunc((Wa[3*Sa+2]-Aa.df[2])/Aa.hf[2]),kc=Y.clamp(kc,0,19),sb=Y.clamp(sb,0,19),tb=Y.clamp(tb,0,19);Aa.Ss[Sa]=Sa;Aa.ql[Sa]=tb*Math.pow(20,2)+20*sb+kc}ea.xx(Aa.ql,Aa.Ss,ea.Yo,!0);Aa.ki=new Uint32Array(Math.pow(20,3));for(Sa=0;Sa<Aa.ql.length;Sa++)Aa.ki[Aa.ql[Sa]]++;delete Aa.ql;for(Sa=1;Sa<Aa.ki.length;Sa++)Aa.ki[Sa]+=Aa.ki[Sa-1]}for(var Nb=0;Nb<Va.length;Nb++){Yb[0]=Va[Nb][0];Yb[1]=Va[Nb][1];
Yb[2]=Va[Nb][2];for(var hc=1E10,Ob=-1,uc=Y.trunc((Yb[0]-Aa.df[0])/Aa.hf[0]),Tb=Y.trunc((Yb[1]-Aa.df[1])/Aa.hf[1]),Pb=Y.trunc((Yb[2]-Aa.df[2])/Aa.hf[2]),uc=Y.clamp(uc,0,19),Tb=Y.clamp(Tb,0,19),Pb=Y.clamp(Pb,0,19),Eb=Pb*Math.pow(20,2)+20*Tb+uc,Oa=Aa.ki[Eb],Ta=0==Eb?0:Aa.ki[Eb-1];Ta<Oa;Ta++){var ib=Aa.Ss[Ta];rb[0]=Wa[3*ib];rb[1]=Wa[3*ib+1];rb[2]=Wa[3*ib+2];Fa.sub(rb,Yb,rb);var bc=Fa.sqrLen(rb);bc<=hc&&(hc=bc,Ob=ib)}if(-1==Ob)for(Ta=0;Ta<Wa.length/3;Ta++)rb[0]=Wa[3*Ta],rb[1]=Wa[3*Ta+1],rb[2]=Wa[3*Ta+
2],Fa.sub(rb,Yb,rb),bc=Fa.sqrLen(rb),bc<=hc&&(hc=bc,Ob=Ta);Sb[Nb]=Ob}Ma=Sb;for(var Zb=Lb.fa/Kc.length,qb=0;qb<Kb.length;qb++){var Fb=Kb[qb].Tn,cc=Kb[qb].Un,Db=Kb[qb].Qk,jb=Kb[qb].an,Xb=Rb.O[Db];switch(Fb){case "a_bending_col_main":var Qb=1;break;case "a_bending_col_detail":Qb=3;break;case "a_color":Qb=3;break;default:for(var kb=Qb=0;kb<pb[Fb].src.length;kb++)Qb+=Y.Xh(pb[Fb].src[kb].Ud)}if(Xb&&0<Xb.length){var lc=Y.Xh(jb),vc=Y.Xh(cc),mc=jb&cc,dc=Y.cx(mc);mc!=cc&&ba.error("Wrong color extraction from "+
Db+" to "+Fb+".");if("a_bending_col_main"==Fb||"a_bending_col_detail"==Fb)Lb.O[Fb]=new Float32Array(Lb.fa*vc);for(kb=0;kb<Kc.length;kb++){var wc=Ma[kb],$b=wc*lc,Sc=kb*Zb*Qb;if(-1!=wc)for(var Fc=0;Fc<Zb;Fc++)for(var Mc=Fc*Qb,Gb=0;Gb<dc.length;Gb++)dc[Gb]&&(Lb.O[Fb][Sc+Mc+(Kb[qb].Ym+Y.Hl(cc,Gb))]=Xb[$b+Y.Hl(jb,Gb)])}}else Lb.O[Fb]=new Float32Array(0)}}ya=Lb;t.push({I:ia,Bd:ya,Nc:[oa.name],g:y,wd:[a]})}}}return t}function O(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=la.Zt(b));return c=c&&e(a,b)}function B(a,
b){for(var c=null,d=null,f=0;f<a.U.length;f++){var e=a.U[f].ed;e&&(c||(c={}),c[f]=e,a.U[f].ed=null);if(e=a.U[f].ha)d||(d={}),d[f]=e,a.U[f].ha=null}a.id=0;a.oG=b;a.id=Y.St(a,b);if(c)for(var g in c)a.U[g].ed=c[g];if(d)for(g in d)a.U[g].ha=d[g]}function G(a){var b=a.Jd;a.Jd=null;var c=Y.St(a,0);a.Jd=b;return c}function M(a,b,c,f,e){var g=d("WIREFRAME");F(g,"wireframe.glslv","wireframe.glslf");g.wireframe_mode=0;g.nh=!0;g.ra=!0;g.rj=c;e&&(g.uu=!0);x(g,b);b=G(b);B(g,b);f?(f=J.zq(1,a.K),ea.gx(f,[a.Be[0],
a.Ce[1],a.De[2]],a.K)):f=J.zq(a.Pa,a.K);ea.uo(f,1,!0);f.O.a_polyindex=ea.qq(f);I(g,f);return g}function F(a,b,c){a.zb.$j=b;a.zb.Mi=c;ma.HG(a.zb)}function R(a,b,c){1==a.U.length&&0==a.lc.length&&a.lc.push("default0");c=c||"default"+String(a.U.length);-1==a.lc.indexOf(c)&&(a.U.push(b),a.lc.push(c));a.gc&&Q.Ft(a)}function S(a){if(!a.zb)throw"No shaders info for batch "+a.name;a.gc=ma.ZD(a.zb);Q.VA(a.gc);Q.ip(a);Q.Ft(a)}function ha(a,b,c){a=a.B[0].T;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].Ke&&
-1!=a[d].pd.indexOf(b))return a[d];return null}function N(a,b,c){a=a.B[0].T;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].Ke&&-1!=a[d].pd.indexOf(b))return a[d];return null}function oa(a,b){a.vc.set(b.vc);a.ag=b.ag;a.Te.set(b.Te);a.bi=b.bi;a.Wc.set(b.Wc);a.of=b.of;a.bf=b.bf;a.$f=b.$f;a.Sf=b.Sf;a.reflect_factor=b.reflect_factor;a.ke.set(b.ke);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);
a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.bk=b.bk}var fa=p("__boundings");p("__camera");var na=p("__config"),ba=p("__print"),E=p("__extensions"),ea=p("__geometry"),qa=p("__graph");p("__lights");var la=p("__nodemat"),ia=p("__obj_util"),ya=p("__particles"),J=p("__primitives"),V=p("__quat"),W=p("__reformer"),Q=p("__renderer"),sa=p("__scenegraph"),ma=p("__shaders");p("__scenes");var ga=p("__textures"),Z=p("__tsr"),Y=p("__util"),Fa=p("__vec3"),ua=p("__vec4"),ca=na.p,ja=
["MAIN"],da=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]);new Float32Array(3);var K=new Float32Array(4);a.sJ=va;var va="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" ");a.qL=d;a.MD=function(a,c,d,f){for(var e=[],h=[],k=0;k<c.length;k++){var m=c[k],l=m.oa;l.ll||(ia.ma(l)?e.push(m):h.push(m))}for(var k=[],k=k.concat(n(e,a.k.jb)),l=k=k.concat(g(h,a.k.jb,a.b4w_batch_grid_size)),e=[],h=[],r={},k=0;k<l.length;k++){var q=l[k].I,t=l[k].g,u=null;if(q.id in r){for(var p=
r[q.id],w=h[p].I,J=h[p].g,x=null,v=null,m=0;m<q.U.length;m++){var A=q.U[m].ed;A&&(x||(x={}),x[m]=A,q.U[m].ed=null);if(A=q.U[m].ha)v||(v={}),v[m]=A,q.U[m].ha=null}Y.Ix(q,w)&&Y.Ix(t,J)&&(u=h[p]);if(x)for(m in x)q.U[m].ed=x[m];if(v)for(m in v)q.U[m].ha=v[m];if(!u){do q.id++;while(r[q.id])}}u||(u={I:q,g:l[k].g,wd:[],xs:[],Nc:[]},r[q.id]=h.length,h.push(u));u.wd=u.wd.concat(l[k].wd);l[k].Bd&&l[k].Bd.fa&&u.xs.push(l[k].Bd);if(u.Nc.length)for(m=0;m<l[k].Nc.length;m++)q=l[k].Nc[m],-1==u.Nc.indexOf(q)&&u.Nc.push(q);
else u.Nc=l[k].Nc;ea.xx(u.Nc,u.xs,ea.bA,!1)}for(k=0;k<h.length;k++){l=h[k].xs;if(0==l.length)m=Y.Xb(Y.Wj("%empty"));else if(1==l.length)m=l[0];else{r=[];for(m=0;m<l.length;m++)ea.OE(l[m])||r.push(m);if(r.length<l.length)for(m=0;m<r.length;m++)ea.uo(l[r[m]]);m=ea.LH(l)}e.push({I:h[k].I,g:h[k].g,Bd:m,Nc:h[k].Nc,wd:h[k].wd})}for(h=0;h<e.length;h++)if(l=e[h].I,l.pd=e[h].Nc,I(l,e[h].Bd),L(l,d,a),"STATIC"==e[h].g.type&&"COLOR_ID"!=l.type){if(k=Y.Wj("%meta%"+l.type+"%"+l.pd.join("%")+"%"),r=ia.Ai(k,"MESH"),
r.g=e[h].g,ia.ti(r,a),ia.wm(r,a,l),f.push(r),"MAIN"==l.type)for(m=0;m<e[h].wd.length;m++)k=e[h].wd[m],k=k.oa,k.iw.push(r)}else for(r=[],m=0;m<e[h].wd.length;m++)k=e[h].wd[m],k=k.oa,-1==r.indexOf(k.name)&&(ia.wm(k,a,l),r.push(k.name));if(ca.wireframe_debug){for(h=0;h<e.length;h++)if(d=e[h].g,"DYNAMIC"==d.type&&(k=e[h].wd[0].oa,-1<ja.indexOf(e[h].I.type))){m=ia.Sa(k,a);l=m.T;r=!1;for(m=0;m<l.length;m++)l[m].nh&&(r=!0);r||(d=M(d.ef,d,k.name,!0,!0),ia.wm(k,a,d))}for(h=0;h<f.length;h++)k=f[h],d=k.g,m=
ia.Sa(k,a),l=m.T,-1<ja.indexOf(l[0].type)&&(d=M(d.dd,d,k.name,!1),ia.wm(k,a,d))}for(h=0;h<c.length;h++)for(m=ia.Sa(c[h].oa,a),l=m.T,m=0;m<l.length;m++)b(l[m]);for(h=0;h<f.length;h++)for(m=ia.Sa(f[h],a),l=m.T,m=0;m<l.length;m++)b(l[m])};a.OD=function(a,c){var f=a.k.at,e=d("MAIN");F(e,"special_skydome.glslv","special_skydome.glslf");if(c.procedural_skydome)w(e,"PROCEDURAL_SKYDOME",1),e.Nw=!0;else{var g=f.ns;if(g){w(e,"WO_SKYTEX",1);var h=u(f.vx,null);R(e,h,"u_sky");g.invert&&w(e,"MTEX_NEGATIVE",1);
g.VI&&w(e,"MTEX_RGBTOINT",1);w(e,"BLENDTYPE",g.cB);g.QI&&w(e,"WOMAP_BLEND",1);g.RI&&w(e,"WOMAP_HORIZ",1);g.TI&&w(e,"WOMAP_ZENUP",1);g.SI&&w(e,"WOMAP_ZENDOWN",1)}f.WI&&w(e,"WO_SKYBLEND",1);f.XI&&w(e,"WO_SKYPAPER",1);f.YI&&w(e,"WO_SKYREAL",1)}c.Ec&&(e.Ec=!0,c.wc&&(e.wc=!0));e.Mh=99999;A(e,"a_position");f=J.ID();I(e,f);b(e);f=Y.Wj("%meta_sky%");f=ia.Ai(f,"MESH");ia.ti(f,a);g=ia.Sa(f,a);f.g=ia.lh("STATIC");f.g.ph=!0;f.g.bc=fa.$c();f.g.dd=fa.oi();f.g.Cb=fa.$c();f.g.Wb=fa.oi();g.T.push(e);return f};a.pu=
function(a,b,d){d=ia.Sa(a,d).T;var f=[];sa.Fb(b,"SHADOW_CAST");var e=sa.Fb(b,"MAIN_PLANE_REFLECT"),g=sa.Fb(b,"MAIN_CUBE_REFLECT"),h=sa.Fb(b,"OUTLINE_MASK");b=sa.Fb(b,"COLOR_PICKING");for(var k=0;k<d.length;k++){var m=d[k],l=null;"SHADOW"==m.type&&"RECEIVE"==m.hb&&m.zd&&(l=c(m),l.hb="CAST");"MAIN"!=m.type&&"PARTICLES"!=m.type||!e&&!g||m.Ja||!m.Ec||(l=c(m),l.hb="REFLECT",l.Ba=m.Ba);"COLOR_ID"==m.type&&m.Ep&&h&&a.g.Kb&&(b&&a.g.xg?(l=c(m),l.hb="OUTLINE"):m.hb="OUTLINE");l&&(l.Ke=!0,B(l,a.g.id),f.push(l))}d.push.apply(d,
f)};a.WG=l;a.mJ=function(a,b,c){if(b)b=c*(b.max_y-b.min_y);else throw"No bounding box for mesh";return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.YA=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.VD=u;a.GA=m;a.fI=h;a.eI=L;a.SG=P;a.Et=function(a,b){w(a,"CSM_SECTION0",0);w(a,"CSM_SECTION1",0);w(a,"CSM_SECTION2",0);w(a,"CSM_SECTION3",0);w(a,"NUM_CAST_LAMPS",0);if(b){w(a,"NUM_CAST_LAMPS",b.le.length);ca.Fn&&
w(a,"MAC_OS_SHADOW_HACK",1);for(var c=0;c<b.csm_num;c++)w(a,"CSM_SECTION"+String(c),1);w(a,"SHADOW_TEX_RES",ma.q(b.csm_resolution));w(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);w(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else w(a,"SHADOW_TEX_RES",0),w(a,"CSM_FADE_LAST_CASCADE",0),w(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.va=w;a.dc=function(a,b){return ma.cE(a.zb,b)};a.cI=I;a.dI=B;a.mB=G;a.uK=M;a.ui=R;a.tG=function(a,b,c){c=a.lc.indexOf(c);-1<c&&(a.U[c]=b)};a.pC=function(a,
b){var c=d("MAIN");c.Ja=!0;ua.set(b[0],b[1],b[2],.5,c.vc);c.nf=ea.jm;I(c,a);F(c,"main.glslv","main_stack.glslf");w(c,"SHADELESS",1);S(c);return c};a.Sb=S;a.LD=function(a,c){for(var f=0;f<c.length;f++){var e=c[f].oa,g=d("LINE");F(g,"line.glslv","line.glslf");g.Ja=!0;var h=J.KD();I(g,h);b(g);ia.ti(e,a);ia.Sa(e,a).T.push(g);S(g)}};a.uB=function(a){return a.gc.xl.length?a.gc.Er.u_cube_fog?!0:!1:!1};a.YB=function(){var a=d("DEPTH_PACK");a.nb=!0;a.ra=!1;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv",
"postprocessing/depth_pack.glslf");S(a);return a};a.Tp=function(a){var b=d("POSTPROCESSING");F(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":w(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":w(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":w(b,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":w(b,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":w(b,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":w(b,
"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":w(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":w(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;case "FLIP_CUBEMAP_COORDS":w(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:throw"Wrong postprocessing effect: "+a;}b.nb=!0;b.ra=!1;a=J.Pb();I(b,a);S(b);return b};a.sC=function(a){var b=d("SSAO");b.ra=!1;b.nb=!0;var c=J.Pb();I(b,c);F(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");w(b,"SSAO_QUALITY",
"SSAO_QUALITY_"+a.Dx);w(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:ga.Wu("SSAO_TEXTURE",a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=u(a,c);R(b,a,"u_ssao_special_tex");S(b);return b};a.tC=function(a){var b=d("SSAO_BLUR");b.ra=!1;b.nb=!0;var c=J.Pb();I(b,c);F(b,"postprocessing/postprocessing.glslv",
"postprocessing/ssao_blur.glslf");w(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);S(b);return b};a.ZB=function(){var a=d("DOF");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");w(a,"DEPTH_RGBA",1);S(a);return a};a.hC=function(){var a=d("OUTLINE");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");S(a);return a};a.aC=function(){var a=d("GLOW_COMBINE");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);
F(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");S(a);return a};a.bC=function(a,b,c){var f=d("GOD_RAYS");f.ra=!1;f.nb=!0;var e=J.DD();I(f,e);F(f,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");w(f,"DEPTH_RGBA",a?1:0);w(f,"WATER_EFFECTS",b?1:0);w(f,"STEPS_PER_PASS",ma.q(c,1));S(f);return f};a.cC=function(){var a=d("GOD_RAYS_COM");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");w(a,"SAFARI_CANVAS_ALPHA_HACK",
ca.fx?1:0);S(a);return a};a.kC=function(){var a=d("SKY");a.ra=!1;a.nb=!0;var b=J.ED();I(a,b);F(a,"procedural_skydome.glslv","procedural_skydome.glslf");w(a,"WATER_EFFECTS",1);S(a);return a};a.RB=function(a){var b=d("ANTIALIASING");b.ra=!1;b.nb=!0;var c=J.Pb();I(b,c);F(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ca.Qw?(w(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),w(b,"AA_QUALITY",a.CD)):w(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");S(b);return b};a.qC=function(a){var b=d("SMAA"),
c=J.Pb();I(b,c);F(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");w(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");w(b,"SMAA_PASS",a);w(b,"SMAA_PREDICATION",0);w(b,"SMAA_REPROJECTION",0);S(b);b.ra=!1;b.nb=!0;return b};a.WB=function(){var a=d("COMPOSITING");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");S(a);return a};a.gC=function(){var a=d("MOTION_BLUR");a.nb=!0;a.ra=!1;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv",
"postprocessing/motion_blur.glslf");S(a);return a};a.uC=function(a){var b=d("STEREO");b.nb=!0;b.ra=!1;var c=J.Pb();I(b,c);F(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");w(b,"ANAGLYPH","ANAGLYPH"===a?1:0);w(b,"DISABLE_DISTORTION_CORRECTION",ca.use_browser_distortion_cor?1:0);S(b);return b};a.dC=function(){var a=d("LUMINANCE");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");S(a);return a};a.SB=function(){var a=
d("LUMINANCE");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");S(a);return a};a.eC=function(){var a=d("LUMINANCE_X_BLUR");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");S(a);return a};a.TB=function(){var a=d("POSTPROCESSING");a.nb=!0;a.ra=!1;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");S(a);return a};a.UB=
function(){var a=d("BLOOM");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");S(a);return a};a.yC=function(){var a=d("VELOCITY");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");S(a);return a};a.QB=function(){var a=d("ANCHOR_VISIBILITY");a.ra=!0;a.nb=!0;a.nf=ea.gt;F(a,"anchors.glslv","anchors.glslf");var b=J.Uu(1);I(a,b);w(a,"ANCHOR_NUM",1);S(a);a.xj=new Float32Array([0,
0,0]);return a};a.iC=function(){var a=d("PERFORMANCE");a.ra=!1;a.nb=!0;var b=J.Pb();I(a,b);F(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");w(a,"POST_EFFECT","POST_EFFECT_X_BLUR");S(a);return a};a.bI=function(a,b){var c=b.length/3;if(c!=a.xj.length/3){var d=J.Uu(c);I(a,d);w(a,"ANCHOR_NUM",c);S(a)}a.xj=b};a.Fq=function(a){if(!a.B.length)return null;a=a.B[0];return a.T.length?a.T[0]:null};a.Fa=ha;a.ld=N;a.UL=oa;a.lK=function(a,b){for(var c=a.B[0].T,d=0;d<c.length;d++)if(c[d].type==
b)return!0;return!1};a.LB=function(a){for(var b=a.U,c=0;c<b.length;c++)ga.MC(b[c].Qa);ea.du(a.P)};a.inherit_material=function(a,b,c,d){for(var f=["MAIN","SHADOW","COLOR_ID"],e=!1,g=0;g<f.length;g++){var h=f[g],k=ha(a,b,h),m=ha(c,d,h);if(k&&m){var e=!0,l=N(c,d,h);"MAIN"==h&&(oa(m,k),l&&oa(l,k));for(h=0;h<m.lc.length;h++){var r=m.lc[h];if(-1!==va.indexOf(r)){var n=k.lc.indexOf(r);-1!==n&&(m.U[h]=k.U[n],l&&(r=l.lc.indexOf(r),-1!==r&&(l.U[r]=k.U[n])))}}}}e||ba.error("Wrong objects for inheriting material!")}};b4w.module.__nodemat=function(a,p){function d(a,c,f,e,h){var m=Fa.get_active(),m=g(c,h,m.uuid);if(m in da)return da[m];if("SHADOW"!=h&&"COLOR_ID"!=h){c=Q.create();for(var n=a.nodes,p=0;p<n.length;p++)if(null==A(c,n[p],0,e,h))return da[m]=null;if(f&&-1==L(a,c,"GROUP_OUTPUT","group"))return null;p=ea(c);n=f?a.links:a.links.slice();if(!qa(c,n,p))return null;if(f)return c;for(p=0;p<n.length;p++){f=n[p];for(var w=r(f.from_node,c),J=r(f.to_node,c),v=0;v<w.length;v++)for(var F=0;F<J.length;F++){var z=w[v],
y=J[F],W=Q.Da(c,z),V=Q.Da(c,y);if(!ba(c,z,y,W,V,f))return da[m]=null}}k(c);a="GLOW"==h?L(a,c,"B4W_GLOW_OUTPUT","material",!0):L(a,c,"OUTPUT","material",!1,!0);-1==a&&(c=l(),a=0);u(c);a=Q.so(c,a,Q.hm);b(a,e);t(a);D(a);x(a);H(a,e,h)}else e=d(a,c,f,e,"MAIN"),e=Q.clone(e,function(a){var b=ua.wk(a);b.J=ua.za(a.J);b.Aa=ua.za(a.Aa);return b}),a=L(a,e,"OUTPUT","material",!1,!0),q(e,a),a=Q.so(e,a,Q.hm),t(a);return da[m]=a}function b(a,b){var d=[];Q.ba(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||
d.push({OF:a,node:b})});for(var f=0;f<d.length;++f){var e=d[f].OF,g=d[f].node,h=Q.bl(a);Q.si(a,h,g.data.yF);var k=Q.bl(a);Q.si(a,k,g.data.zF);Q.rc(a,h,k,[4,2]);for(var m={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},l=Q.qn(a,e),r=[],n=[],q=[],t={},u=0;u<l;u++){var p=Q.Si(a,e,u);p in t||(t[p]=0);var w=Q.sf(a,p,e,t[p]++);r.push([p,e,w]);var J=m[w[1]];if(J)switch(J[0]){case "MATERIAL_END":n.push([p,k,[w[0],J[1]]]);break;case "LIGHTING_APPLY":q.push([p,
[w[0],J[1]]])}else n.push([p,h,w])}c(a,g.data.value,h,k,q,b);for(u=0;u<r.length;u++)Q.co(a,r[u][0],r[u][1],r[u][2]);for(u=0;u<n.length;u++)Q.rc(a,n[u][0],n[u][1],n[u][2]);g=Q.og(a,e);h=[];m=[];l={};for(u=0;u<g;u++)r=Q.cg(a,e,u),r in l||(l[r]=0),w=Q.sf(a,e,r,l[r]++),h.push([e,r,w]),m.push([k,r,w]);for(u=0;u<h.length;u++)Q.co(a,h[u][0],h[u][1],h[u][2]);for(u=0;u<m.length;u++)Q.rc(a,m[u][0],m[u][1],m[u][2]);Q.Re(a,e)}}function c(a,b,c,d,f,e){var g={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},h=
A(a,g,0,e,null),k=h;n(a,c,h,"E");n(a,c,h,"A");n(a,c,h,"D");h=Fa.get_active();h=ga.Ga(h,"LAMP",ga.DATA_ID_ALL);if(!b.Ed)for(var m,l,r=0;r<h.length;r++){var q=h[r].Oa,g={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=A(a,g,0,e,null);g={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};l=A(a,g,0,e,null);n(a,k,l,"color");n(a,k,l,"specular");n(a,m,l,"ldir");n(a,c,l,"normal");n(a,c,l,"D");n(a,c,l,"S");n(a,m,l,"lcolorint");n(a,c,m,"shadow_factor");k="COOKTORR"==b.Hj?"SPECULAR_PHONG":"SPECULAR_"+b.Hj;g={name:k,
type:k};g=A(a,g,0,e,null);n(a,m,g,"ldir");n(a,m,g,"lfac");n(a,c,g,"normal");n(a,g,l,"sfactor");"SPECULAR_PHONG"!=k&&"SPECULAR_BLINN"!=k||n(a,m,g,"norm_fac");n(a,c,g,"sp_params");k="HEMI"==q.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Lk;g={name:k,type:k};g=A(a,g,0,e,null);n(a,m,g,"ldir");n(a,m,g,"lfac");n(a,c,g,"normal");n(a,m,g,"norm_fac");n(a,g,l,"lfactor");"DIFFUSE_LAMBERT"!=k&&n(a,c,g,"dif_params");for(m=0;m<f.length;m++)Q.rc(a,f[m][0],l,f[m][1]);k=l}n(a,k,d,"color");n(a,k,d,"specular")}function n(a,
b,c,d){for(var f=Q.Da(a,b),e=Q.Da(a,c),g,h=0;h<e.J.length;h++)if(d==e.J[h].identifier){g=h;break}for(var k,h=0;h<f.Aa.length;h++)if(d==f.Aa[h].identifier){k=h;break}void 0!=g&&void 0!=k&&Q.rc(a,b,c,[k,g])}function g(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function q(a,b){Q.re(a,function(c,d,f){var e=Q.Da(a,d);d==b&&"Color"==e.J[f[1]].identifier&&Q.co(a,c,d,f)})}function l(){var a=Q.create(),b={data:null,La:[],r:[],J:[{Ra:new Float32Array([0,
0,0]),identifier:"Color",Zb:!1,name:"Color"},{Ra:1,identifier:"Alpha",Zb:!1,name:"Alpha"}],Aa:[],type:"OUTPUT",Mg:[]};Q.si(a,0,b);return a}function t(a){Q.ba(a,function(b,c){for(var d=c.J,f=c.Aa,g=0;g<d.length;g++)e(a,d[g],b,g,1);for(g=0;g<f.length;g++)e(a,f[g],b,g,0)})}function e(a,b,c,d,f){if(b.Zb){var e=!0;Q.re(a,function(a,b,g){if(!f&&a==c&&g[0]==d||f&&b==c&&g[1]==d)e=!1});e&&(b.Zb=!1)}}function H(a,b,c){var d=[];Q.re(a,function(f,e,g){var h=Q.Da(a,f),k=Q.Da(a,e),h=ua.is_vector(h.Aa[g[0]].Ra),
k=ua.is_vector(k.J[g[1]].Ra);if(h!=k){var m,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},r={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!k?m=P("vector_to_scalar","B4W_VECTOSCAL",[l],[r]):!h&&k&&(m=P("scalar_to_vector","B4W_SCALTOVEC",[r],[l]));A(a,m,0,b,c);d.push([f,e,a.G[a.G.length-2],g])}});for(var f=0;f<d.length;++f)Q.co(a,d[f][0],d[f][1],d[f][3]),Q.rc(a,d[f][0],d[f][2],[d[f][3][0],0]),Q.rc(a,d[f][2],d[f][1],[0,d[f][3][1]])}function k(a){var b=[];
Q.ba(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":Q.re(a,function(a,f,e){a==c&&"Translucency"==d.Aa[e[0]].name&&b.push(a,f,[e[0]+1,e[1]+1])})}});for(var c=0;c<b.length;c+=3)Q.rc(a,b[c],b[c+1],b[c+2])}function r(a,b){var c=[];Q.ba(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;throw"Node not found";}function u(a){var b=[];Q.ba(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],f=b[c+1];if("B4W_PARALLAX"==f.type){var e=
z(a,d);if(-1!=e){var g=Q.Si(a,e,0);Q.Wh(a,e,d,-1);-1!=g&&Q.Wh(a,g,e,-1);d=Q.Da(a,e);f.data=d.data;f.r[0]=d.r[0];Q.Re(a,e)}f.J.splice(1,1)}else if("REROUTE"==f.type){for(var f=Q.Si(a,d,0),h=Q.og(a,d),e=[],g=[],k=[],m=0;m<h;m++){var l=Q.cg(a,d,m),r=g.indexOf(l);-1!=r?k[r]+=1:(g.push(l),k.push(1),e.push(d,l))}if(-1!=f)for(h=Q.sf(a,f,d,0)[0],m=0;m<g.length;m++)for(l=0;l<k[m];l++)r=Q.sf(a,d,g[m],l)[1],Q.rc(a,f,g[m],[h,r]);for(m=0;m<e.length;m+=2)Q.Wh(a,e[m],e[m+1],-1)}}}function z(a,b){for(var c=a.ga,
d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function D(a){C(a);f(a);y(a)}function y(a){var b=[],c="",d="",f={};Q.ba(a,function(a,e){if("GEOMETRY_UV"==e.type||"UVMAP"==e.type||"TEX_COORD_UV"==e.type){b.push(a,e);var g=e.data.value;c?c==g||d||(d=g,f[d]=0):(c=g,f[c]=0);f[g]++}});for(var e in f)if(2>f[e]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==e&&b.splice(g,2);delete f[e];c==e&&(c=d,d="");d==e&&(d="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",
is_linked:!1,name:"UV_geom"},k={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};e=P("merged_uv","UV_MERGED",[],[g,k]);e.uv_layer=c;A(a,e,0,"",void 0);var m=a.G[a.G.length-2];e=a.G[a.G.length-1];if(d){k=P("merged_uv","UV_MERGED",[],[g,k]);k.uv_layer=d;A(a,k,0,"",void 0);var l=a.G[a.G.length-2],k=a.G[a.G.length-1]}else k=null;for(var r=-1,n=null,g=0;g<b.length;g+=2){var q=b[g],t=b[g+1];h(t,b[1])?(r=m,n=e):k&&(r=l,n=k);for(var u=[],p=Q.og(a,q),w={},J=0;J<p;J++){var x=Q.cg(a,
q,J);x in w||(w[x]=0);var v=Q.sf(a,q,x,w[x]++);u.push(q,x,v);v=v.splice(0,v.length);switch(t.type){case "GEOMETRY_UV":v[0]=0;n.Aa[0].Zb=!0;break;case "UVMAP":case "TEX_COORD_UV":v[0]=1,n.Aa[1].Zb=!0}Q.rc(a,r,x,v)}for(var J=0;J<u.length;J+=3)Q.Wh(a,u[J],u[J+1],0);Q.Re(a,q)}}}function C(a){var b=[];Q.ba(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=
[],d=0;d<b.length;d+=2){for(var f=b[d],e=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(m(e,k.cd)){g=[];h=Q.og(a,f);for(n=0;n<h;n++){var l=Q.cg(a,f,n),r=Q.sf(a,f,l,0);g.push(f,l,r);Q.rc(a,k.id,l,r)}for(var n=0;n<g.length;n+=3)Q.Wh(a,g[n],g[n+1],0);Q.Re(a,f);g=!1;break}}g&&(k={id:f,cd:e},c.push(k))}}function v(a){for(var b={},c=0;c<a.G.length;c+=2)b[a.G[c]]=[];for(c=0;c<a.ga.length;c+=3){for(var d=a.ga[c],f=a.ga[c+1],e=b[f],g=d,h=0;h<=e.length;h++){if(h>=e.length||e[h]>g)e.splice(h,0,g);else if(e[h]!=
g)continue;break}for(var f=b[f],d=b[d],g=e=0,h=f.length+d.length,k=[],m=0;m<h;m++)e>f.length||f[e]>d[g]?k.push(d[g++]):k.push(f[e++])}return b}function f(a){var b=[];Q.ba(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=v(a),d=[],f=0;f<b.length;f+=2){for(var e=b[f],g=b[f+1],h=!0,k=0;k<d.length;k++){var l=d[k];if(!(3<=l.kj.length||!m(g,l.cd)||-1<c[e].indexOf(l.id)||-1<c[l.id].indexOf(e))){for(var r=!1,n=0;n<l.kj.length;n++){var q=l.kj[n].id;if(-1<
c[e].indexOf(q)||-1<c[q].indexOf(e)){r=!0;break}}if(!r){for(var k=[],q=Q.qn(a,e),t={},n=0;n<q;n++)r=Q.Si(a,e,n),r in t||(t[r]=0),h=Q.sf(a,r,e,t[r]++),k.push(r,e,h);for(var q=[],t=Q.og(a,e),u={},n=0;n<t;n++)r=Q.cg(a,e,n),r in u||(u[r]=0),h=Q.sf(a,e,r,u[r]++),q.push(e,r,h);h=k.concat(q);for(n=0;n<h.length;n+=3)Q.Wh(a,h[n],h[n+1],0);Q.Re(a,e);n={id:e,cd:g,WC:k,XC:q};l.kj.push(n);h=!1;break}}}h&&(l={id:e,cd:g,kj:[]},d.push(l))}for(f=0;f<d.length;f++){l=d[f];c=l.kj.length;for(k=0;k<c;k++){g=l.kj[k];n=
g.cd;e=g.WC;g=g.XC;l.cd.J[k+1].Zb=n.J[0].Zb;l.cd.J[k+1].Ra=n.J[0].Ra;l.cd.Aa[2*(k+1)].Zb=n.Aa[0].Zb;l.cd.Aa[2*(k+1)].Ra=n.Aa[0].Ra;l.cd.Aa[2*(k+1)+1].Zb=n.Aa[1].Zb;l.cd.Aa[2*(k+1)+1].Ra=n.Aa[1].Ra;for(n=0;n<e.length;n+=3)r=e[n],h=e[n+2],h[1]+=k+1,Q.rc(a,r,l.id,h);for(n=0;n<g.length;n+=3)r=g[n+1],h=g[n+2],h[0]+=2*(k+1),Q.rc(a,l.id,r,h);l.cd.La.push(["USE_uv"+(k+2),1])}Q.Re(a,l.id);Q.si(a,l.id,l.cd)}}}function m(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==
b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.uuid==b.data.value.uuid;default:return!1}}function h(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function x(a){var b=[];Q.ba(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c)});for(var c=0;c<b.length;c+=2){for(var d=
b[c],f=b[c+1],e=!1,g=[],h=[],k=[[],[],[]],m=Q.og(a,d),l=0;l<m;l++){var r=Q.cg(a,d,l);if("SEPRGB"!=Q.Da(a,r).type){e=!1;break}g.push(d,r);for(var n={},q=Q.og(a,r),e=0;e<q;e++){var t=Q.cg(a,r,e);t in n||(n[t]=0);var u=Q.sf(a,r,t,n[t]++);g.push(r,t);k[u[0]].push(d,t,u)}h.push(r);e=!0}if(e){for(l=d=m=0;l<k.length;l++)k[l].length&&(m++,d|=1<<2-l);if(m){f.type+=m;f.Aa=[];for(l=0;l<k.length;l++)if(k[l].length)for(f.Aa.push({Ra:0,identifier:"RGB"[l],Zb:!0,name:"RGB"[l]}),e=0;e<k[l].length;e+=3)k[l][e+2][0]=
ua.Hl(d,l);for(l=0;l<g.length;l+=2)Q.Wh(a,g[l],g[l+1],0);for(l=0;l<h.length;l++)Q.Re(a,h[l]);for(l=0;l<k.length;l++)for(e=0;e<k[l].length;e+=3)Q.rc(a,k[l][e],k[l][e+1],k[l][e+2])}}}}function L(a,b,c,d,f,e){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];f?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?r(g,b)[0]:(e||Z.error('No "'+c+'" node in node '+d),-1)}function P(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function A(a,b,c,d,f){var e=b.name,g=b.type,h=[],k=
[],m=[],l=[],r=null,n=[];switch(g){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":k=
oa(b);m=fa(b);Z.warn(g+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":k=oa(b);m=fa(b);break;case "UVMAP":var q=b.uv_layer;q||(g="EMPTY_UV");if("EMPTY_UV"!=g){var r=O("param_"+g+"_a"),t=O("param_"+g+"_v");h.push(na(r));h.push(na(t));l.push(na(t));r={name:r,value:q}}m=fa(b);break;case "UV_MERGED":r=O("param_UV_MERGED_a");t=O("param_UV_MERGED_v");h.push(na(r));h.push(na(t));m.push(S(b,"UV_geom"));m.push(S(b,"UV_cycles"));l.push(na(t));r={name:r,value:b.uv_layer};
break;case "CAMERA":k=[];m=fa(b);break;case "COMBRGB":case "COMBHSV":k=oa(b);m=fa(b);break;case "CURVE_RGB":case "CURVE_VEC":k=oa(b);m=fa(b);r={value:b};break;case "PARTICLE_INFO":k=oa(b);m=fa(b);for(t=0;t<b.outputs.length;t++){var u=b.outputs[t],p=u.identifier,J=na("v_param_PART_INFO_"+p.replace(" ",""));if(u.is_linked)switch(p){case "Size":n.push(["PART_INFO_SIZE",Y.q(1)]);break;case "Age":n.push(["PART_INFO_AGE",Y.q(1)]);break;case "Lifetime":n.push(["PART_INFO_LT",Y.q(1)]);break;case "Location":n.push(["PART_INFO_LOC",
Y.q(1)]);break;case "Index":r=q=na("a_param_PART_INFO_"+u.identifier.replace(" ",""));n.push(["PART_INFO_IND",Y.q(1)]);break;case "Velocity":n.push(["PART_INFO_VEL",Y.q(1)]);break;case "Angular Velocity":n.push(["PART_INFO_A_VEL",Y.q(1)])}"Age"!=p&&"Lifetime"!=p&&"Size"!=p&&(h.push(J),l.push(J))}q&&h.push(q);break;case "GEOMETRY":if(!B(b))return!0;g=G(b,c);if(!g)return Z.error("Geometry output is not supported"),null;switch(g){case "GEOMETRY_UV":(q=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(r=O("param_GEOMETRY_UV_a"),
t=O("param_GEOMETRY_UV_v"),h.push(na(r)),h.push(na(t)),l.push(na(t)),r={name:r,value:q});m.push(S(b,"UV"));break;case "GEOMETRY_VC":(q=b.color_layer)||(g="EMPTY_VC");"EMPTY_VC"!=g&&(r=O("param_GEOMETRY_VC_a"),t=O("param_GEOMETRY_VC_v"),h.push(na(r)),h.push(na(t)),l.push(na(t)),r={name:r,value:q});m.push(S(b,"Vertex Color"));break;case "GEOMETRY_NO":m.push(S(b,"Normal"));break;case "GEOMETRY_FB":m.push(S(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(S(b,"View"));break;case "GEOMETRY_GL":m.push(S(b,
"Global"));break;case "GEOMETRY_LO":m.push(S(b,"Local"));break;case "GEOMETRY_OR":q=O("param_GEOMETRY_OR_v"),h.push(na(q)),m.push(S(b,"Orco")),l.push(na(q))}break;case "TEX_COORD":if(!B(b))return!0;g=M(b,c);if(!g)return Z.error("Texture coordinate output is not supported"),null;switch(g){case "TEX_COORD_UV":(q=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(r=O("param_TEX_COORD_UV_a"),t=O("param_TEX_COORD_UV_v"),h.push(na(r)),h.push(na(t)),l.push(na(t)),r={name:r,value:b.uv_layer});m.push(S(b,"UV"));
break;case "TEX_COORD_NO":m.push(S(b,"Normal"));break;case "TEX_COORD_GE":q=O("param_TEX_COORD_GE_v");h.push(na(q));m.push(S(b,"Generated"));l.push(na(q));break;case "TEX_COORD_OB":m.push(S(b,"Object"));Z.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":m.push(S(b,"Camera"));break;case "TEX_COORD_WI":m.push(S(b,"Window"));Z.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":m.push(S(b,"Reflection")),
Z.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":q=b.node_tree_name;switch(q){case "B4W_LINEAR_TO_SRGB":if(!w(b,[1],[1])){r=I(b,d,f);break}g="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!w(b,[1],[1])){r=I(b,d,f);break}g="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!w(b,[1],[1])){r=I(b,d,f);break}g="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!w(b,[1,1],[1])){r=I(b,d,f);break}g="B4W_REFLECT";break;case "B4W_REFRACTION":if(!w(b,
[1,0],[1])){r=I(b,d,f);break}g="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!w(b,[1,1,0,0,0],[1])){r=I(b,d,f);break}g="B4W_PARALLAX";t=O("temp_texture");l.push(na(t));break;case "B4W_CLAMP":if(!w(b,[1],[1])){r=I(b,d,f);break}g="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!w(b,[0,0,0,0,0],[0])){r=I(b,d,f);break}g="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!w(b,[],[0])){r=I(b,d,f);break}g="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!w(b,[0,0,0],[0])){r=I(b,d,f);break}g="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":g=
"B4W_GLOW_OUTPUT";break;default:r=I(b,d,f)}k=oa(b);m=fa(b);"B4W_TRANSLUCENCY"==q&&(q=N("TranslucencyParams","TranslucencyParams",[0,0,0,0]),q.Zb=m[0].Zb,m.push(q));break;case "LAMP":r=b.lamp;if(!r)return Z.error("There is no lamp in node: "+b.name),null;m.push(S(b,"Color"));m.push(S(b,"Light Vector"));m.push(S(b,"Distance"));m.push(S(b,"Visibility Factor"));r.uuid in va?n.push(["LAMP_INDEX",String(va[r.uuid])]):(va[r.uuid]=U,n.push(["LAMP_INDEX",String(U++)]));r=va;break;case "LIGHTING_AMBIENT":k=
[N("E","E",[0,0,0],!0),N("A","A",[0,0,0],!0),N("D","D",[0,0,0],!0)];m=[N("color","color",[0,0,0],!0),N("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":m=[N("E","E",[0,0,0],!0),N("A","A",[0,0,0],!0),N("D","D",[0,0,0],!0),N("S","S",[0,0,0],!0),N("normal","normal",[0,0,0],!0),N("dif_params","dif_params",[0,0],!0),N("sp_params","sp_params",[0,0],!0),N("shadow_factor","shadow_factor",0,!0),N("translucency_color","translucency_color",0,!0),N("translucency_params","translucency_params",[0,
0,0,0],!0)];break;case "LIGHTING_END":k=[N("color","color",[0,0,0],!0),N("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":k=[N("shadow_factor","shadow_factor",0,!0)];m=[N("ldir","ldir",[0,0,0],!0),N("lfac","lfac",[0,0],!0),N("lcolorint","lcolorint",[0,0,0],!0),N("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[N("ldir","ldir",[0,0,0],!0),N("lfac","lfac",[0,0],!0),N("normal","normal",[0,0,0],!0),N("norm_fac","norm_fac",0,!0)];m=[N("lfactor","lfactor",0,!0)];break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=
[N("ldir","ldir",[0,0,0],!0),N("lfac","lfac",[0,0],!0),N("normal","normal",[0,0,0],!0),N("norm_fac","norm_fac",0,!0),N("dif_params","dif_params",[0,0],!0)];m=[N("lfactor","lfactor",0,!0)];break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":k=[N("ldir","ldir",[0,0,0],!0),N("lfac","lfac",[0,0],!0),N("normal","normal",[0,0,0],!0),N("norm_fac","norm_fac",0,!0),N("sp_params","sp_params",[0,0],!0)];m=[N("sfactor","sfactor",0,!0)];break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[N("ldir","ldir",[0,0,
0],!0),N("lfac","lfac",[0,0],!0),N("normal","normal",[0,0,0],!0),N("sp_params","sp_params",[0,0],!0)];m=[N("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":k=[N("color","color",[0,0,0,0],!0),N("specular","specular",[0,0,0],!0),N("lfactor","lfactor",0,!0),N("sfactor","sfactor",0,!0),N("ldir","ldir",[0,0,0],!0),N("normal","normal",[0,0,0],!0),N("translucency_params","translucency_params",[0,0,0,0],!0),N("D","D",[0,0,0],!0),N("S","S",[0,0,0],!0),N("lcolorint","lcolorint",[0,0,0],!0),N("translucency_color",
"translucency_color",0,!0)];m=[N("color","color",[0,0,0,0],!0),N("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=oa(b);m=fa(b);q=S(b,"Normal");l.push(na(O("param_NORMAL_Normal"),q.Ra,3));break;case "MAPPING":q=b.vector_type;g="MAPPING";k.push(R(b,"Vector"));m.push(S(b,"Vector"));var t=b.rotation,u=b.scale,p=b.translation,J=sa.create(),x=ua.aD(t);"TEXTURE"==q&&(u[0]=u[0]||1,u[1]=u[1]||1,u[2]=u[2]||1);var v=new Float32Array([u[0],0,0,0,u[1],0,0,0,u[2]]);sa.multiply(x,v,J);J=ua.xF(J,ma.create());
switch(q){case "POINT":J[12]=p[0];J[13]=p[1];J[14]=p[2];break;case "TEXTURE":J[12]=p[0];J[13]=p[1];J[14]=p[2];J=ma.invert(J,J);break;case "NORMAL":ma.invert(J,J),ma.transpose(J,J)}switch(q){case "NORMAL":n.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":n.push(["MAPPING_TRS_MATRIX",Y.q(J,16)]);break;case "POINT":0!==ca.length(t)?n.push(["MAPPING_TRS_MATRIX",Y.q(J,16)]):(0!==ca.length(u)&&n.push(["MAPPING_SCALE",Y.q(u,3)]),0!==ca.length(p)&&n.push(["MAPPING_TRANSLATION",Y.q(p,3)]));break;case "VECTOR":0!==
ca.length(t)?n.push(["MAPPING_TRS_MATRIX",Y.q(J,16)]):0!==ca.length(u)&&n.push(["MAPPING_SCALE",Y.q(u,3)])}b.use_min&&n.push(["MAPPING_MIN_CLIP",Y.q(b.min,3)]);b.use_max&&n.push(["MAPPING_MAX_CLIP",Y.q(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":r=[];q=[];t=[];u=[N("E","E",[0,0,0],!0),N("A","A",[0,0,0],!0),N("D","D",[0,0,0],!0),N("S","S",[0,0,0],!0),N("normal","normal",[0,0,0],!0),N("dif_params","dif_params",[0,0],!0),N("sp_params","sp_params",[0,0],!0),N("shadow_factor","shadow_factor",
0,!0)];p=[N("color","color",[0,0,0],!0),N("specular","specular",[0,0,0],!0),N("normal","normal",[0,0,0],!0)];J=[S(b,"Color"),S(b,"Alpha"),S(b,"Normal")];x=[];v=R(b,"Color");v.Ra.splice(3);t.push(v);k.push(v);v=R(b,"Spec");v.Ra.splice(3);t.push(v);k.push(v);t.push(N("DiffuseIntensity","DiffuseIntensity",b.diffuse_intensity));k.push(v);var z=R(b,"Normal");z.Ra.splice(3);t.push(z);k.push(z);"MATERIAL_EXT"==g?((v=R(b,"Emit"))||(v=N("Emit","Emit",0)),t.push(v),k.push(v),(v=R(b,"Translucency"))?(v.Ra=0,
v.name="Translucency",v.identifier="Translucency"):v=N("Translucency","Translucency",0),k.push(v),(v=R(b,"Translucency"))?(v.Ra=[0,0,0,0],v.name="TranslucencyParams",v.identifier="TranslucencyParams"):v=N("TranslucencyParams","TranslucencyParams",[0,0,0,0]),k.push(v),m=R(b,"Reflectivity"),v=R(b,"Ray Mirror"),m?(v=m,m="Reflectivity"):v?m="Ray Mirror":(v=m,m="Reflectivity"),v||(v=N(m,m,0)),k.push(v),p.push(v),(v=R(b,"SpecTra"))||(v=N("SpecTra","SpecTra",0)),k.push(v),p.push(v),(v=R(b,"Alpha"))||(v=
N("Alpha","Alpha",b.alpha)),k.push(v),p.push(v),J.push(S(b,"Diffuse")),J.push(S(b,"Spec")),r.push(["MATERIAL_EXT",1]),q.push(["MATERIAL_EXT",1])):(t.push(N("emit_intensity","emit_intensity",0)),p.push(N("reflect_factor","reflect_factor",0)),p.push(N("specular_alpha","specular_alpha",0)),p.push(N("alpha_in","alpha_in",0)),J.push(N("diffuse_out","diffuse_out",0)),J.push(N("spec_out","spec_out",0)),r.push(["MATERIAL_EXT",0]),q.push(["MATERIAL_EXT",0]));x.push(na(O("param_MATERIAL_alpha"),b.alpha));x.push(na(O("param_MATERIAL_spec_alpha"),
b.specular_alpha));m=J;z.Zb&&r.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&(r.push(["USE_MATERIAL_DIFFUSE",1]),q.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&q.push(["USE_MATERIAL_SPECULAR",1]);var v=[],y=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":z=b.specular_hardness;break;case "WARDISO":z=b.specular_slope;break;case "TOON":z=b.specular_toon_size;y=b.specular_toon_smooth;break;case "BLINN":z=b.specular_ior;y=b.specular_hardness;break;default:Z.error("unsupported specular shader: "+
b.specular_shader+' (material "'+b.material_name+'")'),z=b.specular_hardness}var W,V;switch(b.diffuse_shader){case "LAMBERT":V=W=0;break;case "OREN_NAYAR":W=b.roughness;V=0;break;case "FRESNEL":W=b.diffuse_fresnel;V=b.diffuse_fresnel_factor;break;case "MINNAERT":W=b.darkness;V=0;break;case "TOON":W=b.diffuse_toon_size;V=b.diffuse_toon_smooth;break;default:Z.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),V=W=0}v.push(na(O("param_MATERIAL_diffuse"),[W,V],
2));v.push(na(O("param_MATERIAL_spec"),[b.specular_intensity,z,y],3));r.push(["SHADELESS_MAT",b.use_shadeless?1:0]);z={name:b.name,value:{Hj:b.specular_shader,Lk:b.diffuse_shader,Ed:b.use_shadeless}};r={name:b.name,value:{Hj:b.specular_shader,Lk:b.diffuse_shader,Ed:b.use_shadeless},yF:{name:"material_begin",type:"MATERIAL_BEGIN",J:t,Aa:u,r:v,data:z,La:r,Mg:[]},zF:{name:"material_end",type:"MATERIAL_END",J:p,Aa:J,r:x,data:z,La:q,Mg:[]}};break;case "MATH":switch(b.operation){case "ADD":g="MATH_ADD";
break;case "SUBTRACT":g="MATH_SUBTRACT";break;case "MULTIPLY":g="MATH_MULTIPLY";break;case "DIVIDE":g="MATH_DIVIDE";break;case "SINE":g="MATH_SINE";break;case "COSINE":g="MATH_COSINE";break;case "TANGENT":g="MATH_TANGENT";break;case "ARCSINE":g="MATH_ARCSINE";break;case "ARCCOSINE":g="MATH_ARCCOSINE";break;case "ARCTANGENT":g="MATH_ARCTANGENT";break;case "POWER":g="MATH_POWER";break;case "LOGARITHM":g="MATH_LOGARITHM";break;case "MINIMUM":g="MATH_MINIMUM";break;case "MAXIMUM":g="MATH_MAXIMUM";break;
case "ROUND":g="MATH_ROUND";break;case "LESS_THAN":g="MATH_LESS_THAN";break;case "GREATER_THAN":g="MATH_GREATER_THAN";break;case "MODULO":g="MATH_MODULO";break;case "ABSOLUTE":g="MATH_ABSOLUTE";break;default:return Z.error("Unsupported MATH operation: "+b.operation),null}n.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=oa(b);m=fa(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":g="MIX_RGB_MIX";break;case "ADD":g="MIX_RGB_ADD";break;case "MULTIPLY":g="MIX_RGB_MULTIPLY";break;case "SUBTRACT":g=
"MIX_RGB_SUBTRACT";break;case "SCREEN":g="MIX_RGB_SCREEN";break;case "DIVIDE":g="MIX_RGB_DIVIDE";break;case "DIFFERENCE":g="MIX_RGB_DIFFERENCE";break;case "DARKEN":g="MIX_RGB_DARKEN";break;case "LIGHTEN":g="MIX_RGB_LIGHTEN";break;case "OVERLAY":g="MIX_RGB_OVERLAY";break;case "DODGE":g="MIX_RGB_DODGE";break;case "BURN":g="MIX_RGB_BURN";break;case "HUE":g="MIX_RGB_HUE";break;case "SATURATION":g="MIX_RGB_SATURATION";break;case "VALUE":g="MIX_RGB_VALUE";break;case "COLOR":g="MIX_RGB_COLOR";break;case "SOFT_LIGHT":g=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":g="MIX_RGB_LINEAR_LIGHT";break;default:return Z.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}n.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=oa(b);m=fa(b);break;case "OUTPUT":k=oa(b);m=[];break;case "RGB":q=d+"%join%"+b.name;q={name:"-1",value:q};l.push(q);m.push(S(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=oa(b);m=fa(b);break;case "TEXTURE":g=F(b);if("TEXTURE_EMPTY"==g)m.push(S(b,"Color")),m.push(S(b,"Normal")),m.push(S(b,"Value"));
else if("TEXTURE_ENVIRONMENT"==g)k.push(R(b,"Vector")),m.push(S(b,"Color")),m.push(S(b,"Value"));else{if("TEXTURE_NORMAL"==g&&"ENVIRONMENT_MAP"==b.texture.type)return Z.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;for(r=0;4>r;++r)r?(v=N("Vector"+r,"Vector"+r,[0,0,0]),"TEXTURE_COLOR"==g&&(t=N("Color"+r,"Color"+r,[0,0,0]),u=N("Value"+r,"Value"+r,0)),"TEXTURE_NORMAL"==g&&(t=N("Normal"+r,"Normal"+r,[0,0,0]),u=N("Value"+r,"Value"+r,0))):(v=R(b,"Vector"),"TEXTURE_COLOR"==g&&(t=S(b,"Color"),
u=S(b,"Value")),"TEXTURE_NORMAL"==g&&(t=S(b,"Normal"),u=S(b,"Value"))),k.push(v),m.push(t),m.push(u)}t=O("param_TEXTURE_texture");l.push(na(t));r={name:t,value:b.texture};break;case "VALTORGB":k=oa(b);m=fa(b);r={value:b};q=b.color_ramp.interpolation;"CONSTANT"!=q&&"LINEAR"!=q&&Z.warn("Color Ramp node is not fully supported.");break;case "VALUE":g="VALUE";q=d+"%join%"+b.name;q={name:"-1",value:q};l.push(q);m.push(S(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":g="VECT_MATH_ADD";
break;case "SUBTRACT":g="VECT_MATH_SUBTRACT";break;case "AVERAGE":g="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":g="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":g="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":g="VECT_MATH_NORMALIZE";break;default:return Z.error("Unsupported VECT_MATH operation: "+b.operation),null}k=oa(b);m=fa(b);break;default:k=oa(b),m=fa(b)}g={name:e,type:g,Mg:h,J:k,Aa:m,r:l,data:r,La:n};e=Q.bl(a);Q.si(a,Q.bl(a),g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{g=b.outputs;
for(k=h=0;k<g.length;k++)if(g[k].is_linked&&h++>c){g=!0;break a}g=!1}g=!g}return g||null!=A(a,b,++c,d,f)?e:null}function w(a,b,c){for(var d=a.inputs,f=a.outputs,e=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return Z.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',e,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=f[g],d=c[g],!b||b.default_value instanceof Array!=d)return Z.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',e,'".Processing as general node group.'),!1;return!0}function I(a,b,c){var f=a.node_group.node_tree,e={},g;for(g in f)if("links"==g||"nodes"==g){e[g]=[];for(var h=0;h<f[g].length;h++){e[g][h]={};for(var k in f[g][h])if("links"==g){e[g][h][k]={};for(var m in f[g][h][k])e[g][h][k][m]=T(f[g][h][k][m])}else e[g][h][k]=T(f[g][h][k])}}else e[g]=T(f[g]);f=a.node_tree_name;if("B4W_REPLACE"==f||"B4W_LEVELS_OF_QUALITY"==f)g=P("Group input","GROUP_INPUT",[],a.inputs),h=P("Group output",
"GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==f||"B4W_LEVELS_OF_QUALITY"==f&&(xa.quality==W.P_LOW||xa.tq)?{from_node:g,from_socket:g.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:g,from_socket:g.outputs[0],to_node:h,to_socket:h.inputs[0]},e.nodes=[g,h],e.links=[k];f=a.name;g=e.nodes;h=e.links;for(k=0;k<g.length;k++)g[k].name=E(g[k].type,f,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=E(h[k].from_node.type,f,h[k].from_node.name),h[k].to_node.name=E(h[k].to_node.type,f,h[k].to_node.name);
return{MF:d(e,a.node_group.uuid,!0,b,c),NF:e.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ua.wk(a):a}function O(a){ja[a]||(ja[a]=0);var b=a+"_"+ja[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ja[a]++;return b}function B(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function G(a,b){for(var c=a.outputs,d=0,f=0;f<c.length;f++){var e=c[f];if(e.is_linked&&!(d++<b))switch(e.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function M(a,b){for(var c=a.outputs,d=0,f=0;f<c.length;f++){var e=c[f];if(e.is_linked&&!(d++<b))switch(e.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";
case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function F(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,f=!1,e=0;e<b.length;e++){var g=b[e];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":f=!0;break;default:throw"Unknown texture output";}}if(c)return d&&Z.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":
"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(f)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function R(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var f=c[d];if(f.identifier==b)return ha(f)}return null}function S(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var f=c[d];if(f.identifier==b)return ha(f)}return null}function ha(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=ua.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Zb:d,Ra:a}}function N(a,
b,c,d){return{name:a,identifier:b,Zb:d||!1,Ra:c}}function oa(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ha(a.inputs[c]);d.Ra.length&&d.Ra.splice(3);b.push(d)}return b}function fa(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ha(a.outputs[c]);b.push(d)}return b}function na(a,b,c){b=null===b||void 0===b?null:Y.q(b,c);return{name:a,value:b}}function ba(a,b,c,d,f,e){var g=[],h=e.from_socket.identifier;e=e.to_socket.identifier;var k=d.Aa;for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);
break}f=f.J;for(d=0;d<f.length;d++)if(f[d].identifier==e){g.push(d);break}2==g.length&&Q.rc(a,b,c,g);return!0}function E(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ea(a){var b=[];Q.ba(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function qa(a,b,c){for(var d=0;d<c.length;d++){var f=c[d].data.MF,e=c[d].data.NF;if(!f)return!1;Q.ba(f,function(b,c){Q.si(a,Q.bl(a),c)});for(f=0;f<e.length;f++)b.push(e[f]);V(c[d],b,a)}return!0}function la(a,b,c,d,
f,e){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||f.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||e.push(c)}}function ia(a,b,c){for(var d=[],f=0;f<c.length;f++){for(var e=c[f],g=null,h=0;h<b.length;h++)if(e.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(e.from_node=g.from_node,e.from_socket=g.from_socket):d.push(e)}for(f=0;f<b.length;f++)a.splice(a.indexOf(b[f]),1);return d}function ya(a,b){if(b.length)for(var c=
b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function J(a,b,c,d){for(var f=0;f<d.length;f++){for(var e=d[f],g,h=0;h<c.J.length;h++)if(e.from_socket.identifier==c.J[h].identifier){g=c.J[h].Ra;break}for(var h=e,k=b,m=g,l=r(h.to_node,k),n=0;n<l.length;n++)for(var q=Q.Da(k,l[n]),t=0;t<q.J.length;t++){var u=q.J[t];if(u.identifier==h.to_socket.identifier){q=u.Ra instanceof Object?0:1;if((m instanceof Object?0:1)==q)u.Ra=m;else switch(q){case 0:u=u.Ra;u[0]=u[1]=u[2]=m;break;
case 1:u.Ra=(m[0]+m[1]+m[2])/3}break}}e=a.indexOf(e);-1!=e&&a.splice(e,1)}}function V(a,b,c){for(var d=a.name,f=[],e=[],g=[],h=[],k=0;k<b.length;k++){var m=b[k];la(m.from_node,d,m,f,g,h);la(m.to_node,d,m,e,g,h)}e=ia(b,e,g);f=ia(b,h,f);ya(b,e);J(b,c,a,e);if(f.length){var l;Q.ba(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(l=b)});J(b,c,l,f)}}var W=p("__config"),Q=p("__graph"),sa=p("__mat3"),ma=p("__mat4"),ga=p("__objects"),Z=p("__print"),Y=p("__shaders"),Fa=p("__scenes"),ua=p("__util"),
ca=p("__vec3"),ja={},da={},K={},va={},U=0;new Float32Array(4);var xa=W.p;a.NB=d;a.Sp=function(a,b,d){var f=Fa.get_active();a=g(a,"MAIN",f.uuid);if(a in K)return K[a];var f=Q.create(),e={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},h=A(f,e,0,b,null),e={name:"LIGHTING_END",type:"LIGHTING_END"},e=A(f,e,0,b,null);c(f,d,h,e,[[h,[8,10]],[h,[9,6]]],b);t(f);return K[a]=f};a.Mm=function(a){var b=[],c={};ja={};var d=Q.Is(a);Q.ba(d,function(a,d){var f;f=[];for(var e=[],g=[],h=[],k=[],m=[],l=0;l<d.J.length;l++){var r=
d.J[l];if(r.Zb)f.push(null),e.push(null);else{f.push(O("in_"+d.type+"_"+r.identifier));var n=Y.q(r.Ra,0);xa.px&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==r.identifier||"Color2"==r.identifier||"Fac"==r.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==r.identifier||"Value_001"==r.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==r.identifier||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(r=n,r=r.replace(/(,)/g,"$1 "),r=r.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,
"$1ZERO_VALUE_NODES$3"),r=r.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),n=r=r.replace(/\s+/g,""));e.push(n)}}for(l=0;l<d.Aa.length;l++)r=d.Aa[l],r.Zb?g.push(null):g.push(O("out_"+d.type+"_"+r.identifier));for(l=0;l<d.r.length;l++)r=d.r[l],h.push(r.name),k.push(r.value);for(l=0;l<d.Mg.length;l++)m.push(d.Mg[l].name);f={id:d.type,J:f,Rq:e,Aa:g,r:h,Rn:k,Mg:m,La:JSON.parse(JSON.stringify(d.La))};b.push(f);c[a]=f});Q.re(d,function(a,b,f){var e=Q.Da(d,a);Q.Da(d,b);var g=e.Aa[f[0]];
a=c[a].Aa;b=c[b].J;e=a[f[0]]||O("out_"+e.type+"_"+g.identifier);a[f[0]]=e;b[f[1]]=e});return b};a.Zt=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in da)delete da[a];for(a in K)delete K[a];for(var b in va)delete va[b];U=0}};b4w.module.__animation=function(a,p){function d(a,b){var c=a.M[b];c&&c.rq&&c.Tk&&(c.Tk=!1,c.rq(a,b))}function b(a,b,c){c=a.M[c];c.type=30;var d=b.Y,f=b.pa-d+1;c.start=d;c.length=f;c.gd=d;c.cf=b.name;for(f=d=0;f<a.mc.length;f++){var e=a.mc[f];if(e==b)break;else d+=e.pa-e.Y+1}c.ny=d}function c(a,b){a.type=50;a.cf=b.name;a.start=b.Y;a.length=b.pa-a.start;b.cyclic||(a.length+=b.cr)}function n(a){return a.replace(/_B4W_BAKED$/,"")}function g(a,b){if(a.animation_data){var c=a.animation_data.action;c&&c.k.type==
Z&&b.push(c)}for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];f.node_group&&(f=f.node_group.node_tree)&&g(f,b)}}function q(a){return R.is_mesh(a)&&a.g.mc?!0:!1}function l(a,b,c){var d=a.M;if(-1==c)for(c=0;8>c;c++){var f=d[c];f&&(f.gd=b,e(a,0,c,!0))}else if(f=d[c])f.gd=b,e(a,0,c,!0)}function t(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function e(a,b,c,e){y(a,b,c,e);d(a,c);a.g.Xg&&(f(a,b),v(a,b))}function H(a,b,c){var d=b.frame_range;if(d[0]>d[1])return N.warn('Incompatible action "'+
b.name+'" has been applied to object "'+a.name+'"'),!1;var f=b.k,e=a.M[c];e.cf=b.name;e.$o=d;e.xt=f.Fw;e.vt=f.Jt;e.gh.set(f.gh);e.start=d[0];e.length=d[1]-d[0];e.gd=d[0];switch(f.type){case sa:if(R.is_armature(a)){e.type=10;var g=k(a,b);if(!g){for(var g=a.g.Jd,d=[],l=[],n=b.k.yr,q=0;q<n;q++){for(var t in g){var p=g[t],J=p.zo,w=b.k.vp[t];w?ea.copy(w.subarray(8*q,8*q+8),J):ea.identity(J);p.Ao=!1}p=m(g);d.push(p.trans);l.push(p.Ca)}g={trans:d,Ca:l};a.ri.push(b,g)}e.trans=g.trans;e.Ca=g.Ca;e=g;t=a.g;
g=t.mo;l=a.M[c];d=l.ls;a:{n=t.rx;for(q=0;q<n.length;q+=2)if(b==n[q]){n=n[q+1];break a}n=null}if(n)l.ls=n;else{for(l=0;l<g.length;l++){for(var n=g[l].xi,q=[],p=[],J=e.trans,w=e.Ca,x=0;x<J.length;x++){var v=h(J[x],w[x],n);q.push(v.trans);p.push(v.Ca)}d.push({trans:q,Ca:p})}t.rx.push(b,d)}t.Xg&&(b=t.Co,c>b[1]?(e=b[1],b[1]=c,b[0]=e):c>b[0]&&c<b[1]&&(b[0]=c),r(a))}break;case ma:R.is_speaker(a)&&(e.volume=f.r.volume||null,e.pitch=f.r.pitch||null,e.type=40);break;case Y:R.is_lamp(a)&&(e.color=f.r.color||
null,e.Md=f.r.energy||null,e.type=70);break;case Z:if("MESH"==a.type){e.type=60;t=k(a,b);if(!t){t=[];d=[];l=[];n=[];q=b.k;p=a.g.Hn;J=a.g.In;for(g in q.r)w=b.name+"%join%"+g,z(g,w,q,d,t,p),z(g,w,q,n,l,J);t={ZI:t,values:d,vG:l,wG:n};a.ri.push(b,t)}e.mw=t.ZI;e.ow=t.values;e.lw=t.vG;e.nw=t.wG}break;case ga:if(t=f.r.tsr){e.type=20;g=k(a,b);if(!g){g=b.k.yr;d=[];l=[];for(n=0;n<g;n++)d.push(t.subarray(8*n,8*n+4)),l.push(t.subarray(8*n+4,8*n+8));g={trans:d,Ca:l};a.ri.push(b,g)}e.trans=g.trans;e.Ca=g.Ca;S.pj(a)&&
S.EI(a,e.trans[0],e.Ca[0])}else return N.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1;break;case Fa:R.is_world(a)&&(e.Md=f.r["light_settings.environment_energy"]||null,e.Dv=Boolean(f.r["light_settings.environment_energy"]),e.Td=f.r.horizon_color||null,e.Kv=Boolean(f.r.horizon_color),e.ce=f.r.zenith_color||null,e.Pv=Boolean(f.r.zenith_color),e.rD=f.r["mist_settings.intensity"]||null,e.Iv=Boolean(f.r["mist_settings.intensity"]),e.pD=f.r["mist_settings.depth"]||
null,e.Gv=Boolean(f.r["mist_settings.depth"]),e.sD=f.r["mist_settings.start"]||null,e.Jv=Boolean(f.r["mist_settings.start"]),e.qD=f.r["mist_settings.height"]||null,e.Hv=Boolean(f.r["mist_settings.height"]),e.oD=f.r.b4w_fog_color||null,e.Fv=Boolean(f.r.b4w_fog_color),e.type=80)}R.is_armature(a)&&f.type!=sa&&u(a,c);return!0}function k(a,b){for(var c=a.ri,d=0;d<c.length;d+=2)if(b==c[d])return c[d+1];return null}function r(a){var b=a.g.Co;if(-1!=b[0]&&-1!=b[1]){var c=a.M;a=c[b[1]].gd;var d=Math.floor(a),
f=a-d,b=c[b[0]];a=b.gd;d=Math.floor(a);b.gd=d+f}}function u(a,b){var c=a.g.Co,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var f=a.M;0<=d;d--){var e=f[d];if(e&&10==e.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function z(a,b,c,d,f,e){for(var g=0;g<e.length;g+=2)b==e[g]&&(f.push(e[g+1]),d.push(new Float32Array(c.r[a])))}function D(a){a=a.k;for(var b in a.r)if(-1!=b.indexOf("nodes"))return!0;return!1}function y(a,b,c,d){if((c=a.M[c])&&null!=c.type&&(c.play||d)){var f=a.g,e=c.gd,g=c.start,h=c.length,
e=e+c.speed*b*ba.Yb(),k=c.type,m=c.speed;if(0<=m&&e>=g+h||0>m&&e<g)switch(d||(c.Tk=!0),c.behavior){case 10:e=0<=m?(e-g)%h+g:g+h-1E-6;break;case 20:e=0<=m?g:g+h-1E-6;c.play=!1;break;case 30:e=0<=m?g+h-1E-6:g,c.play=!1}c.gd=e;switch(k){case 10:if(!f.Xg){d=C(c);b=d[0];e=d[1];d=d[2];f.Qc=c.Ca[b];f.ud=c.Ca[e];f.Yc=c.trans[b];f.Dd=c.trans[e];f.Qd=d;d=f.mo;c=c.ls;for(g=0;g<d.length;g++)h=d[g],k=c[g],h.Qc=k.Ca[b],h.ud=k.Ca[e],h.Yc=k.trans[b],h.Dd=k.trans[e],h.Qd=f.Qd;E.m(a)}break;case 20:d=C(c);var f=ca,
e=d[0],g=d[1],h=d[2],k=c.trans,m=k[e][1],l=k[e][2],r=k[g][1],n=k[g][2];f[0]=(1-h)*k[e][0]+h*k[g][0];f[1]=(1-h)*m+h*r;f[2]=(1-h)*l+h*n;e=da;l=d[0];g=d[1];h=d[2];k=c.Ca;m=K;m[0]=k[l][0];m[1]=k[l][1];m[2]=k[l][2];m[3]=k[l][3];l=va;l[0]=k[g][0];l[1]=k[g][1];l[2]=k[g][2];l[3]=k[g][3];oa.slerp(m,l,h,e);g=d[2];h=c.trans;d=(1-g)*h[d[0]][3]+g*h[d[1]][3];a.parent&&a.Xn&&(g=ea.create(),ea.set_sep(f,d,e,g),ea.multiply(a.Xn,g,g),f=ea.get_trans_view(g),e=ea.get_quat_view(g),d=ea.get_scale(g));c.Js&&(g=ja,E.get_translation(a,
g),qa.smooth_v(f,g,b,c.Js,f));c.Lr&&(g=K,E.get_rotation(a,g),qa.wx(e,g,b,c.Lr,e));h=c.gh;h[0]&&E.set_translation_rel(a,f);h[1]&&E.set_rotation_rel(a,e);h[2]&&E.set_scale_rel(a,d);E.m(a);ha.sync_transform(a);break;case 30:d=c.gd-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.ny;ua[0]=a+c;ua[1]=b+c;ua[2]=d;d=ua;f.Rs=d[0];f.my=d[2];break;case 40:d=C(c);b=d[0];f=d[1];d=d[2];c.volume&&na.set_volume(a,(1-d)*c.volume[b]+d*c.volume[f]);
c.pitch&&na.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[f]);break;case 50:S.cH(a,c.cf,10==c.behavior?(e-g)/ba.Yb():e/ba.Yb());break;case 60:d=C(c);b=d[0];f=d[1];d=d[2];k=c.ow;m=c.mw;g=c.nw;c=c.lw;for(e=0;e<m.length;e++)l=k[e],h=m[e],a.g.xf[h]=(1-d)*l[b]+d*l[f];for(e=0;e<c.length;e++)k=g[e],h=c[e],k=la.lerp(k.subarray(3*b,3*b+3),k.subarray(3*f,3*f+3),d,ca),a.g.qd[3*h]=k[0],a.g.qd[3*h+1]=k[1],a.g.qd[3*h+2]=k[2];break;case 70:d=C(c);b=d[0];f=d[1];d=d[2];h=c.gh;(g=c.Md)&&h[0]&&ya.cs(a.Oa,(1-d)*g[b]+d*g[f]);
(c=c.color)&&h[1]&&(ca[0]=(1-d)*c[3*b]+d*c[3*f],ca[1]=(1-d)*c[3*b+1]+d*c[3*f+1],ca[2]=(1-d)*c[3*b+2]+d*c[3*f+2],ya.jx(a.Oa,ca));h=a.B;for(e=0;e<h.length;e++)J.rI(a,h[e].wa);break;case 80:d=C(c);b=d[0];f=d[1];d=d[2];h=a.B;e=J.X(h[0].wa,"MAIN_OPAQUE");g=c.Md;g=c.Dv?(1-d)*g[b]+d*g[f]:e.Md;k=c.Td;c.Kv?(ca[0]=(1-d)*k[3*b]+d*k[3*f],ca[1]=(1-d)*k[3*b+1]+d*k[3*f+1],ca[2]=(1-d)*k[3*b+2]+d*k[3*f+2],k=ca):k=e.Td;m=c.ce;c.Pv?(ja[0]=(1-d)*m[3*b]+d*m[3*f],ja[1]=(1-d)*m[3*b+1]+d*m[3*f+1],ja[2]=(1-d)*m[3*b+2]+d*
m[3*f+2],m=ja):m=e.ce;l=c.rD;c.Iv&&(l=(1-d)*l[b]+d*l[f]);r=c.pD;c.Gv&&(r=(1-d)*r[b]+d*r[f]);n=c.sD;c.Jv&&(n=(1-d)*n[b]+d*n[f]);var q=c.qD;c.Hv&&(q=(1-d)*q[b]+d*q[f]);var t=c.oD;c.Fv&&(da[0]=(1-d)*t[3*b]+d*t[3*f],da[1]=(1-d)*t[3*b+1]+d*t[3*f+1],da[2]=(1-d)*t[3*b+2]+d*t[3*f+2],t=da);for(e=0;e<h.length;e++)b=a.B[e].wa,(c.Dv||c.Kv||c.Pv)&&J.set_environment_colors(b,g,k,m),c.Iv&&J.LG(b,l),c.Gv&&J.JG(b,r),c.Jv&&J.MG(b,n),c.Hv&&J.KG(b,q),c.Fv&&J.set_fog_color_density(b,t);break;default:qa.Z("Unknown animation type:"+
k)}}}function C(a){var b=a.$o[0],c=a.$o[1]-b,b=a.gd-b;0>b&&(b=0);b>=c&&(b=c);b/=a.xt;c=Math.floor(b);a=a.vt[c]?b-c:0;b=Math.ceil(c+a);ua[0]=c;ua[1]=b;ua[2]=a;return ua}function v(a,b){var c=a.g,d=c.Tf,f=c.Co,e=f[0],f=f[1];if(-1!=f){if(-1!=e){var g=a.M[e];if(g.play||0==b){var h=C(g),k=h[0],m=h[1];c.Qd=h[2];var h=g.Ca[k],l=g.Ca[m],k=g.trans[k],m=g.trans[m]}else d=1}else d=1;f=a.M[f];if(f.play||0==b){var e=C(f),r=e[0],n=e[1];c.Qd=e[2]}else if(-1!=e&&g.play)d=0;else return;e=f.Ca[r];g=f.Ca[n];r=f.trans[r];
n=f.trans[n];if(1==d)c.Qc.set(e),c.ud.set(g),c.Yc.set(r),c.Dd.set(n);else if(0==d)c.Qc.set(h),c.ud.set(l),c.Yc.set(k),c.Dd.set(m);else{for(f=0;f<h.length;f+=4){for(var q=da,t=K,u=0;4>u;u++)q[u]=h[f+u],t[u]=e[f+u];oa.slerp(q,t,d,q);for(u=0;4>u;u++)c.Qc[f+u]=q[u];for(u=0;4>u;u++)q[u]=l[f+u],t[u]=g[f+u];oa.slerp(q,t,d,q);for(u=0;4>u;u++)c.ud[f+u]=q[u]}qa.Lt(k,r,d,c.Yc);qa.Lt(m,n,d,c.Dd)}E.m(a);ia.CI(a)}}function f(a,b){var c=a.g,d=c.Tf,f=c.ep;if(0!=f){var d=c.dp-d,e=f*b;qa.sign(d)==qa.sign(f)&&Math.abs(e)<
Math.abs(d)?c.Tf+=e:(c.Tf=c.dp,c.ep=0)}}function m(a){var b=[],c=[],d=new Float32Array(4),f=new Float32Array(4),e;for(e in a){var g=a[e],h=d,k=f,m=g.Jm,l=m[m.length-1],r=l.Ls;l.Ao||ea.identity(r);for(l=m.length-1;0<=l;l--){var n=m[l],q=n.Ls;if(n.Ao)r=q;else{var t=n.Gg,u=n.zo;ea.invert(t,U);ea.multiply(u,U,U);ea.multiply(t,U,U);ea.multiply(r,U,q);r=q;n.Ao=!0}}m=n.Ls;h[0]=m[0];h[1]=m[1];h[2]=m[2];h[3]=m[3];k[0]=m[4];k[1]=m[5];k[2]=m[6];k[3]=m[7];oa.normalize(k,k);g=g.Vf;for(h=0;4>h;h++)k=4*g+h,b[k]=
d[h],c[k]=f[h]}return{trans:b,Ca:c}}function h(a,b,c){var d=[],f=[];new Float32Array(4);new Float32Array(4);for(var e in c)for(var g=c[e],h=g.Vf,g=g.cq,k=0;4>k;k++){var m=4*g+k,l=4*h+k;d[m]=a[l];f[m]=b[l]}d=new Float32Array(d);f=new Float32Array(f);return{trans:d,Ca:f}}function x(a){var b=a.k,c;if(b.vp)c=sa;else if(b.r)if("volume"in b.r||"pitch"in b.r)c=ma;else if(D(a))c=Z;else{a:{if(a.k.r){a=a.fcurves;for(c in a)if("color"==c&&!a[c][3]){c=!0;break a}if("energy"==c){c=!0;break a}}c=!1}c=c?Y:"light_settings.environment_energy"in
b.r||"horizon_color"in b.r||"zenith_color"in b.r||"mist_settings.intensity"in b.r||"mist_settings.depth"in b.r||"mist_settings.start"in b.r||"mist_settings.height"in b.r||"b4w_fog_color"in b.r?Fa:ga}else c=Q;b.type=c}function D(a){if(a=a.k.r)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function L(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function P(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=
1)}function A(a,b,c,d,f,e,g){var h=a+(b-a)/2,k=w(h,d,f,e,g)-c;return.02>Math.abs(k)?h:0<k?A(a,h,c,d,f,e,g):A(h,b,c,d,f,e,g)}function w(a,b,c,d,f){var e=1-a;return b*e*e*e+3*c*e*e*a+3*d*e*a*a+f*a*a*a}function I(a,b){var c={type:null,cf:null,$o:null,xt:0,vt:null,gh:new Int8Array(3),Ca:null,trans:null,ls:[],play:!1,behavior:20,gd:0,start:0,length:0,Js:0,Lr:0,Tk:!1,ny:null,speed:1,volume:null,pitch:null,color:null,Md:null,ow:[],mw:[],nw:[],lw:[]};if(!a.M.length)for(var d=0;8>d;d++)a.M.push(null);a.M[b]=
c;-1==xa.indexOf(a)&&xa.push(a)}function T(a,b){E.m(a);ha.sync_transform(a);e(a,0,b,!0)}function O(a,d,f){f=f||0;if(R.is_mesh(a)){var e=B(a,d);if(e)return I(a,f),b(a,e,f),T(a,f),!0;if((e=G(a,d))&&"EMITTER"==e.Ar){I(a,f);d=e.name;for(var e=f,g=a.B,h=0;h<g.length;h++)for(var k=g[h].T,m=0;m<k.length;m++){var l=k[m].Ba;l&&l.name==d&&c(a.M[e],l)}T(a,f);return!0}}if(e=qa.keysearch("name",d,Ba)||qa.keysearch("name",d+"_B4W_BAKED",Ba)){I(a,f);if(H(a,e,f))return T(a,f),!0;a.M[f]=null}N.error('Unsupported object: "'+
a.name+'" or animation name: "'+d+'"');return!1}function B(a,b){for(var c=0;c<a.mc.length;c++){var d=a.mc[c];if(d.name===b)return d}return null}function G(a,b){for(var c=a.B,d=0;d<c.length;d++)for(var f=c[d].T,e=0;e<f.length;e++){var g=f[e].Ba;if(g&&g.name===b)return g}return null}function M(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var F=p("__config"),R=p("__obj_util"),S=p("__particles"),ha=p("__physics"),N=p("__print"),oa=p("__quat"),
fa=p("__reformer"),na=p("__sfx"),ba=p("__time"),E=p("__transform"),ea=p("__tsr"),qa=p("__util"),la=p("__vec3"),ia=p("__armature"),ya=p("__lights"),J=p("__scenes"),V=F.Yg,W=F.p;a.iz=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.OJ=70;a.NJ=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=
10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var Q=a.qJ=0,sa=a.Ky=1,ma=a.rJ=2,ga=a.Ny=3,Z=a.et=4,Y=a.My=5,Fa=a.Ly=6,ua=Array(3),ca=new Float32Array(3),ja=new Float32Array(3),da=new Float32Array(4),K=new Float32Array(4),va=new Float32Array(4),U=ea.create();new Float32Array(16);var xa=[],Ba=[];a.ev=function(){return qa.trunc((W.gw-50)/4)};a.frame_to_sec=function(a){return a/ba.Yb()};a.update=function(a){for(var b=0;b<xa.length;b++){for(var c=xa[b],e=0;8>e;e++)y(c,a,e);c.g.Xg&&(f(c,a),v(c,a))}for(b=0;b<
xa.length;b++)for(c=xa[b],e=0;8>e&&c.M.length;e++)d(c,e)};a.RD=function(){return Ba};a.get_anim_names=function(a){var b=[];if(q(a))for(var c=0;c<a.mc.length;c++)b.push(a.mc[c].name);for(var d=[],c=0;c<Ba.length;c++){var f=Ba[c],e=f.k;e.type==ga?d.push(f):e.type==sa&&"ARMATURE"==a.type?d.push(f):e.type==ma&&"SPEAKER"==a.type?d.push(f):e.type==Fa&&"WORLD"==a.type&&d.push(f)}if("MESH"==a.type)for(c=0;c<a.actions.length;c++)f=a.actions[c],f.k.type==Z&&d.push(f);for(c=0;c<d.length;c++)b.push(n(d[c].name));
if(S.pj(a)&&S.uw(a))for(a=a.B,c=0;c<a.length;c++)for(d=a[c].T,f=0;f<d.length;f++)(e=d[f].Ba)&&b.push(e.name);return b};a.fM=n;a.get_anim_type=function(a,b){var c=a.M[b];return c?c.type:0};a.apply_def=function(a){for(var d=0,f=a.B,e=0;e<f.length;e++)for(var g=f[e].T,h=0;h<g.length;h++){var k=g[h].Ba;k&&"EMITTER"==k.Ar&&!g[h].Ke&&(I(a,d),c(a.M[d],k),T(a,d),a.M[d].behavior=k.cyclic?10:a.ik,d++)}f=a.actions.slice();for(e=0;e<f.length;e++)g=f[e],I(a,d),H(a,g,d)?(T(a,d),a.M[d].behavior=a.ik,d++):a.M[d]=
null;q(a)&&(I(a,d),b(a,a.mc[0],d),T(a,d),a.M[d].behavior=a.ik)};a.cp=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:qa.Z("Wrong animation behavior")}};a.WD=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c].node_tree;d&&g(d,b)}return b};a.play=function(a,b,c){t(a.M,c,function(a){a.play=!0;a.rq=b?b:null;a.Tk=!1});a.g.Xg&&r(a)};a.stop=function(a,b){t(a.M,b,function(a){a.play=!1;a.rq=null;a.Tk=!1})};a.is_play=
function(a,b){var c=a.M;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=l;a.set_first_frame=function(a,b){b=b||0;t(a.M,b,function(c){l(a,c.start,b)})};a.bv=function(a,b){var c=a.M[b];return c&&c.gd?c.gd:0};a.is_cyclic=function(a,b){var c=a.M[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){t(a.M,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.M[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){t(a.M,
d,function(a){a.Js=b||0;a.Lr=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.M[c]=null;else a.M[b]=null;a.g.Xg&&u(a,b)};a.uI=e;a.ww=function(a){if("ARMATURE"==a.type||a.xm||"WORLD"==a.type)return!0;for(var b=0;b<a.actions.length;b++){var c=a.actions[b].k.type;if(c==ga||c==sa||c==ma&&"SPEAKER"==a.type||c==Y&&"LAMP"==a.type||c==Z&&"MESH"==a.type)return!0}return S.pj(a)&&S.uw(a)||"MESH"==a.type&&a.mc.length?!0:!1};a.Pt=function(a,b){if("ARMATURE"==b.type||M(a))return!0;for(var c=
0;c<b.actions.length;c++){var d=b.actions[c].k.type;if(d==ga||d==sa||d==ma&&"SPEAKER"==b.type||d==Z&&"MESH"==b.type)return!0}return S.hB(a)&&S.gB(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length||"WORLD"==b.type?!0:!1};a.is_animated=function(a){return Boolean(a.M.length)};a.lB=m;a.iD=h;a.qA=function(a){function b(a,c){for(var d=0;d<c;d++){var f=a.subarray(8*d+4,8*d+8);oa.normalize(f,f)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,f=b;else-1<a.indexOf("rotation_quaternion")?(d=4,f=0==b?3:
b-1):-1<a.indexOf("scale")?(d=3,f=0):(d=0,f=b);return d+f}function d(a,b,c,g,h){if(-1<c.search(f)){a=b;c=c.split('"')[1];var k=e}else 8==h?(c="tsr",k=e):k=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof k&&k.length)for(var m=k.length,l=new Float32Array(g*m),r=0;r<g;r++)for(var n=0;n<m;n++)l[r*m+n]=k[n];else if("number"==typeof k)for(l=new Float32Array(g),r=0;r<g;r++)l[r]=k;else qa.Z("Wrong storage default value");h[b]=l}return a[c]}var f=new RegExp(/pose.bones\[\".+\"\]/g),e=ea.create(),
g=a.k={type:Q,yr:0,Fw:0,r:null,vp:null,Jt:null,gh:new Int8Array(3)};g.Fw=1/V.uh;var h=a.fcurves,k={},m={},l=0,r;for(r in h){var n=h[r],q;for(q in n){var t=n[q],u=t.bd;fa.tB(t,a);t=t.num_channels;l||(l=u.length);for(var t=d(k,m,r,l,t),p=t.length/l,J=c(r,q|0),w=0;w<l;w++)t[w*p+J]=u[w]}}if(qa.cl(k)){for(var v in k)"tsr"==v&&b(k[v],l);g.r=k}if(qa.cl(m)){for(var z in m)b(m[z],l);g.vp=m}g.yr=l;g.Jt=a.hA;"tsr"in k&&L(h,g.gh);("color"in k||"energy"in k)&&P(h,g.gh);x(a);Ba.push(a)};a.UD=function(a,b){return(b-
a)*V.uh+1};a.OA=function(a,b,c,d,f,e){var g=new Float32Array(2),h=new Float32Array(2),k=new Float32Array(2),m=new Float32Array(2),l=b[1],r=b[2],n=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var q=0,t=0,u=null;f<=e;f++)if(f<l)for(var p=0;p<V.uh;p++)c[q++]=r;else if(f>n)for(p=0;p<V.uh;p++)c[q++]=a;else{var J=b[t],x=3;0===J&&(x+=2);0===u&&(x+=2);var v=2===J?0:1;if(b[t+1]==b[t+x+1])u=J,t+=x;else{p=0;f==b[t+1]&&(v&&(d[q]=1),c[q]=b[t+2],q++,p++);if(f==n)for(;p<V.uh;p++)c[q++]=a;else for(g[0]=
b[t+1],g[1]=b[t+2],0!==J?(h[0]=0,h[1]=0):0===u?(h[0]=b[t+5],h[1]=b[t+6]):(h[0]=b[t+3],h[1]=b[t+4]),0!==J?(k[0]=0,k[1]=0):(k[0]=b[t+x+3],k[1]=b[t+x+4]),m[0]=b[t+x+1],m[1]=b[t+x+2];p<V.uh;p++){var z=f+p/V.uh;switch(J){case 0:var F=g,y=h,W=k,H=m,I=[],D=[],B=void 0,Q=void 0,G=void 0,B=void 0;I[0]=F[0]-y[0];I[1]=F[1]-y[1];D[0]=H[0]-W[0];D[1]=H[1]-W[1];G=H[0]-F[0];B=Math.abs(I[0]);Q=Math.abs(D[0]);0!=B+Q&&B+Q>G&&(B=G/(B+Q),y[0]=F[0]-B*I[0],y[1]=F[1]-B*I[1],W[0]=H[0]-B*D[0],W[1]=H[1]-B*D[1]);v&&(d[q]=1);
c[q]=w(A(0,1,z,g[0],h[0],k[0],m[0]),g[1],h[1],k[1],m[1]);q++;break;case 1:v&&(d[q]=1);F=g[0];y=g[1];W=(m[1]-y)/(m[0]-F);c[q]=W*z+(y-W*F);q++;break;case 2:v&&(d[q]=1);c[q]=b[t+2];q++;break;default:qa.Z("Unknown keyframe interpolation mode: "+J)}}f+1==b[t+x+1]&&(u=J,t+=x)}}};a.apply=O;a.KA=function(a,b,c){c=c||0;var d=qa.keysearch("uuid",b,Ba);if(d){I(a,c);if(H(a,d,c)){T(a,c);return}a.M[c]=null}N.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.$I=function(a,b){var c=qa.keysearch("name",
b,Ba)||qa.keysearch("name",b+"_B4W_BAKED",Ba);if(c){if(c.k.type==Q)return!1}else if(!(G(a,b)||R.is_mesh(a)&&B(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.M,d=0;d<c.length;d++){var f=c[d];if(f&&n(f.cf)==n(b))return d}return-1};a.SD=function(a,b){var c=a.M[b];return c&&c.cf?n(c.cf):null};a.remove=function(a){a.M.length=0;a=xa.indexOf(a);-1!=a&&xa.splice(a,1)};a.lG=function(a){for(var b=Ba.length-1;0<=b;b--)Ba[b].iA==a&&Ba.splice(b,1)};a.apply_to_first_empty_slot=function(a,
b){if(!a.M.length)return O(a,b,0)?0:-1;for(var c=0;c<a.M.length;c++)if(!a.M[c])return O(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.g.ep=(b-a.g.Tf)/c;a.g.dp=b};a.set_speed=function(a,b,c){t(a.M,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.M[b].speed};a.get_anim_start_frame=function(a,b){return a.M[b].start};a.get_anim_length=function(a,b){return a.M[b].length};a.cleanup=function(){xa.length=0;Ba.length=0};a.kD=function(a){var b=(a[0]||a[1]||a[2]).bd.length,c=da,d=ca,f=Boolean(a[0]);
f||(a[0]={bd:new Float32Array(b),num_channels:8});var e=Boolean(a[1]);e||(a[1]={bd:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={bd:new Float32Array(b),num_channels:8});a[3]={bd:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=f?a[0].bd[h]:0,d[1]=e?a[1].bd[h]:0,d[2]=g?a[2].bd[h]:0,qa.euler_to_quat(d,c),a[0].bd[h]=c[3],a[1].bd[h]=c[0],a[2].bd[h]=c[1],a[3].bd[h]=c[2]};a.Zu=M};b4w.module.__time=function(a,p){var d=p("__config");p("__print");p("__util");var b=0,c=0,n=[],g=0,q=0,l=[],t=-1;a.mx=function(a){b=a;c=performance.now();for(a=0;a<n.length;a++){var d=n[a];b>d.mq&&(n.splice(a,1),a--,d.callback())}for(a=0;a<l.length;a++){var d=l[a],g=1-(d.mq-b)/d.duration,g=Math.min(g,1);d.callback(d.from+g*(d.to-d.from));1==g&&(l.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,d){var k;g++;k=g;n.push({id:k,callback:a,mq:b+(performance.now()-c+d)/1E3});
return k};a.clear_timeout=function(a){for(var b=0;b<n.length;b++)if(n[b].id==a){n.splice(b,1);break}};a.clear_animation=function(a){for(var b=l.length;b--;)if(l[b].id==a){l.splice(b,1);break}};a.animate=function(a,c,d,g){d/=1E3;var n;q++;n=q;l.push({id:n,callback:g,from:a,to:c,mq:b+d,duration:d});g(a);return n};a.reset=function(){c=b=0;n.length=0;q=g=l.length=0};a.Yb=function(){return-1!==d.Yg.fn?d.Yg.fn:t};a.OG=function(a){t=a}};b4w.module.__transform=function(a,p){function d(a,b){e.Sd(a)?z.set_trans(b,e.Rd(a)):z.set_trans(b,a.g.i)}function b(a,b){var c=a.g;if(e.Sd(a)){z.set_quat(b,c.i);var d=e.gn(a),d=z.invert(d,x);z.multiply(d,c.i,e.Rd(a))}else z.set_quat(b,c.i)}function c(a,b){e.Sd(a)?z.set_quat(b,e.Rd(a)):z.set_quat(b,a.g.i)}function n(a,b){e.Sd(a)?z.copy(b,e.Rd(a)):z.copy(b,a.g.i)}function g(a,b){e.Sd(a)?z.copy(e.Rd(a),b):z.copy(a.g.i,b);return b}function q(a){var b=a.g,c=a.B,d=a.type;"CAMERA"==d&&t.Ns(a);e.oI(a,P);
"CAMERA"==d&&t.kI(a);var g=z.Ui(b.i,m),n=z.gv(b.i,h);b.bc&&b.Cb&&(l.wp(b.bc,b.i,b.Cb),l.yp(b.dd,b.i,b.Wb),l.xp(b.ef,b.i,b.Uf));switch(d){case "SPEAKER":u.zH(a,P);break;case "MESH":var p=a.xm;p&&(z.invert(p.g.i,x),z.multiply(x,b.i,x),f.set(x[0],x[1],x[2],x[3],b.hp),k.set(x[4],x[5],x[6],x[7],b.gp));break;case "CAMERA":t.lI(a);if(r.la()){var v=r.get_active();r.Qi(v)==a&&u.kF(v,g,n,P)}break;case "LAMP":H.sI(a)}for(v=0;v<c.length;v++){var F=c[v];if(F.un){var p=F.wa,R=p.k;switch(d){case "LAMP":r.Fo(a,p);
break;case "CAMERA":r.DG(p);R.kc&&(R.kc.enable_csm&&r.Xr(p),r.BI(a,R.jb));break;case "MESH":b.bc&&b.Cb&&(b.zd&&r.Xr(p),R=F.Yf,null!=b.Kd&&R&&r.ay(R,g));break;case "EMPTY":D.by(a)}F=F.Pe;R=a.Fl;if(R.length)for(var L=0;L<F.length;L++){var ha=F[L].j;r.dy(F[L],g,n);y.ey(R,ha.$b);t.fH(ha,r.Qi(p));C.cn(ha.ve,ha.Zk)}}}c=a.fe;for(v=0;v<c.length;v++)q(c[v]);a=a.Pp;for(v=0;v<a.length;v++)c=a[v],p=c[0],e.hI(p,c[1]);b.uq=!0}var l=p("__boundings"),t=p("__camera"),e=p("__constraints"),H=p("__lights");p("__mat3");
p("__mat4");p("__particles");var k=p("__quat"),r=p("__scenes"),u=p("__sfx"),z=p("__tsr"),D=p("__objects"),y=p("__obj_util"),C=p("__util"),v=p("__vec3"),f=p("__vec4"),m=new Float32Array(3),h=new Float32Array(4);new Float32Array(9);var x=z.create(),L=z.create(),P=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){P=a};a.set_translation=function(a,b){var c=a.g;if(e.Sd(a)){z.set_trans(b,c.i);var d=e.gn(a),d=z.invert(d,x);z.multiply(d,c.i,e.Rd(a))}else z.set_trans(b,c.i)};a.set_translation_rel=d;a.get_translation=
function(a,b){var c=z.get_trans_view(a.g.i);v.copy(c,b);return b};a.get_translation_rel=function(a,b){if(e.Sd(a))v.copy(z.get_trans_view(e.Rd(a)),b);else{var c=z.get_trans_view(a.g.i);v.copy(c,b)}return b};a.set_rotation=b;a.set_rotation_rel=c;a.get_rotation=function(a,b){var c=z.get_quat_view(a.g.i);k.copy(c,b);return b};a.get_rotation_rel=function(a,b){if(e.Sd(a))k.copy(z.get_quat_view(e.Rd(a)),b);else{var c=z.get_quat_view(a.g.i);k.copy(c,b)}return b};a.set_rotation_euler=function(a,c){var d=C.euler_to_quat(c,
h);b(a,d)};a.set_rotation_euler_rel=function(a,b){var d=C.euler_to_quat(b,h);c(a,d)};a.set_scale=function(a,b){var c=a.g;if(e.Sd(a)){var c=e.Rd(a),d=z.get_scale(e.gn(a));z.set_scale(b/d,c)}else z.set_scale(b,c.i)};a.set_scale_rel=function(a,b){var c=a.g;e.Sd(a)?z.set_scale(b,e.Rd(a)):z.set_scale(b,c.i)};a.get_scale=function(a){return z.get_scale(a.g.i)};a.get_scale_rel=function(a){return e.Sd(a)?z.get_scale(e.Rd(a)):z.get_scale(a.g.i)};a.set_tsr=function(a,b){z.copy(b,a.g.i);if(e.Sd(a)){var c=e.gn(a),
c=z.invert(c,x);z.multiply(c,a.g.i,e.Rd(a))}};a.set_tsr_rel=n;a.get_tsr=function(a,b){return z.copy(a.g.i,b)};a.get_tsr_rel=g;a.get_object_size=function(a){var b=a.g;a=b.vi;var c=z.get_scale(b.i),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){c||(c=new Float32Array(3));b?(a=a.g,v.copy(a.Wb.K,c)):(a=a.g,b=a.vi,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,z.transform_vec3(c,a.i,c));
return c};a.move_local=function(a,b,c,f){var e=g(a,x),h=m;h[0]=b;h[1]=c;h[2]=f;z.transform_vec3(h,e,h);d(a,h)};a.Tr=function(a,b){var c=g(a,x),d=z.set_quat(b,z.identity(L));z.multiply(c,d,d);n(a,d)};a.m=q;a.distance=function(a,b){var c=z.get_trans_view(a.g.i),d=z.get_trans_view(b.g.i);return v.dist(c,d)};a.qj=function(a,b){var c=z.get_trans_view(a.g.i);return v.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.g.Cb.max_x,min_x:a.g.Cb.min_x,max_y:a.g.Cb.max_y,min_y:a.g.Cb.min_y,max_z:a.g.Cb.max_z,
min_z:a.g.Cb.min_z}}};b4w.module.__tsr=function(a,p){function d(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function b(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function c(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function n(a,b,c){var d=b[0],e=b[1],g=b[2],k=b[3],f=b[4],m=b[5],h=b[6];b=b[7];var l=a[0]*k,n=a[1]*k,q=a[2]*k;a=b*l+m*q-h*n;var k=b*n+h*l-f*q,t=b*q+f*n-m*l,l=-f*l-m*n-h*q;c[0]=a*b+l*-f+k*-h-t*-m;c[1]=k*b+l*-m+t*-f-a*-h;c[2]=t*b+l*-h+a*-m-k*-f;
c[0]+=d;c[1]+=e;c[2]+=g;return c}p("__mat3");var g=p("__mat4"),q=p("__quat"),l=p("__util"),t=p("__vec3"),e=new Float32Array(3),H=new Float32Array(4),k=new Float32Array(16);a.create=d;a.from_values=function(a,b,c,e,g,k,l,f){var m=d();m[0]=a;m[1]=b;m[2]=c;m[3]=e;m[4]=g;m[5]=k;m[6]=l;m[7]=f;return m};a.Sm=b;a.PK=function(a,c,d,e,g,k,l,f){var m=b();m[0]=a;m[1]=c;m[2]=d;m[3]=e;m[4]=g;m[5]=k;m[6]=l;m[7]=f;return m};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];
b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=c;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.Ui=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=
function(a){return a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.gv=function(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],g=a[2];H[0]=a[4];H[1]=a[5];H[2]=a[6];H[3]=a[7];q.invert(H,H);var k=H[0],f=H[1],m=H[2],h=H[3],d=d*c,e=e*c,l=g*c,g=h*d+f*l-m*e,n=h*e+m*d-k*l,t=h*l+k*e-f*d,d=-k*d-f*e-m*l;b[0]=-(g*h+d*-k+n*-m-t*-f);b[1]=-(n*h+d*-f+t*-k-g*-m);b[2]=-(t*h+d*-m+g*-f-n*-k);b[3]=c;b[4]=k;b[5]=f;b[6]=m;b[7]=h;
return b};a.to_mat4=function(a,b){var c=a[3];g.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var d=l.ew(a,e),g=l.dw(a),k=l.matrix_to_quat(a,H);c(d,g,k,b);return b};a.multiply=function(a,b,c){n(b,a,c);c[3]=a[3]*b[3];var d=a[4],e=a[5],g=a[6];a=a[7];var k=b[4],f=b[5],m=b[6];b=b[7];c[4]=d*b+a*k+e*m-g*f;c[5]=e*b+a*f+g*k-d*m;c[6]=g*b+a*m+d*f-e*k;c[7]=a*b-d*k-e*f-g*m;return c};a.WH=function(a,b,c){var d=b[3];b=g.fromRotationTranslation(b.subarray(4,
8),b.subarray(0,3),k);for(var e=0;12>e;e++)b[e]*=d;g.multiply(b,a,c);return c};a.transform_vec3=n;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],g=a[1]-b[1],k=a[2]-b[2];a=b[4];var f=b[5],m=b[6];b=b[7];var h=a*a+f*f+m*m+b*b,h=h?1/h:0;a=-a*h;f=-f*h;m=-m*h;b*=h;var h=b*e+f*k-m*g,l=b*g+m*e-a*k,n=b*k+a*g-f*e,e=-a*e-f*g-m*k;c[0]=h*b+e*-a+l*-m-n*-f;c[1]=l*b+e*-f+n*-a-h*-m;c[2]=n*b+e*-m+h*-f-l*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,
g=b[0],k=b[1],f=b[2],m=b[3],h=b[4],l=b[5],n=b[6];b=b[7];for(var q=0;q<e;q+=3){var t=a[q]*m,p=a[q+1]*m,H=a[q+2]*m,T=b*t+l*H-n*p,O=b*p+n*t-h*H,B=b*H+h*p-l*t,t=-h*t-l*p-n*H;c[d+q]=T*b+t*-h+O*-n-B*-l;c[d+q+1]=O*b+t*-l+B*-h-T*-n;c[d+q+2]=B*b+t*-n+T*-l-O*-h;c[d+q]+=g;c[d+q+1]+=k;c[d+q+2]+=f}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,g=b[3],k=b[4],f=b[5],m=b[6];b=b[7];for(var h=0;h<e;h+=3){var l=a[h]*g,n=a[h+1]*g,q=a[h+2]*g,t=b*l+f*q-m*n,p=b*n+m*l-k*q,H=b*q+k*n-f*l,l=-k*
l-f*n-m*q;c[d+h]=t*b+l*-k+p*-m-H*-f;c[d+h+1]=p*b+l*-f+H*-k-t*-m;c[d+h+2]=H*b+l*-m+t*-f-p*-k}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],g=b[5],k=b[6];b=b[7];var f=a[0]*d,m=a[1]*d,h=a[2]*d;a=b*f+g*h-k*m;var d=b*m+k*f-e*h,l=b*h+e*m-g*f,f=-e*f-g*m-k*h;c[0]=a*b+f*-e+d*-k-l*-g;c[1]=d*b+f*-g+l*-e-a*-k;c[2]=l*b+f*-k+a*-g-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,g=b[3],k=b[4],f=b[5],m=b[6];b=b[7];for(var h=0;h<e;h+=4){var l=a[h]*g,n=a[h+1]*g,q=a[h+
2]*g,t=b*l+f*q-m*n,p=b*n+m*l-k*q,H=b*q+k*n-f*l,l=-k*l-f*n-m*q;c[d+h]=t*b+l*-k+p*-m-H*-f;c[d+h+1]=p*b+l*-f+H*-k-t*-m;c[d+h+2]=H*b+l*-m+t*-f-p*-k;c[d+h+3]=a[h+3]}return c};a.translate=function(a,b,c){var d=a[3],e=a[4],g=a[5],k=a[6],f=a[7],m=b[0]*d,h=b[1]*d,l=b[2]*d;b=f*m+g*l-k*h;var d=f*h+k*m-e*l,n=f*l+e*h-g*m,m=-e*m-g*h-k*l;c[0]=a[0]+b*f+m*-e+d*-k-n*-g;c[1]=a[1]+d*f+m*-g+n*-e-b*-k;c[2]=a[2]+n*f+m*-k+b*-g-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,
d){t.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);q.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.HK=function(a,b,c,d){var e=a.subarray(0,3),g=b.subarray(0,3),k=d.subarray(0,3);k[0]=g[0]*(c+1)-e[0]*c;k[1]=g[1]*(c+1)-e[1]*c;k[2]=g[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;q.normalize(e,e);return d};
a.GE=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var g=d[1];d=d[2];var k=a[4],f=a[5],m=a[6],h=a[7];e[4]=.5*(c*h+g*m-d*f);e[5]=.5*(g*h+d*k-c*m);e[6]=.5*(d*h+c*f-g*k);e[7]=.5*(-c*k-g*f-d*m);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];g=e[7];a=a*a+b*b+c*c+g*g;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)}};b4w.module.__util=function(a,p){function d(a){return 0<a?1:0>a?-1:0}function b(a){var b=a[0],c=a[1],d=a[2],f=a[3],e=Math.sqrt(b*b+c*c+d*d),e=1/e;a[0]=b*e;a[1]=c*e;a[2]=d*e;a[3]=f*e}function c(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}function n(a,b){var c=b;switch(typeof a){case "number":return g(a,c);case "string":return q(a,c);case "boolean":return g(a|0,c);case "function":case "undefined":return g(0,c);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==
a.byteLength)for(d=0;d<a.length;d++)c=g(a[d],c);else if(d)for(d=0;d<a.length;d++)c=n(a[d],c);else for(var f in a)c=n(a[f],c)}else c=g(0,c)}return c}function g(a,b){var c=b;F[0]=a;c=(c<<5)-c+R[0];c&=c;c=(c<<5)-c+R[1];return c&c}function q(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function l(a){return(34*a+1)*a%289}function t(a){return a-Math.floor(a)}function e(a){return H((34*a+5)*a)}function H(a){return a-289*Math.floor(a/289)}function k(a){return a-7*Math.floor(a/
7)}function r(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function u(a){return r(a,0,2*Math.PI)}function z(a,b){if(a&&b){var c=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,f=b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength;if(c!=b instanceof Array||d!=f)return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!D(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{for(var e in a)if(!D(a[e],
b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function D(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return z(a,b);default:return!0}}function y(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var f=a[d];""!=f&&"."!=f&&(".."!=f||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(f):c.length&&c.pop())}a=
c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}var C=p("__mat3"),v=p("__mat4"),f=p("__print"),m=p("__tsr"),h=p("__quat"),x=p("__vec3"),L=p("__vec4"),P=0,A={},w=new Float32Array(3),I=new Float32Array(3),T=new Float32Array(4),O=new Float32Array(4),B=new Float32Array(9),G=new Float32Array(16),M=new Float32Array(16),F=new Float64Array(1),R=new Uint32Array(F.buffer),S=new Float32Array([0,0,0]),ha=new Float32Array([0,0,0,1]),N=new Float32Array([0,0,0,1,0,0,0,1]),oa=new Float32Array([1,1,1]),fa=new Float32Array([1,
0,0]),na=new Float32Array([0,1,0]),ba=new Float32Array([0,0,1]),E=new Float32Array([-1,0,0]),ea=new Float32Array([0,-1,0]),qa=new Float32Array([0,0,-1]),la=Math.floor(44488.07041494893),ia=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,
0,0,0,1])];a.ot=S;a.nt=ha;a.RJ=N;a.pt=oa;a.AXIS_X=fa;a.AXIS_Y=na;a.AXIS_Z=ba;a.AXIS_MX=E;a.AXIS_MY=ea;a.AXIS_MZ=qa;a.XYX=0;a.YZY=1;a.ZXZ=2;a.XZX=3;a.YXY=4;a.ZYZ=5;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.Sy=ia;a.nd=function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],f=c.length,e=0;e<f;e++){var g=c[e];g[a]==b&&d.push(g)}return d};a.nD=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.YH=function(a,b){var c=a.length,d=
new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.AB=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.PA=function(a,b){var c=[],d={},f=b.length,e,g;for(e=0;e<f;e++)d[b[e]]=!0;f=a.length;for(e=0;e<f;e++)g=a[e],g in d&&c.push(g);return c};a.sign=d;a.BL=function(a,b,c){for(var d=c.length,f=0;f<d;f++)if(c[f][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var f=c[d];if(f[a]===b)return f}return null};a.AL=function(a,
b,c,d,f){for(var e=0;e<f.length;e++){var g=f[e];if(g[a]==b&&g[c]==d)return g}return null};a.hE=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.JA=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.oK=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.TH=function(a,b,c,d){d||(d=new Float32Array(16));v.identity(d);d[12]=a;d[13]=b;d[14]=c};var ya=1;a.jG=function(){ya=(69069*ya+5)%Math.pow(2,32);
return Math.round(ya/65536)%32768/32767};a.FH=function(a){ya=a};a.Yd=function(a){var b=a[0]%la*48271-3399*Math.floor(a[0]/la);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.sn=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),f=Math.cos(a[0]/2),e=Math.sin(a[1]/2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=c*d*h+e*g*f;b[1]=e*d*f+c*g*h;b[2]=c*g*f-e*d*h;b[3]=c*d*f-e*g*h;return b};a.ordered_angles_to_quat=
function(a,b,c){var d=a[0],f=a[1];a=a[2];var e=Math.cos(d/2),g=Math.cos(f/2),h=Math.cos(a/2),k=Math.sin(d/2),f=Math.sin(f/2),m=Math.sin(a/2);if(-1<[0,1,2,4,5].indexOf(b))var l=Math.cos((d+a)/2),n=Math.sin((d+a)/2),q=Math.cos((d-a)/2),r=Math.sin((d-a)/2),t=Math.cos((a-d)/2),p=Math.sin((a-d)/2);switch(b){case 0:c[0]=g*n;c[1]=f*q;c[2]=f*r;c[3]=g*l;break;case 1:c[0]=f*r;c[1]=g*n;c[2]=f*q;c[3]=g*l;break;case 2:c[0]=f*q;c[1]=f*r;c[2]=g*n;c[3]=g*l;break;case 3:c[0]=g*n;c[1]=f*p;c[2]=f*t;c[3]=g*l;break;case 4:c[0]=
f*t;c[1]=g*n;c[2]=f*p;c[3]=g*l;break;case 5:c[0]=f*p;c[1]=f*t;c[2]=g*n;c[3]=g*l;break;case 6:c[0]=k*g*h+e*f*m;c[1]=e*f*h-k*g*m;c[2]=e*g*m+k*f*h;c[3]=e*g*h-k*f*m;break;case 7:c[0]=e*g*m+k*f*h;c[1]=k*g*h+e*f*m;c[2]=e*f*h-k*g*m;c[3]=e*g*h-k*f*m;break;case 8:c[0]=e*f*h-k*g*m;c[1]=e*g*m+k*f*h;c[2]=k*g*h+e*f*m;c[3]=e*g*h-k*f*m;break;case 9:c[0]=k*g*h-e*f*m;c[1]=e*g*m-k*f*h;c[2]=e*f*h+k*g*m;c[3]=e*g*h+k*f*m;break;case 10:c[0]=e*f*h+k*g*m;c[1]=k*g*h-e*f*m;c[2]=e*g*m-k*f*h;c[3]=e*g*h+k*f*m;break;case 11:c[0]=
e*g*m-k*f*h,c[1]=e*f*h+k*g*m,c[2]=k*g*h-e*f*m,c[3]=e*g*h+k*f*m}return c};a.aD=function(a){var b=C.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),f=Math.cos(a[2]),e=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*f,k=c*a,m=e*f,l=e*a;b[0]=d*f;b[1]=d*a;b[2]=-g;b[3]=g*m-k;b[4]=g*l+h;b[5]=d*e;b[6]=g*h+l;b[7]=g*k-m;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],f=a[2],e=a[3],g=f*f,h=c*d+f*e;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,e),b[2]=Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,
e),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*e-2*d*f,1-2*c*c-2*g),b[1]=Math.atan2(2*d*e-2*c*f,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*f*e));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));x.transformQuat(b,a,c);return c};a.QC=function(a,b,c){c||(c=new Float32Array(4));a=x.normalize(a,w);var d=x.dot(b,a);a=x.cross(b,a,I);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2)};a.UH=function(a,b,c,d){d||(d=new Float32Array(4));x.transformQuat(c,
b,d);d[3]=-x.dot(a,d)};a.PC=function(a){var b=m.get_quat_view(a.g.i);switch(a.type){case "CAMERA":w[0]=0;w[1]=-1;w[2]=0;x.transformQuat(w,b,w);I[0]=0;I[1]=0;I[2]=-1;break;case "MESH":w[0]=0;w[1]=0;w[2]=1;x.transformQuat(w,b,w);I[0]=0;I[1]=0;I[2]=1;break;case "EMPTY":w[0]=0,w[1]=1,w[2]=0,x.transformQuat(w,b,w),I[0]=0,I[1]=1,I[2]=0}w[1]=0;x.normalize(w,w);a=x.dot(w,I);return Math.acos(a)*(0<-w[0]*I[2]?-1:1)};a.Lt=function(a,b,c,d){if(0!=c){d=d||[];for(var f=0;f<a.length;f++)d[f]=(1-c)*a[f]+c*b[f]}};
a.kM=function(){P++;return P.toString(16)};a.Wj=function(a){A[a]||(A[a]=0);var b=a+A[a];A[a]++;return b};a.ge=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Xb=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,fa:0,Ia:null,D:[],O:b,qa:[]}};a.hh=function(a){return JSON.parse(JSON.stringify(a))};a.za=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;
switch(c){case Float32Array:case Uint32Array:case Uint16Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.za(b[d]);break;default:for(d in c=new c,b)c[d]=a.za(b[d])}return c};a.wk=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Float32Array:case Uint32Array:case Uint16Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=
function(a,b){b||(b=new Float32Array(4));C.fromMat4(a,B);var c=B[0],d=B[3],f=B[6],e=B[1],g=B[4],k=B[7],m=B[2],l=B[5],n=B[8],c=Math.sqrt(c*c+d*d+f*f)||1,e=Math.sqrt(e*e+g*g+k*k)||1,m=Math.sqrt(m*m+l*l+n*n)||1;B[0]/=c;B[3]/=c;B[6]/=c;B[1]/=e;B[4]/=e;B[7]/=e;B[2]/=m;B[5]/=m;B[8]/=m;h.fromMat3(B,b);h.normalize(b,b);return b};a.ew=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.dw=function(a){T[0]=.577350269189626;T[1]=.577350269189626;T[2]=.577350269189626;T[3]=0;
L.transformMat4(T,a,T);return L.length(T)};a.cn=function(a,c){var d=c.left,f=c.right,e=c.top,g=c.bottom,h=c.Va,k=c.Eb;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];f[0]=a[3]-a[0];f[1]=a[7]-a[4];f[2]=a[11]-a[8];f[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];b(d);
b(f);b(e);b(g);b(h);b(k)};a.AH=function(a,b,d){return d<-c(a,b.left)||d<-c(a,b.right)||d<-c(a,b.top)||d<-c(a,b.bottom)||d<-c(a,b.Va)||d<-c(a,b.Eb)?!0:!1};a.YC=function(a,b,d,f,e){g=x.dot(d,b.Eb);h=x.dot(f,b.Eb);k=x.dot(e,b.Eb);g=Math.sqrt(g*g+h*h+k*k);if(g<-c(a,b.Va)||g<-c(a,b.Eb))return!0;var g=x.dot(d,b.left),h=x.dot(f,b.left),k=x.dot(e,b.left);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.left))return!0;g=x.dot(d,b.right);h=x.dot(f,b.right);k=x.dot(e,b.right);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.right))return!0;
g=x.dot(d,b.top);h=x.dot(f,b.top);k=x.dot(e,b.top);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.top))return!0;g=x.dot(d,b.bottom);h=x.dot(f,b.bottom);k=x.dot(e,b.bottom);return Math.sqrt(g*g+h*h+k*k)<-c(a,b.bottom)?!0:!1};a.yj=function(a,b,c,d){d||(d=0);for(var f=a.length,e=0;e<f;e+=3){var g=a[e],h=a[e+1],k=a[e+2];c[d+e]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+e+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+e+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.cJ=function(a,b,c){for(var d=0,d=0,f=a.length,e=0;e<f;e+=3){var g=a[e],h=a[e+1],k=a[e+
2];c[d+e]=b[0]*g+b[4]*h+b[8]*k;c[d+e+1]=b[1]*g+b[5]*h+b[9]*k;c[d+e+2]=b[2]*g+b[6]*h+b[10]*k}};a.QH=function(a,b,c){for(var d=0,d=0,f=a.length,e=0;e<f;e+=4){var g=a[e],h=a[e+1],k=a[e+2];c[d+e]=b[0]*g+b[4]*h+b[8]*k;c[d+e+1]=b[1]*g+b[5]*h+b[9]*k;c[d+e+2]=b[2]*g+b[6]*h+b[10]*k;c[d+e+3]=a[e+3]}};a.aJ=function(a,b,c){c||(c=new Float32Array(3));T[0]=a[0];T[1]=a[1];T[2]=a[2];T[3]=0;L.transformMat4(T,b,T);c[0]=T[0];c[1]=T[1];c[2]=T[2]};a.KK=function(a,b){var c=a.length;if(!c)throw"flatten(): Wrong or empty array";
var d=a[0].length;if(!d)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(c*d));for(var f=0;f<c;f++)for(var e=0;e<d;e++)b[f*d+e]=a[f][e];return b};a.bJ=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.Dm=function(b,c,d,f){if(f<d)return d;var e=d+Math.floor((f-d)/2);return b[e]>c?a.Dm(b,c,d,e-1):b[e]<c?a.Dm(b,c,e+1,f):e};a.Xf=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.pK=function(a,b,c){for(var d=
0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.RL=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.WH=function(a,b,c,d,f){f||(f=new Float32Array(16));b=v.fromRotationTranslation(c,d,G);v.multiply(b,a,f);return f};a.transform_vec3=function(a,b,c,d,f){f||(f=new Float32Array(3));c=v.fromRotationTranslation(c,d,G);1!==b&&(d=v.identity(M),b=x.set(b,b,b,w),v.scale(d,b,d),v.multiply(c,d,c));x.transformMat4(a,
c,f);return f};a.iM=function(a,b,c,d,f){f||(f=new Float32Array(4));b=v.fromRotationTranslation(c,d,G);L.transformMat4(a,b,f);return f};a.tL=function(a,b,c,d,f){f||(f=new Float32Array(3));b=v.fromRotationTranslation(c,d,G);v.invert(b,b);x.transformMat4(a,b,f);return f};a.hM=function(a,b,c){c||(c=new Float32Array(16));v.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.IL=function(b,c,d){a.ew(b,c);c[3]=a.dw(b);a.matrix_to_quat(b,d)};a.XJ=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);
return JSON.stringify(b)};a.xG=function(a,b,c,d){d||(d=new Float32Array(3));x.subtract(b,a,w);x.transformQuat(w,c,w);x.subtract(b,w,d)};a.FD=function(){w[0]=0;w[1]=0;w[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),f=new Float32Array(16),e=new Float32Array(16);v.lookAt(w,[-1,0,0],[0,-1,0],a);v.scale(a,[-1,1,1],a);v.scale(a,[-1,1,-1],b);v.lookAt(w,[0,-1,0],[0,0,-1],c);v.scale(c,[1,1,-1],c);v.scale(c,[1,-1,-1],d);v.lookAt(w,[0,0,-1],[0,-1,0],f);
v.scale(f,[-1,1,1],f);v.scale(f,[-1,1,-1],e);return[a,b,c,d,f,e]};a.JD=function(){w[0]=0;w[1]=0;w[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),f=new Float32Array(16),e=new Float32Array(16);v.lookAt(w,[1,0,0],[0,-1,0],a);v.scale(a,[-1,1,-1],b);v.lookAt(w,[0,1,0],[0,0,1],c);v.scale(c,[1,-1,-1],d);v.lookAt(w,[0,0,1],[0,-1,0],f);v.scale(f,[-1,1,-1],e);return[a,b,c,d,f,e]};a.St=function(a,b){return n(a,b)};a.hash_code=n;a.nL=q;a.xF=function(a,b){b[15]=
1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.vd=function(a){return a*Math.PI/180};a.LC=function(a){return 180*a/Math.PI};a.os=
function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),f=.211324865405187*c+.211324865405187*d,b=a[0]-c+f;a=a[1]-d+f;var e=b>a?1:0,g=1-e,f=b+.211324865405187-e,h=a+.211324865405187-g,k=b+-.577350269189626,m=a+-.577350269189626,c=c%289,d=d%289,n=l(l(d)+c),g=l(l(d+g)+c+e),q=l(l(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(f*f+h*h),0),e=Math.max(.5-(k*k+m*m),0),r=2*t(.024390243902439*n)-1,p=2*t(.024390243902439*g)-1,u=2*t(.024390243902439*q)-1,
n=Math.abs(r)-.5,g=Math.abs(p)-.5,q=Math.abs(u)-.5,r=r-Math.floor(r+.5),p=p-Math.floor(p+.5),u=u-Math.floor(u+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(r*r+n*n)),d=d*d*d*d*(1.79284291400159-.85373472095314*(p*p+g*g)),e=e*e*e*e*(1.79284291400159-.85373472095314*(u*u+q*q));return 130*(c*(r*b+n*a)+d*(p*f+g*h)+e*(u*k+q*m))};a.Wt=function(a){var b=1/7,c=b/2,d=H(Math.floor(a[0])),f=H(Math.floor(a[1])),g=t(a[0]);a=t(a[1]);var h=g-.5,m=g-1.5,g=a-.5;a-=1.5;var l=e(d),n=e(d+1),q=l,d=n,l=e(l+f),n=e(n+
f),q=e(q+f+1),d=e(d+f+1),f=h+.7*(k(l)*b+c),r=m+.7*(k(n)*b+c),h=h+.7*(k(q)*b+c),m=m+.7*(k(d)*b+c),l=g+.7*(k(Math.floor(l*b))*b+c),g=g+.7*(k(Math.floor(n*b))*b+c),q=a+.7*(k(Math.floor(q*b))*b+c),b=a+.7*(k(Math.floor(d*b))*b+c);return Math.min(f*f+l*l,r*r+g*g,h*h+q*q,m*m+b*b)};a.quat_project=function(a,b,c,d,f){f||(f=new Float32Array(4));a=x.transformQuat(b,a,w);b=c[0];var e=c[1];c=c[2];B[0]=e*e+c*c;B[1]=-e*b;B[2]=-c*b;B[3]=-b*e;B[4]=b*b+c*c;B[5]=-c*e;B[6]=-b*c;B[7]=-e*c;B[8]=b*b+e*e;x.transformMat3(a,
B,a);x.normalize(a,a);h.rotationTo(d,a,f);return f};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=T,d=O,c=h.setAxisAngle([0,1,0],Math.PI,h.create()),d=h.setAxisAngle([1,0,0],Math.PI/2,h.create());h.multiply(c,d,c);h.multiply(a,c,b);return b};a.cleanup=function(){P=0;A={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,f){f||(f=new Float32Array(a.length));c=Math.exp(-c/d);
for(d=0;d<f.length;d++)f[d]=(1-c)*a[d]+c*b[d];return f};a.wx=function(a,b,c,d,f){f||(f=new Float32Array(a.length));h.slerp(a,b,Math.exp(-c/d),f)};a.uL=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=C.fromQuat(a,B);I[0]=0;I[1]=1;I[2]=0;w[0]=c[3];w[1]=c[4];w[2]=c[5];var d=x.cross(I,w,w);
x.normalize(d,d);var f=c[7];!b&&0<f&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);I[0]=c[0];I[1]=c[1];I[2]=c[2];x.normalize(I,I);h.rotationTo(I,d,O);h.multiply(O,a,a)};a.Yu=function(a,b,c,d){c=c*b-.5;var f=d*b-.5;d=c-Math.floor(c);var e=f-Math.floor(f);c=Math.floor(c);var f=Math.floor(f),g=b-1,h=a[f*b+c],k=a[f*b+Math.min(c+1,g)],m=a[Math.min(f+1,g)*b+c];a=a[Math.min(f+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+k*d)*(1-e)+(m*(1-d)+a*d)*e};a.Xh=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.cx=function(a){for(var b=
[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Hl=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.yq=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.cl=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.xz_direction=function(a,b,
c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];x.normalize(c,c)};a.VH=function(a,b,c){var d=a[0],f=a[1];a=a[2];var e=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*f,m=h*d-e*a,l=e*f-g*d,n=g*l-h*m,h=h*k-e*l,e=e*m-g*k;c[0]=d+2*k*b+2*n;c[1]=f+2*m*b+2*h;c[2]=a+2*l*b+2*e};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.Z=function(a){a&&f.error.apply(f,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
};a.angle_wrap_periodic=r;a.angle_wrap_0_2pi=u;a.Eq=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.Ix=function(a,b){for(var c in a){var d=!0,f=a[c],e=b[c];switch(typeof f){case "number":case "string":case "boolean":d=f==e;break;case "object":d=z(f,e)}if(!d)return!1}return!0};a.Kr=function(a,b){var c=a[0],d=a[2],f=a[3];b[0]=a[1];b[1]=d;b[2]=f;b[3]=c};a.Ru=function(a){a+=1;132651<a&&f.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/
51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d,f){T.set(a);T[3]=b;O.set(d);O[3]=0;a=L.dot(T,O);if(0==a)return null;O.set(c);O[3]=1;a=-L.dot(T,O)/a;f[0]=c[0]+a*d[0];f[1]=c[1]+a*d[1];f[2]=c[2]+a*d[2];return f};a.lE=function(a,b,c,d){var f=b[0]-a[0],e=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=e*b-f*a;d[2]=f*h-g*e;return d};a.rK=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.ex=function(a,b,c){var d=x.dot(a,b);-.9999999>d?(x.cross(fa,a,w),
1E-6>x.length(w)&&x.cross(na,a,w),x.normalize(w,w),h.setAxisAngle(w,Math.PI,c)):(x.cross(a,b,w),c.set(w),c[3]=1+d,h.normalize(c,c));return c};a.fh=function(a,b,c){if(b==c)return c-a;a=u(a);b=u(b);c=u(c);b=2*Math.PI-b;c=u(c+b);a=u(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=clamp(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.QA=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;
return!1};a.xK=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.qy=function(a,b){for(var c=Math.max(a.length,b.length),f=0;f<c;f++){var e=d((f>=a.length?0:a[f])-(f>=b.length?0:b[f]));if(e)return e}return 0};a.Lg=function(a){return a.join(".")};a.Gx=function(a){return a.split(".").map(function(a){return a|0})};a.Cx=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.fr=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],
1/2.2);return b};a.pl=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=y(b[1]),b.join("://")):y(a)};a.vk=function(a){return 0!=parseInt(a.toString(2).substr(1),2)}};b4w.module.__sfx=function(a,p){function d(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;y.warn("deprecated WebAudio implementation");return null}y.warn("WebAudio is not supported");return null}function b(a,b,d){var e=a.H;if("NONE"!=e.behavior){var h=e.loop,k=e.pitch;if(e.src&&(h||0<=d)){e.lp=Math.floor(5E4*Math.random());var m=T.currentTime+b,m=Math.max(0,m);e.Ad=m;e.state=20;c(a);"POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior?(b=T.createBufferSource(),
b.buffer=e.src,b.playbackRate.value=k,f.nd(b.onended)&&(b.onended=function(){e.state=50}),h?(e.Rb&&e.Rb.disconnect(),b.loop=!0,b.start(m),e.duration=0):(h=b.buffer?b.buffer.duration:0,d>h?(h=m+d+e.kd,b.loop=!0,b.start(m),b.stop(h),e.duration=d):(b.loop=!1,b.start(m),e.duration=h)),b.connect(e.Pc),e.Rb=b,g(e),q(e)):"BACKGROUND_MUSIC"==e.behavior&&(C.clear_timeout(e.pp),C.clear_timeout(e.qp),d=function(){var b=a.H,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Rb=b.Rb||T.createMediaElementSource(c),b.Rb.connect(b.Pc),
20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==b?d():e.pp=C.set_timeout(d,1E3*b),e.duration=h?0:z(a));l(e,m)}}}function c(a){var b=a.H;if(!b.Pc){var c=v.get_trans_view(a.g.i);a=v.get_quat_view(a.g.i);if(x.Kn){var d=T.createBiquadFilter();d.type="peaking"}else d=null;var e=T.createGain();switch(b.behavior){case "POSITIONAL":var g=T.createPanner();"string"!=typeof g.panningModel?(g.panningModel=g.EQUALPOWER,g.distanceModel=g.INVERSE_DISTANCE):(g.panningModel="equalpower",g.distanceModel=
"inverse");g.setPosition(c[0],c[1],c[2]);m.copy(c,b.ar);c=L;f.quat_to_dir(a,f.AXIS_MY,c);g.setOrientation(c[0],c[1],c[2]);m.copy(c,b.direction);g.refDistance=b.dist_ref;g.maxDistance=b.dist_max;g.rolloffFactor=b.attenuation;g.coneInnerAngle=b.iu;g.coneOuterAngle=b.ju;g.coneOuterGain=b.ku;var h=T.createGain();h.gain.value=u(b);d?(g.connect(d),d.connect(h)):g.connect(h);h.connect(e);b.Pc=g;if(b.li){var k=T.createGain();e.connect(k);k.connect(T?O.ya.Pc:null)}else k=null,e.connect(T?O.ya.Pc:null);break;
case "BACKGROUND_SOUND":g=null;h=T.createGain();h.gain.value=u(b);d?(b.Pc=d,d.connect(h)):b.Pc=h;h.connect(e);b.li?(k=T.createGain(),e.connect(k),k.connect(T?O.ya.Pc:null)):(k=null,e.connect(T?O.ya.Pc:null));break;case "BACKGROUND_MUSIC":k=g=null,h=T.createGain(),h.gain.value=u(b),d?(b.Pc=d,d.connect(h)):b.Pc=h,h.connect(e),e.connect(T?O.ya.Pc:null)}b.tl=g;b.Je=d;b.Oi=h;b.rh=e;b.Sw=k}}function n(a){var c=a.H,d=c.duration,c=c.delay+c.zu*Math.random();b(a,c,d)}function g(a){a.li&&a.Sw.gain.cancelScheduledValues(a.Ad);
a.wj&&a.Rb.playbackRate.cancelScheduledValues(a.Ad);a.dm=a.Ad}function q(a){if(a.li||a.wj){var b=a.Sw,c=a.Rb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Ad;G[0]=a.lp;for(var g=0;5>g;){var h=a.pitch+a.wj*f.Yd(G);if(e>=a.dm){if(a.li){var k=1-f.clamp(a.li,0,1)*Math.random();b.gain.setValueAtTime(k,e)}a.wj&&c.playbackRate.setValueAtTime(h,e);g++}e+=d/h}a.dm=e-.001}}}function l(a,b){if(a.sh||a.kd){var c=a.rh;c.gain.cancelScheduledValues(b);a.sh?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,
b+a.sh)):c.gain.setValueAtTime(1,b);a.kd&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.kd))}}function t(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.H;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.rh,d=T.currentTime;b.kd&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.kd));"BACKGROUND_MUSIC"==b.behavior?b.src&&(C.clear_timeout(b.pp),C.clear_timeout(b.qp),b.qp=C.set_timeout(function(){var b=
a.H.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.kd)):(c=b.Rb,b.duration<c.buffer.duration?b.kd&&20==b.state?c.stop(d+b.kd):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Ad=0,b.Dr=0,b.zp=0);b.state=30}}function e(a){a=a.H;if(20==a.state){var b=T.currentTime;a.Dr=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.Ad){G[0]=a.lp;for(var d=a.Rb.buffer.duration,e=a.Ad;e<b;)c=a.pitch+a.wj*f.Yd(G),e+=d/c;c*=d/c-(e-b)}else c=0;a.zp=c;a.Rb.stop(0);a.Rb.disconnect();
g(a)}a.state=40}}function H(a){var b=a.H;if(40==b.state){var c=T.currentTime;b.Ad+=c-b.Dr;"BACKGROUND_MUSIC"==b.behavior?b.src.play():(k(a),b.dm=c,a=b.Rb,f.nd(a.onended)&&(a.onended=function(){b.state=50}),a.start(b.Ad,b.zp),q(b));l(b,b.Ad);b.state=20}}function k(a){a=a.H;var b=T.createBufferSource();b.loop=a.Rb.loop;b.buffer=a.Rb.buffer;b.playbackRate.value=a.Rb.playbackRate.value;a.tl?b.connect(a.tl):b.connect(a.Oi);a.Rb=b}function r(a){a=a.H;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=
a.state?!1:!0}function u(a){return a.muted?0:a.volume}function z(a){a=a.H;return(a=a.src)?a.duration:0}var D=p("__config"),y=p("__print"),C=p("__time"),v=p("__tsr"),f=p("__util"),m=p("__vec3"),h=D.p,x=D.H;a.dt=10;a.To=20;a.bt=30;var L=new Float32Array(3),P=new Float32Array(3),A=new Float32Array(3),w=[],I=[],T=null,O=null,B=[],G=[1],M=null;a.oC=function(){return{Jg:-1,qf:"",behavior:"NONE",oh:!1,muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,iu:360,ju:360,ku:1,cyclic:!1,loop:!1,delay:0,
zu:0,li:0,wj:0,sh:0,kd:0,Ad:0,Dr:0,zp:0,duration:0,dm:0,lp:1,src:null,state:10,ar:new Float32Array(3),direction:new Float32Array(3),rs:new Float32Array(3),pp:-1,qp:-1,qh:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(w.push("ogg"),w.push("ogv")),""!=a.canPlayType("audio/mpeg")&&w.push("mp3"),""!=a.canPlayType("audio/mp4")&&(w.push("mp4"),w.push("m4v")),""!=a.canPlayType("audio/webm")&&w.push("webm"));b.canPlayType&&
(""!=b.canPlayType("video/ogg")&&I.push("ogv"),""!=b.canPlayType("video/mp4")&&I.push("m4v"),""!=b.canPlayType("video/webm")&&I.push("webm"));(T=x.Xs?d():null)&&y.log("%cINIT WEBAUDIO: "+T.sampleRate+"Hz","color: #00a")};a.Gt=function(a){var b={Dh:new Float32Array(3),Zv:new Float32Array(3),hj:new Float32Array(3)};a.ya=b;if(T){var c=T.createGain(),d=T.createGain();b.Oi=c;b.rh=d;c.connect(d);d.connect(T.destination);if(a.b4w_enable_dynamic_compressor){var d=T.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;
d.threshold.value=f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Dk=d;b.Pc=d}else b.Dk=null,b.Pc=c;c=T.listener;b.oh=h.gq;b.oh||(c.dopplerFactor=a.audio_doppler_factor,c.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.qh=0}};a.GG=function(a){O=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<w.indexOf(a)?a:"ogg"==a&&-1<w.indexOf("mp4")?"mp4":"mp3"==a&&-1<w.indexOf("ogg")?"ogg":"mp4"==a&&-1<w.indexOf("ogg")?
"ogg":"ogv"==a&&-1<w.indexOf("m4v")?"m4v":"webm"==a&&-1<w.indexOf("m4v")?"m4v":"m4v"==a&&-1<w.indexOf("webm")?"webm":""};a.detect_video_container=function(a){a||(a="webm");return-1<I.indexOf(a)?a:"ogv"==a&&-1<I.indexOf("m4v")?"m4v":"webm"==a&&-1<I.indexOf("m4v")?"m4v":"m4v"==a&&-1<I.indexOf("webm")?"webm":""};a.Ig=function(a,b){var c=a.data,d=b.H;d.Jg=a.data.sound.uuid;d.qf=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=T?c.b4w_behavior:"NONE";break;
case "BACKGROUND_MUSIC":var f;T?(window.MediaElementAudioSourceNode?f=!0:(y.warn("MediaElementAudioSourceNode not found"),f=!1),f=f?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";d.behavior=f;break;default:throw"Wrong speaker behavior";}c.sound||(d.behavior="NONE");d.oh=c.b4w_disable_doppler||h.gq;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.iu=c.cone_angle_inner;d.ju=c.cone_angle_outer;d.ku=c.cone_volume_outer;
d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.delay=c.b4w_delay;d.zu=c.b4w_delay_random;d.li=c.b4w_volume_random;d.wj=c.b4w_pitch_random;d.sh=c.b4w_fade_in;d.kd=c.b4w_fade_out;B.push(b)};a.yx=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.H.behavior){case "POSITIONAL":return a.To;case "BACKGROUND_SOUND":return a.To;case "BACKGROUND_MUSIC":return a.bt;case "NONE":return a.dt;default:throw"Wrong speaker behavior";}};a.DI=function(a,b){var c=a.H;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=
b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.Hw=function(){var a=T.createBufferSource();a.buffer=T.createBuffer(1,22050,22050);a.connect(T.destination);a.start(0)};a.JC=function(a,b,c){T?T.decodeAudioData(a,b,c):c()};a.xH=function(a){t(a);a.H=null;B.splice(B.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<B.length;a++){var b=B[a].H;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.Rb&&b.Rb.disconnect()}O&&O.ya&&(a=O.ya,a.Dh[0]=0,a.Dh[1]=0,a.Dh[2]=0,a.hj[0]=0,a.hj[1]=
0,a.hj[2]=0);O=null;B.splice(0);M=null};a.update=function(a){if(T&&0!=B.length){for(var b=0;b<B.length;b++){var c=B[b],d=c.H,e=d.Rb,g=T.currentTime;!d.loop&&20==d.state&&d.duration&&d.Ad+d.duration<g&&("BACKGROUND_MUSIC"==d.behavior||e&&!f.nd(e.onended))&&(d.state=50);d.cyclic&&50==d.state&&n(c);20==d.state&&3>d.dm-g&&q(d)}M&&M.Hf.length&&(-1==M.Bb||a>M.yt+M.Eu[M.Bb])&&(b=M,-1<b.Bb&&t(b.Hf[b.Bb]),-1==b.Bb&&b.random?c=Math.round(Math.random()*(b.Hf.length-1)):b.random?(c=1+Math.round(Math.random()*
(b.Hf.length-2)),c=(b.Bb+c)%b.Hf.length):c=(b.Bb+1)%b.Hf.length,n(b.Hf[c]),b.Bb=c,b.yt=a)}};a.play=b;a.play_def=n;a.stop=t;a.is_playing=function(a){return 20==a.H.state};a.wH=e;a.yH=H;a.playrate=function(a,b){var c=a.H;c.pitch=b;!r(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Rb.playbackRate.value=b,g(c),q(c))};a.get_playrate=function(a){return a.H.pitch};a.cyclic=function(a,b){a.H.cyclic=Boolean(b)};a.is_cyclic=function(a){return a.H.cyclic};a.kF=function(a,b,c,d){if(T&&a.ya){var e=
L;e[0]=0;e[1]=-1;e[2]=0;m.transformQuat(e,c,e);P[0]=0;P[1]=0;P[2]=-1;m.transformQuat(P,c,P);c=T.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],P[0],P[1],P[2]);m.copy(e,a.ya.Zv);!a.ya.oh&&d&&(A[0]=(b[0]-a.ya.Dh[0])/d,A[1]=(b[1]-a.ya.Dh[1])/d,A[2]=(b[2]-a.ya.Dh[2])/d,f.smooth_v(A,a.ya.hj,d,.3,A),c.setVelocity(A[0],A[1],A[2]),m.copy(A,a.ya.hj));m.copy(b,a.ya.Dh)}};a.listener_reset_speed=function(a,b){if(T&&O.ya&&!O.ya.oh){var c=L;b?m.copy(b,c):m.copy(O.ya.Zv,c);m.scale(c,a,c);
T.listener.setVelocity(c[0],c[1],c[2]);m.copy(c,O.ya.hj)}};a.zH=function(a,b){var c=a.H;if(r(a)&&"POSITIONAL"==c.behavior){var d=v.get_trans_view(a.g.i),e=v.get_quat_view(a.g.i),g=c.tl;g.setPosition(d[0],d[1],d[2]);var h=L;f.quat_to_dir(e,f.AXIS_MY,h);g.setOrientation(h[0],h[1],h[2]);e=c.ar;!c.oh&&b&&(P[0]=(d[0]-e[0])/b,P[1]=(d[1]-e[1])/b,P[2]=(d[2]-e[2])/b,f.smooth_v(P,c.rs,b,.3,P),g.setVelocity(P[0],P[1],P[2]),m.copy(P,c.rs));m.copy(d,e)}};a.speaker_reset_speed=function(a,b,c){var d=a.H;if(r(a)&&
"POSITIONAL"==d.behavior&&!d.oh){var f=L;c?m.copy(c,f):m.copy(d.direction,f);m.scale(f,b,f);d.tl.setVelocity(f[0],f[1],f[2]);m.copy(f,d.rs);a=v.get_trans_view(a.g.i);m.copy(a,d.ar)}};a.Gq=function(a){return a.H.behavior};a.check_active_speakers=function(){for(var a=0;a<B.length;a++)if(r(B[a]))return!0;return!1};a.YG=function(a){var b=O.ya;b&&(b.volume=a,T&&(b.Oi.gain.value=u(b)))};a.jE=function(){var a=O.ya;return a?a.volume:0};a.set_volume=function(a,b){var c=a.H;c.volume=b;r(a)&&(c.Oi.gain.value=
u(c))};a.get_volume=function(a){return a.H.volume};a.mute=function(a,b){a.H.muted=Boolean(b);r(a)&&(a.H.Oi.gain.value=u(a.H))};a.is_muted=function(a){return a.H.muted};a.KF=function(a){var b=O.ya;b&&(b.muted=Boolean(a),T&&(b.Oi.gain.value=u(b)))};a.PE=function(){var a=O.ya;return a?a.muted:!1};a.get_speaker_objects=function(){return B};a.pause=function(){for(var a=0;a<B.length;a++)e(B[a])};a.resume=function(){for(var a=0;a<B.length;a++)H(B[a])};a.set_compressor_params=function(a,b){if(a.ya&&a.ya.Dk){var c=
a.ya.Dk;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.ya||!a.ya.Dk)return null;a=a.ya.Dk;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(r(a)){a=a.H;var d=a.rh,f=T.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(b,f+c);a.qh=c}};a.unduck=function(a){if(r(a)){a=
a.H;var b=a.rh,c=T.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.qh);a.qh=0}};a.UC=function(a,b){if(T){var c=O.ya,d=c.rh,f=T.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(a,f+b);c.qh=b}};a.$H=function(){if(T){var a=O.ya,b=a.rh,c=T.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.qh);a.qh=0}};a.apply_playlist=function(a,b,c){M={Bb:-1,yt:0,random:c,Hf:[],Eu:[]};for(c=0;c<a.length;c++){var d=
a[c],f=z(d);0==f?y.warn("Ignoring speaker with zero duration: "+d.name):(t(d),d.H.cyclic=!1,M.Hf.push(d),M.Eu.push(f+b))}};a.get_duration=z;a.clear_playlist=function(){if(M)for(var a=M.Hf,b=0;b<a.length;b++)t(a[b]);M=null};a.get_positional_params=function(a){return(a=a.H)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.H;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=
b.attenuation;var d=c.tl;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.H;c&&c.Je&&(c.Je.frequency.value=b.freq,c.Je.Q.value=b.Q,c.Je.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.H)&&a.Je?{freq:a.Je.frequency.value,Q:a.Je.Q.value,gain:a.Je.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.H;if(!a||!a.Je)return null;a.Je.getFrequencyResponse(b,c,d)}};b4w.module.__vec3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new p(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var c=new p(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.fromValues=function(a,c,d){var g=new p(3);g[0]=a;g[1]=c;g[2]=d;return g};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.set=function(a,c,d,g){g[0]=a;g[1]=c;g[2]=d;return g};a.add=function(a,c,d){d[0]=a[0]+c[0];d[1]=a[1]+c[1];d[2]=a[2]+c[2];
return d};a.subtract=function(a,c,d){d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];return d};a.sub=a.subtract;a.multiply=function(a,c,d){d[0]=a[0]*c[0];d[1]=a[1]*c[1];d[2]=a[2]*c[2];return d};a.mul=a.multiply;a.divide=function(a,c,d){d[0]=a[0]/c[0];d[1]=a[1]/c[1];d[2]=a[2]/c[2];return d};a.div=a.divide;a.min=function(a,c,d){d[0]=Math.min(a[0],c[0]);d[1]=Math.min(a[1],c[1]);d[2]=Math.min(a[2],c[2]);return d};a.max=function(a,c,d){d[0]=Math.max(a[0],c[0]);d[1]=Math.max(a[1],c[1]);d[2]=Math.max(a[2],
c[2]);return d};a.scale=function(a,c,d){d[0]=a[0]*c;d[1]=a[1]*c;d[2]=a[2]*c;return d};a.scaleAndAdd=function(a,c,d,g){g[0]=a[0]+c[0]*d;g[1]=a[1]+c[1]*d;g[2]=a[2]+c[2]*d;return g};a.distance=function(a,c){var d=c[0]-a[0],g=c[1]-a[1],q=c[2]-a[2];return Math.sqrt(d*d+g*g+q*q)};a.dist=a.distance;a.squaredDistance=function(a,c){var d=c[0]-a[0],g=c[1]-a[1],q=c[2]-a[2];return d*d+g*g+q*q};a.sqrDist=a.squaredDistance;a.length=function(a){var c=a[0],d=a[1];a=a[2];return Math.sqrt(c*c+d*d+a*a)};a.len=a.length;
a.squaredLength=function(a){var c=a[0],d=a[1];a=a[2];return c*c+d*d+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,c){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];return c};a.inverse=function(a,c){c[0]=1/a[0];c[1]=1/a[1];c[2]=1/a[2];return c};a.normalize=function(a,c){var d=a[0],g=a[1],q=a[2],d=d*d+g*g+q*q;0<d&&(d=1/Math.sqrt(d),c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d);return c};a.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};a.cross=function(a,c,d){var g=a[0],q=a[1];a=a[2];var l=c[0],t=c[1];c=c[2];
d[0]=q*c-a*t;d[1]=a*l-g*c;d[2]=g*t-q*l;return d};a.lerp=function(a,c,d,g){var q=a[0],l=a[1];a=a[2];g[0]=q+d*(c[0]-q);g[1]=l+d*(c[1]-l);g[2]=a+d*(c[2]-a);return g};a.random=function(a,c){a=a||1;var n=2*d()*Math.PI,g=2*d()-1,q=Math.sqrt(1-g*g)*a;c[0]=Math.cos(n)*q;c[1]=Math.sin(n)*q;c[2]=g*a;return c};a.transformMat4=function(a,c,d){var g=a[0],q=a[1];a=a[2];var l=c[3]*g+c[7]*q+c[11]*a+c[15],l=l||1;d[0]=(c[0]*g+c[4]*q+c[8]*a+c[12])/l;d[1]=(c[1]*g+c[5]*q+c[9]*a+c[13])/l;d[2]=(c[2]*g+c[6]*q+c[10]*a+c[14])/
l;return d};a.transformMat3=function(a,c,d){var g=a[0],q=a[1];a=a[2];d[0]=g*c[0]+q*c[3]+a*c[6];d[1]=g*c[1]+q*c[4]+a*c[7];d[2]=g*c[2]+q*c[5]+a*c[8];return d};a.transformQuat=function(a,c,d){var g=a[0],q=a[1],l=a[2];a=c[0];var t=c[1],e=c[2];c=c[3];var p=c*g+t*l-e*q,k=c*q+e*g-a*l,r=c*l+a*q-t*g,g=-a*g-t*q-e*l;d[0]=p*c+g*-a+k*-e-r*-t;d[1]=k*c+g*-t+r*-a-p*-e;d[2]=r*c+g*-e+p*-t-k*-a;return d};a.rotateX=function(a,c,d,g){var q=[],l=[];q[0]=a[0]-c[0];q[1]=a[1]-c[1];q[2]=a[2]-c[2];l[0]=q[0];l[1]=q[1]*Math.cos(d)-
q[2]*Math.sin(d);l[2]=q[1]*Math.sin(d)+q[2]*Math.cos(d);g[0]=l[0]+c[0];g[1]=l[1]+c[1];g[2]=l[2]+c[2];return g};a.rotateY=function(a,c,d,g){var q=[],l=[];q[0]=a[0]-c[0];q[1]=a[1]-c[1];q[2]=a[2]-c[2];l[0]=q[2]*Math.sin(d)+q[0]*Math.cos(d);l[1]=q[1];l[2]=q[2]*Math.cos(d)-q[0]*Math.sin(d);g[0]=l[0]+c[0];g[1]=l[1]+c[1];g[2]=l[2]+c[2];return g};a.rotateZ=function(a,c,d,g){var q=[],l=[];q[0]=a[0]-c[0];q[1]=a[1]-c[1];q[2]=a[2]-c[2];l[0]=q[0]*Math.cos(d)-q[1]*Math.sin(d);l[1]=q[0]*Math.sin(d)+q[1]*Math.cos(d);
l[2]=q[2];g[0]=l[0]+c[0];g[1]=l[1]+c[1];g[2]=l[2]+c[2];return g};a.forEach=function(){var b=a.create();return function(a,d,g,q,l,t){d||(d=3);g||(g=0);for(q=q?Math.min(q*d+g,a.length):a.length;g<q;g+=d)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],l(b,t,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2];return a}}();a.VJ=function(b,c){var d=a.fromValues(b[0],b[1],b[2]),g=a.fromValues(c[0],c[1],c[2]);a.normalize(d,d);a.normalize(g,g);d=a.dot(d,g);return 1<d?0:Math.acos(d)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+
a[2]+")"};"undefined"!==typeof a&&(a.vec3=a)};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var c=new p(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c};a.fromValues=function(a,c,d,g){var q=new p(4);q[0]=a;q[1]=c;q[2]=d;q[3]=g;return q};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c};a.set=function(a,c,d,g,q){q[0]=a;q[1]=c;q[2]=d;q[3]=g;return q};a.add=function(a,c,d){d[0]=
a[0]+c[0];d[1]=a[1]+c[1];d[2]=a[2]+c[2];d[3]=a[3]+c[3];return d};a.subtract=function(a,c,d){d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];d[3]=a[3]-c[3];return d};a.sub=a.subtract;a.multiply=function(a,c,d){d[0]=a[0]*c[0];d[1]=a[1]*c[1];d[2]=a[2]*c[2];d[3]=a[3]*c[3];return d};a.mul=a.multiply;a.divide=function(a,c,d){d[0]=a[0]/c[0];d[1]=a[1]/c[1];d[2]=a[2]/c[2];d[3]=a[3]/c[3];return d};a.div=a.divide;a.min=function(a,c,d){d[0]=Math.min(a[0],c[0]);d[1]=Math.min(a[1],c[1]);d[2]=Math.min(a[2],c[2]);d[3]=
Math.min(a[3],c[3]);return d};a.max=function(a,c,d){d[0]=Math.max(a[0],c[0]);d[1]=Math.max(a[1],c[1]);d[2]=Math.max(a[2],c[2]);d[3]=Math.max(a[3],c[3]);return d};a.scale=function(a,c,d){d[0]=a[0]*c;d[1]=a[1]*c;d[2]=a[2]*c;d[3]=a[3]*c;return d};a.scaleAndAdd=function(a,c,d,g){g[0]=a[0]+c[0]*d;g[1]=a[1]+c[1]*d;g[2]=a[2]+c[2]*d;g[3]=a[3]+c[3]*d;return g};a.distance=function(a,c){var d=c[0]-a[0],g=c[1]-a[1],q=c[2]-a[2],l=c[3]-a[3];return Math.sqrt(d*d+g*g+q*q+l*l)};a.dist=a.distance;a.squaredDistance=
function(a,c){var d=c[0]-a[0],g=c[1]-a[1],q=c[2]-a[2],l=c[3]-a[3];return d*d+g*g+q*q+l*l};a.sqrDist=a.squaredDistance;a.length=function(a){var c=a[0],d=a[1],g=a[2];a=a[3];return Math.sqrt(c*c+d*d+g*g+a*a)};a.len=a.length;a.squaredLength=function(a){var c=a[0],d=a[1],g=a[2];a=a[3];return c*c+d*d+g*g+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,c){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];c[3]=-a[3];return c};a.inverse=function(a,c){c[0]=1/a[0];c[1]=1/a[1];c[2]=1/a[2];c[3]=1/a[3];return c};a.normalize=
function(a,c){var d=a[0],g=a[1],q=a[2],l=a[3],d=d*d+g*g+q*q+l*l;0<d&&(d=1/Math.sqrt(d),c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d,c[3]=a[3]*d);return c};a.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};a.lerp=function(a,c,d,g){var q=a[0],l=a[1],t=a[2];a=a[3];g[0]=q+d*(c[0]-q);g[1]=l+d*(c[1]-l);g[2]=t+d*(c[2]-t);g[3]=a+d*(c[3]-a);return g};a.random=function(b,c){b=b||1;c[0]=d();c[1]=d();c[2]=d();c[3]=d();a.normalize(c,c);a.scale(c,b,c);return c};a.transformMat4=function(a,c,d){var g=a[0],
q=a[1],l=a[2];a=a[3];d[0]=c[0]*g+c[4]*q+c[8]*l+c[12]*a;d[1]=c[1]*g+c[5]*q+c[9]*l+c[13]*a;d[2]=c[2]*g+c[6]*q+c[10]*l+c[14]*a;d[3]=c[3]*g+c[7]*q+c[11]*l+c[15]*a;return d};a.transformQuat=function(a,c,d){var g=a[0],q=a[1],l=a[2],t=c[0],e=c[1],p=c[2];c=c[3];var k=c*g+e*l-p*q,r=c*q+p*g-t*l,u=c*l+t*q-e*g,g=-t*g-e*q-p*l;d[0]=k*c+g*-t+r*-p-u*-e;d[1]=r*c+g*-e+u*-t-k*-p;d[2]=u*c+g*-p+k*-e-r*-t;d[3]=a[3];return d};a.forEach=function(){var b=a.create();return function(a,d,g,q,l,t){d||(d=4);g||(g=0);for(q=q?Math.min(q*
d+g,a.length):a.length;g<q;g+=d)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],b[3]=a[g+3],l(b,t,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2],a[g+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,p){var d=p("__vec3"),b=p("__vec4"),c=p("__mat3"),n="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new n(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=d.create(),c=d.fromValues(1,0,0),l=d.fromValues(0,1,0);return function(n,e,p){var k=d.dot(n,e);if(-.9999999>k)return d.cross(c,n,b),1E-6>d.length(b)&&d.cross(l,n,b),d.normalize(b,b),a.setAxisAngle(b,Math.PI,p),p;if(.9999999<k)return p[0]=0,p[1]=0,p[2]=0,p[3]=1,p;d.cross(n,
e,b);p[0]=b[0];p[1]=b[1];p[2]=b[2];p[3]=1+k;return a.normalize(p,p)}}();a.setAxes=function(){var b=c.create();return function(c,d,n,e){b[0]=d[0];b[3]=d[1];b[6]=d[2];b[1]=n[0];b[4]=n[1];b[7]=n[2];b[2]=-c[0];b[5]=-c[1];b[8]=-c[2];return a.normalize(a.fromMat3(b,e),e)}}();a.clone=b.clone;a.fromValues=b.fromValues;a.copy=b.copy;a.set=b.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=b.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],n=a[2];a=a[3];var k=b[0],r=b[1],p=b[2];b=b[3];c[0]=d*b+a*k+e*p-n*r;c[1]=e*b+a*r+n*k-d*p;c[2]=n*b+a*p+d*r-e*k;c[3]=a*b-d*k-e*r-n*p;return c};a.mul=a.multiply;a.scale=b.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*k;c[1]=e*b+n*k;c[2]=n*b-e*k;c[3]=a*b-d*k;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=d*
b-n*k;c[1]=e*b+a*k;c[2]=n*b+d*k;c[3]=a*b-e*k;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*k;c[1]=e*b-d*k;c[2]=n*b+a*k;c[3]=a*b-n*k;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];b[0]=c;b[1]=d;b[2]=e;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};a.dot=b.dot;a.lerp=b.lerp;a.slerp=function(a,b,c,d){var e=a[0],n=a[1],k=a[2];a=a[3];var r=b[0],p=b[1],z=b[2];b=b[3];var D,y,C;y=e*r+n*p+k*z+a*b;0>y&&(y=-y,r=-r,p=-p,
z=-z,b=-b);1E-6<1-y?(D=Math.acos(y),C=Math.sin(D),y=Math.sin((1-c)*D)/C,c=Math.sin(c*D)/C):y=1-c;d[0]=y*e+c*r;d[1]=y*n+c*p;d[2]=y*k+c*z;d[3]=y*a+c*b;return d};a.invert=function(a,b){var c=a[0],d=a[1],e=a[2],n=a[3],k=c*c+d*d+e*e+n*n,k=k?1/k:0;b[0]=-c*k;b[1]=-d*k;b[2]=-e*k;b[3]=n*k;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=b.length;a.len=a.length;a.squaredLength=b.squaredLength;a.sqrLen=a.squaredLength;a.normalize=b.normalize;a.fromMat3=function(a,
b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var e=(d+1)%3,n=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*e+e]-a[3*n+n]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*e+n]-a[3*n+e])*c;b[e]=(a[3*e+d]+a[3*d+e])*c;b[n]=(a[3*n+d]+a[3*d+n])*c}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};a.clone=function(a){var b=new p(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,b){if(b===a){var c=a[1],n=a[2],g=a[5];b[1]=a[3];b[2]=a[6];b[3]=c;b[5]=a[7];b[6]=n;b[7]=g}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b};a.invert=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=a[4],t=a[5],e=a[6],p=a[7],k=a[8],r=k*l-t*p,u=-k*q+t*e,z=
p*q-l*e,D=c*r+n*u+g*z;if(!D)return null;D=1/D;b[0]=r*D;b[1]=(-k*n+g*p)*D;b[2]=(t*n-g*l)*D;b[3]=u*D;b[4]=(k*c-g*e)*D;b[5]=(-t*c+g*q)*D;b[6]=z*D;b[7]=(-p*c+n*e)*D;b[8]=(l*c-n*q)*D;return b};a.adjoint=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=a[4],t=a[5],e=a[6],p=a[7],k=a[8];b[0]=l*k-t*p;b[1]=g*p-n*k;b[2]=n*t-g*l;b[3]=t*e-q*k;b[4]=c*k-g*e;b[5]=g*q-c*t;b[6]=q*p-l*e;b[7]=n*e-c*p;b[8]=c*l-n*q;return b};a.determinant=function(a){var b=a[3],c=a[4],n=a[5],g=a[6],q=a[7],l=a[8];return a[0]*(l*c-n*q)+a[1]*
(-l*b+n*g)+a[2]*(q*b-c*g)};a.multiply=function(a,b,c){var n=a[0],g=a[1],q=a[2],l=a[3],t=a[4],e=a[5],p=a[6],k=a[7];a=a[8];var r=b[0],u=b[1],z=b[2],D=b[3],y=b[4],C=b[5],v=b[6],f=b[7];b=b[8];c[0]=r*n+u*l+z*p;c[1]=r*g+u*t+z*k;c[2]=r*q+u*e+z*a;c[3]=D*n+y*l+C*p;c[4]=D*g+y*t+C*k;c[5]=D*q+y*e+C*a;c[6]=v*n+f*l+b*p;c[7]=v*g+f*t+b*k;c[8]=v*q+f*e+b*a;return c};a.mul=a.multiply;a.translate=function(a,b,c){var n=a[0],g=a[1],q=a[2],l=a[3],t=a[4],e=a[5],p=a[6],k=a[7];a=a[8];var r=b[0];b=b[1];c[0]=n;c[1]=g;c[2]=q;
c[3]=l;c[4]=t;c[5]=e;c[6]=r*n+b*l+p;c[7]=r*g+b*t+k;c[8]=r*q+b*e+a;return c};a.rotate=function(a,b,c){var n=a[0],g=a[1],q=a[2],l=a[3],t=a[4],e=a[5],p=a[6],k=a[7];a=a[8];var r=Math.sin(b);b=Math.cos(b);c[0]=b*n+r*l;c[1]=b*g+r*t;c[2]=b*q+r*e;c[3]=b*l-r*n;c[4]=b*t-r*g;c[5]=b*e-r*q;c[6]=p;c[7]=k;c[8]=a;return c};a.scale=function(a,b,c){var n=b[0];b=b[1];c[0]=n*a[0];c[1]=n*a[1];c[2]=n*a[2];c[3]=b*a[3];c[4]=b*a[4];c[5]=b*a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.AD=function(a,b){b[0]=1;b[1]=0;b[2]=
0;b[3]=0;b[4]=1;b[5]=0;b[6]=a[0];b[7]=a[1];b[8]=1;return b};a.yD=function(a,b){var c=Math.sin(a),n=Math.cos(a);b[0]=n;b[1]=c;b[2]=0;b[3]=-c;b[4]=n;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.zD=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=a[1];b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.fromMat2d=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=0;b[3]=a[2];b[4]=a[3];b[5]=0;b[6]=a[4];b[7]=a[5];b[8]=1;return b};a.fromQuat=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=c+c,t=n+n,e=g+g,c=c*l,p=n*l,n=n*t,k=g*l,r=
g*t,g=g*e,l=q*l,t=q*t,q=q*e;b[0]=1-n-g;b[3]=p-q;b[6]=k+t;b[1]=p+q;b[4]=1-c-g;b[7]=r-l;b[2]=k-t;b[5]=r+l;b[8]=1-c-n;return b};a.normalFromMat4=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=a[4],t=a[5],e=a[6],p=a[7],k=a[8],r=a[9],u=a[10],z=a[11],D=a[12],y=a[13],C=a[14],v=a[15],f=c*t-n*l,m=c*e-g*l,h=c*p-q*l,x=n*e-g*t,L=n*p-q*t,P=g*p-q*e,A=k*y-r*D,w=k*C-u*D,k=k*v-z*D,I=r*C-u*y,r=r*v-z*y,u=u*v-z*C,z=f*u-m*r+h*I+x*k-L*w+P*A;if(!z)return null;z=1/z;b[0]=(t*u-e*r+p*I)*z;b[1]=(e*k-l*u-p*w)*z;b[2]=(l*r-t*
k+p*A)*z;b[3]=(g*r-n*u-q*I)*z;b[4]=(c*u-g*k+q*w)*z;b[5]=(n*k-c*r-q*A)*z;b[6]=(y*P-C*L+v*x)*z;b[7]=(C*h-D*P-v*m)*z;b[8]=(D*L-y*h+v*f)*z;return b};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.xD=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var b=new p(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.copy=function(a,b){b[0]=a[0];
b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,b){if(b===a){var c=a[1],n=a[2],g=a[3],q=a[6],l=a[7],t=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=n;b[9]=q;b[11]=a[14];b[12]=g;b[13]=
l;b[14]=t}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};a.invert=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=a[4],t=a[5],e=a[6],p=a[7],k=a[8],r=a[9],u=a[10],z=a[11],D=a[12],y=a[13],C=a[14],v=a[15],f=c*t-n*l,m=c*e-g*l,h=c*p-q*l,x=n*e-g*t,L=n*p-q*t,P=g*p-q*e,A=k*y-r*D,w=k*C-u*D,I=k*v-z*D,T=r*C-u*y,O=r*v-z*y,B=u*v-z*C,G=f*B-m*O+h*T+x*I-L*w+P*A;if(!G)return null;
G=1/G;b[0]=(t*B-e*O+p*T)*G;b[1]=(g*O-n*B-q*T)*G;b[2]=(y*P-C*L+v*x)*G;b[3]=(u*L-r*P-z*x)*G;b[4]=(e*I-l*B-p*w)*G;b[5]=(c*B-g*I+q*w)*G;b[6]=(C*h-D*P-v*m)*G;b[7]=(k*P-u*h+z*m)*G;b[8]=(l*O-t*I+p*A)*G;b[9]=(n*I-c*O-q*A)*G;b[10]=(D*L-y*h+v*f)*G;b[11]=(r*h-k*L-z*f)*G;b[12]=(t*w-l*T-e*A)*G;b[13]=(c*T-n*w+g*A)*G;b[14]=(y*m-D*x-C*f)*G;b[15]=(k*x-r*m+u*f)*G;return b};a.adjoint=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=a[4],t=a[5],e=a[6],p=a[7],k=a[8],r=a[9],u=a[10],z=a[11],D=a[12],y=a[13],C=a[14],v=a[15];
b[0]=t*(u*v-z*C)-r*(e*v-p*C)+y*(e*z-p*u);b[1]=-(n*(u*v-z*C)-r*(g*v-q*C)+y*(g*z-q*u));b[2]=n*(e*v-p*C)-t*(g*v-q*C)+y*(g*p-q*e);b[3]=-(n*(e*z-p*u)-t*(g*z-q*u)+r*(g*p-q*e));b[4]=-(l*(u*v-z*C)-k*(e*v-p*C)+D*(e*z-p*u));b[5]=c*(u*v-z*C)-k*(g*v-q*C)+D*(g*z-q*u);b[6]=-(c*(e*v-p*C)-l*(g*v-q*C)+D*(g*p-q*e));b[7]=c*(e*z-p*u)-l*(g*z-q*u)+k*(g*p-q*e);b[8]=l*(r*v-z*y)-k*(t*v-p*y)+D*(t*z-p*r);b[9]=-(c*(r*v-z*y)-k*(n*v-q*y)+D*(n*z-q*r));b[10]=c*(t*v-p*y)-l*(n*v-q*y)+D*(n*p-q*t);b[11]=-(c*(t*z-p*r)-l*(n*z-q*r)+k*
(n*p-q*t));b[12]=-(l*(r*C-u*y)-k*(t*C-e*y)+D*(t*u-e*r));b[13]=c*(r*C-u*y)-k*(n*C-g*y)+D*(n*u-g*r);b[14]=-(c*(t*C-e*y)-l*(n*C-g*y)+D*(n*e-g*t));b[15]=c*(t*u-e*r)-l*(n*u-g*r)+k*(n*e-g*t);return b};a.determinant=function(a){var b=a[0],c=a[1],n=a[2],g=a[3],q=a[4],l=a[5],t=a[6],e=a[7],p=a[8],k=a[9],r=a[10],u=a[11],z=a[12],D=a[13],y=a[14];a=a[15];return(b*l-c*q)*(r*a-u*y)-(b*t-n*q)*(k*a-u*D)+(b*e-g*q)*(k*y-r*D)+(c*t-n*l)*(p*a-u*z)-(c*e-g*l)*(p*y-r*z)+(n*e-g*t)*(p*D-k*z)};a.multiply=function(a,b,c){var n=
a[0],g=a[1],q=a[2],l=a[3],t=a[4],e=a[5],p=a[6],k=a[7],r=a[8],u=a[9],z=a[10],D=a[11],y=a[12],C=a[13],v=a[14];a=a[15];var f=b[0],m=b[1],h=b[2],x=b[3];c[0]=f*n+m*t+h*r+x*y;c[1]=f*g+m*e+h*u+x*C;c[2]=f*q+m*p+h*z+x*v;c[3]=f*l+m*k+h*D+x*a;f=b[4];m=b[5];h=b[6];x=b[7];c[4]=f*n+m*t+h*r+x*y;c[5]=f*g+m*e+h*u+x*C;c[6]=f*q+m*p+h*z+x*v;c[7]=f*l+m*k+h*D+x*a;f=b[8];m=b[9];h=b[10];x=b[11];c[8]=f*n+m*t+h*r+x*y;c[9]=f*g+m*e+h*u+x*C;c[10]=f*q+m*p+h*z+x*v;c[11]=f*l+m*k+h*D+x*a;f=b[12];m=b[13];h=b[14];x=b[15];c[12]=f*n+
m*t+h*r+x*y;c[13]=f*g+m*e+h*u+x*C;c[14]=f*q+m*p+h*z+x*v;c[15]=f*l+m*k+h*D+x*a;return c};a.mul=a.multiply;a.translate=function(a,b,c){var n=b[0],g=b[1];b=b[2];var q,l,t,e,p,k,r,u,z,D,y,C;a===c?(c[12]=a[0]*n+a[4]*g+a[8]*b+a[12],c[13]=a[1]*n+a[5]*g+a[9]*b+a[13],c[14]=a[2]*n+a[6]*g+a[10]*b+a[14],c[15]=a[3]*n+a[7]*g+a[11]*b+a[15]):(q=a[0],l=a[1],t=a[2],e=a[3],p=a[4],k=a[5],r=a[6],u=a[7],z=a[8],D=a[9],y=a[10],C=a[11],c[0]=q,c[1]=l,c[2]=t,c[3]=e,c[4]=p,c[5]=k,c[6]=r,c[7]=u,c[8]=z,c[9]=D,c[10]=y,c[11]=C,
c[12]=q*n+p*g+z*b+a[12],c[13]=l*n+k*g+D*b+a[13],c[14]=t*n+r*g+y*b+a[14],c[15]=e*n+u*g+C*b+a[15]);return c};a.scale=function(a,b,c){var n=b[0],g=b[1];b=b[2];c[0]=a[0]*n;c[1]=a[1]*n;c[2]=a[2]*n;c[3]=a[3]*n;c[4]=a[4]*g;c[5]=a[5]*g;c[6]=a[6]*g;c[7]=a[7]*g;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.rotate=function(a,b,c,n){var g=c[0],q=c[1];c=c[2];var l=Math.sqrt(g*g+q*q+c*c),t,e,p,k,r,u,z,D,y,C,v,f,m,h,x,L,P,A,w,I;if(1E-7>Math.abs(l))return null;
l=1/l;g*=l;q*=l;c*=l;t=Math.sin(b);e=Math.cos(b);p=1-e;b=a[0];l=a[1];k=a[2];r=a[3];u=a[4];z=a[5];D=a[6];y=a[7];C=a[8];v=a[9];f=a[10];m=a[11];h=g*g*p+e;x=q*g*p+c*t;L=c*g*p-q*t;P=g*q*p-c*t;A=q*q*p+e;w=c*q*p+g*t;I=g*c*p+q*t;g=q*c*p-g*t;q=c*c*p+e;n[0]=b*h+u*x+C*L;n[1]=l*h+z*x+v*L;n[2]=k*h+D*x+f*L;n[3]=r*h+y*x+m*L;n[4]=b*P+u*A+C*w;n[5]=l*P+z*A+v*w;n[6]=k*P+D*A+f*w;n[7]=r*P+y*A+m*w;n[8]=b*I+u*g+C*q;n[9]=l*I+z*g+v*q;n[10]=k*I+D*g+f*q;n[11]=r*I+y*g+m*q;a!==n&&(n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15]);
return n};a.rotateX=function(a,b,c){var n=Math.sin(b);b=Math.cos(b);var g=a[4],q=a[5],l=a[6],t=a[7],e=a[8],p=a[9],k=a[10],r=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=g*b+e*n;c[5]=q*b+p*n;c[6]=l*b+k*n;c[7]=t*b+r*n;c[8]=e*b-g*n;c[9]=p*b-q*n;c[10]=k*b-l*n;c[11]=r*b-t*n;return c};a.rotateY=function(a,b,c){var n=Math.sin(b);b=Math.cos(b);var g=a[0],q=a[1],l=a[2],t=a[3],e=a[8],p=a[9],k=a[10],r=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],
c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*b-e*n;c[1]=q*b-p*n;c[2]=l*b-k*n;c[3]=t*b-r*n;c[8]=g*n+e*b;c[9]=q*n+p*b;c[10]=l*n+k*b;c[11]=t*n+r*b;return c};a.rotateZ=function(a,b,c){var n=Math.sin(b);b=Math.cos(b);var g=a[0],q=a[1],l=a[2],t=a[3],e=a[4],p=a[5],k=a[6],r=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*b+e*n;c[1]=q*b+p*n;c[2]=l*b+k*n;c[3]=t*b+r*n;c[4]=e*b-g*n;c[5]=p*b-q*n;c[6]=k*b-l*n;c[7]=r*b-t*n;return c};
a.AD=function(a,b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};a.zD=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.yD=function(a,b,c){var n=b[0],g=b[1];b=b[2];var q=Math.sqrt(n*n+g*g+b*b),l;if(1E-7>Math.abs(q))return null;q=1/q;n*=q;g*=q;b*=q;q=Math.sin(a);a=Math.cos(a);l=1-a;c[0]=n*n*l+a;c[1]=g*n*l+b*
q;c[2]=b*n*l-g*q;c[3]=0;c[4]=n*g*l-b*q;c[5]=g*g*l+a;c[6]=b*g*l+n*q;c[7]=0;c[8]=n*b*l+g*q;c[9]=g*b*l-n*q;c[10]=b*b*l+a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.MK=function(a,b){var c=Math.sin(a),n=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=n;b[6]=c;b[7]=0;b[8]=0;b[9]=-c;b[10]=n;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.NK=function(a,b){var c=Math.sin(a),n=Math.cos(a);b[0]=n;b[1]=0;b[2]=-c;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=c;b[9]=0;b[10]=n;b[11]=0;b[12]=0;b[13]=0;
b[14]=0;b[15]=1;return b};a.OK=function(a,b){var c=Math.sin(a),n=Math.cos(a);b[0]=n;b[1]=c;b[2]=0;b[3]=0;b[4]=-c;b[5]=n;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotationTranslation=function(a,b,c){var n=a[0],g=a[1],q=a[2],l=a[3],t=n+n,e=g+g,p=q+q;a=n*t;var k=n*e,n=n*p,r=g*e,g=g*p,q=q*p,t=l*t,e=l*e,l=l*p;c[0]=1-(r+q);c[1]=k+l;c[2]=n-e;c[3]=0;c[4]=k-l;c[5]=1-(a+q);c[6]=g+t;c[7]=0;c[8]=n+e;c[9]=g-t;c[10]=1-(a+r);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];
c[15]=1;return c};a.fromQuat=function(a,b){var c=a[0],n=a[1],g=a[2],q=a[3],l=c+c,t=n+n,e=g+g,c=c*l,p=n*l,n=n*t,k=g*l,r=g*t,g=g*e,l=q*l,t=q*t,q=q*e;b[0]=1-n-g;b[1]=p+q;b[2]=k-t;b[3]=0;b[4]=p-q;b[5]=1-c-g;b[6]=r+l;b[7]=0;b[8]=k+t;b[9]=r-l;b[10]=1-c-n;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.frustum=function(a,b,c,n,g,q,l){var t=1/(b-a),e=1/(n-c),p=1/(g-q);l[0]=2*g*t;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=2*g*e;l[6]=0;l[7]=0;l[8]=(b+a)*t;l[9]=(n+c)*e;l[10]=(q+g)*p;l[11]=-1;l[12]=0;l[13]=0;l[14]=
q*g*2*p;l[15]=0;return l};a.perspective=function(a,b,c,n,g){a=1/Math.tan(a/2);var q=1/(c-n);g[0]=a/b;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=a;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=(n+c)*q;g[11]=-1;g[12]=0;g[13]=0;g[14]=2*n*c*q;g[15]=0;return g};a.OL=function(a,b,c,n){var g=Math.tan(a.upDegrees*Math.PI/180),q=Math.tan(a.downDegrees*Math.PI/180),l=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var t=2/(l+a),e=2/(g+q);n[0]=t;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=e;n[6]=0;n[7]=0;n[8]=-((l-
a)*t*.5);n[9]=(g-q)*e*.5;n[10]=c/(b-c);n[11]=-1;n[12]=0;n[13]=0;n[14]=c*b/(b-c);n[15]=0;return n};a.ortho=function(a,b,c,n,g,q,l){var t=1/(a-b),e=1/(c-n),p=1/(g-q);l[0]=-2*t;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=-2*e;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=2*p;l[11]=0;l[12]=(a+b)*t;l[13]=(n+c)*e;l[14]=(q+g)*p;l[15]=1;return l};a.lookAt=function(d,b,c,n){var g,q,l,t,e,p,k,r,u=d[0],z=d[1];d=d[2];l=c[0];t=c[1];q=c[2];k=b[0];c=b[1];g=b[2];if(1E-7>Math.abs(u-k)&&1E-7>Math.abs(z-c)&&1E-7>Math.abs(d-g))return a.identity(n);
b=u-k;c=z-c;k=d-g;r=1/Math.sqrt(b*b+c*c+k*k);b*=r;c*=r;k*=r;g=t*k-q*c;q=q*b-l*k;l=l*c-t*b;(r=Math.sqrt(g*g+q*q+l*l))?(r=1/r,g*=r,q*=r,l*=r):l=q=g=0;t=c*l-k*q;e=k*g-b*l;p=b*q-c*g;(r=Math.sqrt(t*t+e*e+p*p))?(r=1/r,t*=r,e*=r,p*=r):p=e=t=0;n[0]=g;n[1]=t;n[2]=b;n[3]=0;n[4]=q;n[5]=e;n[6]=c;n[7]=0;n[8]=l;n[9]=p;n[10]=k;n[11]=0;n[12]=-(g*u+q*z+l*d);n[13]=-(t*u+e*z+p*d);n[14]=-(b*u+c*z+k*d);n[15]=1;return n};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+
a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.xD=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function p(a,g){var t=a[0],e=a[1],p=a[2],k=a[3],t=b(t,e,p,k,g[0],7,-680876936),k=b(k,t,e,p,g[1],12,-389564586),p=b(p,k,t,e,g[2],17,606105819),e=b(e,p,k,t,g[3],22,-1044525330),t=b(t,e,p,k,g[4],7,-176418897),k=b(k,t,e,p,g[5],12,1200080426),p=b(p,k,t,e,g[6],17,-1473231341),e=b(e,p,k,t,g[7],22,-45705983),t=b(t,e,p,k,g[8],7,1770035416),k=b(k,t,e,p,g[9],12,-1958414417),p=b(p,k,t,e,g[10],17,-42063),e=b(e,p,k,t,g[11],22,-1990404162),t=b(t,e,p,k,g[12],7,1804603682),k=b(k,t,e,p,
g[13],12,-40341101),p=b(p,k,t,e,g[14],17,-1502002290),e=b(e,p,k,t,g[15],22,1236535329),t=c(t,e,p,k,g[1],5,-165796510),k=c(k,t,e,p,g[6],9,-1069501632),p=c(p,k,t,e,g[11],14,643717713),e=c(e,p,k,t,g[0],20,-373897302),t=c(t,e,p,k,g[5],5,-701558691),k=c(k,t,e,p,g[10],9,38016083),p=c(p,k,t,e,g[15],14,-660478335),e=c(e,p,k,t,g[4],20,-405537848),t=c(t,e,p,k,g[9],5,568446438),k=c(k,t,e,p,g[14],9,-1019803690),p=c(p,k,t,e,g[3],14,-187363961),e=c(e,p,k,t,g[8],20,1163531501),t=c(t,e,p,k,g[13],5,-1444681467),k=
c(k,t,e,p,g[2],9,-51403784),p=c(p,k,t,e,g[7],14,1735328473),e=c(e,p,k,t,g[12],20,-1926607734),t=d(e^p^k,t,e,g[5],4,-378558),k=d(t^e^p,k,t,g[8],11,-2022574463),p=d(k^t^e,p,k,g[11],16,1839030562),e=d(p^k^t,e,p,g[14],23,-35309556),t=d(e^p^k,t,e,g[1],4,-1530992060),k=d(t^e^p,k,t,g[4],11,1272893353),p=d(k^t^e,p,k,g[7],16,-155497632),e=d(p^k^t,e,p,g[10],23,-1094730640),t=d(e^p^k,t,e,g[13],4,681279174),k=d(t^e^p,k,t,g[0],11,-358537222),p=d(k^t^e,p,k,g[3],16,-722521979),e=d(p^k^t,e,p,g[6],23,76029189),t=
d(e^p^k,t,e,g[9],4,-640364487),k=d(t^e^p,k,t,g[12],11,-421815835),p=d(k^t^e,p,k,g[15],16,530742520),e=d(p^k^t,e,p,g[2],23,-995338651),t=n(t,e,p,k,g[0],6,-198630844),k=n(k,t,e,p,g[7],10,1126891415),p=n(p,k,t,e,g[14],15,-1416354905),e=n(e,p,k,t,g[5],21,-57434055),t=n(t,e,p,k,g[12],6,1700485571),k=n(k,t,e,p,g[3],10,-1894986606),p=n(p,k,t,e,g[10],15,-1051523),e=n(e,p,k,t,g[1],21,-2054922799),t=n(t,e,p,k,g[8],6,1873313359),k=n(k,t,e,p,g[15],10,-30611744),p=n(p,k,t,e,g[6],15,-1560198380),e=n(e,p,k,t,g[13],
21,1309151649),t=n(t,e,p,k,g[4],6,-145523070),k=n(k,t,e,p,g[11],10,-1120210379),p=n(p,k,t,e,g[2],15,718787259),e=n(e,p,k,t,g[9],21,-343485551);a[0]=t+a[0]&4294967295;a[1]=e+a[1]&4294967295;a[2]=p+a[2]&4294967295;a[3]=k+a[3]&4294967295}function d(a,b,c,d,g,k){b=(b+a&4294967295)+(d+k&4294967295)&4294967295;return(b<<g|b>>>32-g)+c&4294967295}function b(a,b,c,e,g,k,r){return d(b&c|~b&e,a,b,g,k,r)}function c(a,b,c,e,g,k,r){return d(b&e|c&~e,a,b,g,k,r)}function n(a,b,c,e,g,k,r){return d(c^(b|~e),a,b,g,
k,r)}var g="0123456789abcdef".split("");a.wv=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){for(var n=b.substring(d-64,d),k=[],r=void 0,r=0;64>r;r+=4)k[r>>2]=n.charCodeAt(r)+(n.charCodeAt(r+1)<<8)+(n.charCodeAt(r+2)<<16)+(n.charCodeAt(r+3)<<24);p(a,k)}b=b.substring(d-64);n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)n[d>>2]|=b.charCodeAt(d)<<(d%4<<3);n[d>>2]|=128<<(d%4<<3);if(55<d)for(p(a,n),d=0;16>d;d++)n[d]=0;n[14]=8*
c;p(a,n);for(b=0;b<a.length;b++){c=a[b];d="";for(n=0;4>n;n++)d+=g[c>>8*n+4&15]+g[c>>8*n&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",b:[{type:"var",name:"ANCHOR_NUM",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",
a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"std_enums.glsl"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"color_util.glslf"},
{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["USE_OUTLINE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_color_id",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],
group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",
"ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"varying vec4 bI ; varying vec4 bJ ; varying vec4 bK ; varying vec4 bL ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 qN ; float qO , qP ; vec4 qQ ; vec3 qR , qS , qT , qU ;".split(" ")},
{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"qR = u_camera_eye_frag - bC ; qR = normalize ( qR ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"qN = O ( u_view_tsr_frag ) ; qM ( qR , qN , qS , qT , qU , qQ , qO ) ;".split(" ")}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"qM ( qR , mat4 ( 0.0 ) , qS , qT , qU , qQ , qO ) ;".split(" ")}]}}]},{type:"textline",a:["qO","=","qO",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"qO = ( texture2D ( u_sampler , bM ) ) . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"qP = u_alpha_factor * qO ; qP += ( 1.0 - step ( 0.0 , qP ) ) ; qO = mix ( qP , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"qO = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",a:"if ( qO < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["color_id.glslv"]=
{type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",
b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",
b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute",
"vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",
a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",
b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 tv ; float tw , tx , ty ; vec3 tz , tA , tB , tC , tD , tE ; mat4 tF , tG , tH ; tF = O ( u_view_tsr ) ; tz = a_position ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["tA","=","a_normal",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tB = vec3 ( a_tangent ) ; tC = a_tangent [ 3 ] * cross ( tA , tB ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"tB = vec3 ( 0.0 ) ; tC = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tA = vec3 ( 0.0 ) ; tB = vec3 ( 0.0 ) ; tC = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"tz = mix ( tz , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"tA = mix ( tA , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tD = vec3 ( a_tangent ) ; tE = a_tangent_next [ 3 ] * cross ( a_normal_next , tD ) ; tB = mix ( tB , tD , u_va_frame_factor ) ; tC = mix ( tC , tE , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sB ( tz , tB , tC , tA ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tC","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tC = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tG = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",
b:[{type:"textline",a:"tB = ( tG * vec4 ( tC , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tH = ru ( u_camera_eye , tB , tF , tG ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tH = ro ( u_camera_eye , tB , tF ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tH = tH * rg ( u_wind , u_time , u_jitter_amp , u_jitter_freq , tB ) ;".split(" ")}]}}]},{type:"textline",a:"c tI = rB ( tz - tC , tC , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tH ) ; tI . b = tB ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c tI = rB ( tz , tC , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tG ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tp ( tI . a , tI . b , tA ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tA","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tA = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tp ( tI . a , tI . b , tA ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rE ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = tI . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = tI . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tw = ( dot ( cross ( tI . e , tI . c ) , tI . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( tI . c , tw ) ;".split(" ")}]}}]},{type:"textline",a:"bD = tF * vec4 ( tI . a , 1.0 ) ; tv = u_proj_matrix * bD ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"tv . xy += u_subpixel_jitter * tv . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tw = tv . x ; tx = tv . y ; ty = tv . w ; bG . x = ( tw + ty ) / 2.0 ; bG . y = ( tx + ty ) / 2.0 ; bG . z = ty ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - bD . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tu","(",")",";"]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * tF * vec4 ( tI . a , 1.0 ) ; }".split(" ")}]};a["grass_map.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","tv",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["varying","float","tv",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tv",";"]}]}}]}]}}]},{type:"textline",a:["void","main","(",")","{"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["gl_FragColor","=","tv",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( tv , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , tv ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",a:["}"]}]};a["grass_map.glslv"]={type:"group",b:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","tv",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["varying","float","tv",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tv",";"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec4 tw ; vec3 tx ; mat4 ty , tz , tA ; ty = O ( u_view_tsr ) ; tz = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"tx = ( tz * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; tA = ro ( u_camera_eye , tx , ty ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tA = tA * rg ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"c tB = rB ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tA ) ; tB . b = tx ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c tB = rB ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tz ) ;".split(" ")}]}}]},
{type:"textline",a:"tw = u_proj_matrix * ty * vec4 ( tB . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"tv = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["tv","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",b:[{type:"textline",a:["tv","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",a:["gl_Position","=","tw",";","}"]}]};a["halo.glslf"]={type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 tw ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying float tx ;".split(" ")},
{type:"include",file:"color_util.glslf"},{type:"include",file:"halo_color.glslf"},{type:"textline",a:"void main ( ) { float ud ; vec3 ue ; vec4 uf ; uf = uc ( ) ; ue = uf . rgb ; ud = uf . a ; bu ( ue ) ; bx ( ue , ud ) ; gl_FragColor = vec4 ( ue , ud ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; attribute float a_random_vals ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; varying vec2 bM ; varying float tx ;".split(" ")},
{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","tw",";"]}]}}]},
{type:"textline",a:"void main ( ) { vec4 ud , ue ; vec3 uf ; mat4 ug , uh , ui ; ug = O ( u_view_tsr ) ; uh = O ( u_model_tsr ) ; uf = ( uh * vec4 ( a_position , 1.0 ) ) . xyz ; bM = a_halo_bb_vertex * 2.0 ; tx = a_random_vals ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uh = qT ( uf , ug ) ; ui = ug ; ui [ 3 ] [ 0 ] = 0.0 ; ui [ 3 ] [ 1 ] = 0.0 ; ui [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"uh = qT ( uf , ug ) ;".split(" ")}]}}]},{type:"textline",a:"ud = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; ud = uh * ud ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"ue = u_proj_matrix * ui * ud ; ue . z = 0.99999 * ue . w ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tw","=","ud",
";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"ue = u_proj_matrix * ug * ud ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","ue",";","}"]}]};a["line.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; void main ( ) { float ud ; vec3 ue ; ue = u_diffuse_color . xyz ; ud = u_diffuse_color . a ; bu ( ue ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],
group:{type:"group",b:[{type:"textline",a:"bx ( ue , ud ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( ue , ud ) ; }".split(" ")}]};a["line.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ;".split(" ")},
{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"void main ( ) { mat2 ud ; float ue ; vec2 uf , ug ; vec4 uh ; mat4 ui , uj ; ui = O ( u_view_tsr ) ; uj = O ( u_model_tsr ) ; c uk = rB ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , uj ) ; uh = u_proj_matrix * ui * vec4 ( uk . a , 1.0 ) ; uh . xyz /= uh . w ; uf = ( u_proj_matrix * ui * vec4 ( uk . e , 0.0 ) ) . xy ; ue = M_PI / 2.0 ; ud = mat2 ( cos ( ue ) , sin ( ue ) , - sin ( ue ) , cos ( ue ) ) ; uf = ud * normalize ( uf ) ; ug = ( u_line_width / u_height ) * vec2 ( u_proj_matrix [ 0 ] [ 0 ] / u_proj_matrix [ 1 ] [ 1 ] , 1.0 ) ; gl_Position = vec4 ( uh . xy + uf . xy * ug / 2.0 , uh . z , 1.0 ) ; gl_Position *= uh . w ; }".split(" ")}]};
a["main.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",
name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",
";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3",
"u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",b:[{type:"if",
d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},
{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:4}],group:{type:"group",
b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D",
"u_nodes_texture",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"nodes.glslf"},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 uK ; mat4 uL ; vec4 uM ; vec3 uN , uO , uP , uQ , uR ; float uS , uT , uU ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},
"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"uS = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uT = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uN","=","u_sun_intensity",";"]}]}}]},{type:"textline",a:"uO = normalize ( u_camera_eye_frag - bC ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"uL = O ( u_view_tsr_frag ) ; qM ( uO , uL , uP , uQ , uR , uM , uU ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"qM ( uO , mat4 ( 0.0 ) , uP , uQ , uR , uM , uU ) ;".split(" ")}]}}]},{type:"textline",a:"uP = uP ; uU = uU ; uR = uR ; uM = uM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],
group:{type:"group",b:[{type:"textline",a:"uP = max ( uP - sqrt ( 0.01 * - min ( uT , 0.0 ) ) , 0.5 * uP ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( uP , uT , u_time , uM , uR , u_sun_direction , uN , u_sun_quaternion , bC , uS ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( uU < 0.5 ) discard ; uU = 1.0 ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["uU","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uJ ( uP , length ( bD ) , uO , uT ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uJ ( uP , length ( bD ) , uO , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SSAO_ONLY",
"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uK = texture2DProj ( u_shadow_mask , bG ) . rg ; uT = uK . g ; uP = vec3 ( uT ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","uP",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( uP , uU ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( uP , uU ) ; }".split(" ")}]};
a["main.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",
b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4",
"a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",
a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3",
"a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"uniform mat4 u_view_matrix ; uniform mat3 u_view_tsr ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:["uniform","mat4","u_proj_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",
b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",
b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",
e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4",
"bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uK",";"]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR",
"DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",
{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},
{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 vD , vE ; float vF ; vec3 vG , vH , vI , vJ , vK , vL , vM ; mat4 vN , vO , vP , vQ ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["vN","=","u_view_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",
{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vO = O ( u_view_tsr ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( u_view_tsr ) ;".split(" ")}]}}]},{type:"textline",
a:"vP = O ( u_model_tsr ) ; vG = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["vH","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vH = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vI = vec3 ( a_tangent ) ; vJ = a_tangent [ 3 ] * cross ( vH , vI ) ;".split(" ")}]}},{type:"elif",d:["NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"vK = ( vP * vec4 ( a_position , 1.0 ) ) . xyz ; vL = normalize ( ( vP * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vK = vK - u_camera_eye ; vJ = cross ( vK , vL ) ; vI = cross ( vL , vJ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vI = vec3 ( 0.0 ) ; vJ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"vG = mix ( vG , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"vH = mix ( vH , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:"vL = vec3 ( a_tangent ) ; vK = a_tangent_next [ 3 ] * cross ( a_normal_next , vL ) ; vI = mix ( vI , vL , u_va_frame_factor ) ; vJ = mix ( vJ , vK , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sB ( vG , vI , vJ , vH ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["vK","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vK = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",
a:"c vR = vq ( vG , vI , vJ , vH , vK , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , vN ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"vL = ( vP * vec4 ( vK , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"vQ = ru ( u_camera_eye , vL , vN , vP ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vQ = ro ( u_camera_eye , vL , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vM = ( vP * vec4 ( vK , 1.0 ) ) . xyz ; vQ = vQ * rg ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vM ) ;".split(" ")}]}}]},{type:"textline",a:"c vR = rB ( vG - vK , vK , vI , vJ , vH , vQ ) ; vR . b = vL ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"c vR = rB ( vG , vK , vI , vJ , vH , vP ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vF = ( dot ( cross ( vR . e , vR . c ) , vR . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( vR . c , vF ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tp ( vR . a , vR . b , vH ) ;".split(" ")}]}}]},
{type:"textline",a:"bC = vR . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"bE = vR . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uK = u_camera_eye - vR . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"bM = rE ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uL = vR . f ;".split(" ")}]}},{type:"elif",d:["VERTEX_COLOR"],group:{type:"group",b:[{type:"textline",a:["uL","=","a_color",";"]}]}}]}]}}]},{type:"textline",a:"vD = vN * vec4 ( vR . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",
{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"vE = vO * vec4 ( vR . a , 1.0 ) ; bD = vE ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:["bD","=","vD",";"]}]}}]}]}}]},{type:"textline",a:"vE = u_proj_matrix * vD ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"vE . xy += u_subpixel_jitter * vE . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",
b:[{type:"textline",a:"bG = L ( vE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vC ( vR . a , vR . e ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - vD . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["tu","(",")",";"]}]}}]},{type:"textline",a:["gl_Position","=","vE",";","}"]}]};a["main_stack.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},
{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",
d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",
b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",
e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE",
"SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION",
"sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",a:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"textline",a:"varying vec3 bC ; varying vec3 bE ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"textline",a:["varying","vec3","uK",";"]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["varying","vec3","uL",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",
e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},
{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec4 xI , xJ , xK , xL ; mat4 xM ; mat3 xN ; vec2 xO , xP , xQ , xR ; vec3 xS , xT , xU , xV , xW , xX , xY , xZ , x_ ; float ya , yb , yc , yd , ye ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"ya = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",
b:[{type:"textline",a:"yb = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["xS","=","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["xO","=","bM",";"]}]}}]},{type:"textline",a:"xT = normalize ( bE ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!","gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"xT = xT ; else xT = - xT ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:"xU = cross ( xT , bF . xyz ) * bF . w ; xN = mat3 ( bF . xyz , xU , xT ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"xM = O ( u_view_tsr_frag ) ; xP = normalize ( xM * vec4 ( bE , 0.0 ) ) . st ; xP = xP * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ya < PARALLAX_LOD_DIST ) { yc = clamp ( 0.5 * ( PARALLAX_LOD_DIST - ya ) , 0.0 , 1.0 ) ; yc = u_parallax_scale * yc ; xU = normalize ( uK * xN ) ; yd = 1.0 / PARALLAX_STEPS ; xQ = xU . xy * yc / ( PARALLAX_STEPS * xU . z ) ; yc = 1.0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["xR","=","xP",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["xR","=","xO",";"]}]}}]},{type:"textline",a:"ye = texture2D ( u_normalmap0 , xR ) . a ; for ( float yf = 1.0 ; yf <= PARALLAX_STEPS ; yf ++ ) { if ( ye < yc ) { yc -= yd ; xR -= xQ ; ye = texture2D ( u_normalmap0 , xR ) . a ; } } xQ = xR + xQ ; yd = texture2D ( u_normalmap0 , xQ ) . a - ( yc + yd ) ; yc = ye - yc ; yd = yc / ( yc - yd ) ; xR = yd * xQ + ( 1.0 - yd ) * xR ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"xO += xR - xP ;".split(" ")}]}}]},{type:"textline",a:["xP","=","xR",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"xP += xR - xO ;".split(" ")}]}}]},{type:"textline",a:["xO","=","xR",";"]}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xI = texture2D ( u_normalmap0 , xP ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xI = texture2D ( u_normalmap0 , xO ) ;".split(" ")}]}}]},{type:"textline",a:"xU = xI . rgb - 0.5 ; xU = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , xU , u_normal_factor ) ; xU = xN * xU ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["xU","=","xT",";"]}]}}]},{type:"textline",a:"xU = normalize ( xU ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"xP = normalize ( xM * vec4 ( xU , 0.0 ) ) . st ; xP = xP * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"xT = normalize ( uK ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"xV = uL ; br ( xV ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xI = vec4 ( xV , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["xI","=","u_diffuse_color",";"]}]}}]},{type:"textline",a:["yd","=","1.0",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"xJ = texture2D ( u_colormap0 , xP ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xJ = texture2D ( u_colormap0 , xO ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"br ( xJ . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",b:[{type:"textline",a:[";"]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xK = texture2D ( u_colormap1 , xP ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xK = texture2D ( u_colormap1 , xO ) ;".split(" ")}]}}]},{type:"textline",a:"br ( xK . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"xL = texture2D ( u_stencil0 , xP ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xL = texture2D ( u_stencil0 , xO ) ;".split(" ")}]}}]},{type:"textline",a:"xJ = mix ( xJ , xK , xL . r ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xI . rgb = mix ( xI . rgb , xJ . rgb , u_diffuse_color_factor ) ; yc = u_alpha_factor * xJ . a ; yc += ( 1.0 - step ( 0.0 , yc ) ) ; xI . a = mix ( yc , 1.0 , u_diffuse_color . a ) ; yd = xJ . a ;".split(" ")}]}},
{type:"elif",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xI . rgb *= mix ( vec3 ( 1.0 ) , xJ . rgb , u_diffuse_color_factor ) ; xI . a = xJ . a ; yd = xJ . a ;".split(" ")}]}}]}]}}]},{type:"textline",a:"xV = u_diffuse_intensity * xI . rgb ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS"],group:{type:"group",b:[{type:"textline",a:["xW","=","xV",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xX = u_environment_energy * dS ( xU ) ; xX = u_ambient * xX ; xJ = du ( xV ) ; xY = u_emit * xI . rgb ; xZ = u_specular_color ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_AS_SPEC"],group:{type:"group",b:[{type:"textline",a:"x_ = vec3 ( yd ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"x_ = texture2D ( u_specmap0 , xP ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"x_ = texture2D ( u_specmap0 , xO ) . rgb ;".split(" ")}]}}]},
{type:"textline",a:"br ( x_ . rgb ) ; xZ = mix ( xZ , x_ , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"yd = u_specular_params [ 0 ] ; xO = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; xZ = yd * xZ ; xH ( xY , xX , xV , xZ , bC , xU , xT , xO , u_diffuse_params , xJ , 0.0 , vec4 ( 0.0 ) , xW , x_ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},
{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"dP ( xW , xT , xU , u_reflect_factor , xM ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( xW , xT , xU , u_reflect_factor , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",
b:[{type:"textline",a:"dP ( xW , xT , xU , 0.0 , xM ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( xW , xT , xU , 0.0 , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["xW","+=","x_",";"]}]}}]},{type:"textline",a:"yd = xI . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],group:{type:"group",b:[{type:"textline",a:"xW = max ( xW - sqrt ( 0.01 * - min ( yb , 0.0 ) ) , 0.5 * xW ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( xW , yb , u_time , xJ , xU , u_sun_direction , xS , u_sun_quaternion , bC , ya ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( yd < 0.5 ) discard ; yd = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"yc = max ( max ( x_ . r , x_ . g ) , x_ . b ) * u_specular_alpha ; yd = xI . a * ( 1.0 - yc ) + yc ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yd","=","1.0",
";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"xW = mix ( ef ( bG , xU . xz * u_refr_bump ) , xW , yd ) ; yd = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uJ ( xW , ya , xT , yb ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uJ ( xW , ya , xT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",a:["bu","(","xW",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( xW , yd ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( xW , yd ) ; }".split(" ")}]};a["particle_system.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",
a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",
b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec2",
"bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"textline",a:["varying","vec3","bE",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"include",file:"environment.glslf"},
{type:"include",file:"math.glslv"},{type:"include",file:"particles_nodes.glslf"},{type:"textline",a:"void main ( ) { mat4 Kd ; float Ke , Kf , Kg ; vec4 Kh ; vec3 Ki , Kj , Kk , Kl ; Ki = normalize ( u_camera_eye_frag - bC ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kd = O ( u_view_tsr_frag ) ; Kc ( Ki , Kd , Kj , Kk , Kl , Kh , Ke ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Kc ( Ki , mat4 ( 0.0 ) , Kj , Kk , Kl , Kh , Ke ) ;".split(" ")}]}}]},{type:"textline",a:"Kj = Kj ; Ke = Ke ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( Ke < 0.5 ) discard ; Ke = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Ke","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uJ ( Kj , length ( bD ) , Ki , 1.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Kf = - bD . z / u_view_max_depth ; Kh = texture2DProj ( u_scene_depth , bG ) ; Kg = Z ( Kh ) ; Kf = Kg - Kf ; Kf = u_view_max_depth / SOFT_STRENGTH * Kf ; Ke = Ke * min ( Kf , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","Kj",")",";"]},{type:"condition",
b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( Kj , Ke ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Kj , Ke ) ; }".split(" ")}]};a["particle_system.glslv"]={type:"group",b:[{type:"var",name:"BILLBOARD_ALIGN",a:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",a:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",a:["0"]},{type:"define",name:"BILLBOARD_ALIGN_VIEW",a:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",
a:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",a:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",a:["4"]},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute vec3 a_p_data ; attribute vec4 a_p_vels ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"textline",a:["attribute","vec2","a_p_bb_vertex",";"]},{type:"condition",
b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ;".split(" ")},{type:"condition",
b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_view_matrix",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:"uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["WORLD_SPACE",{type:"logic_negative_expr",e:1},"NODES","HALO_PARTICLES",{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying float Kd ; varying vec3 uL ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO",
"CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",
d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",
a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","tx",";"]}]}}]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"particles.glslv"},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},
{type:"include",file:"particles_nodes.glslv"}]}}]},{type:"textline",a:"float KR ( vec2 KP , vec2 KQ ) { return ( atan ( KQ . y , KQ . x ) - atan ( KP . y , KP . x ) ) ; } void main ( ) { vec3 KS , KT , KU ; vec4 KV , KW , KX ; float KY , KZ , K_ ; mat4 La , Lb ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["La","=","u_view_matrix",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"La = O ( u_view_tsr ) ;".split(" ")}]}}]},
{type:"textline",a:"Ke Lc ; Lc = KG ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { KY = Lc . e ; Lb = qT ( Lc . b , La ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { KY = Lc . e ; Lb = w ( ) ; Lb [ 3 ] = vec4 ( Lc . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { KY = Lc . e ; Lb = A ( radians ( 90.0 ) ) ; Lb [ 3 ] = vec4 ( Lc . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { KY = KR ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + Lc . e ; Lb = y ( radians ( - 90.0 ) ) ; Lb [ 3 ] = vec4 ( Lc . b , 1.0 ) ; } KV = vec4 ( a_p_bb_vertex * 2.0 * Lc . a * u_p_size , 0.0 , 1.0 ) ; KV = Lb * C ( KY ) * KV ; KW = La * KV ; KX = u_proj_matrix * KW ;".split(" ")},
{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"tx = a_p_data [ 2 ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["KS","=","a_normal",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"KT = vec3 ( a_tangent ) ; KU = a_tangent [ 3 ] * cross ( KS , KT ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KT = vec3 ( 0.0 ) ; KU = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"c Ld = rB ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , KT , KU , KS , Lb * C ( KY ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KY = ( dot ( cross ( Ld . e , Ld . c ) , Ld . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Ld . c , KY ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"bE = Ld . e ;".split(" ")}]}}]},{type:"textline",a:"KO ( Lc . b , Lc . f , Lc . g , Lc . h , Lc . a , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex + 0.5 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Kd = Lc . c ; uL = Lc . d ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"KY = KX . x ; KZ = KX . y ; K_ = KX . w ; bG . x = ( KY + K_ ) / 2.0 ; bG . y = ( KZ + K_ ) / 2.0 ; bG . z = K_ ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["bD","=","KW",";"]}]}}]},{type:"textline",a:"gl_Position = KX ; bC = KV . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uK = u_camera_eye - KV . xyz ;".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["particle_system_stack.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},
{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",
{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",
a:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",
b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 uL ; varying float Kd ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uK",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","tx",";"]},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","tw",";"]}]}}]}]}}]},{type:"include",file:"lighting_nodes.glslf"},{type:"condition",b:[{type:"if",
d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"environment.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"include",file:"halo_color.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 KP ; float KQ , KR , KS ; vec4 KT , KU ; vec3 KV , KW , KX , KY , KZ , K_ , La , Lb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KV = normalize ( uK ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"KT = uc ( ) ; KW = KT . rgb ; KQ = 0.9 * length ( bM ) ; KQ = smoothstep ( u_p_alpha_start , u_p_alpha_end , KQ ) ; KQ = KT . a * ( 1.0 - KQ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["KT","=","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"KU = texture2D ( u_sampler , bM ) ; br ( KU . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KT . rgb = mix ( KT . rgb , KU . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KT . rgb *= mix ( vec3 ( 1.0 ) , KU . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"KT . a = KU . a ;".split(" ")}]}}]},{type:"textline",a:"KT . rgb *= uL ; KX = u_diffuse_intensity * KT . rgb ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"KY = u_emit * KT . rgb ; KZ = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logic_negative_expr",e:1},"SKY_COLOR",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"K_ = u_environment_energy * dS ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"K_ = u_environment_energy * dS ( KZ ) ;".split(" ")}]}}]},{type:"textline",a:"K_ = u_ambient * K_ ; KR = u_specular_params [ 0 ] ; KP = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; La = KR * u_specular_color ; xH ( KY , K_ , KX , La , bC , KZ , KV , KP , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , KW , Lb ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["KW","=","KX",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uJ ( KW , length ( bD ) , KV , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"KQ = KT . a * Kd ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uJ ( KW , length ( bD ) , KV , 1.0 ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"KR = - bD . z / u_view_max_depth ; KT = texture2DProj ( u_scene_depth , bG ) ; KS = Z ( KT ) ; KR = KS - KR ; KR = u_view_max_depth / SOFT_STRENGTH * KR ; KQ = KQ * min ( KR , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","KW",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"bx ( KW , KQ ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( KW , KQ ) ; }".split(" ")}]};a["procedural_skydome.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 KP ; const float KQ = 0.99 ; const float KR = 1.8 ; const int KS = 8 ; float KY ( vec3 KT , vec3 KU ) { float KV , KW , KX ; KV = dot ( KU , KU ) ; KW = 2.0 * dot ( KU , KT ) ; KX = dot ( KT , KT ) - 1.0 ; KV = KW * KW - 4.0 * KV * KX ; KV = sqrt ( KV ) ; KV = ( - KW - KV ) / 2.0 ; KV = KX / KV ; return KV ; } float Le ( float KZ , float K_ ) { float La , Lb , Lc , Ld ; La = 3.0 * ( 1.0 - K_ * K_ ) ; Lb = 2.0 * ( 2.0 + K_ * K_ ) ; Lc = 1.0 + KZ * KZ ; Ld = pow ( 1.0 + K_ * K_ - 2.0 * K_ * KZ , 1.5 ) ; Ld = max ( Ld , 0.00001 ) ; return ( La / Lb ) * ( Lc / Ld ) ; } float Lk ( vec3 Lf , vec3 Lg , float Lh ) { vec3 Li ; float Lj ; Lj = dot ( Lg , - Lf ) ; if ( Lj < 0.0 ) { return 1.0 ; } Li = Lf + Lj * Lg ; if ( length ( Li ) < Lh ) { return 0.0 ; } else if ( length ( Li ) >= Lh ) { Li = normalize ( Li ) * Lh - Lf ; Lj = acos ( dot ( normalize ( Li ) , Lg ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( Lj * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 Lo ( float Ll , vec3 Lm , float Ln ) { return Lm - Lm * pow ( u_sky_color , vec3 ( Ln / Ll ) ) ; } void main ( ) { float Lp , Lq , Lr , Ls , Lt , Lu , Lv , Lw , Lx ; vec3 Ly , Lz , LA , LB , LC , LD , LE ; Ly = normalize ( KP ) ; Lz = u_sun_direction ; Lp = dot ( Ly , Lz ) ; Lq = Le ( Lp , - 0.01 ) * u_rayleigh_brightness * Lz . y ; Lr = Le ( Lp - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - Lz . y ) ; Lp = smoothstep ( 0.0 , 100.0 , Le ( Lp , 0.9995 ) ) * u_spot_brightness ; LA = vec3 ( 0.0 , KQ , 0.0 ) ; Ls = KY ( LA , Ly ) ; Lt = Ls / float ( KS ) ; Lu = Lk ( LA , Ly , KQ - 0.3 ) ; LB = vec3 ( 0.0 , 0.0 , 0.0 ) ; LC = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int LF = 0 ; LF < KS ; LF ++ ) { Lv = Lt * float ( LF ) ; LD = LA + Ly * Lv ; Lw = Lk ( LD , Lz , KQ - 0.2 ) ; Lx = KY ( LD , Lz ) ; LE = Lo ( Lx , vec3 ( KR ) , u_scatter_strength ) * Lw ; LB += Lo ( sqrt ( Lv ) , u_sky_color * LE , u_rayleigh_strength ) ; LC += Lo ( Lv , LE , u_mie_strength ) ; } LB = LB * Lu * pow ( Ls , u_rayleigh_collection_power ) / float ( KS ) ; LC = ( LC * Lu * pow ( Ls , u_mie_collection_power ) ) / float ( KS ) ; LB = vec3 ( Lp * LC + Lr * LC + Lq * LB ) ; bu ( LB ) ; gl_FragColor = vec4 ( LB , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 KP ; void main ( ) { vec4 KQ , KR ; KQ = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; KR = u_cube_view_matrix * KQ ; KP = KR . xyz ; gl_Position = KQ ; }".split(" ")}]};a["shadow.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",
a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",
a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"condition",
b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},
{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",
e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",
e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},
"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",
b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 KQ ; float KR , KS ; vec4 KT ; vec3 KU , KV , KW , KX ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"KU = u_camera_eye_frag - bC ; KU = normalize ( KU ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KQ = O ( u_view_tsr_frag ) ; qM ( KU , KQ , KV , KW , KX , KT , KR ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"qM ( KU , mat4 ( 0.0 ) , KV , KW , KX , KT , KR ) ;".split(" ")}]}}]},{type:"textline",a:["KR","=","KR",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"KR = ( texture2D ( u_colormap0 , bM ) ) . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KS = u_alpha_factor * KR ; KS += ( 1.0 - step ( 0.0 , KS ) ) ; KR = mix ( KS , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KR = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",a:"if ( KR < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","NO_SHADOWS",
{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = dr ( bD . z ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor . a *= clamp ( bF . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}"]}]};a["shadow.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",
file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},
"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",
a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1",
"NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},
{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec2 KQ ; vec4 KR , KS ; float KT ; vec3 KU , KV , KW , KX , KY , KZ ; mat4 K_ , La , Lb , Lc ; K_ = O ( u_view_tsr ) ; KU = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["KV","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",
a:"KW = vec3 ( a_tangent ) ; KX = a_tangent [ 3 ] * cross ( KV , KW ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KW = vec3 ( 0.0 ) ; KX = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"KU = mix ( KU , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"KV = mix ( KV , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"KY = vec3 ( a_tangent ) ; KZ = a_tangent_next [ 3 ] * cross ( a_normal_next , KY ) ; KW = mix ( KW , KY , u_va_frame_factor ) ; KX = mix ( KX , KZ , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sB ( KU , KW , KX , KV ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["KX","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KX = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",
a:"c Ld = vq ( KU , vec3 ( 0.0 ) , vec3 ( 0.0 ) , KV , KX , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , K_ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"La = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"KW = ( La * vec4 ( KX , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["HAIR_BILLBOARD",{type:"logic_negative_expr",
e:1},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lb = O ( u_shadow_cast_billboard_view_tsr ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Lb","=","K_",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lc = ru ( u_camera_eye , KW , Lb , La ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lc = ro ( u_camera_eye , KW , Lb ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lc = Lc * rg ( u_wind , u_time , u_jitter_amp , u_jitter_freq , KW ) ;".split(" ")}]}}]},{type:"textline",a:"c Ld = rB ( KU - KX , KX , vec3 ( 0.0 ) , vec3 ( 0.0 ) , KV , Lc ) ; Ld . b = KW ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"c Ld = rB ( KU , KX , vec3 ( 0.0 ) , vec3 ( 0.0 ) , KV , La ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["KV","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tp ( Ld . a , Ld . b , KV ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = Ld . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = Ld . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",
a:"KT = ( dot ( cross ( Ld . e , Ld . c ) , Ld . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Ld . c , KT ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"KR = K_ * vec4 ( Ld . a , 1.0 ) ; KS = u_proj_matrix * KR ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"KS . xy += u_subpixel_jitter * KS . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bG = L ( KS ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - bD . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tu","(",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rE ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vC ( Ld . a , Ld . e ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["bD","=","KR",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KQ = ( u_proj_matrix * K_ [ 3 ] ) . xy ; KT = SHADOW_TEX_RES / 2.0 ; KQ = floor ( KQ * KT + 0.5 ) / KT - KQ ; KS . xy += KQ ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","KS",";","}"]}]};a["special_lens_flares.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"textline",a:"uniform sampler2D u_sampler ; varying vec2 bM ; void main ( ) { vec4 KQ ; KQ = texture2D ( u_sampler , bM ) ; bu ( KQ . rgb ) ; bx ( KQ . rgb , KQ . a ) ; gl_FragColor = KQ ; }".split(" ")}]};a["special_lens_flares.glslv"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"define",name:"LIGHT_INDEX",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 bM ; void main ( ) { vec2 KQ ; float KR ; vec4 KS ; vec3 KT ; mat4 KU ; KU = O ( u_view_tsr ) ; bM = a_texcoord ; KT = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; KS = u_proj_matrix * KU * vec4 ( KT , 0.0 ) ; KS . x /= KS . w ; KS . y /= KS . w ; KS += 99999.0 * step ( KS . z , 0.0 ) ; KS += 100.0 * ( step ( 1.0 , abs ( KS . x ) ) + step ( 1.0 , abs ( KS . y ) ) ) ; KS . x = - a_lf_dist * KS . x ; KS . y = - a_lf_dist * KS . y ; KR = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; KQ = vec2 ( a_lf_bb_vertex . x / KR , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float KV = 1.9 ; KQ *= ( 1.0 + KV * length ( KS . xy ) ) ; } gl_Position = vec4 ( KS . xy + KQ , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"define",name:"INV_PI",a:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",a:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 MU ( vec3 MP , vec3 MQ , float MR , float MS ) { float MT ; MT = MR * MS ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Ld ( MQ , MP , MT ) ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lh ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Ll ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lq ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"return Lv ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LA ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LE ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"return LI ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LM ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LQ ( MP , MQ , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","HUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LW ( MQ , MP , MT ) ;".split(" ")}]}},{type:"elif",
d:["BLENDTYPE","SATURATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mb ( MQ , MP , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","VALUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mh ( MQ , MP , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","COLOR",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mn ( MQ , MP , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"return Ms ( MQ , MP , MT ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mw ( MQ , MP , MT ) ;".split(" ")}]}}]},{type:"textline",a:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Nb ( float MV , float MW , float MX , float MY ) { float MZ ; vec3 M_ , Na ; M_ = vec3 ( MV ) , Na = vec3 ( MW ) ; MZ = MX * MY ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Ld ( Na , M_ , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lh ( M_ , Na , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Ll ( M_ , Na , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"return MC ( MV , MW , MZ , MY ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MI ( MV , MW , MZ , MY ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MO ( MV , MW , MZ , MY ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LE ( M_ , Na , MZ ) . x ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LI ( M_ , Na , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LM ( M_ , Na , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LQ ( M_ , Na , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Ms ( Na , M_ , MZ ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mw ( Na , M_ , MZ ) . x ;".split(" ")}]}}]},{type:"textline",a:["return","0.0",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",a:["varying","vec3","KP",";"]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",
e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Nc ; float Nd , Ne , Nf ; vec3 Ng , Nh , Ni , Nj , Nk ; Nh = normalize ( KP ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME"],group:{type:"group",b:[{type:"textline",a:"Ng = textureCube ( u_sky , Nh ) . rgb ;".split(" ")}]}},{type:"elif",d:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
e:2},{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Ng = u_horizon_color ; bu ( Ng ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"textline",a:"Ni = vec3 ( bM , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ni = vec3 ( KP . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["Nd","=","0.0",";"]},{type:"condition",b:[{type:"if",
d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"Nd = abs ( bM . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nd = ( bM . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ne = acos ( Nh . y ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",
b:[{type:"textline",a:"Nd = abs ( Ne * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nd = 1.0 - Ne * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",a:"Nj = u_horizon_color ; Nk = u_zenith_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYTEX"],group:{type:"group",b:[{type:"textline",a:"Ne = 1.0 ; Nc = textureCube ( u_sky , Nh ) ; br ( Nc . rgb ) ; Ne = Nc . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",
b:[{type:"textline",a:"Ne = bB ( Nc ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["MTEX_NEGATIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nc = vec4 ( vec3 ( 1.0 ) - Nc . rgb , Nc . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ne = 1.0 - Ne ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",b:[{type:"textline",a:"Nc = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ne = Nc . a ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ"],group:{type:"group",b:[{type:"textline",a:"Nj = MU ( Nc . rgb , Nj , Ne , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["Nf","=","0.0",";"]},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"if ( dot ( Ni , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nf = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]}]}}]},{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENDOWN"],
group:{type:"group",b:[{type:"textline",a:"else Nf = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nf = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",d:["WOMAP_ZENDOWN"],group:{type:"group",b:[{type:"textline",a:"Nf = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",a:"if ( Nf != 0.0 ) Nk = MU ( Nc . rgb , Nk , Ne , Nf ) ;".split(" ")}]}}]}]}}]},{type:"condition",
b:[{type:"if",d:["WOMAP_BLEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Ne = dot ( Nc . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",a:"Nd = Nb ( u_sky_tex_dvar , Nd , Ne , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ng = mix ( Nj , Nk , Nd ) ;".split(" ")}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:["Ng","=","Nj",";"]}]}}]},{type:"textline",a:["bu","(","Ng",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"bu ( Nj ) ; bu ( Nk ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ng = mix ( Nj , Nk , Nd ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Ng","=","Nj",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",
{type:"logic_negative_expr",e:1},"REFLECTION_PASS",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"br ( Ng ) ; Nd = WATER_LEVEL - u_camera_eye_frag . y ; Nj = vec3 ( 0.0 ) ; Nj = mix ( u_underwater_fog_color_density . rgb , Nj , min ( - Nh . y , 1.0 ) ) ; Nj *= min ( 1.0 - min ( 0.03 * Nd , 0.8 ) , 1.0 ) ; Nd = clamp ( sign ( 0.01 * Nd - Nh . y ) , 0.0 , 1.0 ) ; Ng = mix ( Ng , Nj , Nd ) ; bu ( Ng ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Ng , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 KP ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 MP , MQ ; MP = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; MQ = u_sky_vp_inverse * MP ; KP = MQ . xyz ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = a_position . xy ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","MP",";","}"]}]};a["special_water.glslf"]={type:"group",b:[{type:"var",name:"ABSORB",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"SSS_STRENGTH",a:["6.0"]},{type:"var",name:"SSS_WIDTH",
a:["0.0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",a:["0.001"]},{type:"define",name:"REFR_BUMP",a:["0.0005"]},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],
group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2",
"u_normalmap2_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"const float MP = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",a:"varying vec3 uK ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 MQ ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MR",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MS",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MT",";"]}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"vec3 Ne ( in vec2 MU , in vec3 MV , in vec3 MW , in vec3 MX , out float MY ) { float MZ , M_ , Na ; vec2 Nb ; vec3 Nc , Nd ; MY = 0.0 ; Nc = reflect ( - MW , MV ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nb = MU . xy + MV . xz * REFL_BUMP / bH ; MY = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nd = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"Nd = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",a:"} else { Nd = texture2D ( u_plane_reflection , Nb ) . rgb ; br ( Nd ) ; }".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MY = u_mirror_factor ; Nd = MX * textureCube ( u_mirrormap , Nc ) . rgb ; br ( Nd ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"MY = u_reflect_factor ; Nd = MX * vec3 ( 0.3 , 0.5 , 1.0 ) ; br ( Nd ) ;".split(" ")}]}}]},
{type:"textline",a:"Nc = normalize ( Nc + MW ) ; MZ = 1.0 - dot ( MW , Nc ) ; M_ = u_fresnel_params [ 3 ] ; Na = u_fresnel_params [ 2 ] ; Na = M_ + ( 1.0 - M_ ) * pow ( MZ , Na ) ; MY = min ( MY * Na , 1.0 ) ; return Nd ; }".split(" ")},{type:"include",file:"lighting_nodes.glslf"},{type:"textline",a:"void main ( ) { vec4 Nf ; vec2 Ng , Nh , Ni ; float Nj , Nk , Nl , Nm , Nn ; vec3 No , Np , Nq , Nr , Ns , Nt , Nu , Nv , Nw ; mat3 Nx ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",
0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nx = mat3 ( bF , MQ , bE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"No = normalize ( bE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","FOAM",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nj = bC . y - WATER_LEVEL ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"Ng = vec2 ( MR . x , - MR . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ng = vec2 ( bC . x , - bC . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:["Ng","=","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Np = vec3 ( 0.0 ) ; Nq = texture2D ( u_normalmap0 , Ng * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Np += Nq ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"Nr = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORM_FOAM0"],
group:{type:"group",b:[{type:"textline",a:["Nr","+=","Nq",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nq = texture2D ( u_normalmap0 , Ng * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Np += Nq ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM1"],group:{type:"group",b:[{type:"textline",
a:["Nr","+=","Nq",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nq = texture2D ( u_normalmap0 , Ng * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Np += Nq ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM2"],group:{type:"group",b:[{type:"textline",a:["Nr","+=","Nq",";"]}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nq = texture2D ( u_normalmap0 , Ng * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Np += Nq ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM3"],group:{type:"group",b:[{type:"textline",a:["Nr","+=","Nq",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"Nr = Nx * Nr ; if ( ! f ( Nr , vec3 ( 0.0 ) ) ) Nr = normalize ( Nr ) ; Nr = mix ( No , Nr , 0.2 ) ; Nr = normalize ( Nr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"No = mix ( No , normalize ( Nx * Np ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"No = mix ( No , normalize ( Nx * Np ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"No = normalize ( No ) ;".split(" ")}]}}]},{type:"textline",a:"Np = normalize ( uK ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nh = bG . xy / bG . z ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"Ni = Nh + No . xz * u_refr_bump / bH ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"Nk = u_diffuse_color . a ; Nf = texture2DProj ( u_scene_depth , bG ) ; Nl = Z ( Nf ) ; Nm = max ( Nl - bH , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"Nl = dY ( Nl , Ni , Nh ) ; Nl = max ( Nl - bH , 0.0 ) ; Nl = u_view_max_depth / ABSORB * Nl ; Nl = min ( Nk * Nl , 1.0 ) ; Nk = min ( 15.0 * Nk * u_view_max_depth * Nm , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Nn = u_view_max_depth / ABSORB * Nm ; if ( u_cam_water_depth > 0.0 ) Nk = min ( Nk * Nn , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nk = u_diffuse_color . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["Nl","=","Nk",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) Nl = 0.0 ; Nq = texture2D ( u_refractmap , Ni ) . rgb ; br ( Nq ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nn = pow ( min ( MS . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; Ns = mix ( u_shallow_water_col , u_diffuse_color . rgb , Nn ) ; Nn = pow ( min ( MS . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; Ns = mix ( u_shore_water_col , Ns , Nn ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ns = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"Nm = max ( 1.0 - u_view_max_depth * Nm , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nm = 1.0 - Nk ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"Nj = max ( Nj / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nt = normalize ( vec3 ( MS . r , 0.0 , MS . g ) ) ; Nt = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , Nt , 0.8 ) ) ; Nn = 1.25 * max ( dot ( Nr , Nt ) - 0.2 , 0.0 ) ; Nn += max ( dot ( Nr , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; Nm += Nn * ( 1.0 - MS . b ) ; Nj *= ( 1.0 - 0.95 * pow ( MS . b , 0.1 ) ) ;".split(" ")}]}}]},
{type:"textline",a:"Nm += Nj ; Nm = min ( u_foam_factor * Nm , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"Nf = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + Ng * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",a:"Nj = u_specular_params [ 0 ] ; Ng = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; Nr = Nj * u_specular_color ; Nt = u_environment_energy * dS ( No ) ; Nt = u_ambient * Nt ; Nt = Nt + u_sun_intensity ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nu = Ne ( Nh , No , Np , Nt , Nj ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nu = Ne ( vec2 ( 0.0 ) , No , Np , Nt , Nj ) ;".split(" ")}]}}]},{type:"textline",a:"Ns = u_diffuse_intensity * Ns ; xH ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ns , Nr , bC , No , Np , Ng , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , Nv , Nw ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"Nn = max ( dot ( u_sun_direction , - bE ) + SSS_WIDTH , 0.0 ) * max ( dot ( - Np , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; Nn = clamp ( SSS_STRENGTH * Nn , 0.0 , 1.0 ) ; Nv = mix ( Nv , u_shallow_water_col , Nn ) ; Nv = mix ( Nv , u_shore_water_col , Nn ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"Nv = mix ( Nq , Nv , Nl ) ;".split(" ")}]}}]},
{type:"textline",a:"Nv = mix ( Nv , Nu , Nj ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"Nj = mix ( Nf . g , Nf . r , max ( 4.0 * ( Nm - 0.75 ) , 0.0 ) ) ; Nj = mix ( Nf . b , Nj , max ( 2.0 * Nm - 1.0 , 0.0 ) ) ; Nj = mix ( 0.0 , Nj , Nm ) ; Nv = mix ( Nv , Nt , Nj ) ;".split(" ")}]}}]},{type:"textline",a:["Nv","+=","Nw",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",
a:"Nm = bH * u_view_max_depth ; Nl = 1.0 ; if ( u_cam_water_depth > 1.0 ) Nl = 2.0 ; uJ ( Nv , Nm , Np , Nl ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","Nv",")",";"]},{type:"condition",b:[{type:"if",d:["REFRACTIVE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nk = max ( Nk , Nw . r ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["Nk","+=","Nj",";"]}]}}]}]}},{type:"elif",d:["SHORE_SMOOTHING",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["Nk","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( Nv , Nk ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"Nw = fwidth ( MT ) ; Nw = smoothstep ( vec3 ( 0.0 ) , Nw * MP , MT ) ; Nj = min ( min ( Nw . x , Nw . y ) , Nw . z ) ; Nj = clamp ( Nj , 0.0 , 1.0 ) ; Nv = mix ( u_wireframe_edge_color , Nv , Nj ) ; Nk = mix ( 1.0 , Nk , Nj ) ;".split(" ")}]}}]},
{type:"textline",a:"gl_FragColor = vec4 ( Nv , Nk ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",b:[{type:"var",name:"DIR_MIN_SHR_FAC",a:["0.0"]},{type:"var",name:"DIR_FREQ",a:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",a:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",a:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
a:["0.0"]},{type:"var",name:"DST_MIN_FAC",a:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",a:["0.0"]},{type:"var",name:"PRECISION",a:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",a:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",a:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",a:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",a:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"WAVES_LENGTH",a:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"DYNAMIC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["GENERATED_MESH",{type:"logic_negative_expr",e:1},"NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",
{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",a:"varying vec3 uK ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 MQ ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MR",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MS",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","MT",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"vec3 MY ( in vec2 MP ) { float MU ; vec4 MV ; vec2 MW ; MW = 0.5 + vec2 ( ( MP . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( MP . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; MV = texture2D ( u_shore_dist_map , MW ) ; const vec2 MX = vec2 ( 1.0 / 255.0 , 1.0 ) ; MU = dot ( MV . ba , MX ) ; MW = normalize ( MV . rg * 2.0 - 1.0 ) ; return vec3 ( MW , MU ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],
group:{type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",a:["0.3"]},{type:"textline",a:"void Nj ( inout vec3 MZ , in float M_ , in vec3 Na ) { vec2 Nb , Nc , Nd ; float Ne , Nf , Ng , Nh , Ni ; Ne = aU ( DST_NOISE_SCALE_0 * ( MZ . xz + DST_NOISE_FREQ_0 * M_ ) ) * aU ( DST_NOISE_SCALE_1 * ( MZ . zx - DST_NOISE_FREQ_1 * M_ ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nf = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; Ng = Na . b ; Nh = sqrt ( Ng ) ; Nf = max ( Ng , DIR_MIN_SHR_FAC ) * sin ( Nh / Nf + DIR_FREQ * M_ ) ; Ni = max ( aU ( DIR_NOISE_SCALE * ( MZ . xz + DIR_NOISE_FREQ * M_ ) ) , DIR_MIN_NOISE_FAC ) ; Nf *= Ni ; Nh = WAVES_HEIGHT * mix ( Nf , Ne , max ( Nh , DST_MIN_FAC ) ) ; Nb = Na . rg ; Nf = WAVES_HOR_FAC * Nf * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - Ng ) , 0.0 ) ; Nb = Nf * Nb ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Nh = WAVES_HEIGHT * Ne ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"Nc = 2.0 * ( MZ . xz - 0.1 * M_ ) ; Nd = 1.3 * ( MZ . zx + 0.03 * M_ ) ; Ne = ay ( 0.5 * Nc ) . x + ay ( 0.5 * Nd ) . x - 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"MZ . xz += Nb ; Ne *= Ng ;".split(" ")}]}}]},{type:"textline",a:"Nh += SMALL_WAVES_FAC * Ne ;".split(" ")}]}}]},
{type:"textline",a:"MZ . y += Nh ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { vec4 Nk , Nl ; vec2 Nm ; float Nn , No , Np ; vec3 Nq , Nr , Ns , Nt ; mat4 Nu , Nv ; Nu = O ( u_view_tsr ) ; Nv = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"if ( a_polyindex == 0.0 ) MT = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) MT = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) MT = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["Nq","=","a_position",";"]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"Nn = abs ( Nq . y ) ; Nm = u_camera_eye . xz - mod ( u_camera_eye . xz , Nn ) ; Nq . y = WATER_LEVEL ; Nq . xz += Nm ;".split(" ")}]}},{type:"elif",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["bM","=","a_texcoord",";"]}]}}]},{type:"textline",a:"c Nw = rB ( Nq , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Nv ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"MS = MY ( Nw . a . xz ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"No = length ( u_wind ) ; Np = u_time ; Np *= No ;".split(" ")},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"Nn = Nn ; Nq = Nw . a + vec3 ( Nn , 0.0 , 0.0 ) ; Nr = Nw . a + vec3 ( 0.0 , 0.0 , Nn ) ;".split(" ")},{type:"condition",
b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MR = Nw . a ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nq = Nw . a + vec3 ( 0.05 , 0.0 , 0.0 ) ; Nr = Nw . a + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Ns = MY ( Nq . xz ) ; Nt = MY ( Nr . xz ) ; Nj ( Nq , Np , Ns ) ; Nj ( Nr , Np , Nt ) ; Nj ( Nw . a , Np , MS ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Nj ( Nq , Np , vec3 ( 0.0 ) ) ; Nj ( Nr , Np , vec3 ( 0.0 ) ) ; Nj ( Nw . a , Np , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"if ( a_position . y < 0.0 ) { Nw . a . y = WATER_LEVEL - 1.0 ; Nq . y = Nw . a . y ; Nr . y = Nw . a . y ; } Nq = normalize ( Nq - Nw . a ) ; Nr = normalize ( Nr - Nw . a ) ; bE = normalize ( cross ( Nr , Nq ) ) ; Np = dot ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Np = clamp ( 0.8 - Np , 0.0 , 1.0 ) ; bE = mix ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) , Np ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nr = a_tangent ; bE = a_normal ;".split(" ")}]}}]},{type:"textline",a:"bF = Nr ; MQ = cross ( bE , bF ) ;".split(" ")}]}}]},{type:"textline",a:"bC = Nw . a ; uK = u_camera_eye - Nw . a ; Nk = Nu * vec4 ( Nw . a , 1.0 ) ; Nl = u_proj_matrix * Nk ;".split(" ")},{type:"condition",b:[{type:"if",
d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"Np = Nl . x ; Nn = Nl . y ; No = Nl . w ; bG . x = ( Np + No ) / 2.0 ; bG . y = ( Nn + No ) / 2.0 ; bG . z = No ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",
b:[{type:"textline",a:"bH = - Nk . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","Nl",";","}"]}]};a["wireframe.glslf"]={type:"group",b:[{type:"define",name:"WM_NONE",a:["0"]},{type:"define",name:"WM_OPAQUE_WIREFRAME",a:["1"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",a:["2"]},{type:"define",name:"WM_FRONT_BACK_VIEW",a:["3"]},{type:"define",name:"WM_DEBUG_SPHERES",a:["4"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",a:"varying vec3 MT ; const float MP = 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"const vec3 MU = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 MU = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 MV = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 MW = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 MX = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"void main ( ) { float MY , MZ ; vec3 M_ , Na ; M_ = vec3 ( 0.0 ) ; MY = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",
b:[{type:"textline",a:"Na = sign ( MT - vec3 ( 0.02 * MP ) ) ; if ( Na . x < 0.0 || Na . y < 0.0 || Na . z < 0.0 ) { M_ = MU ; MY = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",d:["WIREFRAME_QUALITY",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Na = sign ( MT - vec3 ( 0.02 * MP ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( Na . x < 0.0 || Na . y < 0.0 || Na . z < 0.0 ) M_ = u_wireframe_edge_color ; else M_ = MX ; MY = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( Na . x < 0.0 || Na . y < 0.0 || Na . z < 0.0 ) MY = 1.0 ; else MY = 0.0 ; M_ = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( Na . x < 0.0 || Na . y < 0.0 || Na . z < 0.0 ) M_ = u_wireframe_edge_color ; else if ( gl_FrontFacing ) M_ = MV ; else M_ = MW ; MY = 1.0 ; }".split(" ")}]}},
{type:"elif",d:["WIREFRAME_QUALITY",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"Na = fwidth ( MT ) ; Na = smoothstep ( vec3 ( 0.0 ) , Na * MP , MT ) ; MZ = min ( min ( Na . x , Na . y ) , Na . z ) ; MZ = clamp ( MZ , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { M_ = vec3 ( mix ( u_wireframe_edge_color , MX , MZ ) ) ; MY = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { M_ = u_wireframe_edge_color ; MY = mix ( 1.0 , 0.0 , MZ ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) M_ = mix ( u_wireframe_edge_color , MV , MZ ) ; else M_ = mix ( u_wireframe_edge_color , MW , MZ ) ; MY = 1.0 ; }".split(" ")}]}}]},
{type:"textline",a:["bu","(","M_",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( M_ , MY ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( M_ , MY ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",
";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",a:["varying","vec3","MT",";"]},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec3 MP , MU , MV , MW , MX ; mat4 MY , MZ , M_ ; MY = O ( u_view_tsr ) ; MZ = O ( u_model_tsr ) ; if ( a_polyindex == 0.0 ) MT = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) MT = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) MT = vec3 ( 0.0 , 0.0 , 1.0 ) ; MP = a_position ; MU = a_normal ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"textline",a:"c Na = rB ( MP , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , MZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"MP = mix ( MP , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"MV = vec3 ( 0.0 ) ; MW = vec3 ( 0.0 ) ; sB ( MP , MV , MW , MU ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["MW","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"MW = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"c Na = vq ( MP , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , MW , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , MY ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"MV = ( MZ * vec4 ( MW , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"M_ = ru ( u_camera_eye , MV , MY , MZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"M_ = ro ( u_camera_eye , MV , MY ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MX = ( MZ * vec4 ( MW , 1.0 ) ) . xyz ; M_ = M_ * rg ( u_wind , u_time , u_jitter_amp , u_jitter_freq , MX ) ;".split(" ")}]}}]},{type:"textline",a:"c Na = rB ( MP - MW , MW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , M_ ) ; Na . b = MV ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c Na = rB ( MP , MW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , MZ ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tp ( Na . a , Na . b , MU ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * MY * vec4 ( Na . a , 1.0 ) ; }".split(" ")}]};a["postprocessing/antialiasing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"define",
name:"AA_METHOD_FXAA_LIGHT",a:["1"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",a:["2"]},{type:"define",name:"AA_QUALITY_LOW",a:["0"]},{type:"define",name:"AA_QUALITY_MEDIUM",a:["1"]},{type:"define",name:"AA_QUALITY_HIGH",a:["2"]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_REDUCE_MIN",a:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",a:["(","1.0","/","8.0",")"]},{type:"define",
name:"FXAA_SPAN_MAX",a:["8.0"]},{type:"textline",a:"vec4 MW ( float MP , float MU ) { vec2 MV ; MV = bM + vec2 ( MP , MU ) * u_texel_size ; return texture2D ( u_color , MV ) ; } vec4 Ni ( ) { vec2 MX ; float MY , MZ , M_ , Na , Nb , Nc ; vec4 Nd , Ne , Nf , Ng , Nh ; Nd = MW ( - 1.0 , - 1.0 ) ; Ne = MW ( 1.0 , - 1.0 ) ; Nf = MW ( - 1.0 , 1.0 ) ; Ng = MW ( 1.0 , 1.0 ) ; Nh = MW ( 0.0 , 0.0 ) ; MY = bB ( Nh ) ; MZ = bB ( Nd ) ; M_ = bB ( Ne ) ; Na = bB ( Nf ) ; Nb = bB ( Ng ) ; Nc = min ( MY , min ( min ( MZ , M_ ) , min ( Na , Nb ) ) ) ; MY = max ( MY , max ( max ( MZ , M_ ) , max ( Na , Nb ) ) ) ; MX . x = - ( ( MZ + M_ ) - ( Na + Nb ) ) ; MX . y = ( ( MZ + Na ) - ( M_ + Nb ) ) ; Nb = max ( ( MZ + M_ + Na + Nb ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; Nb = 1.0 / ( min ( abs ( MX . x ) , abs ( MX . y ) ) + Nb ) ; MX = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , MX * Nb ) ) * u_texel_size ; Ng = 0.5 * ( texture2D ( u_color , bM + MX * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , bM + MX * ( 2.0 / 3.0 - 0.5 ) ) ) ; Nf = Ng * 0.5 + 0.25 * ( texture2D ( u_color , bM + MX * - 0.5 ) + texture2D ( u_color , bM + MX * 0.5 ) ) ; Nb = bB ( Nf ) ; if ( ( Nb < Nc ) || ( Nb > MY ) ) return Ng ; else return Nf ; }".split(" ")}]}},
{type:"elif",d:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["1"]},{type:"define",name:"FXAA_BLEND4WEB",a:["1"]},{type:"include",file:"fxaa.glslf"},{type:"condition",b:[{type:"if",d:["AA_QUALITY","AA_QUALITY_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["39"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["1.00"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",
a:["0.063"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0312"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["20"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.65"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0625"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_LOW",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.50"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0833"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec2 N_ ;".split(" ")},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = Ni ( ) ;".split(" ")}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"N_ = u_texel_size ; gl_FragColor = NZ ( bM , u_color , N_ , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 MP ; vec2 MU , MV ; MU = vec2 ( 0.0 , 0.0 ) ; MV = u_texel_size ; MP = texture2D ( u_color , bM ) ; gl_FragColor = MP * 0.0875447373698 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0858112354248 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0808139781061 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0731235112908 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0635705267419 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0530985673112 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0426125984122 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0328565115809 ; MU += MV ; gl_FragColor += texture2D ( u_color , bM + MU ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , bM - MU ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * MP , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 bM ; void main ( ) { vec4 MP , MU ; MP = texture2D ( u_main , bM ) ; MU = texture2D ( u_bloom , bM ) ; MP = MP ; MP += MU ; gl_FragColor = vec4 ( MP . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"define",name:"PI_4",a:["0.785398163"]},{type:"textline",a:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 bM ; void main ( ) { float MP ; vec3 MU ; vec4 MV ; MV = texture2D ( u_color , bM ) ; MU = MV . rgb ; if ( u_brightness < 0.0 ) MU = MU * ( 1.0 + u_brightness ) ; else MU = MU + ( ( 1.0 - MU ) * u_brightness ) ; MU = ( MU - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; MU *= u_exposure ; MP = bB ( vec4 ( MU , 0.0 ) ) ; MU = mix ( vec3 ( MP ) , MU , u_saturation ) ; gl_FragColor = vec4 ( MU , MV . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { gl_FragColor = V ( clamp ( Of ( u_depth , bM , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { float MP , MU ; vec4 MV , MW ; MV = texture2D ( u_sharp , bM ) ; if ( u_dof_dist > 0.0 ) { MP = Of ( u_depth , bM , u_camera_range ) ; MP *= u_view_max_depth ; if ( MP < u_dof_dist ) MU = ( u_dof_dist - MP ) / u_dof_front ; else MU = ( MP - u_dof_dist ) / u_dof_rear ; MU = clamp ( MU , 0.0 , 1.0 ) ; MW = texture2D ( u_blurred , bM ) ; gl_FragColor = mix ( MV , MW , MU ) ; } else gl_FragColor = MV ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 bM ; void main ( ) { float MP ; vec4 MU , MV , MW ; MU = texture2D ( u_src_color , bM ) ; MV = texture2D ( u_glow_mask_small , bM ) ; MW = texture2D ( u_glow_mask_large , bM ) ; gl_FragColor = MU ; if ( MW . a != 0.0 ) { MP = u_glow_mask_large_coeff * MW . a ; MP = clamp ( MP , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , MW . rgb / MW . a , MP ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , MP ) ; } if ( MV . a != 0.0 ) { MP = u_glow_mask_small_coeff * MV . a ; MP = clamp ( MP , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , MV . rgb / MV . a , MP ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , MP ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",a:["0.0"]},{type:"textline",a:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_camera_range",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"varying float Og ; varying vec2 Oh ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oi ; void main ( ) { vec4 Oj ; int Ok ; float Ol , Om , On , Oo ; vec2 Op , Oq , Or ; Op = ( Oi . xy - bM ) ; Ol = length ( Op ) ; Op = u_radial_blur_step * Op / Ol ; Om = Ol / u_radial_blur_step ; Op *= min ( Om , STEPS_PER_PASS ) / STEPS_PER_PASS ; Om = max ( Om , STEPS_PER_PASS ) ; Oq = bM ; On = 0.0 ; const int Os = int ( STEPS_PER_PASS ) ; Ok = int ( Om + 0.5 ) ; for ( int Ot = 0 ; Ot < Os ; Ot += 1 ) { if ( Ot <= Ok ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:"Om = Of ( u_input , Oq , u_camera_range ) ; On += max ( ( 1.0 - pow ( Ol , 0.3 ) ) * step ( 0.9 , Om ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Oj = texture2D ( u_input , Oq ) ; On += Z ( Oj ) ;".split(" ")}]}}]},{type:"textline",a:"} Oq += Op ; }".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"Or = bM + Oh ; Oo = ay ( vec2 ( 2.5 * ( Or . x ) , 2.5 * ( Or . y ) + 1.0 * u_time ) ) . x + 0.75 * ay ( vec2 ( 5.0 * ( Or . x ) - 0.66 * u_time , 5.0 * ( Or . y ) + 0.66 * u_time ) ) . x + 0.5 * aU ( vec2 ( 7.5 * ( Or . x ) + 0.33 * u_time , 7.5 * ( Or . y ) - 0.33 * u_time ) ) ; Oo *= clamp ( 1.2 - sqrt ( 0.2 * Ol ) , 0.0 , 1.0 ) * Og ; On = max ( Oo , On ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = V ( On / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",b:[{type:"include",file:"math.glslv"},{type:"textline",a:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float Og ; varying vec2 Oh ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oi ; void main ( ) { float MP , MU ; vec3 MV ; bM = a_bb_vertex + 0.5 ; MV = normalize ( u_sun_direction ) ; Oi = u_view_proj_matrix * vec4 ( MV , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) { Og = 1.0 ; MV = vec3 ( 0.0 , 1.0 , 0.0 ) ; MV = i ( u_camera_quat , MV ) ; MV = normalize ( MV ) ; MP = dot ( MV , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; MU = atan ( MV . x , MV . z ) ; Oh = vec2 ( - MU , acos ( MP ) ) ; } else { Og = 0.0 ; }".split(" ")}]}}]},{type:"textline",a:"Oi . xy = 0.5 * ( Oi . xy / Oi . w + 1.0 ) ; Oi += 99999.0 * step ( Oi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/god_rays_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 bM ; void main ( ) { float MP ; vec3 MU ; vec4 MV ; MV = texture2D ( u_main , bM ) ; MU = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; br ( MV . rgb ) ; MP = Z ( texture2D ( u_god_rays , bM ) ) ; MU = MV . rgb + u_god_rays_intensity * vec3 ( MP ) * MU ; bu ( MU ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SAFARI_CANVAS_ALPHA_HACK"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( MU , max ( 0.01 , MV . a ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( MU , MV . a ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/luminance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; varying vec2 bM ; void main ( ) { float MP ; vec4 MU ; MU = texture2D ( u_input , bM ) ; MP = dot ( MU . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( MP ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; void main ( ) { float MP , MU , MV , MW ; MU = 0.0 ; MV = 0.025 ; MW = 0.025 ; for ( int MX = 0 ; MX < 20 ; MX += 1 ) { MW = 0.025 ; for ( int MY = 0 ; MY < 20 ; MY += 1 ) { MP = max ( texture2D ( u_input , vec2 ( MV , MW ) ) . r , 0.01 ) ; MU += log ( MP ) ; MW += 0.05 ; } MV += 0.05 ; } MU = exp ( MU / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( MU ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 bM ; varying float Oj ; void main ( ) { vec4 Ok ; float Ol , Om ; Ol = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; Om = texture2D ( u_luminance , bM ) . r ; Ok = texture2D ( u_main , bM ) ; Ol = Om / Ol ; Om = u_bloom_edge_lum ; gl_FragColor = Ok * max ( Ol - Om , 0.0 ) * Oj ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 bM ; varying float Oj ; const vec3 MP = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Na ( in vec4 MU , in vec3 MV , out vec3 MW ) { float MX , MY , MZ , M_ ; MX = MU . w * MV . x + MU . y * MV . z - MU . z * MV . y ; MY = MU . w * MV . y + MU . z * MV . x - MU . x * MV . z ; MZ = MU . w * MV . z + MU . x * MV . y - MU . y * MV . x ; M_ = - MU . x * MV . x - MU . y * MV . y - MU . z * MV . z ; MW . x = MX * MU . w - M_ * MU . x - MY * MU . z + MZ * MU . y ; MW . y = MY * MU . w - M_ * MU . y - MZ * MU . x + MX * MU . z ; MW . z = MZ * MU . w - M_ * MU . z - MX * MU . y + MY * MU . x ; } void main ( ) { vec3 Nb ; bM = 2.0 * a_position ; Na ( u_camera_quat , MP , Nb ) ; Oj = dot ( - Nb , u_sun_direction ) * u_bloom_key ; Oj *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 bM ; float MP = 0.0042 ; void main ( ) { vec4 MU , MV , MW , MX ; MU = texture2D ( u_mb_tex_curr , bM ) ; MV = texture2D ( u_mb_tex_accum , bM ) ; if ( length ( MU - MV ) > u_motion_blur_decay_threshold ) { MW = ( 1.0 - u_motion_blur_exp ) * MU + u_motion_blur_exp * MV ; MW = MW - MV ; MX = MU - MV ; MW = min ( max ( abs ( MW ) , vec4 ( MP ) ) , abs ( MX ) ) * sign ( MW ) ; gl_FragColor = MV + MW ; } else { gl_FragColor = MU ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 bM ; void main ( ) { vec3 MP ; float MU ; vec4 MV , MW , MX ; MV = texture2D ( u_outline_src , bM ) ; gl_FragColor = MV ; if ( u_draw_outline != 0.0 ) { MW = texture2D ( u_outline_mask , bM ) ; MX = texture2D ( u_outline_mask_blurred , bM ) ; MU = MX . a - MW . a ; if ( MU != 0.0 ) { MU = smoothstep ( 0.0 , 1.0 , MX . a ) ; if ( MW . a == 0.0 ) { MP = u_outline_color ; bu ( MP ) ; MW = vec4 ( clamp ( MP , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( MV , MW , MU ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 MP ; MP = vec4 ( 0.0 ) ; for ( int MU = 0 ; MU < 100 ; MU ++ ) MP += 0.001 * texture2D ( u_color , bM + vec2 ( 0.001 * vec2 ( MU ) ) ) ; gl_FragColor = MP ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",
a:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",a:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",a:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",a:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",a:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",a:["6"]},{type:"define",name:"FLIP_CUBEMAP_COORDS",a:["7"]},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{type:"textline",a:"varying vec2 bM ; void main ( ) { float MP , MU , MV , MW ; vec2 MX , MY ; vec4 MZ ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = texture2D ( u_color , bM ) ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"MZ = texture2D ( u_color , bM ) ; gl_FragColor . rgb = vec3 ( ( MZ . r + MZ . g + MZ . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MX = vec2 ( 0.0 , 0.0 ) ; MY = u_texel_size ; MZ = texture2D ( u_color , bM ) ; gl_FragColor = MZ * 0.2270270270 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * 0.1945945946 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * 0.1945945946 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * 0.1216216216 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * 0.1216216216 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * 0.0540540541 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * 0.0540540541 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * 0.0162162162 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * 0.0162162162 ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MX = vec2 ( 0.0 , 0.0 ) ; MY = u_texel_size ; MZ = texture2D ( u_color , bM ) ; gl_FragColor = MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.152507 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.141763 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.141763 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.113861 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.113861 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.079019 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.079019 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.047383 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.047383 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.024549 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.024549 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.01099 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.01099 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.00425 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.00425 ; MX += MY ; MZ = texture2D ( u_color , bM + MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.00142 ; MZ = texture2D ( u_color , bM - MX ) ; gl_FragColor += MZ * ( 1.0 - step ( 0.0 , - MZ . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MY = u_texel_size ; MZ = texture2D ( u_color , bM ) ; gl_FragColor = MZ ; if ( MZ . a == 0.0 ) { MZ = texture2D ( u_color , bM + MY ) ; if ( MZ . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , MZ . a ) ; else { MZ = texture2D ( u_color , bM - MY ) ; if ( MZ . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , MZ . a ) ; } }".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MP = u_delta [ 0 ] ; MU = u_delta [ 1 ] ; MV = 1.0 / 3.0 ; MW = 0.5 ; MY = vec2 ( MV , MW ) ; if ( u_tex_number == 0 ) { MX = bM * MY + vec2 ( 2.0 * MV , 0.0 ) ; MX [ 0 ] = min ( MX [ 0 ] , 1.0 - MP ) ; MX [ 1 ] = min ( MX [ 1 ] , 0.5 - MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * MV - MX [ 0 ] , MX [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { MX = bM * MY ; MX [ 0 ] = max ( MX [ 0 ] , MP ) ; MX [ 1 ] = min ( MX [ 1 ] , 0.5 - MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( MV - MX [ 0 ] , MX [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { MX = bM * MY + vec2 ( MV , MW ) ; MX [ 0 ] = max ( MX [ 0 ] , MV + MP ) ; MX [ 0 ] = min ( MX [ 0 ] , 2.0 * MV - MP ) ; MX [ 1 ] = min ( MX [ 1 ] , 1.0 - MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( MX [ 0 ] , 3.0 * MW - MX [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { MX = bM * MY + vec2 ( 0.0 , MW ) ; MX [ 0 ] = min ( MX [ 0 ] , MV - MP ) ; MX [ 1 ] = min ( MX [ 1 ] , 1.0 - MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( MX [ 0 ] , 3.0 * MW - MX [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { MX = bM * MY + vec2 ( MV , 0.0 ) ; MX [ 0 ] = max ( MX [ 0 ] , MV + MP ) ; MX [ 0 ] = min ( MX [ 0 ] , 2.0 * MV - MP ) ; MX [ 1 ] = min ( MX [ 1 ] , 0.5 - MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( 1.0 - MX [ 0 ] , MX [ 1 ] ) ) ; } else { MY = bM * MY + vec2 ( 2.0 * MV , MW ) ; MY [ 0 ] = min ( MY [ 0 ] , 1.0 - MP ) ; MY [ 1 ] = max ( MY [ 1 ] , 0.5 + MU ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * MV - MY [ 0 ] , MY [ 1 ] ) ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; varying vec2 bM ; void main ( ) { bM = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",a:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",a:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:["uniform","sampler2D","u_color",";"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2},"SMAA_PREDICATION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",a:"uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","Ok",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 Ol ; varying vec4 Om ; varying vec4 On ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","Oo",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",a:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",b:[{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",b:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",b:[{type:"define",
name:"SMAA_PREDICATION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",a:["0.01"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_SCALE",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",a:["0.4"]}]}}]},
{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",a:["30.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",a:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",a:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",a:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",a:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",a:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",a:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",a:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 Ou ( vec2 Op , sampler2D Oq ) { float Or , Os , Ot ; Or = texture2D ( Oq , Op ) . r ; Os = texture2D ( Oq , Ol . xy ) . r ; Ot = texture2D ( Oq , Ol . zw ) . r ; return vec3 ( Or , Os , Ot ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 Oz ( vec2 Ov , sampler2D Ow ) { vec2 Ox ; vec3 Oy ; Oy = Ou ( Ov , Ow ) ; Ox = abs ( Oy . xx - Oy . yz ) ; Ox = step ( SMAA_PREDICATION_THRESHOLD , Ox ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * Ox ) ; }".split(" ")}]}}]},
{type:"textline",a:"void OD ( bvec2 OA , inout vec2 OB , vec2 OC ) { if ( OA . x ) OB . x = OC . x ; if ( OA . y ) OB . y = OC . y ; } void OD ( bvec4 OE , inout vec4 OF , vec4 OG ) { OD ( OE . xy , OF . xy , OG . xy ) ; OD ( OE . zw , OF . zw , OG . zw ) ; } vec2 OI ( vec2 OH ) { return sign ( OH ) * floor ( abs ( OH ) + .5 ) ; } vec4 OI ( vec4 OJ ) { return sign ( OJ ) * floor ( abs ( OJ ) + .5 ) ; }".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 OW ( vec2 OK , sampler2D OL".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","OM"]}]}}]},{type:"textline",a:") { vec4 ON ; float OO , OP , OQ , OR , OS ; vec3 OT ; vec2 OU , OV ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:"OU = Oz ( OK , OM ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"OU = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",a:"OT = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; OO = dot ( texture2D ( OL , OK ) . rgb , OT ) ; OP = dot ( texture2D ( OL , Ol . xy ) . rgb , OT ) ; OQ = dot ( texture2D ( OL , Ol . zw ) . rgb , OT ) ; ON . xy = abs ( OO - vec2 ( OP , OQ ) ) ; OU = step ( OU , ON . xy ) ; if ( dot ( OU , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; OR = dot ( texture2D ( OL , Om . xy ) . rgb , OT ) ; OS = dot ( texture2D ( OL , Om . zw ) . rgb , OT ) ; ON . zw = abs ( OO - vec2 ( OR , OS ) ) ; OV = max ( ON . xy , ON . zw ) ; OS = dot ( texture2D ( OL , On . xy ) . rgb , OT ) ; OR = dot ( texture2D ( OL , On . zw ) . rgb , OT ) ; ON . zw = abs ( vec2 ( OP , OQ ) - vec2 ( OS , OR ) ) ; OV = max ( OV . xy , ON . zw ) ; OR = max ( OV . x , OV . y ) ; OU . xy *= step ( OR , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * ON . xy ) ; return OU ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vec2 OY ( vec2 OX ) { OX . r = OX . r * abs ( 5.0 * OX . r - 5.0 * 0.75 ) ; return OI ( OX ) ; } vec4 OY ( vec4 OZ ) { OZ . rb = OZ . rb * abs ( 5.0 * OZ . rb - 5.0 * 0.75 ) ; return OI ( OZ ) ; } vec2 Pg ( sampler2D O_ , vec2 Pa , vec2 Pb , out vec2 Pc ) { vec3 Pd ; vec4 Pe ; Pe = vec4 ( Pa , - 1.0 , 1.0 ) ; Pd = vec3 ( u_texel_size , 1.0 ) ; for ( int Pf = 0 ; Pf < SMAA_MAX_SEARCH_STEPS_DIAG ; Pf ++ ) { if ( Pe . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Pe . w > 0.9 ) { Pe . xyz += Pd * vec3 ( Pb , 1.0 ) ; Pc = texture2D ( O_ , Pe . xy , 0.0 ) . rg ; Pe . w = dot ( Pc , vec2 ( 0.5 , 0.5 ) ) ; } } return Pe . zw ; } vec2 Po ( sampler2D Ph , vec2 Pi , vec2 Pj , out vec2 Pk ) { vec3 Pl ; vec4 Pm ; Pm = vec4 ( Pi , - 1.0 , 1.0 ) ; Pm . x += 0.25 * u_texel_size . x ; Pl = vec3 ( u_texel_size , 1.0 ) ; for ( int Pn = 0 ; Pn < SMAA_MAX_SEARCH_STEPS_DIAG ; Pn ++ ) { if ( Pm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Pm . w > 0.9 ) { Pm . xyz = Pl * vec3 ( Pj , 1.0 ) + Pm . xyz ; Pk = texture2D ( Ph , Pm . xy , 0.0 ) . rg ; Pk = OY ( Pk ) ; Pm . w = dot ( Pk , vec2 ( 0.5 , 0.5 ) ) ; } } return Pm . zw ; } vec2 Pu ( sampler2D Pp , vec2 Pq , vec2 Pr , float Ps ) { vec2 Pt ; Pt = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * Pr + Pq ; Pt = SMAA_AREATEX_PIXEL_SIZE * Pt + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Pt . x += 0.5 ; Pt . y += SMAA_AREATEX_SUBTEX_SIZE * Ps ; return texture2D ( Pp , Pt , 0.0 ) . rg ; } vec2 PG ( sampler2D Pv , sampler2D Pw , vec2 Px , vec2 Py , vec4 Pz ) { vec4 PA , PB , PC ; vec2 PD , PE , PF ; PD = vec2 ( 0.0 , 0.0 ) ; if ( Py . r > 0.0 ) { PA . xz = Pg ( Pv , Px , vec2 ( - 1.0 , 1.0 ) , PE ) ; PA . x += float ( PE . y > 0.9 ) ; } else PA . xz = vec2 ( 0.0 , 0.0 ) ; PA . yw = Pg ( Pv , Px , vec2 ( 1.0 , - 1.0 ) , PE ) ; if ( PA . x + PA . y > 2.0 ) { PB = vec4 ( - PA . x + 0.25 , PA . x , PA . y , - PA . y - 0.25 ) * u_texel_size . xyxy + Px . xyxy ; PC . xy = texture2D ( Pv , PB . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; PC . zw = texture2D ( Pv , PB . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; PC . yxwz = OY ( PC . xyzw ) ; PF = vec2 ( 2.0 , 2.0 ) * PC . xz + PC . yw ; OD ( bvec2 ( step ( 0.9 , PA . zw ) ) , PF , vec2 ( 0.0 , 0.0 ) ) ; PD += Pu ( Pw , PA . xy , PF , Pz . z ) ; } PA . xz = Po ( Pv , Px , vec2 ( - 1 , - 1 ) , PE ) ; if ( texture2D ( Pv , Px + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { PA . yw = Po ( Pv , Px , vec2 ( 1 , 1 ) , PE ) ; PA . y += float ( PE . y > 0.9 ) ; } else PA . yw = vec2 ( 0.0 , 0.0 ) ; if ( PA . x + PA . y > 2.0 ) { PC = vec4 ( - PA . x , - PA . x , PA . y , PA . y ) * u_texel_size . xyxy + Px . xyxy ; PB . x = texture2D ( Pv , PC . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; PB . y = texture2D ( Pv , PC . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; PB . zw = texture2D ( Pv , PC . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; PE = vec2 ( 2.0 , 2.0 ) * PB . xz + PB . yw ; OD ( bvec2 ( step ( 0.9 , PA . zw ) ) , PE , vec2 ( 0 , 0 ) ) ; PD += Pu ( Pw , PA . xy , PE , Pz . w ) . gr ; } return PD ; }".split(" ")}]}}]},
{type:"textline",a:"float PM ( sampler2D PH , vec2 PI , float PJ ) { vec2 PK , PL ; PK = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; PL = SMAA_SEARCHTEX_SIZE * vec2 ( PJ , 1.0 ) ; PK += vec2 ( - 1.0 , 1.0 ) ; PL += vec2 ( 0.5 , - 0.5 ) ; PK *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; PL *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( PH , PK * PI + PL , 0.0 ) . r ; } float PU ( sampler2D PN , sampler2D PO , vec2 PP , float PQ ) { float PR ; vec2 PS ; PS = vec2 ( 0.0 , 1.0 ) ; for ( int PT = 0 ; PT < SMAA_MAX_SEARCH_STEPS ; PT ++ ) { if ( PP . x > PQ && PS . g > 0.8281 && PS . r == 0.0 ) { PS = texture2D ( PN , PP , 0.0 ) . rg ; PP = - vec2 ( 2.0 , 0.0 ) * u_texel_size + PP ; } } PR = - ( 255.0 / 127.0 ) * PM ( PO , PS , 0.0 ) + 3.25 ; return u_texel_size . x * PR + PP . x ; } float Qb ( sampler2D PV , sampler2D PW , vec2 PX , float PY ) { float PZ ; vec2 P_ ; P_ = vec2 ( 0.0 , 1.0 ) ; for ( int Qa = 0 ; Qa < SMAA_MAX_SEARCH_STEPS ; Qa ++ ) { if ( PX . x < PY && P_ . g > 0.8281 && P_ . r == 0.0 ) { P_ = texture2D ( PV , PX , 0.0 ) . rg ; PX = vec2 ( 2.0 , 0.0 ) * u_texel_size + PX ; } } PZ = - ( 255.0 / 127.0 ) * PM ( PW , P_ , 0.5 ) + 3.25 ; return - u_texel_size . x * PZ + PX . x ; } float Qj ( sampler2D Qc , sampler2D Qd , vec2 Qe , float Qf ) { float Qg ; vec2 Qh ; Qh = vec2 ( 1.0 , 0.0 ) ; for ( int Qi = 0 ; Qi < SMAA_MAX_SEARCH_STEPS ; Qi ++ ) { if ( Qe . y > Qf && Qh . r > 0.8281 && Qh . g == 0.0 ) { Qh = texture2D ( Qc , Qe , 0.0 ) . rg ; Qe = - vec2 ( 0.0 , 2.0 ) * u_texel_size + Qe ; } } Qg = - ( 255.0 / 127.0 ) * PM ( Qd , Qh . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Qg + Qe . y ; } float Qr ( sampler2D Qk , sampler2D Ql , vec2 Qm , float Qn ) { float Qo ; vec2 Qp ; Qp = vec2 ( 1.0 , 0.0 ) ; for ( int Qq = 0 ; Qq < SMAA_MAX_SEARCH_STEPS ; Qq ++ ) { if ( Qm . y < Qn && Qp . r > 0.8281 && Qp . g == 0.0 ) { Qp = texture2D ( Qk , Qm , 0.0 ) . rg ; Qm = vec2 ( 0.0 , 2.0 ) * u_texel_size + Qm ; } } Qo = - ( 255.0 / 127.0 ) * PM ( Ql , Qp . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * Qo + Qm . y ; } vec2 Qy ( sampler2D Qs , vec2 Qt , float Qu , float Qv , float Qw ) { vec2 Qx ; Qx = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * OI ( 4.0 * vec2 ( Qu , Qv ) ) + Qt ; Qx = SMAA_AREATEX_PIXEL_SIZE * Qx + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Qx . y = SMAA_AREATEX_SUBTEX_SIZE * Qw + Qx . y ; return texture2D ( Qs , Qx , 0.0 ) . rg ; } void QF ( sampler2D Qz , inout vec2 QA , vec4 QB , vec2 QC ) { vec2 QD , QE ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"QD = step ( QC . xy , QC . yx ) ; QE = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * QD ; QE /= QD . x + QD . y ; QD = vec2 ( 1.0 , 1.0 ) ; QD . x -= QE . x * texture2D ( Qz , QB . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; QD . x -= QE . y * texture2D ( Qz , QB . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; QD . y -= QE . x * texture2D ( Qz , QB . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; QD . y -= QE . y * texture2D ( Qz , QB . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; QA *= clamp ( QD , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:"} void QM ( sampler2D QG , inout vec2 QH , vec4 QI , vec2 QJ ) { vec2 QK , QL ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"QK = step ( QJ . xy , QJ . yx ) ; QL = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * QK ; QL /= QK . x + QK . y ; QK = vec2 ( 1.0 , 1.0 ) ; QK . x -= QL . x * texture2D ( QG , QI . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; QK . x -= QL . y * texture2D ( QG , QI . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; QK . y -= QL . x * texture2D ( QG , QI . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; QK . y -= QL . y * texture2D ( QG , QI . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; QH *= clamp ( QK , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 Q_ ( vec2 QN , vec2 QO , sampler2D QP , sampler2D QQ , sampler2D QR , vec4 QS ) { float QT , QU ; vec3 QV ; vec2 QW , QX , QY ; vec4 QZ ; QZ = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; QW = texture2D ( QP , QN ) . rg ; if ( QW . g > 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"QZ . rg = PG ( QP , QQ , QN , QW , QS ) ; if ( QZ . r == - QZ . g ) {".split(" ")}]}}]},{type:"textline",a:"; QV . x = PU ( QP , QR , Ol . xy , On . x ) ; QV . y = Om . y ; QX . x = QV . x ; QT = texture2D ( QP , QV . xy , 0.0 ) . r ; QV . z = Qb ( QP , QR , Ol . zw , On . y ) ; QX . y = QV . z ; QX = abs ( OI ( QX / u_texel_size . xx - QO . xx ) ) ; QY = sqrt ( QX ) ; QU = texture2D ( QP , QV . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; QZ . rg = Qy ( QQ , QY , QT , QU , QS . y ) ; QV . y = QN . y ; QF ( QP , QZ . rg , QV . xyzy , QX ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"} else QW . r = 0.0 ;".split(" ")}]}}]},{type:"textline",a:"} if ( QW . r > 0.0 ) { ; QV . y = Qj ( QP , QR , Om . xy , On . z ) ; QV . x = Ol . x ; QW . x = QV . y ; QU = texture2D ( QP , QV . xy , 0.0 ) . g ; QV . z = Qr ( QP , QR , Om . zw , On . w ) ; QW . y = QV . z ; QW = abs ( OI ( QW / u_texel_size . yy - QO . yy ) ) ; QX = sqrt ( QW ) ; QT = texture2D ( QP , QV . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; QZ . ba = Qy ( QQ , QX , QU , QT , QS . x ) ; QV . x = QN . x ; QM ( QP , QZ . ba , QV . xyxz , QW ) ; } return QZ ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 Rl ( vec2 Ra , sampler2D Rb , sampler2D Rc".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Rd"]}]}}]},{type:"textline",a:") { bool Re ; vec2 Rf , Rg , Rh ; vec4 Ri , Rj , Rk ; Ri . x = texture2D ( Rc , Ok . xy ) . a ; Ri . y = texture2D ( Rc , Ok . zw ) . g ; Ri . wz = texture2D ( Rc , Ra ) . xz ; if ( dot ( Ri , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { Rj = texture2D ( Rb , Ra , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"Rk = texture2D ( Rd , bM ) ; Rf = 2.0 * ag ( Rk ) - 1.0 ; Rj . a = sqrt ( 2.0 * length ( Rf ) ) ;".split(" ")}]}}]},{type:"textline",a:"return Rj ; } else { Re = max ( Ri . x , Ri . z ) > max ( Ri . y , Ri . w ) ; Rj = vec4 ( 0.0 , Ri . y , 0.0 , Ri . w ) ; Rf = Ri . yw ; OD ( bvec4 ( Re , Re , Re , Re ) , Rj , vec4 ( Ri . x , 0.0 , Ri . z , 0.0 ) ) ; OD ( bvec2 ( Re , Re ) , Rf , Ri . xz ) ; Rf /= dot ( Rf , vec2 ( 1.0 , 1.0 ) ) ; Rj = Rj * vec4 ( u_texel_size , - u_texel_size ) + Ra . xyxy ; Ri = Rf . x * texture2D ( Rb , Rj . xy , 0.0 ) ; Ri += Rf . y * texture2D ( Rb , Rj . zw , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"Rk = texture2D ( Rd , Rj . xy ) ; Rg = 2.0 * ag ( Rk ) - 1.0 ; Rh = Rf . x * Rg ; Rk = texture2D ( Rd , Rj . zw ) ; Rg = 2.0 * ag ( Rk ) - 1.0 ; Rh += Rf . y * Rg ; Ri . a = sqrt ( 2.0 * length ( Rh ) ) ;".split(" ")}]}}]},{type:"textline",a:["return","Ri",";","}","}"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"vec4 Rv ( vec2 Rm , sampler2D Rn , sampler2D Ro".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Rp"]}]}}]},{type:"textline",a:") { float Rq ; vec2 Rr ; vec4 Rs , Rt , Ru ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"Rs = texture2D ( Rp , bM ) ; Rr = 2.0 * ag ( Rs ) - 1.0 ; Rs = texture2D ( Rn , Rm ) ; Rt = texture2D ( Ro , Rm - Rr ) ; Rq = abs ( Rs . a * Rs . a - Rt . a * Rt . a ) / 2.0 ; Rq = 0.5 * clamp ( 1.0 - sqrt ( Rq ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; Ru = mix ( Rs , Rt , Rq ) ; Ru . a = 1.0 ; return Ru ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Rs = texture2D ( Rn , Rm ) ; Rt = texture2D ( Ro , Rm ) ; return mix ( Rs , Rt , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Rw ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Rw = vec4 ( OW ( bM , u_color".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",
b:[{type:"textline",a:[",","u_predication_tex"]}]}}]},{type:"textline",a:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Rw = Q_ ( bM , Oo , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Rw = Rl ( bM , u_color , u_blend".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",";"]}]}},{type:"elif",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Rw = vec4 ( Rv ( bM , u_color , u_color_prev".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",")",";"]}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"Rw = texture2D ( u_color , bM ) ;".split(" ")}]}}]},{type:"textline",a:["gl_FragColor","=","Rw",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",b:[{type:"define",name:"SMAA_EDGE_DETECTION",a:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","Ok",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 Ol ; varying vec4 Om ; varying vec4 On ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","Oo",";"]}]}}]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["4"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["8"]}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["32"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void MU ( vec2 MP ) { Ol = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + MP . xyxy ; Om = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + MP . xyxy ; On = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + MP . xyxy ; }".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void MX ( vec2 MV , out vec2 MW ) { MW = MV / u_texel_size ; Ol = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + MV . xyxy ; Om = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + MV . xyxy ; On = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( Ol . xz , Om . yw ) ; }".split(" ")}]}},
{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void MZ ( vec2 MY ) { Ok = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + MY . xyxy ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { bM = 2.0 * a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["MU","(","bM",")",";"]}]}},{type:"elif",d:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"MX ( bM , Oo ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["MZ","(","bM",")",";"]}]}}]},{type:"textline",a:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",
a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",a:["1"]},{type:"define",name:"SSAO_QUALITY_16",a:["2"]},{type:"define",name:"SSAO_QUALITY_24",a:["3"]},{type:"define",name:"SSAO_QUALITY_32",a:["4"]},{type:"textline",a:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 bM ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float MU ( in vec2 MP ) { return Of ( u_depth , MP , u_camera_range ) ; } void main ( ) { float MV , MW , MX , MY , MZ , M_ ; vec3 Na , Nb , Nc , Nd ; Na = texture2D ( u_color , bM ) . rgb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_WHITE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Na , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",a:"Nb = normalize ( 2.0 * texture2D ( u_ssao_special_tex , bM * 0.25 / u_texel_size ) . rgb - 1.0 ) ; MV = MU ( bM ) ; MW = MV * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Ne = 8.0 ; const int Nf = 1 ;".split(" ")}]}},
{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Ne = 16.0 ; const int Nf = 2 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Ne = 24.0 ; const int Nf = 3 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Ne = 32.0 ; const int Nf = 4 ;".split(" ")}]}}]},
{type:"textline",a:"MX = u_ssao_radius_increase * 0.001 ; const float Ng = 1.0 + 2.4 / Ne ; MY = 0.0 ; for ( int Nh = 0 ; Nh < Nf ; Nh ++ ) for ( int Ni = - 1 ; Ni <= 1 ; Ni += 2 ) for ( int Op = - 1 ; Op <= 1 ; Op += 2 ) for ( int Oq = - 1 ; Oq <= 1 ; Oq += 2 ) { Nc = reflect ( normalize ( vec3 ( Ni , Op , Oq ) ) , Nb ) * ( MX *= Ng ) ; Nd = vec3 ( bM , MW ) ; Nd += vec3 ( Nc . xy , Nc . z * MW * 2.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",
a:"Nd . z -= 1.4 * ( Nd . z - MW ) * step ( MW , Nd . z ) ;".split(" ")}]}}]},{type:"textline",a:"MZ = MU ( Nd . xy ) * ( u_camera_range . y - u_camera_range . x ) ; M_ = clamp ( ( MW - MZ ) / MZ , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"MY += mix ( 1.0 , M_ , step ( MZ , Nd . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"MY += mix ( step ( Nd . z , MZ ) , 0.5 , M_ ) ;".split(" ")}]}}]},
{type:"textline",a:"} MY = MY / Ne ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"MY = clamp ( MY * MY + 0.6 * MY , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"MY = clamp ( MY * MY + MY , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"MV = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * MV ) ; MY = mix ( 1.0 , MY , MV ) ; gl_FragColor = vec4 ( Na , MY ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",a:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float MU ( in vec2 MP ) { return Of ( u_depth , MP , u_camera_range ) ; }".split(" ")}]}}]},
{type:"textline",a:"void main ( ) { vec2 MV , MW ; float MX , MY , MZ , M_ , Na , Nb , Nc ; MX = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"MY = MU ( bM ) ; MZ = 0.0 ; M_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{type:"textline",a:"MV = vec2 ( - 2.0 ) ; for ( int Nd = 0 ; Nd < 4 ; ++ Nd ) { for ( int Ne = 0 ; Ne < 4 ; ++ Ne ) { MW = ( MV + vec2 ( float ( Nd ) , float ( Ne ) ) ) * u_texel_size ; Na = texture2D ( u_ssao_mask , bM + MW ) . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"Nb = MU ( bM + MW ) ; Nc = 1.0 - clamp ( abs ( Nb - MY ) * M_ , 0.0 , 1.0 ) ; MX += Na * Nc ; MZ += Nc ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["MX","+=","Na",";"]}]}}]},{type:"textline",a:["}","}"]},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , MX / MZ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , MX / 16.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/stereo.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","int","u_enable_hmd_stereo",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_DISTORTION_CORRECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void Nb ( vec2 MP , vec2 MU , sampler2D MV ) { vec4 MW ; float MX ; vec2 MY , MZ , M_ , Na ; MY = ( MP - MU ) * 2.0 ; MX = MY . x * MY . x + MY . y * MY . y ; MY = MY * ( 1.0 + u_distortion_params [ 0 ] * MX + u_distortion_params [ 1 ] * MX * MX ) ; MY = MY * 0.5 * u_distortion_params [ 2 ] ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { MZ = MY * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + MX * u_chromatic_aberration_coefs [ 1 ] ) + MU ; M_ = MY + MU ; Na = MY * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + MX * u_chromatic_aberration_coefs [ 3 ] ) + MU ; if ( clamp ( Na , 0.0 , 1.0 ) != Na ) { gl_FragColor = vec4 ( 0.0 ) ; } else { MW = texture2D ( MV , M_ ) ; gl_FragColor [ 0 ] = texture2D ( MV , MZ ) . x ; gl_FragColor [ 1 ] = MW . y ; gl_FragColor [ 2 ] = texture2D ( MV , Na ) . z ; gl_FragColor [ 3 ] = MW . w ; } } else { MY += MU ; if ( clamp ( MY , 0.0 , 1.0 ) != MY ) { gl_FragColor = vec4 ( 0.0 ) ; } else { gl_FragColor = texture2D ( MV , MY ) ; } } }".split(" ")}]}}]}]}}]},
{type:"textline",a:"void main ( ) { vec2 Nc , Nd ; mat3 Ne , Nf ; vec3 Ng , Nh ; vec4 Ni , Op ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH"],group:{type:"group",b:[{type:"textline",a:"Ni = texture2D ( u_sampler_left , bM ) ; Op = texture2D ( u_sampler_right , bM ) ; Ng = vec3 ( Ni [ 0 ] , Ni [ 1 ] , Ni [ 2 ] ) ; br ( Ng ) ; Nh = vec3 ( Op [ 0 ] , Op [ 1 ] , Op [ 2 ] ) ; br ( Nh ) ; Ne = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; Nf = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; Nh = clamp ( Ne * Ng , 0.0 , 1.0 ) + clamp ( Nf * Nh , 0.0 , 1.0 ) ; bu ( Nh ) ; gl_FragColor = vec4 ( Nh , Ni [ 3 ] + Op [ 3 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( u_enable_hmd_stereo != 0 ) { if ( bM [ 0 ] < 0.5 ) { Nc = vec2 ( 2.0 * bM [ 0 ] , bM [ 1 ] ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_DISTORTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = texture2D ( u_sampler_left , Nc ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nd = vec2 ( 0.5 + u_distortion_params [ 3 ] * 0.5 , 0.5 ) ; Nb ( Nc , Nd , u_sampler_left ) ;".split(" ")}]}}]},
{type:"textline",a:"} else { Nd = vec2 ( 2.0 * ( bM [ 0 ] - 0.5 ) , bM [ 1 ] ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_DISTORTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = texture2D ( u_sampler_right , Nd ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nc = vec2 ( 0.5 - u_distortion_params [ 3 ] * 0.5 , 0.5 ) ; Nb ( Nd , Nc , u_sampler_right ) ;".split(" ")}]}}]},{type:"textline",a:"} } else { gl_FragColor = texture2D ( u_sampler_left , bM ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 bM ; void main ( ) { vec2 MP ; vec4 MU , MV ; float MW ; MW = texture2D ( u_depth , bM ) . x ; MU = vec4 ( bM * 2.0 - 1.0 , 2.0 * MW - 1.0 , 1.0 ) ; MV = u_view_proj_inverse * MU ; MV = MV / MV . w ; MV = u_view_proj_prev * MV ; MV /= MV . w ; MP = ( MU . xy - MV . xy ) / 4.0 + 0.5 ; MP = clamp ( MP , 0.0 , 1.0 ) ; gl_FragColor = V ( MP ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"float a = 0.0 ; float b = 1.0 ; struct c { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool f ( vec3 d , vec3 e ) { return any ( lessThan ( abs ( d - e ) , vec3 ( EPSILON ) ) ) ; } vec3 i ( in vec4 g , in vec3 h ) { return h + 2.0 * cross ( g . xyz , cross ( g . xyz , h ) + g . w * h ) ; } vec4 k ( in vec4 j ) { return vec4 ( - j . xyz , j . w ) / dot ( j , j ) ; } vec3 p ( vec4 l , vec4 m , vec4 n ) { vec3 o ; o = n . xyz * l . w ; o = i ( m , o ) ; o += l . xyz * n . w ; return o ; } vec3 v ( vec4 q , vec4 r , vec4 s ) { vec4 t ; vec3 u ; u = s . xyz - q . xyz * s . w ; t = k ( r ) ; u = i ( t , u ) ; u /= q . w ; return u ; } mat4 w ( ) { return mat4 ( b , a , a , a , a , b , a , a , a , a , b , a , a , a , a , b ) ; } mat4 y ( float x ) { return mat4 ( b , a , a , a , a , cos ( x ) , sin ( x ) , a , a , - sin ( x ) , cos ( x ) , a , a , a , a , b ) ; } mat4 A ( float z ) { return mat4 ( cos ( z ) , a , - sin ( z ) , a , a , b , a , a , sin ( z ) , a , cos ( z ) , a , a , a , a , b ) ; } mat4 C ( float B ) { return mat4 ( cos ( B ) , sin ( B ) , a , a , - sin ( B ) , cos ( B ) , a , a , a , a , b , a , a , a , a , b ) ; } c E ( in c D ) { return c ( D . a , D . b , normalize ( D . c ) , normalize ( D . d ) , normalize ( D . e ) , D . f ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"vec3 L ( vec4 F ) { vec3 G ; float H , I , J ; H = F . x ; I = F . y ; J = F . w ; G . x = ( H + J ) / 2.0 ; G . y = ( I + J ) / 2.0 ; G . z = J ; return G ; }".split(" ")}]}}]},{type:"textline",a:"mat4 O ( mat3 M ) { mat4 N ; N [ 0 ] [ 0 ] = ( b - ( M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 1 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 2 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 3 ] = a ; N [ 1 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) - M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 1 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 2 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 3 ] = a ; N [ 2 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 1 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 2 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 3 ] = a ; N [ 3 ] [ 0 ] = M [ 0 ] [ 0 ] ; N [ 3 ] [ 1 ] = M [ 0 ] [ 1 ] ; N [ 3 ] [ 2 ] = M [ 0 ] [ 2 ] ; N [ 3 ] [ 3 ] = 1.0 ; return N ; }".split(" ")}]};
a["include/std_enums.glsl"]={type:"group",b:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",a:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",a:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",a:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",a:["2"]},{type:"define",name:"SHADOW_SRC_NONE",a:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",a:["2"]},{type:"define",name:"SHADOW_SRC_MASK",a:["3"]},{type:"define",name:"SHADOW_DST_NONE",a:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",a:["2"]},
{type:"define",name:"SHADOW_DST_MASK",a:["3"]},{type:"define",name:"NO_SHADOWS",a:["1"]},{type:"define",name:"SHADOW_CASTING",a:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",a:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",a:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",a:["5"]},{type:"define",name:"SPECULAR_PHONG",a:["1"]},{type:"define",name:"SPECULAR_COOKTORR",a:["2"]},{type:"define",name:"SPECULAR_WARDISO",a:["3"]},{type:"define",name:"SPECULAR_BLINN",a:["4"]},{type:"define",name:"SPECULAR_TOON",
a:["5"]},{type:"define",name:"DIFFUSE_LAMBERT",a:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",a:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",a:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",a:["4"]},{type:"define",name:"DIFFUSE_TOON",a:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",a:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",a:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",a:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",a:["3.0"]},{type:"define",name:"MIX",a:["0"]},{type:"define",
name:"ADD",a:["1"]},{type:"define",name:"SUBTRACT",a:["2"]},{type:"define",name:"MULTIPLY",a:["3"]},{type:"define",name:"SCREEN",a:["4"]},{type:"define",name:"OVERLAY",a:["5"]},{type:"define",name:"DIFFERENCE",a:["6"]},{type:"define",name:"DIVIDE",a:["7"]},{type:"define",name:"DARKEN",a:["8"]},{type:"define",name:"LIGHTEN",a:["9"]},{type:"define",name:"HUE",a:["10"]},{type:"define",name:"SATURATION",a:["11"]},{type:"define",name:"VALUE",a:["12"]},{type:"define",name:"COLOR",a:["13"]},{type:"define",
name:"SOFT_LIGHT",a:["14"]},{type:"define",name:"LINEAR_LIGHT",a:["15"]},{type:"define",name:"REFL_NONE",a:["0"]},{type:"define",name:"REFL_MIRRORMAP",a:["1"]},{type:"define",name:"REFL_PLANE",a:["2"]},{type:"define",name:"REFL_CUBE",a:["3"]},{type:"define",name:"INVERSE_QUADRATIC",a:["0"]},{type:"define",name:"LINEAR",a:["1"]},{type:"define",name:"QUADRATIC",a:["2"]},{type:"define",name:"HEMI",a:["1"]},{type:"define",name:"SPOT",a:["2"]},{type:"define",name:"POINT",a:["3"]},{type:"define",name:"SUN",
a:["4"]}]};a["include/pack.glslf"]={type:"group",b:[{type:"textline",a:"float P = 255.0 ; float Q = 0.0 ; float R = 1.0 ; vec4 V ( const in float S ) { vec4 T , U ; T = vec4 ( P * P * P , P * P , P , R ) ; U = vec4 ( Q , R / P , R / P , R / P ) ; T = fract ( S * T ) ; T -= T . xxyz * U ; return T ; } float Z ( const in vec4 W ) { vec4 X ; float Y ; X = vec4 ( R / ( P * P * P ) , R / ( P * P ) , R / P , R ) ; Y = dot ( W , X ) ; return Y ; } vec4 V ( const in vec2 _ ) { vec4 aa ; vec2 ab , ac ; ab = vec2 ( P , R ) ; ac = vec2 ( Q , R / P ) ; aa = fract ( _ . xxyy * ab . xyxy ) ; aa -= aa . xxzz * ac . xyxy ; if ( _ . r == R ) aa . rg = vec2 ( Q , R ) ; if ( _ . g == R ) aa . ba = vec2 ( Q , R ) ; return aa ; } vec2 ag ( const in vec4 ad ) { vec2 ae , af ; af = vec2 ( R / P , R ) ; ae . r = dot ( ad . rg , af ) ; ae . g = dot ( ad . ba , af ) ; return ae ; }".split(" ")}]};
a["include/procedural.glslf"]={type:"group",b:[{type:"textline",a:"float ah = 0.0 ; float ai = 1.0 ; vec4 ak ( vec4 aj ) { return aj - floor ( aj * ( ai / 289.0 ) ) * 289.0 ; } vec3 ak ( vec3 al ) { return al - floor ( al * ( ai / 289.0 ) ) * 289.0 ; } vec2 ak ( vec2 am ) { return am - floor ( am * ( ai / 289.0 ) ) * 289.0 ; } vec4 ao ( vec4 an ) { return an - floor ( an * ( ai / 7.0 ) ) * 7.0 ; } vec4 aq ( vec4 ap ) { return ak ( ( 34.0 * ap + 5.0 ) * ap ) ; }".split(" ")},{type:"define",name:"K",
a:["0.142857142857"]},{type:"define",name:"K2",a:["0.0714285714285"]},{type:"define",name:"JITTER",a:["0.7"]},{type:"textline",a:"vec2 ay ( vec2 ar ) { vec4 as , at , au , av ; vec2 aw , ax ; aw = ak ( floor ( ar ) ) ; ax = fract ( ar ) ; as = ax . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; at = ax . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; au = aq ( aw . x + vec4 ( ah , ai , ah , ai ) ) ; au = aq ( au + aw . y + vec4 ( ah , ah , ai , ai ) ) ; av = ao ( au ) * K + K2 ; au = ao ( floor ( au * K ) ) * K + K2 ; av = as + JITTER * av ; au = at + JITTER * au ; au = av * av + au * au ;".split(" ")},
{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"textline",a:"au . xy = min ( au . xy , au . zw ) ; au . x = min ( au . x , au . y ) ; return au . xx ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"au . xy = ( au . x < au . y ) ? au . xy : au . yx ; au . xz = ( au . x < au . z ) ? au . xz : au . zx ; au . xw = ( au . x < au . w ) ? au . xw : au . wx ; au . y = min ( au . y , au . z ) ; au . y = min ( au . y , au . w ) ; return sqrt ( au . xy ) ;".split(" ")}]}}]},
{type:"textline",a:"} vec3 aH ( vec2 az , float aA ) { vec4 aB , aC , aD , aE ; vec2 aF , aG ; aF = ak ( floor ( az ) ) ; aG = fract ( az ) ; aB = aG . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; aC = aG . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; aD = aq ( aF . x + vec4 ( ah , ai , ah , ai ) ) ; aD = aq ( aD + aF . y + vec4 ( ah , ah , ai , ai ) ) ; aE = ao ( aD ) * K + K2 ; aD = ao ( floor ( aD * K ) ) * K + K2 ; aE = aB + JITTER * aE ; aD = aC + JITTER * aD ; aC = aE * aE + aD * aD ; aE += aA ; aD += aA ; aB = aE * aE + aD * aD ; aE += aA ; aD += aA ; aD = aE * aE + aD * aD ; aC . xy = min ( aC . xy , aC . zw ) ; aC . x = min ( aC . x , aC . y ) ; aB . xy = min ( aB . xy , aB . zw ) ; aB . x = min ( aB . x , aB . y ) ; aD . xy = min ( aD . xy , aD . zw ) ; aD . x = min ( aD . x , aD . y ) ; return vec3 ( aC . x , aB . x , aD . x ) ; } vec3 aJ ( vec3 aI ) { return ak ( ( ( aI * 34.0 ) + ai ) * aI ) ; } float aU ( vec2 aK ) { vec3 aL , aM , aN , aO ; vec4 aP ; vec2 aQ , aR , aS ; const vec4 aT = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; aQ = floor ( aK + dot ( aK , aT . yy ) ) ; aR = aK - aQ + dot ( aQ , aT . xx ) ; aS = ( aR . x > aR . y ) ? vec2 ( ai , ah ) : vec2 ( ah , ai ) ; aP = aR . xyxy + aT . xxzz ; aP . xy -= aS ; aQ = ak ( aQ ) ; aL = aJ ( aJ ( aQ . y + vec3 ( ah , aS . y , ai ) ) + aQ . x + vec3 ( ah , aS . x , ai ) ) ; aM = max ( 0.5 - vec3 ( dot ( aR , aR ) , dot ( aP . xy , aP . xy ) , dot ( aP . zw , aP . zw ) ) , ah ) ; aM = aM * aM ; aM = aM * aM ; aL = 2.0 * fract ( aL * aT . www ) - ai ; aN = abs ( aL ) - 0.5 ; aO = floor ( aL + 0.5 ) ; aO = aL - aO ; aM *= 1.79284291400159 - 0.85373472095314 * ( aO * aO + aN * aN ) ; aL . x = aO . x * aR . x + aN . x * aR . y ; aL . yz = aO . yz * aP . xz + aN . yz * aP . yw ; return 130.0 * dot ( aM , aL ) ; } vec2 aY ( vec2 aV ) { float aW , aX ; aW = dot ( aV , vec2 ( 12.9898 , 78.233 ) ) ; aX = dot ( aV , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; aW = fract ( sin ( aW ) * 43758.5453 ) * 2.0 - ai ; aX = fract ( sin ( aX ) * 43758.5453 ) * 2.0 - ai ; return vec2 ( aW , aX ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",b:[{type:"var",name:"CAUST_SPEED",a:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",a:["0.0"]},{type:"var",name:"CAUST_BRIGHT",a:["0.0"]},{type:"var",name:"SUN_NUM",a:["0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",a:["100.0"]},{type:"textline",a:"void bp ( inout vec3 aZ , float a_ , float ba , vec4 bb , vec3 bc , vec3 bd , vec3 be , vec4 bf , vec3 bg , float bh ) { float bi , bj , bk ; vec2 bl , bm ; vec3 bn ; vec4 bo ; if ( bh > CAUSTICS_VIEW_DISTANCE ) return ; bo = bf ; bn = bg + bc ; bn . xz = 10.0 * sin ( 0.1 * bn . xz ) ; bn = bn + 2.0 * cross ( - bo . xyz , cross ( - bo . xyz , bn ) + bo . w * bn ) ; bl = bn . xz ; bn = bd ; bi = max ( dot ( bc , bn ) , 0.0 ) ; bj = 0.025 ; bm = CAUST_SPEED * ba ; bl . s += 0.25 * sin ( dot ( bg + ba , vec3 ( 1.0 ) ) ) ; bl . t += 0.35 * ( - sin ( dot ( bg - ba , vec3 ( - 0.7 ) ) ) ) ; bl . st += 0.15 * cos ( 4.0 * a_ - bm . x ) + 1.5 * sin ( a_ - 0.3 * bm . y ) ; bk = CAUST_SCALE * ( 1.0 + max ( 0.1 * a_ , 0.0 ) ) ; bn = aH ( ( bl / bk ) , bj ) ; bn *= CAUST_BRIGHT ; bn *= bn ; bj = min ( 0.25 * a_ , - a_ ) + 1.0 ; bj = max ( bj , 0.0 ) ; bi = bb [ SUN_NUM ] * bi ; bk = max ( sign ( a_ ) , 0.0 ) ; bi = bi + max ( 0.5 * sign ( - bc . y ) * bk , 0.0 ) ; bi = min ( bi , 1.0 ) ; aZ += be * bn * bj * bi ; }".split(" ")}]};
a["include/color_util.glslf"]={type:"group",b:[{type:"define",name:"GAMMA",a:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",a:["1"]},{type:"textline",a:"void br ( inout vec3 bq ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bq = max ( vec3 ( 0.0 ) , bq ) ; bq = pow ( bq , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void br ( inout float bs ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",
a:"bs = pow ( max ( 0.0 , bs ) , 2.2 ) ;".split(" ")}]}}]},{type:"textline",a:"} void bu ( inout vec3 bt ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bt = max ( vec3 ( 0.0 ) , bt ) ; bt = pow ( bt , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void bx ( inout vec3 bv , in float bw ) {".split(" ")},{type:"condition",b:[{type:"if",d:["PREMULTIPLY_ALPHA"],group:{type:"group",b:[{type:"textline",a:"bv = bv * bw ;".split(" ")}]}}]},
{type:"textline",a:"} float bB ( vec4 by ) { float bz ; vec3 bA ; bA = vec3 ( 0.299 , 0.587 , 0.114 ) ; bz = dot ( by . rgb , bA ) ; return bz ; }".split(" ")}]};a["include/shadow.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",a:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",a:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float bN = 0.1 ; const float bO = 0.1 ; const float bP = - 0.01 ; const float bQ = 0.05 ; vec4 bR = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 bS = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 bT = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 bU = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 bV = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 bW = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 bX = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 bY = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool ca ( vec2 bZ , float b_ ) { return all ( lessThanEqual ( bZ , vec2 ( 1.0 + b_ ) ) ) && all ( greaterThanEqual ( bZ , vec2 ( 0.0 - b_ ) ) ) ; } float cj ( float cb , float cc , mat2 cd , vec3 ce , float cf , PRECISION sampler2D cg ) { vec2 ch , ci ; ci . x = cb ; ci . y = cc ; ci = cd * ci ; ch = ce . xy + ci * cf / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"if ( ! ca ( ch , bP ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",a:"return step ( ce . z , texture2D ( cg , ch ) . r ) ; } float cs ( vec3 ck , PRECISION sampler2D cl , float cm ) { mat2 cn ; float co , cp , cq ; co = 0.0 ; ck . z = clamp ( ck . z , 0.0 , 1.0 ) ; cp = aY ( ck . xy ) . x * M_PI ; cq = cos ( cp ) ; cp = sin ( cp ) ; cn = mat2 ( cq , cp , - cp , cq ) ; for ( int cr = 0 ; cr < 4 ; cr ++ ) { co += cj ( bR [ cr ] , bV [ cr ] , cn , ck , cm , cl ) ; co += cj ( bS [ cr ] , bW [ cr ] , cn , ck , cm , cl ) ; co += cj ( bT [ cr ] , bX [ cr ] , cn , ck , cm , cl ) ; co += cj ( bU [ cr ] , bY [ cr ] , cn , ck , cm , cl ) ; } return clamp ( co / 16.0 , 0.0 , 1.0 ) ; } float cH ( vec3 ct , PRECISION sampler2D cu , vec3 cv , PRECISION sampler2D cw , float cx , float cy , float cz ) { mat2 cA ; float cB , cC , cD , cE ; ct . z = clamp ( ct . z , 0.0 , 1.0 ) ; cv . z = clamp ( cv . z , 0.0 , 1.0 ) ; cB = 0.0 ; cC = 0.0 ; cD = aY ( ct . xy ) . x * M_PI ; cE = cos ( cD ) ; cD = sin ( cD ) ; cA = mat2 ( cE , cD , - cD , cE ) ; for ( int cF = 0 ; cF < 4 ; cF ++ ) { cB += cj ( bR [ cF ] , bV [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bS [ cF ] , bW [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bT [ cF ] , bX [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bU [ cF ] , bY [ cF ] , cA , ct , cx , cu ) ; } for ( int cG = 0 ; cG < 4 ; cG ++ ) { cC += cj ( bR [ cG ] , bV [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bS [ cG ] , bW [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bT [ cG ] , bX [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bU [ cG ] , bY [ cG ] , cA , cv , cy , cw ) ; } cB = mix ( cB , cC , cz ) ; cB /= 16.0 ; return clamp ( cB , 0.0 , 1.0 ) ; } float cL ( vec2 cI ) { float cJ , cK ; cJ = min ( cI . x , cI . y ) ; cK = min ( 1.0 - cI . x , 1.0 - cI . y ) ; return min ( cJ , cK ) ; } float cO ( float cM , float cN ) { if ( cN >= 0.0 && cN <= bO ) cM = ( cM - 1.0 ) / bO * cN + 1.0 ; return cM ; } float cZ ( vec3 cP , vec3 cQ , PRECISION sampler2D cR , PRECISION sampler2D cS , float cT , float cU , float cV , float cW ) { float cX , cY ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",b:[{type:"textline",a:"cY = cL ( cP . xy ) ; if ( - cW > cV && cY >= 0.0 && cY <= bN && ca ( cQ . xy , 0.0 ) ) { cY = 1.0 - cY / bN ; cX = cH ( cP , cR , cQ , cS , cT , cU , cY ) ; } else".split(" ")}]}}]},{type:"textline",a:"cX = cs ( cP , cR , cT ) ; return cX ; } float dg ( vec3 c_ , PRECISION sampler2D da , float db , float dc , float dd ) { float de , df ; de = cs ( c_ , da , db ) ;".split(" ")},{type:"condition",
b:[{type:"if",d:["CSM_FADE_LAST_CASCADE"],group:{type:"group",b:[{type:"textline",a:"if ( - dd > dc ) { df = cL ( c_ . xy ) ; de = cO ( de , df ) ; }".split(" ")}]}}]},{type:"textline",a:"return de ; } vec4 dr ( float dh ) { vec3 di , dj , dk , dl ; float dm , dn , dp , dq ; dm = 1.0 ; di = bI . xyz / bI . w ; if ( bI . w < 0.0 ) di . z = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"dj = bJ . xyz / bJ . w ; if ( bJ . w < 0.0 ) dj . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dk = bK . xyz / bK . w ; if ( bK . w < 0.0 ) dk . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dl = bL . xyz / bL . w ; if ( bL . w < 0.0 ) dl . z = 0.0 ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , 0.0 ) ) { dm = cZ ( di , dj , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , bQ ) ) { dm = dg ( di , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dj . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dj , dk , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dj , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dk . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dk , dl , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dk , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dl . xy , 0.0 ) ) dm = dg ( dl , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , dh ) ; }".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dn = cs ( dj , u_shadow_map1 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dn","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dp = cs ( dk , u_shadow_map2 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["dp","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dq = cs ( dl , u_shadow_map3 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dq","=","1.0",";"]}]}}]},{type:"textline",a:"return vec4 ( dm , dn , dp , dq ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 du ( inout vec3 ds ) { vec4 dt ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = texture2DProj ( u_shadow_mask , bG ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"l_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"ds *= dt . a ;".split(" ")}]}}]},{type:"textline",a:["return","dt",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = dr ( bD . z ) ; return dt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};
a["include/mirror.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"define",name:"REFL_BUMP",a:["0.1"]},{type:"textline",a:"float dB ( in vec3 dv , vec3 dw , float dx , float dy ) { float dz ; vec3 dA ; dA = normalize ( dw + dv ) ; dz = 1.0 - dot ( dv , dA ) ; dz = dy + ( 1.0 - dy ) * pow ( dz , dx ) ; return dz ; } void dP ( inout vec3 dC , vec3 dD , vec3 dE , float dF , mat4 dG ) { vec2 dH , dI ; float dJ , dK , dL ; vec3 dM , dN , dO ; dM = reflect ( - dD , dE ) ; dJ = u_fresnel_params [ 2 ] ; dK = u_fresnel_params [ 3 ] ; dL = 1.0 ; if ( dJ != 0.0 ) dL = dB ( dD , dM , dJ , dK ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_cube_reflection , dM ) . xyz ;".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"dO = u_refl_plane . xyz * dot ( dE , u_refl_plane . xyz ) ; dO = dE - dO ; dH = ( dG * vec4 ( dO , 0.0 ) ) . xy ; dI = bG . xy / bG . z ; dI += dH * REFL_BUMP ; dN = texture2D ( u_plane_reflection , dI ) . rgb ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"dN = vec3 ( 1.0 ) ; dF = 0.0 ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_mirrormap , dM ) . xyz ; dF = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",a:"br ( dN . rgb ) ; dC = mix ( dC , dN , dF * dL ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",b:[{type:"textline",a:"vec3 dS ( vec3 dQ ) { float dR ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKY_TEXTURE"],group:{type:"group",b:[{type:"textline",a:"return textureCube ( u_sky_texture , dQ ) . rgb ;".split(" ")}]}},{type:"elif",d:["SKY_COLOR"],group:{type:"group",b:[{type:"textline",a:"dR = 0.5 * dQ . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , dR ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/refraction.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"float dY ( in float dT , inout vec2 dU , in vec2 dV ) { float dW ; vec4 dX ; dX = texture2D ( u_scene_depth , dU ) ; dW = Z ( dX ) ; if ( dW < bH ) { dU = dV ; return dT ; } else { return dW ; } return dT ; }".split(" ")}]}}]},
{type:"textline",a:"vec3 ef ( in vec3 dZ , in vec2 d_ ) { vec3 ea ; float eb ; vec4 ec ; vec2 ed , ee ; ed = dZ . xy / dZ . z ; ee = ed + d_ ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"ec = texture2DProj ( u_scene_depth , dZ ) ; eb = Z ( ec ) ; dY ( eb , ee , ed ) ;".split(" ")}]}}]},{type:"textline",a:"ea = texture2D ( u_refractmap , ee ) . rgb ; br ( ea ) ; return ea ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",
b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",
a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","eg",";"]}]}}]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float eh = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"vec3 el ( in vec3 ei , in float ej ) { vec3 ek ; ek = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"ek = ef ( bG , ei . xz * ej ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"ek = texture2D ( u_refractmap , bG . xy / bG . z ) . rgb ; br ( ek ) ;".split(" ")}]}}]},{type:"textline",a:["return","ek",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eq ( vec3 em ) { float en , eo ; vec4 ep ; ep = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; ep = mix ( vec4 ( em . bg , ep . wz ) , vec4 ( em . gb , ep . xy ) , step ( em . b , em . g ) ) ; ep = mix ( vec4 ( ep . xyw , em . r ) , vec4 ( em . r , ep . yzx ) , step ( ep . x , em . r ) ) ; en = ep . x - min ( ep . w , ep . y ) ; eo = 1.0e-10 ; return vec3 ( abs ( ep . z + ( ep . w - ep . y ) / ( 6.0 * en + eo ) ) , en / ( ep . x + eo ) , ep . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eu ( vec3 er ) { vec3 es ; vec4 et ; et = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; es = abs ( fract ( vec3 ( er . r , er . r , er . r ) + et . xyz ) * 6.0 - et . www ) ; return er . b * mix ( et . xxx , clamp ( es - et . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , er . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 ew ( vec2 ev ) { return vec3 ( ev * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 ey ( vec3 ex ) { return vec2 ( ex . xy * eh + vec2 ( eh , eh ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"fm",qualifier:["vec3"],c:!0},{type:"node_out",name:"fn",qualifier:["float"],c:!0},{type:"node_out",name:"fo",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fm"],f:[{type:"textline",a:"fm = normalize ( fd . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fn"],f:[{type:"textline",a:"fn = abs ( fd . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fo"],
f:[{type:"textline",a:"fo = length ( fd . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"fp",qualifier:["float"],c:!1},{type:"node_in",name:"fq",qualifier:["float"],c:!1},{type:"node_in",name:"fr",qualifier:["float"],c:!1},{type:"node_out",name:"fs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fs = vec3 ( fp , fq , fr ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"ft",qualifier:["float"],c:!1},{type:"node_in",name:"fu",qualifier:["float"],
c:!1},{type:"node_in",name:"fv",qualifier:["float"],c:!1},{type:"node_out",name:"fw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fw = eu ( vec3 ( ft , fu , fv ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"fx",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fx = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"fy",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fy = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"fz",qualifier:["vec3"],c:!1},{type:"node_param",name:"ez",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"fz = ew ( ez ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"fA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fA = 2.0 * eg - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"fB",qualifier:["vec3"],c:!1},{type:"node_param",name:"eA",qualifier:["varying",
"vec3"],c:!1}],f:[{type:"textline",a:"fB = eA ; br ( fB ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"fC",qualifier:["float"],c:!1},{type:"node_param",name:"eB",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:"fC = eB ; br ( fC ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"fD",qualifier:["float"],c:!1},{type:"node_out",name:"fE",qualifier:["float"],c:!1},{type:"node_param",name:"eC",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",
a:"fD = eC [ 0 ] ; fE = eC [ 1 ] ; br ( fD ) ; br ( fE ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"fF",qualifier:["float"],c:!1},{type:"node_out",name:"fG",qualifier:["float"],c:!1},{type:"node_out",name:"fH",qualifier:["float"],c:!1},{type:"node_param",name:"eD",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:"fF = eD [ 0 ] ; fG = eD [ 1 ] ; fH = eD [ 2 ] ; br ( fF ) ; br ( fG ) ; br ( fH ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",
name:"fI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["fI","=","fg",";"]}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"fJ",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",a:"fJ = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"fJ = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",
name:"fK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["fK","=","eM",";"]}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"fL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fL [ 0 ] = fd [ 0 ] ; fL [ 1 ] = fd [ 1 ] ; fL [ 2 ] = fd [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"fM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fM = vec3 ( fh . r , - fh . b , fh . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"fN",
qualifier:["vec3"],c:!1},{type:"node_out",name:"fO",qualifier:["vec3"],c:!1},{type:"node_out",name:"fP",qualifier:["vec3"],c:!1},{type:"node_out",name:"fQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"fR",qualifier:["vec3"],c:!1},{type:"node_out",name:"fS",qualifier:["vec3"],c:!1},{type:"node_out",name:"fT",qualifier:["float"],c:!1},{type:"node_out",name:"fU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fN = vec3 ( ZERO_VALUE_NODES ) ; fO = vec3 ( ZERO_VALUE_NODES ) ; fP = vec3 ( ZERO_VALUE_NODES ) ; fQ = vec3 ( ZERO_VALUE_NODES ) ; fR = vec3 ( ZERO_VALUE_NODES ) ; fS = vec3 ( ZERO_VALUE_NODES ) ; fT = ZERO_VALUE_NODES ; fU = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"fV",qualifier:["float"],c:!1},{type:"node_in",name:"fW",qualifier:["float"],c:!1},{type:"node_in",name:"fX",qualifier:["float"],c:!1},{type:"node_in",name:"fY",qualifier:["float"],c:!1},{type:"node_in",name:"fZ",qualifier:["vec3"],c:!1},{type:"node_out",name:"f_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fj = eq ( fZ ) ; fj [ 0 ] += ( fV - eh ) ; if ( fj [ 0 ] > UNITY_VALUE_NODES ) fj [ 0 ] -= UNITY_VALUE_NODES ; else if ( fj [ 0 ] < ZERO_VALUE_NODES ) fj [ 0 ] += UNITY_VALUE_NODES ; fj *= vec3 ( UNITY_VALUE_NODES , fW , fX ) ; fj = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , fj , step ( vec3 ( ZERO_VALUE_NODES ) , fj ) ) , step ( fj , vec3 ( UNITY_VALUE_NODES ) ) ) ; f_ = mix ( fZ , eu ( fj ) , fY ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"ga",qualifier:["float"],c:!1},{type:"node_in",name:"gb",qualifier:["vec3"],c:!1},{type:"node_out",name:"gc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gc = mix ( gb , vec3 ( UNITY_VALUE_NODES ) - gb , ga ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"gd",qualifier:["vec3"],c:!0},{type:"node_out",name:"ge",qualifier:["vec3"],c:!1},{type:"node_out",name:"gf",qualifier:["float"],c:!1},{type:"node_out",name:"gg",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gd"],f:[{type:"textline",a:"gd = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"fe = u_lamp_light_factors [ LAMP_INDEX ] ; fj = u_lamp_light_directions [ LAMP_INDEX ] ; fk = u_lamp_light_positions [ LAMP_INDEX ] ; eX = fe . z ; if ( eX != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"ge = fk - bC ; gf = length ( ge ) ; ge = normalize ( ge ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_gg"],f:[{type:"textline",a:"gg = eX / ( eX + gf * gf ) ; eX = fe . x ; eY = fe . y ; if ( eX > - UNITY_VALUE_NODES ) { eZ = dot ( ge , fj ) ; eZ *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( eZ - eX ) / eY ) ; gg *= eZ ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ge"],f:[{type:"textline",a:["ge","=","fj",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gf"],f:[{type:"textline",a:"gf = length ( fk - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gg"],f:[{type:"textline",a:["gg","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"gh",qualifier:["vec3"],c:!1},{type:"node_out",name:"gi",qualifier:["vec3"],c:!0},{type:"node_out",name:"gj",qualifier:["float"],c:!0},{type:"node_param",name:"eE",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gi"],f:[{type:"textline",a:["gi","=","eE",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_gj"],f:[{type:"textline",a:"gj = - dot ( gh , eE ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"gk",qualifier:["vec3"],c:!1},{type:"node_out",name:"gl",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gl = - ( eN * vec4 ( gk , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"gm",qualifier:["vec3"],c:!1},{type:"node_in",name:"gn",qualifier:["float"],c:!1},{type:"node_in",name:"go",
qualifier:["float"],c:!1},{type:"node_in",name:"gp",qualifier:["float"],c:!1},{type:"node_in",name:"gq",qualifier:["vec3"],c:!1},{type:"node_in",name:"gr",qualifier:["vec3"],c:!1},{type:"node_out",name:"gs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gs","=","gm",";"]},{type:"textline",a:"gn ; go ; gp ; gq ; gr ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"gt",qualifier:["vec3"],c:!1},{type:"node_in",name:"gu",qualifier:["float"],c:!1},{type:"node_in",name:"gv",
qualifier:["vec3"],c:!1},{type:"node_out",name:"gw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gw","=","gt",";"]},{type:"textline",a:["gu",";","gv",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"gx",qualifier:["vec3"],c:!1},{type:"node_in",name:"gy",qualifier:["float"],c:!1},{type:"node_in",name:"gz",qualifier:["float"],c:!1},{type:"node_in",name:"gA",qualifier:["vec3"],c:!1},{type:"node_out",name:"gB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gB","=","gx",";"]},{type:"textline",
a:"gy ; gz ; gA ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"gC",qualifier:["vec3"],c:!1},{type:"node_in",name:"gD",qualifier:["float"],c:!1},{type:"node_in",name:"gE",qualifier:["vec3"],c:!1},{type:"node_out",name:"gF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gF","=","gC",";"]},{type:"textline",a:["gD",";","gE",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"gG",qualifier:["vec3"],c:!1},{type:"node_in",name:"gH",qualifier:["float"],c:!1},{type:"node_in",
name:"gI",qualifier:["float"],c:!1},{type:"node_in",name:"gJ",qualifier:["float"],c:!1},{type:"node_out",name:"gK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gK","=","gG",";"]},{type:"textline",a:"gH ; gI ; gJ ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"gL",qualifier:["vec3"],c:!1},{type:"node_out",name:"gM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gM","=","gL",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"gN",qualifier:["vec3"],
c:!1},{type:"node_in",name:"gO",qualifier:["vec3"],c:!1},{type:"node_out",name:"gP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gP","=","gN",";"]},{type:"textline",a:["gO",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"gQ",qualifier:["vec3"],c:!1},{type:"node_in",name:"gR",qualifier:["float"],c:!1},{type:"node_in",name:"gS",qualifier:["float"],c:!1},{type:"node_in",name:"gT",qualifier:["vec3"],c:!1},{type:"node_out",name:"gU",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"gU [ 0 ] = gU [ 1 ] = gU [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"gQ ; gR ; gS ; gT ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"gV",qualifier:["vec3"],c:!1},{type:"node_in",name:"gW",qualifier:["float"],c:!1},{type:"node_in",name:"gX",qualifier:["float"],c:!1},{type:"node_in",name:"gY",qualifier:["vec3"],c:!1},{type:"node_out",name:"gZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gZ","=","gV",";"]},{type:"textline",a:"gW ; gX ; gY ;".split(" ")}]},
{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"g_",qualifier:["vec3"],c:!1},{type:"node_in",name:"ha",qualifier:["float"],c:!1},{type:"node_in",name:"hb",qualifier:["vec3"],c:!1},{type:"node_out",name:"hc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hc","=","g_",";"]},{type:"textline",a:["ha",";","hb",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",h:[{type:"node_in",name:"hd",qualifier:["vec3"],c:!1},{type:"node_in",name:"he",qualifier:["float"],c:!1},{type:"node_in",name:"hf",
qualifier:["vec3"],c:!1},{type:"node_in",name:"hg",qualifier:["float"],c:!1},{type:"node_in",name:"hh",qualifier:["float"],c:!1},{type:"node_in",name:"hi",qualifier:["vec3"],c:!1},{type:"node_out",name:"hj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hj [ 0 ] = hj [ 1 ] = hj [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"hd ; hf ; hg ; hh ; hi ; he ;".split(" ")}]},{type:"node",name:"EMISSION",h:[{type:"node_in",name:"hk",qualifier:["vec3"],c:!1},{type:"node_in",name:"hl",qualifier:["float"],
c:!1},{type:"node_out",name:"hm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hm","=","hk",";"]},{type:"textline",a:["hl",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"hn",qualifier:["vec3"],c:!1},{type:"node_out",name:"ho",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ho [ 0 ] = ho [ 1 ] = ho [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hn",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"hp",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"hp [ 0 ] = hp [ 1 ] = hp [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"hq",qualifier:["vec3"],c:!1},{type:"node_in",name:"hr",qualifier:["float"],c:!1},{type:"node_out",name:"hs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hs [ 0 ] = hs [ 1 ] = hs [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hq",";","hr",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"ht",qualifier:["vec3"],c:!1},{type:"node_in",
name:"hu",qualifier:["float"],c:!1},{type:"node_in",name:"hv",qualifier:["float"],c:!1},{type:"node_out",name:"hw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hw [ 0 ] = hw [ 1 ] = hw [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"ht ; hu ; hv ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"hx",qualifier:["float"],c:!1},{type:"node_in",name:"hy",qualifier:["float"],c:!1},{type:"node_in",name:"hz",qualifier:["float"],c:!1},{type:"node_in",name:"hA",qualifier:["vec3"],
c:!1},{type:"node_out",name:"hB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hB","=","hA",";"]},{type:"textline",a:"hx ; hy ; hz ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"hC",qualifier:["float"],c:!1},{type:"node_in",name:"hD",qualifier:["vec3"],c:!1},{type:"node_out",name:"hE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hE","=","hD",";"]},{type:"textline",a:["hC",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"hF",qualifier:["vec3"],
c:!1},{type:"node_out",name:"hG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hG [ 0 ] = hG [ 1 ] = hG [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hF",";"]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"hH",qualifier:["float"],c:!1},{type:"node_out",name:"hI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hI [ 0 ] = hI [ 1 ] = hI [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hH",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"hJ",qualifier:["float"],
c:!1},{type:"node_out",name:"hK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hK [ 0 ] = hK [ 1 ] = hK [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hJ",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"hL",qualifier:["vec3"],c:!1},{type:"node_out",name:"hM",qualifier:["float"],c:!1},{type:"node_out",name:"hN",qualifier:["float"],c:!1},{type:"node_out",name:"hO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"hM = hL [ 0 ] ; hN = hL [ 1 ] ; hO = hL [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"hP",qualifier:["float"],c:!1},{type:"node_in",name:"hQ",qualifier:["float"],c:!1},{type:"node_in",name:"hR",qualifier:["float"],c:!1},{type:"node_out",name:"hS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hS [ 0 ] = hP ; hS [ 1 ] = hQ ; hS [ 2 ] = hR ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"hT",qualifier:["vec3"],c:!1},{type:"node_in",name:"hU",qualifier:["float"],c:!1},{type:"node_in",name:"hV",qualifier:["float"],
c:!1},{type:"node_out",name:"hW",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eZ = hU - hV * eh ; hW = max ( ( UNITY_VALUE_NODES + hV ) * hT + eZ , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"hX",qualifier:["float"],c:!1},{type:"node_in",name:"hY",qualifier:["float"],c:!1},{type:"node_out",name:"hZ",qualifier:["float"],c:!1},{type:"node_out",name:"h_",qualifier:["float"],c:!1},{type:"node_out",name:"ia",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"hZ = h_ = ia = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hX",";","hY",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"ib",qualifier:["vec3"],c:!1},{type:"node_out",name:"ic",qualifier:["vec3"],c:!1},{type:"node_out",name:"id",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ic [ 0 ] = ic [ 1 ] = ic [ 2 ] = ZERO_VALUE_NODES ; id = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["ib",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"ie",qualifier:["vec3"],
c:!1},{type:"node_out",name:"ig",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ig [ 0 ] = ig [ 1 ] = ig [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ie",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"ih",qualifier:["vec3"],c:!1},{type:"node_out",name:"ii",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ii [ 0 ] = ii [ 1 ] = ii [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ih",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"ij",qualifier:["vec3"],
c:!1},{type:"node_in",name:"ik",qualifier:["float"],c:!1},{type:"node_in",name:"il",qualifier:["float"],c:!1},{type:"node_in",name:"im",qualifier:["float"],c:!1},{type:"node_out",name:"io",qualifier:["vec3"],c:!1},{type:"node_out",name:"ip",qualifier:["float"],c:!1}],f:[{type:"textline",a:"io [ 0 ] = io [ 1 ] = io [ 2 ] = ZERO_VALUE_NODES ; ip = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"ij ; ik ; il ; im ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"iq",qualifier:["vec3"],
c:!1},{type:"node_in",name:"ir",qualifier:["float"],c:!1},{type:"node_in",name:"is",qualifier:["float"],c:!1},{type:"node_in",name:"it",qualifier:["float"],c:!1},{type:"node_in",name:"iu",qualifier:["float"],c:!1},{type:"node_out",name:"iv",qualifier:["vec3"],c:!1},{type:"node_out",name:"iw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iv [ 0 ] = iv [ 1 ] = iv [ 2 ] = ZERO_VALUE_NODES ; iw = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iq ; ir ; is ; it ; iu ;".split(" ")}]},{type:"node",
name:"TEX_VORONOI",h:[{type:"node_in",name:"ix",qualifier:["vec3"],c:!1},{type:"node_in",name:"iy",qualifier:["float"],c:!1},{type:"node_out",name:"iz",qualifier:["vec3"],c:!1},{type:"node_out",name:"iA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iz [ 0 ] = iz [ 1 ] = iz [ 2 ] = ZERO_VALUE_NODES ; iA = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["ix",";","iy",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",name:"iB",qualifier:["vec3"],c:!1},{type:"node_in",name:"iC",qualifier:["float"],
c:!1},{type:"node_in",name:"iD",qualifier:["float"],c:!1},{type:"node_in",name:"iE",qualifier:["float"],c:!1},{type:"node_in",name:"iF",qualifier:["float"],c:!1},{type:"node_in",name:"iG",qualifier:["float"],c:!1},{type:"node_in",name:"iH",qualifier:["float"],c:!1},{type:"node_out",name:"iI",qualifier:["vec3"],c:!1},{type:"node_out",name:"iJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iI [ 0 ] = iI [ 1 ] = iI [ 2 ] = ZERO_VALUE_NODES ; iJ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"iB ; iC ; iD ; iE ; iF ; iG ; iH ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"iK",qualifier:["vec3"],c:!1},{type:"node_out",name:"iL",qualifier:["vec3"],c:!1},{type:"node_out",name:"iM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iL [ 0 ] = iL [ 1 ] = iL [ 2 ] = ZERO_VALUE_NODES ; iM = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["iK",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"iN",qualifier:["vec3"],c:!1},{type:"node_in",name:"iO",
qualifier:["float"],c:!1},{type:"node_in",name:"iP",qualifier:["float"],c:!1},{type:"node_out",name:"iQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"iR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iQ [ 0 ] = iQ [ 1 ] = iQ [ 2 ] = ZERO_VALUE_NODES ; iR = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iN ; iO ; iP ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"iS",qualifier:["vec3"],c:!1},{type:"node_in",name:"iT",qualifier:["vec3"],c:!1},{type:"node_in",name:"iU",
qualifier:["vec3"],c:!1},{type:"node_in",name:"iV",qualifier:["float"],c:!1},{type:"node_out",name:"iW",qualifier:["vec3"],c:!1},{type:"node_out",name:"iX",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iW [ 0 ] = iW [ 1 ] = iW [ 2 ] = ZERO_VALUE_NODES ; iX = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iS ; iT ; iU ; iV ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"iY",qualifier:["vec3"],c:!1},{type:"node_in",name:"iZ",qualifier:["vec3"],c:!1},{type:"node_in",
name:"i_",qualifier:["vec3"],c:!1},{type:"node_in",name:"ja",qualifier:["vec3"],c:!1},{type:"node_in",name:"jb",qualifier:["float"],c:!1},{type:"node_in",name:"jc",qualifier:["float"],c:!1},{type:"node_in",name:"jd",qualifier:["float"],c:!1},{type:"node_in",name:"je",qualifier:["float"],c:!1},{type:"node_in",name:"jf",qualifier:["float"],c:!1},{type:"node_out",name:"jg",qualifier:["vec3"],c:!1},{type:"node_out",name:"jh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jg [ 0 ] = jg [ 1 ] = jg [ 2 ] = ZERO_VALUE_NODES ; jh = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"iY ; iZ ; i_ ; ja ; jb ; jc ; jd ; je ; jf ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"ji",qualifier:["vec3"],c:!1},{type:"node_in",name:"jj",qualifier:["vec3"],c:!1},{type:"node_out",name:"jk",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jk = clamp ( ji + jj , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"jl",qualifier:["float"],c:!1},{type:"node_in",name:"jm",
qualifier:["vec3"],c:!1},{type:"node_in",name:"jn",qualifier:["vec3"],c:!1},{type:"node_out",name:"jo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eZ = clamp ( jl , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; jo = eZ * jm + ( UNITY_VALUE_NODES - eZ ) * jn ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"jp",qualifier:["vec3"],c:!1},{type:"node_out",name:"jq",qualifier:["vec3"],c:!1},{type:"node_param",name:"eF",qualifier:["varying","vec2"],c:!1}],f:[{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_jp"],f:[{type:"textline",a:"jp = ew ( eF ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_jq"],f:[{type:"textline",a:"jq = vec3 ( eF , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"jr",qualifier:["vec3"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jr = vec3 ( eG , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",
name:"js",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["js","=","fi",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"jt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["jt","=","eg",";"]}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"ju",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ju [ 0 ] = ju [ 1 ] = ju [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"jv",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jv [ 0 ] = fd [ 0 ] ; jv [ 1 ] = fd [ 1 ] ; jv [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",h:[{type:"node_out",name:"jw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jw [ 0 ] = jw [ 1 ] = jw [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"jx",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jx [ 0 ] = jx [ 1 ] = jx [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"jy",
qualifier:["vec3"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jy = vec3 ( eH , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_out",name:"jz",qualifier:["float"],c:!1},{type:"node_out",name:"jA",qualifier:["float"],c:!1},{type:"node_out",name:"jB",qualifier:["float"],c:!1},{type:"node_out",name:"jC",qualifier:["vec3"],c:!1},{type:"node_out",name:"jD",qualifier:["float"],c:!1},{type:"node_out",name:"jE",qualifier:["vec3"],
c:!1},{type:"node_out",name:"jF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jz = ZERO_VALUE_NODES ; jA = ZERO_VALUE_NODES ; jB = ZERO_VALUE_NODES ; jC = vec3 ( ZERO_VALUE_NODES ) ; jD = ZERO_VALUE_NODES ; jE = jC ; jF = jC ;".split(" ")}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"jG",qualifier:["float"],c:!1},{type:"node_out",name:"jH",qualifier:["float"],c:!1},{type:"node_out",name:"jI",qualifier:["float"],c:!1},{type:"node_out",name:"jJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jG = ZERO_VALUE_NODES ; jH = ZERO_VALUE_NODES ; jI = ZERO_VALUE_NODES ; jJ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"jK",qualifier:["vec3"],c:!1},{type:"node_out",name:"jL",qualifier:["float"],c:!1},{type:"node_out",name:"jM",qualifier:["float"],c:!1},{type:"node_out",name:"jN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jL = ZERO_VALUE_NODES ; jM = ZERO_VALUE_NODES ; jN = ZERO_VALUE_NODES ; jK = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"jO",qualifier:["float"],c:!1},{type:"node_out",name:"jP",qualifier:["float"],c:!1}],f:[{type:"textline",a:["jP","=","jO",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"jQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jQ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"jR",qualifier:["float"],c:!1},{type:"node_in",name:"jS",qualifier:["vec3"],c:!1},{type:"node_out",name:"jT",
qualifier:["float"],c:!1},{type:"node_out",name:"jU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jT = jU = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["jS",";","jR",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"jV",qualifier:["float"],c:!1},{type:"node_out",name:"jW",qualifier:["float"],c:!1},{type:"node_out",name:"jX",qualifier:["float"],c:!1},{type:"node_out",name:"jY",qualifier:["float"],c:!1},{type:"node_out",name:"jZ",qualifier:["float"],c:!1},{type:"node_out",
name:"j_",qualifier:["float"],c:!1},{type:"node_out",name:"ka",qualifier:["float"],c:!1},{type:"node_out",name:"kb",qualifier:["float"],c:!1},{type:"node_out",name:"kc",qualifier:["float"],c:!1},{type:"node_out",name:"kd",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jV = jW = jX = ZERO_VALUE_NODES ; jY = jZ = j_ = ZERO_VALUE_NODES ; ka = ka = kc = kd = ZERO_VALUE_NODES ; kb = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"ke",qualifier:["vec3"],c:!1},
{type:"node_out",name:"kf",qualifier:["vec3"],c:!1},{type:"node_out",name:"kg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ke = kf = vec3 ( ZERO_VALUE_NODES ) ; kg = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"kh",qualifier:["float"],c:!1},{type:"node_in",name:"ki",qualifier:["vec3"],c:!1},{type:"node_out",name:"kj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kj","=","ki",";"]},{type:"node_condition",b:[{type:"node_if",
d:["READ_R"],f:[{type:"textline",a:"kj . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * ki . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"kj . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * ki . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"kj . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * ki . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{type:"textline",a:"kj = mix ( ki , kj , kh ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"kk",qualifier:["float"],c:!1},{type:"node_in",name:"kl",qualifier:["vec3"],c:!1},{type:"node_out",name:"km",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"eZ = texture2D ( u_nodes_texture , vec2 ( kl . r , NODE_TEX_ROW ) ) . a ; eY = texture2D ( u_nodes_texture , vec2 ( kl . g , NODE_TEX_ROW ) ) . a ; eX = texture2D ( u_nodes_texture , vec2 ( kl . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"eZ = kl . r ; eY = kl . g ; eX = kl . b ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"km . r = texture2D ( u_nodes_texture , vec2 ( eZ , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"km . r = eZ ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"km . g = texture2D ( u_nodes_texture , vec2 ( eY , NODE_TEX_ROW ) ) . g ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"km . g = eY ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"km . b = texture2D ( u_nodes_texture , vec2 ( eX , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"km . b = eX ;".split(" ")}]}]},{type:"textline",a:"km = mix ( kl , km , kk ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"kn",qualifier:["float"],c:!1},{type:"node_out",name:"ko",qualifier:["vec3"],
c:!1},{type:"node_out",name:"kp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fe = texture2D ( u_nodes_texture , vec2 ( kn , NODE_TEX_ROW ) ) ; ko = fe . rgb ; kp = fe . a ;".split(" ")}]},{type:"node",name:"MAPPING",h:[{type:"node_in",name:"kq",qualifier:["vec3"],c:!1},{type:"node_out",name:"kr",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kr","=","kq",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"kr = ( MAPPING_TRS_MATRIX * vec4 ( kr , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"kr = kr * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"kr = kr + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"kr = max ( kr , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",
a:"kr = min ( kr , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"kr = normalize ( kr ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"ks",qualifier:["float"],c:!1},{type:"node_in",name:"kt",qualifier:["float"],c:!1},{type:"node_out",name:"ku",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ku = ks + kt ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"ku = clamp ( ku , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"kv",qualifier:["float"],c:!1},{type:"node_in",name:"kw",qualifier:["float"],c:!1},{type:"node_out",name:"kx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kx = kv - kw ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kx = clamp ( kx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",
name:"MATH_MULTIPLY",h:[{type:"node_in",name:"ky",qualifier:["float"],c:!1},{type:"node_in",name:"kz",qualifier:["float"],c:!1},{type:"node_out",name:"kA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kA = ky * kz ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kA = clamp ( kA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"kB",qualifier:["float"],c:!1},{type:"node_in",name:"kC",
qualifier:["float"],c:!1},{type:"node_out",name:"kD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kD = ( kC != ZERO_VALUE_NODES ) ? kB / kC : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kD = clamp ( kD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"kE",qualifier:["float"],c:!1},{type:"node_in",name:"kF",qualifier:["float"],c:!1},{type:"node_out",name:"kG",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"kG = sin ( kE ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kG = clamp ( kG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kF",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"kH",qualifier:["float"],c:!1},{type:"node_in",name:"kI",qualifier:["float"],c:!1},{type:"node_out",name:"kJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kJ = cos ( kH ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kJ = clamp ( kJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kI",";"]}]},{type:"node",name:"MATH_TANGENT",h:[{type:"node_in",name:"kK",qualifier:["float"],c:!1},{type:"node_in",name:"kL",qualifier:["float"],c:!1},{type:"node_out",name:"kM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kM = tan ( kK ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],
f:[{type:"textline",a:"kM = clamp ( kM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kL",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"kN",qualifier:["float"],c:!1},{type:"node_in",name:"kO",qualifier:["float"],c:!1},{type:"node_out",name:"kP",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kP = ( kN <= UNITY_VALUE_NODES && kN >= - UNITY_VALUE_NODES ) ? asin ( kN ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kP = clamp ( kP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kO",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"kQ",qualifier:["float"],c:!1},{type:"node_in",name:"kR",qualifier:["float"],c:!1},{type:"node_out",name:"kS",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kS = ( kQ <= UNITY_VALUE_NODES && kQ >= - UNITY_VALUE_NODES ) ? acos ( kQ ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kS = clamp ( kS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kR",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"kT",qualifier:["float"],c:!1},{type:"node_in",name:"kU",qualifier:["float"],c:!1},{type:"node_out",name:"kV",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kV = atan ( kT ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"kV = clamp ( kV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kU",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"kW",qualifier:["float"],c:!1},{type:"node_in",name:"kX",qualifier:["float"],c:!1},{type:"node_out",name:"kY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( kW < ZERO_VALUE_NODES && kX != floor ( kX ) ) kY = ZERO_VALUE_NODES ; else if ( kX == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"kY = UNITY_VALUE_NODES ; else if ( kW < ZERO_VALUE_NODES ) kY = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - kX , 2.0 ) ) ) * pow ( - kW , kX ) ; else if ( kW == ZERO_VALUE_NODES ) kY = ZERO_VALUE_NODES ; else kY = pow ( kW , kX ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kY = clamp ( kY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"kZ",qualifier:["float"],c:!1},{type:"node_in",name:"k_",qualifier:["float"],c:!1},{type:"node_out",name:"la",qualifier:["float"],c:!1}],f:[{type:"textline",a:"la = ( kZ > ZERO_VALUE_NODES && k_ > ZERO_VALUE_NODES ) ? log2 ( kZ ) / log2 ( k_ ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"la = clamp ( la , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"lb",qualifier:["float"],c:!1},{type:"node_in",name:"lc",qualifier:["float"],c:!1},{type:"node_out",name:"ld",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ld = min ( lb , lc ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ld = clamp ( ld , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"le",qualifier:["float"],c:!1},{type:"node_in",name:"lf",qualifier:["float"],c:!1},{type:"node_out",name:"lg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lg = max ( le , lf ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lg = clamp ( lg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"lh",qualifier:["float"],c:!1},
{type:"node_in",name:"li",qualifier:["float"],c:!1},{type:"node_out",name:"lj",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lj = floor ( lh + eh ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lj = clamp ( lj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["li",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"lk",qualifier:["float"],c:!1},{type:"node_in",name:"ll",qualifier:["float"],c:!1},
{type:"node_out",name:"lm",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lm = ( lk < ll ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lm = clamp ( lm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"ln",qualifier:["float"],c:!1},{type:"node_in",name:"lo",qualifier:["float"],c:!1},{type:"node_out",name:"lp",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"lp = ( ln > lo ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lp = clamp ( lp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"lq",qualifier:["float"],c:!1},{type:"node_in",name:"lr",qualifier:["float"],c:!1},{type:"node_out",name:"ls",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ls = abs ( lr ) > 0.000001 ? mod ( lq , lr ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ls = clamp ( ls , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"lt",qualifier:["float"],c:!1},{type:"node_in",name:"lu",qualifier:["float"],c:!1},{type:"node_out",name:"lv",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lv = abs ( lt ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lv = clamp ( lv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["lu",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"lw",qualifier:["float"],c:!1},{type:"node_in",name:"lx",qualifier:["vec3"],c:!1},{type:"node_in",name:"ly",qualifier:["vec3"],c:!1},{type:"node_out",name:"lz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lz = mix ( lx , ly , eX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lz = clamp ( lz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"lA",qualifier:["float"],c:!1},{type:"node_in",name:"lB",qualifier:["vec3"],c:!1},{type:"node_in",name:"lC",qualifier:["vec3"],c:!1},{type:"node_out",name:"lD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lD = mix ( lB , lB + lC , eX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"lE",qualifier:["float"],c:!1},{type:"node_in",name:"lF",qualifier:["vec3"],c:!1},{type:"node_in",name:"lG",qualifier:["vec3"],c:!1},{type:"node_out",name:"lH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lH = mix ( lF , lF * lG , eX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lH = clamp ( lH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"lI",qualifier:["float"],c:!1},{type:"node_in",name:"lJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"lK",qualifier:["vec3"],c:!1},{type:"node_out",name:"lL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lL = mix ( lJ , lJ - lK , eX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lL = clamp ( lL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"lM",qualifier:["float"],c:!1},{type:"node_in",name:"lN",qualifier:["vec3"],c:!1},{type:"node_in",name:"lO",qualifier:["vec3"],c:!1},{type:"node_out",name:"lP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = UNITY_VALUE_NODES - eX ; lP = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( eY ) + eX * ( vec3 ( UNITY_VALUE_NODES ) - lO ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lN ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lP = clamp ( lP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"lQ",qualifier:["float"],c:!1},{type:"node_in",name:"lR",qualifier:["vec3"],c:!1},{type:"node_in",name:"lS",qualifier:["vec3"],c:!1},{type:"node_out",name:"lT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = UNITY_VALUE_NODES - eX ; lS += step ( lS , vec3 ( ZERO_VALUE_NODES ) ) ; lT = eY * lR + eX * lR / lS ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lT = clamp ( lT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"lU",qualifier:["float"],c:!1},{type:"node_in",name:"lV",qualifier:["vec3"],c:!1},{type:"node_in",name:"lW",qualifier:["vec3"],c:!1},{type:"node_out",name:"lX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lX = mix ( lV , abs ( lV - lW ) , eX ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lX = clamp ( lX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"lY",qualifier:["float"],c:!1},{type:"node_in",name:"lZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"l_",qualifier:["vec3"],c:!1},{type:"node_out",name:"ma",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ma = min ( lZ . rgb , l_ . rgb * eX ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"ma = clamp ( ma , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"mb",qualifier:["float"],c:!1},{type:"node_in",name:"mc",qualifier:["vec3"],c:!1},{type:"node_in",name:"md",qualifier:["vec3"],c:!1},{type:"node_out",name:"me",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; me = max ( mc . rgb , md . rgb * eX ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"me = clamp ( me , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"mf",qualifier:["float"],c:!1},{type:"node_in",name:"mg",qualifier:["vec3"],c:!1},{type:"node_in",name:"mh",qualifier:["vec3"],c:!1},{type:"node_out",name:"mi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fk = vec3 ( UNITY_VALUE_NODES - eX ) ; mi = mix ( mg * ( fk + 2.0 * eX * mh ) , vec3 ( UNITY_VALUE_NODES ) - ( fk + 2.0 * eX * ( vec3 ( UNITY_VALUE_NODES ) - mh ) ) * ( vec3 ( UNITY_VALUE_NODES ) - mg ) , step ( eh , mg ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mi = clamp ( mi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"mj",qualifier:["float"],c:!1},{type:"node_in",name:"mk",qualifier:["vec3"],c:!1},{type:"node_in",name:"ml",qualifier:["vec3"],c:!1},{type:"node_out",name:"mm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fk = vec3 ( UNITY_VALUE_NODES ) - eX * ml ; fj = clamp ( mk / fk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mm = mix ( mix ( fj , vec3 ( UNITY_VALUE_NODES ) , step ( fk , vec3 ( ZERO_VALUE_NODES ) ) ) , mk , step ( mk , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mm = clamp ( mm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"mn",qualifier:["float"],c:!1},{type:"node_in",name:"mo",qualifier:["vec3"],c:!1},{type:"node_in",name:"mp",qualifier:["vec3"],c:!1},{type:"node_out",name:"mq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fk = vec3 ( UNITY_VALUE_NODES - eX ) ; fk = fk + eX * mp ; fj = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - mo ) / fk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mq = mix ( fj , vec3 ( ZERO_VALUE_NODES ) , step ( fk , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mq = clamp ( mq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"mr",qualifier:["float"],c:!1},{type:"node_in",name:"ms",qualifier:["vec3"],c:!1},{type:"node_in",name:"mt",qualifier:["vec3"],c:!1},{type:"node_out",name:"mu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mu = ms ; fj = eq ( mt ) ; if ( fj . y != ZERO_VALUE_NODES ) { fk = eq ( mu ) ; fk . x = fj . x ; fl = eu ( fk ) ; mu = mix ( mu , fl , eX ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mu = clamp ( mu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"mv",qualifier:["float"],c:!1},{type:"node_in",name:"mw",qualifier:["vec3"],c:!1},{type:"node_in",name:"mx",qualifier:["vec3"],c:!1},{type:"node_out",name:"my",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = UNITY_VALUE_NODES - eX ; my = mw ; fl = eq ( my ) ; if ( fl . y != ZERO_VALUE_NODES ) { fk = eq ( mx ) ; fl . y = eY * fl . y + eX * fk . y ; my = eu ( fl ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"my = clamp ( my , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"mz",qualifier:["float"],c:!1},{type:"node_in",name:"mA",qualifier:["vec3"],c:!1},{type:"node_in",name:"mB",qualifier:["vec3"],c:!1},{type:"node_out",name:"mC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = UNITY_VALUE_NODES - eX ; fl = eq ( mA ) ; fk = eq ( mB ) ; fl . z = eY * fl . z + eX * fk . z ; mC = eu ( fl ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mC = clamp ( mC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"mD",qualifier:["float"],c:!1},{type:"node_in",name:"mE",qualifier:["vec3"],c:!1},{type:"node_in",name:"mF",qualifier:["vec3"],c:!1},{type:"node_out",name:"mG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mG = mE ; fk = eq ( mF ) ; if ( fk . y != ZERO_VALUE_NODES ) { fl = eq ( mG ) ; fl . x = fk . x ; fl . y = fk . y ; fj = eu ( fl ) ; mG = mix ( mG , fj , eX ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mG = clamp ( mG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"mH",qualifier:["float"],c:!1},{type:"node_in",name:"mI",qualifier:["vec3"],c:!1},{type:"node_in",name:"mJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"mK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = UNITY_VALUE_NODES - eX ; fj = mJ + mI - mJ * mI ; mK = mI * ( vec3 ( eY ) + vec3 ( eX ) * ( ( vec3 ( UNITY_VALUE_NODES ) - mI ) * mJ + fj ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mK = clamp ( mK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"mL",qualifier:["float"],c:!1},{type:"node_in",name:"mM",qualifier:["vec3"],c:!1},{type:"node_in",name:"mN",qualifier:["vec3"],c:!1},{type:"node_out",name:"mO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"eX = clamp ( mL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mO = mM + eX * ( 2.0 * mN - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mO = clamp ( mO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"mP",qualifier:["vec3"],c:!1},{type:"node_in",name:"mQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eO = mP ; eS = mQ ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"mR",qualifier:["vec3"],c:!1},{type:"node_in",name:"mS",qualifier:["vec3"],c:!1},{type:"node_in",
name:"mT",qualifier:["float"],c:!1},{type:"node_in",name:"mU",qualifier:["vec3"],c:!0},{type:"node_in",name:"mV",qualifier:["float"],c:!0},{type:"node_out",name:"mW",qualifier:["vec3"],c:!1},{type:"node_out",name:"mX",qualifier:["vec3"],c:!1},{type:"node_out",name:"mY",qualifier:["vec3"],c:!1},{type:"node_out",name:"mZ",qualifier:["vec3"],c:!1},{type:"node_out",name:"m_",qualifier:["vec3"],c:!1},{type:"node_out",name:"na",qualifier:["vec2"],c:!1},{type:"node_out",name:"nb",qualifier:["vec2"],c:!1},
{type:"node_out",name:"nc",qualifier:["vec4"],c:!1},{type:"node_param",name:"eI",qualifier:["const","vec2"],c:!1},{type:"node_param",name:"eJ",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"mY = clamp ( mR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"mZ = eJ [ 0 ] * clamp ( mS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"m_ = normalize ( mU ) ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:["m_","=","fi",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"mW = mV * mY ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"mW = eV * mY ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:["mY","*=","mT",";"]}]}]},{type:"textline",a:"mX = eW * u_environment_energy * dS ( m_ ) ; nc = du ( mY ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"na = vec2 ( eI [ 0 ] , eI [ 1 ] ) ;".split(" ")},{type:"textline",a:"nb = vec2 ( eJ [ 1 ] , eJ [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["eR","=","nc",";"]}]},{type:"node_else",f:[{type:"textline",a:"mW = vec3 ( ZERO_VALUE_NODES ) ; mX = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"nd",qualifier:["vec4"],c:!1},{type:"node_in",name:"ne",
qualifier:["vec3"],c:!1},{type:"node_in",name:"nf",qualifier:["vec3"],c:!1},{type:"node_in",name:"ng",qualifier:["float"],c:!0},{type:"node_in",name:"nh",qualifier:["float"],c:!0},{type:"node_in",name:"ni",qualifier:["float"],c:!0},{type:"node_out",name:"nj",qualifier:["vec3"],c:!0},{type:"node_out",name:"nk",qualifier:["float"],c:!0},{type:"node_out",name:"nl",qualifier:["vec3"],c:!0},{type:"node_out",name:"nm",qualifier:["vec3"],c:!0},{type:"node_out",name:"nn",qualifier:["vec3"],c:!0},{type:"node_param",
name:"eK",qualifier:["float"],c:!1},{type:"node_param",name:"eL",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nj"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"nj = nd . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"nj = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",e:2},{type:"logical_and_expr",
e:2}],f:[{type:"node_condition",b:[{type:"node_if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],f:[{type:"textline",a:"dP ( nj , eM , nf , ng , eN ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"dP ( nj , eM , nf , ng , mat4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["nj","+=","ne",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nl"],f:[{type:"textline",a:["nl",
"=","nf",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nm"],f:[{type:"textline",a:"nm = nd . rgb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nn"],f:[{type:"textline",a:["nn","=","ne",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nk"],f:[{type:"textline",a:"nk = clamp ( ni , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],
f:[{type:"textline",a:"eX = max ( max ( ne . r , ne . g ) , ne . b ) * nh ; nk = clamp ( ni * ( UNITY_VALUE_NODES - eX ) + eX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nk"],f:[{type:"textline",a:"nk = clamp ( eK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"eX = max ( max ( ne . r , ne . g ) , ne . b ) * eL ; nk = eK * ( UNITY_VALUE_NODES - eX ) + eX ;".split(" ")}]}]}]}]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["eP","=","ne",";"]}]},{type:"node_else",f:[{type:"textline",a:"eP = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["eQ","=","nf",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"no",qualifier:["vec3"],c:!1},{type:"node_in",name:"np",qualifier:["vec3"],c:!1},{type:"node_in",name:"nq",qualifier:["vec3"],c:!1},{type:"node_out",name:"nr",qualifier:["vec4"],c:!1},{type:"node_out",
name:"ns",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"nr = vec4 ( no + nq * np , ZERO_VALUE_NODES ) ; ns = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"nt",qualifier:["vec4"],c:!1},{type:"node_out",name:"nu",qualifier:["vec3"],c:!1},{type:"node_out",name:"nv",qualifier:["vec2"],c:!1},{type:"node_out",name:"nw",qualifier:["vec3"],c:!1},{type:"node_out",name:"nx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nv = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",a:["nx","=","eh",";"]}]},{type:"node_else",f:[{type:"textline",a:["nx","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"nw = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"nw *= nt [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"fj = u_light_positions [ LAMP_IND ] ; nu = fj - fh ;".split(" ")},{type:"textline",a:"eX = length ( nu ) ; nw *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + eX * eX ) ; nu = normalize ( nu ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"fj = u_light_directions [ LAMP_IND ] ; eX = dot ( nu , fj ) ; eX *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( eX - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nw *= eX ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"nu = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"ny",qualifier:["vec3"],c:!1},{type:"node_in",name:"nz",qualifier:["vec2"],c:!1},{type:"node_in",name:"nA",qualifier:["vec3"],c:!1},{type:"node_in",name:"nB",qualifier:["float"],c:!1},{type:"node_in",name:"nC",qualifier:["vec2"],c:!1},{type:"node_out",name:"nD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nD = ZERO_VALUE_NODES ; if ( nz . r != ZERO_VALUE_NODES ) { eX = ( UNITY_VALUE_NODES - nB ) * dot ( nA , ny ) + nB ; if ( nC [ 0 ] == ZERO_VALUE_NODES ) { nD = UNITY_VALUE_NODES ; } else { eX = UNITY_VALUE_NODES + abs ( eX ) ; eX = nC [ 1 ] + ( UNITY_VALUE_NODES - nC [ 1 ] ) * pow ( eX , nC [ 0 ] ) ; nD = clamp ( eX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } nD = max ( nD , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"nE",qualifier:["vec3"],c:!1},{type:"node_in",name:"nF",qualifier:["vec2"],c:!1},{type:"node_in",name:"nG",qualifier:["vec3"],c:!1},{type:"node_in",name:"nH",qualifier:["float"],c:!1},{type:"node_out",name:"nI",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nI = ZERO_VALUE_NODES ; if ( nF . r != ZERO_VALUE_NODES ) { eX = ( UNITY_VALUE_NODES - nH ) * dot ( nG , nE ) + nH ; nI = max ( eX , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"nJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"nK",qualifier:["vec2"],c:!1},{type:"node_in",name:"nL",qualifier:["vec3"],c:!1},{type:"node_in",name:"nM",qualifier:["float"],c:!1},{type:"node_in",name:"nN",qualifier:["vec2"],c:!1},{type:"node_out",name:"nO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nO = ZERO_VALUE_NODES ; if ( nK . r != ZERO_VALUE_NODES ) { eX = ( UNITY_VALUE_NODES - nM ) * dot ( nL , nJ ) + nM ; if ( nN [ 0 ] > ZERO_VALUE_NODES ) { eY = max ( dot ( nL , eM ) , ZERO_VALUE_NODES ) ; eZ = nN [ 0 ] * nN [ 0 ] ; e_ = UNITY_VALUE_NODES - eh * ( eZ / ( eZ + 0.33 ) ) ; fj = nJ - eX * nL ; fl = eM - eY * nL ;".split(" ")},
{type:"textline",a:"if ( length ( fj ) == ZERO_VALUE_NODES || length ( fl ) == ZERO_VALUE_NODES || abs ( eX ) > UNITY_VALUE_NODES || abs ( eY ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"nO = eX * e_ ; else { fa = acos ( eX ) ; eY = acos ( eY ) ; fj = normalize ( fj ) ; fl = normalize ( fl ) ; fb = max ( fa , eY ) ; fc = min ( fa , eY ) ; fc *= 0.95 ; eY = max ( dot ( fj , fl ) , ZERO_VALUE_NODES ) ; eZ = 0.45 * ( eZ / ( eZ + 0.09 ) ) ; nO = eX * ( e_ + ( eZ * eY * sin ( fb ) * tan ( fc ) ) ) ; } } else nO = eX ; nO = max ( nO , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"nP",qualifier:["vec3"],c:!1},{type:"node_in",name:"nQ",qualifier:["vec2"],c:!1},{type:"node_in",name:"nR",qualifier:["vec3"],c:!1},{type:"node_in",name:"nS",qualifier:["float"],c:!1},{type:"node_in",name:"nT",qualifier:["vec2"],c:!1},{type:"node_out",name:"nU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nU = ZERO_VALUE_NODES ; if ( nQ . r != ZERO_VALUE_NODES ) { eX = ( UNITY_VALUE_NODES - nS ) * dot ( nR , nP ) + nS ; fc = max ( dot ( nR , eM ) , ZERO_VALUE_NODES ) ; if ( nT [ 0 ] <= UNITY_VALUE_NODES ) nU = eX * pow ( max ( fc * eX , 0.1 ) , nT [ 0 ] - UNITY_VALUE_NODES ) ; else nU = eX * pow ( 1.0001 - fc , nT [ 0 ] - UNITY_VALUE_NODES ) ; nU = max ( nU , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"nV",qualifier:["vec3"],c:!1},{type:"node_in",name:"nW",qualifier:["vec2"],c:!1},{type:"node_in",name:"nX",qualifier:["vec3"],c:!1},{type:"node_in",name:"nY",qualifier:["float"],c:!1},{type:"node_in",name:"nZ",qualifier:["vec2"],c:!1},{type:"node_out",name:"n_",qualifier:["float"],c:!1}],f:[{type:"textline",a:"n_ = ZERO_VALUE_NODES ; if ( nW . r != ZERO_VALUE_NODES ) { fc = ( UNITY_VALUE_NODES - nY ) * dot ( nX , nV ) + nY ; fc = acos ( fc ) ; if ( fc < nZ [ 0 ] ) n_ = UNITY_VALUE_NODES ; else if ( fc > ( nZ [ 0 ] + nZ [ 1 ] ) || nZ [ 1 ] == ZERO_VALUE_NODES ) n_ = ZERO_VALUE_NODES ; else n_ = UNITY_VALUE_NODES - ( ( fc - nZ [ 0 ] ) / nZ [ 1 ] ) ; n_ = max ( n_ , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"oa",qualifier:["vec3"],c:!1},{type:"node_in",name:"ob",qualifier:["vec2"],c:!1},{type:"node_in",name:"oc",qualifier:["vec3"],c:!1},{type:"node_in",name:"od",qualifier:["float"],c:!1},{type:"node_in",name:"oe",qualifier:["vec2"],c:!1},{type:"node_out",name:"of",qualifier:["float"],c:!1}],f:[{type:"textline",a:"of = ZERO_VALUE_NODES ; if ( ob . g == UNITY_VALUE_NODES ) { fl = normalize ( oa + eM ) ; of = ( UNITY_VALUE_NODES - od ) * max ( dot ( oc , fl ) , ZERO_VALUE_NODES ) + od ; of = pow ( of , oe [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"og",qualifier:["vec3"],c:!1},{type:"node_in",name:"oh",qualifier:["vec2"],c:!1},{type:"node_in",name:"oi",qualifier:["vec3"],c:!1},{type:"node_in",name:"oj",qualifier:["vec2"],c:!1},{type:"node_out",name:"ok",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ok = ZERO_VALUE_NODES ; if ( oh . g == UNITY_VALUE_NODES ) { fl = normalize ( og + eM ) ; fc = max ( dot ( oi , fl ) , 0.001 ) ;".split(" ")},{type:"textline",a:"eX = max ( dot ( oi , eM ) , 0.01 ) ; fb = max ( dot ( oi , og ) , 0.01 ) ; fc = tan ( acos ( fc ) ) ; eY = max ( oj [ 0 ] , 0.001 ) ; ok = fb * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * eY * eY ) ) * ( exp ( - ( fc * fc ) / ( eY * eY ) ) / ( sqrt ( eX * fb ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"ol",qualifier:["vec3"],c:!1},{type:"node_in",name:"om",qualifier:["vec2"],c:!1},{type:"node_in",name:"on",qualifier:["vec3"],c:!1},{type:"node_in",name:"oo",qualifier:["vec2"],c:!1},{type:"node_out",name:"op",qualifier:["float"],c:!1}],f:[{type:"textline",a:"op = ZERO_VALUE_NODES ; if ( om . g == UNITY_VALUE_NODES ) { fl = normalize ( ol + eM ) ; fb = acos ( dot ( fl , on ) ) ; if ( fb < oo [ 0 ] ) op = UNITY_VALUE_NODES ; else if ( fb >= oo [ 0 ] + oo [ 1 ] || oo [ 1 ] == ZERO_VALUE_NODES ) op = ZERO_VALUE_NODES ; else op = UNITY_VALUE_NODES - ( fb - oo [ 0 ] ) / oo [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"oq",qualifier:["vec3"],c:!1},{type:"node_in",name:"or",qualifier:["vec2"],c:!1},{type:"node_in",name:"os",qualifier:["vec3"],c:!1},{type:"node_in",name:"ot",qualifier:["float"],c:!1},{type:"node_in",name:"ou",qualifier:["vec2"],c:!1},{type:"node_out",name:"ov",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ov = ZERO_VALUE_NODES ; if ( or . g == UNITY_VALUE_NODES ) { if ( ou [ 0 ] < UNITY_VALUE_NODES || ou [ 1 ] == ZERO_VALUE_NODES ) ov = ZERO_VALUE_NODES ; else { if ( ou [ 1 ] < 100.0 ) ou [ 1 ] = sqrt ( UNITY_VALUE_NODES / ou [ 1 ] ) ; else ou [ 1 ] = 10.0 / ou [ 1 ] ; fl = normalize ( eM + oq ) ; fb = ( UNITY_VALUE_NODES - ot ) * max ( dot ( os , fl ) , ZERO_VALUE_NODES ) + ot ; if ( fb < ZERO_VALUE_NODES ) ov = ZERO_VALUE_NODES ; else { eX = max ( dot ( os , eM ) , 0.01 ) ; eY = dot ( os , oq ) ; if ( eY <= 0.01 ) ov = ZERO_VALUE_NODES ; else { fc = max ( dot ( eM , fl ) , 0.01 ) ; eZ = UNITY_VALUE_NODES ; eX = ( 2.0 * fb * eX ) / fc ; eY = ( 2.0 * fb * eY ) / fc ; eY = min ( min ( eZ , eX ) , eY ) ; eX = sqrt ( pow ( ou [ 0 ] , 2.0 ) + pow ( fc , 2.0 ) - UNITY_VALUE_NODES ) ; fc = pow ( eX - fc , 2.0 ) / pow ( eX + fc , 2.0 ) * ( UNITY_VALUE_NODES + pow ( fc * ( eX + fc ) - UNITY_VALUE_NODES , 2.0 ) / pow ( fc * ( eX - fc ) + UNITY_VALUE_NODES , 2.0 ) ) ; fb = acos ( fb ) ; ov = max ( fc * eY * exp ( - pow ( fb , 2.0 ) / ( 2.0 * pow ( ou [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"ow",qualifier:["vec4"],c:!1},{type:"node_in",name:"ox",qualifier:["vec3"],c:!1},{type:"node_in",name:"oy",qualifier:["float"],c:!1},{type:"node_in",name:"oz",qualifier:["float"],c:!1},{type:"node_in",name:"oA",qualifier:["vec3"],c:!1},{type:"node_in",name:"oB",qualifier:["vec3"],c:!1},{type:"node_in",name:"oC",qualifier:["vec4"],c:!1},{type:"node_in",name:"oD",qualifier:["vec3"],c:!1},{type:"node_in",name:"oE",qualifier:["vec3"],c:!1},{type:"node_in",
name:"oF",qualifier:["vec3"],c:!1},{type:"node_in",name:"oG",qualifier:["float"],c:!1},{type:"node_out",name:"oH",qualifier:["vec4"],c:!1},{type:"node_out",name:"oI",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( oA , oB ) * dot ( eM , oB ) < ZERO_VALUE_NODES ) { fb = oC . x ; eY = oC . y ; fc = oC . z ; eX = oC . w ;".split(" ")},{type:"textline",a:"eZ = clamp ( abs ( dot ( oA , oB ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; e_ = clamp ( dot ( eM , - oA ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = pow ( e_ , eY ) ;".split(" ")},
{type:"textline",a:"oH = ow + oG * vec4 ( oF * eZ * pow ( oD , vec3 ( fb ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"oH += fc * mix ( vec4 ( oD , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , eX ) * oG * vec4 ( oF * eZ * vec3 ( eY ) , UNITY_VALUE_NODES ) ; oI = ox ; } else {".split(" ")},{type:"textline",a:"oI = ox + oF * oE * oz ; oH = ow + vec4 ( oF * oD * oy , oz ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"oI = ox + oF * oE * oz ; oH = ow + vec4 ( oF * oD * oy , oz ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"oJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"oJ = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"oK",qualifier:["vec3"],c:!1},{type:"node_out",name:"oL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oL = dot ( oK , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"oM",qualifier:["vec3"],c:!1},{type:"node_out",name:"oN",qualifier:["float"],c:!0},
{type:"node_out",name:"oO",qualifier:["float"],c:!0},{type:"node_out",name:"oP",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oN"],f:[{type:"textline",a:"oN = oM . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oO"],f:[{type:"textline",a:"oO = oM . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oP"],f:[{type:"textline",a:"oP = oM . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"oQ",
qualifier:["vec3"],c:!1},{type:"node_out",name:"oR",qualifier:["float"],c:!0},{type:"node_out",name:"oS",qualifier:["float"],c:!0},{type:"node_out",name:"oT",qualifier:["float"],c:!0}],f:[{type:"textline",a:"fl = eq ( oQ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oR"],f:[{type:"textline",a:"oR = fl . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oS"],f:[{type:"textline",a:"oS = fl . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_oT"],f:[{type:"textline",a:"oT = fl . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"oU",qualifier:["float"],c:!1},{type:"node_in",name:"oV",qualifier:["float"],c:!1},{type:"node_in",name:"oW",qualifier:["float"],c:!1},{type:"node_out",name:"oX",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oX = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( oU - oW ) * oV ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"oY",qualifier:["vec3"],
c:!1},{type:"node_in",name:"oZ",qualifier:["float"],c:!1},{type:"node_out",name:"o_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"o_ = oY ; if ( o_ . x > ZERO_VALUE_NODES ) o_ . x = pow ( oY . x , oZ ) ; if ( o_ . y > ZERO_VALUE_NODES ) o_ . y = pow ( oY . y , oZ ) ; if ( o_ . z > ZERO_VALUE_NODES ) o_ . z = pow ( oY . z , oZ ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"pa",qualifier:["vec3"],c:!1},{type:"node_out",name:"pb",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"pb = max ( vec3 ( ZERO_VALUE_NODES ) , pa ) ; pb = pow ( pb , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"pc",qualifier:["vec3"],c:!1},{type:"node_out",name:"pd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"pd = max ( vec3 ( ZERO_VALUE_NODES ) , pc ) ; pd = pow ( pd , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"pe",qualifier:["vec3"],c:!1},{type:"node_out",name:"pf",qualifier:["vec3"],
c:!1},{type:"node_out",name:"pg",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pg"],f:[{type:"textline",a:"pe [ 2 ] = pe [ 1 ] = pe [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pg"],f:[{type:"textline",a:"pf [ 2 ] = pf [ 1 ] = pf [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pg"],f:[{type:"textline",a:["pg","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"ph",qualifier:["vec3"],c:!1},{type:"node_out",name:"pi",qualifier:["vec3"],c:!0},{type:"node_out",name:"pj",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"fe = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , ph ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pi"],f:[{type:"textline",a:"pi = fe . xyz ; br ( pi ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_pj"],f:[{type:"textline",a:"pj = fe . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"pk",qualifier:["vec3"],c:!0},{type:"node_in",name:"pl",qualifier:["vec3"],c:!0},{type:"node_in",name:"pm",qualifier:["vec3"],c:!0},{type:"node_in",name:"pn",qualifier:["vec3"],c:!0},{type:"node_out",name:"po",qualifier:["vec3"],c:!0},{type:"node_out",name:"pp",qualifier:["float"],c:!0},{type:"node_out",name:"pq",qualifier:["vec3"],c:!0},{type:"node_out",
name:"pr",qualifier:["float"],c:!0},{type:"node_out",name:"ps",qualifier:["vec3"],c:!0},{type:"node_out",name:"pt",qualifier:["float"],c:!0},{type:"node_out",name:"pu",qualifier:["vec3"],c:!0},{type:"node_out",name:"pv",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pk ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_po"],
f:[{type:"textline",a:"po = fe . xyz ; br ( po ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pp"],f:[{type:"textline",a:"pp = fe . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pl ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pq"],f:[{type:"textline",a:"pq = fe . xyz ; br ( pq ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_pr"],f:[{type:"textline",a:"pr = fe . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pm ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ps"],f:[{type:"textline",a:"ps = fe . xyz ; br ( ps ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pt"],f:[{type:"textline",a:"pt = fe . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_uv4"],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pn ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pu"],f:[{type:"textline",a:"pu = fe . xyz ; br ( pu ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pv"],f:[{type:"textline",a:"pv = fe . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"pw",qualifier:["vec3"],c:!0},{type:"node_in",name:"px",qualifier:["vec3"],c:!0},{type:"node_in",
name:"py",qualifier:["vec3"],c:!0},{type:"node_in",name:"pz",qualifier:["vec3"],c:!0},{type:"node_out",name:"pA",qualifier:["vec3"],c:!0},{type:"node_out",name:"pB",qualifier:["float"],c:!0},{type:"node_out",name:"pC",qualifier:["vec3"],c:!0},{type:"node_out",name:"pD",qualifier:["float"],c:!0},{type:"node_out",name:"pE",qualifier:["vec3"],c:!0},{type:"node_out",name:"pF",qualifier:["float"],c:!0},{type:"node_out",name:"pG",qualifier:["vec3"],c:!0},{type:"node_out",name:"pH",qualifier:["float"],c:!0},
{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pw ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pA"],f:[{type:"textline",a:"pA = normalize ( ff * ( fe . xyz - eh ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pB"],f:[{type:"textline",a:"pB = fe . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],
f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( px ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pC"],f:[{type:"textline",a:"pC = normalize ( ff * ( fe . xyz - eh ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pD"],f:[{type:"textline",a:"pD = fe . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( py ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pE"],f:[{type:"textline",a:"pE = normalize ( ff * ( fe . xyz - eh ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pF"],f:[{type:"textline",a:"pF = fe . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"fe = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pz ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pG"],f:[{type:"textline",a:"pG = normalize ( ff * ( fe . xyz - eh ) ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pH"],f:[{type:"textline",a:"pH = fe . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",name:"pI",qualifier:["float"],c:!1}],f:[{type:"textline",a:"pI = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"pJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"pK",qualifier:["vec3"],c:!1},{type:"node_out",name:"pL",qualifier:["vec3"],c:!1},{type:"node_out",name:"pM",qualifier:["float"],
c:!0}],f:[{type:"textline",a:"pL = pJ + pK ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pM"],f:[{type:"textline",a:"pM = ( abs ( pL [ 0 ] ) + abs ( pL [ 1 ] ) + abs ( pL [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"pN",qualifier:["vec3"],c:!1},{type:"node_in",name:"pO",qualifier:["vec3"],c:!1},{type:"node_out",name:"pP",qualifier:["vec3"],c:!1},{type:"node_out",name:"pQ",qualifier:["float"],c:!0}],f:[{type:"textline",
a:"pP = pN - pO ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pQ"],f:[{type:"textline",a:"pQ = ( abs ( pP [ 0 ] ) + abs ( pP [ 1 ] ) + abs ( pP [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",h:[{type:"node_in",name:"pR",qualifier:["vec3"],c:!1},{type:"node_in",name:"pS",qualifier:["vec3"],c:!1},{type:"node_out",name:"pT",qualifier:["vec3"],c:!1},{type:"node_out",name:"pU",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pT = pR + pS ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pU"],f:[{type:"textline",a:"pU = length ( pT ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pT"],f:[{type:"textline",a:"pT = normalize ( pT ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"pV",qualifier:["vec3"],c:!1},{type:"node_in",name:"pW",qualifier:["vec3"],c:!1},{type:"node_out",name:"pX",qualifier:["vec3"],c:!1},{type:"node_out",name:"pY",qualifier:["float"],c:!0}],f:[{type:"textline",
a:"pX = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pY"],f:[{type:"textline",a:"pY = dot ( pV , pW ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",name:"pZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"p_",qualifier:["vec3"],c:!1},{type:"node_out",name:"qa",qualifier:["vec3"],c:!1},{type:"node_out",name:"qb",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qa = cross ( pZ , p_ ) ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_qb"],f:[{type:"textline",a:"qb = length ( qa ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"qc",qualifier:["vec3"],c:!1},{type:"node_in",name:"qd",qualifier:["vec3"],c:!1},{type:"node_out",name:"qe",qualifier:["vec3"],c:!1},{type:"node_out",name:"qf",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qe = normalize ( qc ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qf"],f:[{type:"textline",a:"qf = length ( qc ) ;".split(" ")}]}]},
{type:"textline",a:["qd",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"qg",qualifier:["vec3"],c:!1},{type:"node_in",name:"qh",qualifier:["vec3"],c:!1},{type:"node_out",name:"qi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qi = reflect ( - qg , qh ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"qj",qualifier:["vec3"],c:!1},{type:"node_in",name:"qk",qualifier:["float"],c:!1},{type:"node_in",name:"ql",qualifier:["const","float"],c:!1},{type:"node_in",
name:"qm",qualifier:["const","float"],c:!1},{type:"node_out",name:"qn",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"eY = length ( fd ) ; if ( eY < qm ) { eT = ey ( qj ) ; eY = clamp ( eh * ( qm - eY ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eY = qk * eY ;".split(" ")},{type:"textline",a:"fl = normalize ( eM * ff ) ;".split(" ")},{type:"textline",a:"eZ = UNITY_VALUE_NODES / ql ;".split(" ")},{type:"textline",
a:"eU = fl . xy * eY / ( ql * fl . z ) ; eY = UNITY_VALUE_NODES ; eX = texture2D ( node_B4W_PARALLAX_var_texture , eT ) . a ;".split(" ")},{type:"textline",a:"for ( float qo = 1.0 ; qo <= ql ; qo ++ ) { if ( eX < eY ) { eY -= eZ ; eT -= eU ; eX = texture2D ( node_B4W_PARALLAX_var_texture , eT ) . a ; } }".split(" ")},{type:"textline",a:"eU = eT + eU ; eZ = texture2D ( node_B4W_PARALLAX_var_texture , eU ) . a - ( eY + eZ ) ; eY = eX - eY ; eZ = eY / ( eY - eZ ) ;".split(" ")},{type:"textline",a:"eT = eZ * eU + ( UNITY_VALUE_NODES - eZ ) * eT ; qn = ew ( eT ) ; } else qn = qj ;".split(" ")}]},
{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"qp",qualifier:["vec3"],c:!1},{type:"node_out",name:"qq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qq = clamp ( qp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"qr",qualifier:["vec3"],c:!1},{type:"node_in",name:"qs",qualifier:["float"],c:!1},{type:"node_out",name:"qt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qt = el ( qr , qs ) ;".split(" ")}]},{type:"node",
name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"qu",qualifier:["float"],c:!1},{type:"node_in",name:"qv",qualifier:["float"],c:!1},{type:"node_in",name:"qw",qualifier:["float"],c:!1},{type:"node_in",name:"qx",qualifier:["float"],c:!1},{type:"node_in",name:"qy",qualifier:["float"],c:!1},{type:"node_out",name:"qz",qualifier:["float"],c:!0},{type:"node_out",name:"qA",qualifier:["vec4"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qz"],f:[{type:"textline",a:["qz","=","qu",";"]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qA"],f:[{type:"textline",a:"qA = vec4 ( qv , qw , qx , qy ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"qB",qualifier:["float"],c:!1}],f:[{type:"textline",a:["qB","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"qC",qualifier:["float"],c:!1},{type:"node_in",name:"qD",qualifier:["float"],c:!1},{type:"node_in",name:"qE",qualifier:["float"],c:!1},{type:"node_out",name:"qF",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"qF = smoothstep ( qD , qE , qC ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"qG",qualifier:["vec3"],c:!1},{type:"node_in",name:"qH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eO = qG ; eS = qH ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"qI",qualifier:["vec3"],c:!1},{type:"node_out",name:"qJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"qJ = ( qI . r + qI . g + qI . b ) / 3.0 ;".split(" ")}]},
{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"qK",qualifier:["float"],c:!1},{type:"node_out",name:"qL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qL [ 0 ] = qK ; qL [ 1 ] = qK ; qL [ 2 ] = qK ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void qM ( in vec3 eM , in mat4 eN , out vec3 eO , out vec3 eP , out vec3 eQ , out vec4 eR , out float eS ) { vec2 eT , eU ; float eV , eW , eX , eY , eZ , e_ , fa , fb , fc ; vec4 fd , fe ; mat3 ff ; vec3 fg , fh , fi , fj , fk , fl ; eO = vec3 ( ZERO_VALUE_NODES ) ; eP = vec3 ( ZERO_VALUE_NODES ) ; eQ = vec3 ( ZERO_VALUE_NODES ) ; eR = vec4 ( ZERO_VALUE_NODES ) ; eS = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"fg = normalize ( bE ) ; fh = fg ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"fh = fh ; else fh = - fh ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["fi","=","fh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["fi","=","fg",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["fg","=",
"fh",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"fj = cross ( fh , bF . xyz ) * bF . w ; ff = mat3 ( bF . xyz , fj , fh ) ; ff = ff ;".split(" ")}]}}]},{type:"textline",a:"fh = bC ; fd = bD ; eV = u_emit ; eW = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/to_world.glslv"]={type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",a:["(","M_PI",
"/","4.0",")"]},{type:"textline",a:"const vec3 qN = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 qT ( vec3 qO , mat4 qP ) { vec3 qQ , qR , qS ; qQ = vec3 ( qP [ 0 ] [ 0 ] , qP [ 1 ] [ 0 ] , qP [ 2 ] [ 0 ] ) ; qR = vec3 ( qP [ 0 ] [ 1 ] , qP [ 1 ] [ 1 ] , qP [ 2 ] [ 1 ] ) ; qS = vec3 ( qP [ 0 ] [ 2 ] , qP [ 1 ] [ 2 ] , qP [ 2 ] [ 2 ] ) ; qR = cross ( qS , qQ ) ; return mat4 ( vec4 ( qQ , 0.0 ) , vec4 ( qR , 0.0 ) , vec4 ( qS , 0.0 ) , vec4 ( qO , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"mat4 qZ ( vec3 qU , vec3 qV ) { vec3 qW , qX , qY ; qW = qU - qV ; qW . y = 0.0 ; qW = normalize ( qW ) ; qX = normalize ( cross ( qN , qW ) ) ; qY = normalize ( cross ( qW , qX ) ) ; return mat4 ( vec4 ( qX , 0.0 ) , vec4 ( qY , 0.0 ) , vec4 ( qW , 0.0 ) , vec4 ( qV , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"mat4 rg ( in vec3 q_ , float ra , float rb , float rc , vec3 rd ) { float re , rf ; re = fract ( length ( rd ) / 0.17 ) ; rf = rc + re / 10.0 ; re = re ; if ( rc != 0.0 ) re /= rc ; q_ *= 1.0 + 0.5 * sin ( ra ) ; re = length ( q_ ) * rb * sin ( 2.0 * 3.14 * ra * rf + re ) ; return C ( re ) ; }".split(" ")}]}}]},
{type:"textline",a:"mat4 ro ( in vec3 rh , in vec3 ri , in mat4 rj ) { vec3 rk ; float rl , rm ; mat4 rn ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"rn = qT ( ri , rj ) ;".split(" ")}]}},{type:"elif",d:["BILLBOARD_RANDOM"],group:{type:"group",b:[{type:"textline",
a:"rl = fract ( ( ri . x * 1.43 + ri . y * 0.123 + ri . z * 6.1 ) ) ; rl = 2.0 * M_PI * rl ; rk = normalize ( vec3 ( rj [ 0 ] [ 2 ] , 0.0 , rj [ 2 ] [ 2 ] ) ) ; rm = acos ( rk [ 2 ] ) ; if ( rk [ 0 ] < 0.0 ) rm = 2.0 * M_PI - rm ; rm = rm - rl ; if ( rm < 0.0 ) rm = 2.0 * M_PI + rm ; rl = rl ; if ( rm <= MAX_BILLBOARD_ANGLE ) rl += rm ; else if ( rm <= M_PI - MAX_BILLBOARD_ANGLE ) rl += MAX_BILLBOARD_ANGLE * ( 2.0 * rm - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( rm <= M_PI + MAX_BILLBOARD_ANGLE ) rl += rm - M_PI ; else if ( rm <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) rl += MAX_BILLBOARD_ANGLE * ( 2.0 * rm - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else rl += rm - 2.0 * M_PI ; rn = A ( rl ) ; rn [ 3 ] = vec4 ( ri , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"rn = qZ ( rh , ri ) ;".split(" ")}]}}]},{type:"textline",a:["return","rn",";","}"]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 ru ( in vec3 rp , in vec3 rq , in mat4 rr , mat4 rs ) { mat4 rt ; rt = ro ( rp , rq , rr ) ; rs [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; rt = rt * rs ; return rt ; }".split(" ")}]}}]},
{type:"textline",a:"c rB ( in vec3 rv , in vec3 rw , in vec3 rx , in vec3 ry , in vec3 rz , in mat4 rA ) { rv = ( rA * vec4 ( rv , 1.0 ) ) . xyz ; rw = ( rA * vec4 ( rw , 1.0 ) ) . xyz ; rx = ( rA * vec4 ( rx , 0.0 ) ) . xyz ; ry = ( rA * vec4 ( ry , 0.0 ) ) . xyz ; rz = ( rA * vec4 ( rz , 0.0 ) ) . xyz ; return E ( c ( rv , rw , rx , ry , rz , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",b:[{type:"textline",a:"vec2 rE ( vec2 rC , vec3 rD ) { return ( rC + 0.5 ) * rD . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",b:[{type:"define",name:"SKIN_SLERP",a:["0"]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"vec4 rL ( in vec4 rF , in vec4 rG , in float rH ) { float rI , rJ , rK ; rI = rF [ 0 ] * rG [ 0 ] + rF [ 1 ] * rG [ 1 ] + rF [ 2 ] * rG [ 2 ] + rF [ 3 ] * rG [ 3 ] ; if ( rI < 0.0 ) { rG *= - 1.0 ; rI = - rI ; } if ( abs ( rI ) >= 1.0 ) return rF ; rJ = acos ( rI ) ; rI = sqrt ( 1.0 - rI * rI ) ; if ( abs ( rI ) < 0.001 ) return vec4 ( rF * 0.5 + rG * 0.5 ) ; rK = sin ( ( 1.0 - rH ) * rJ ) / rI ; rI = sin ( rH * rJ ) / rI ; return rF * rK + rG * rI ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"vec3 rX ( in vec3 rM , in vec4 rN , in vec4 rO , in vec4 rP , in vec4 rQ , in float rR ) { vec4 rS , rT ; vec3 rU , rV , rW ; rU = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rM , 1.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"rS = rL ( rN , rO , rR ) ; rT = mix ( rP , rQ , rR ) ; rV = i ( rS , rU ) ; rV = rV * rT . w + rT . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"rW = i ( rN , rU ) ; rU = i ( rO , rU ) ; rW = rW * rP . w + rP . xyz ; rU = rU * rQ . w + rQ . xyz ; rV = mix ( rW , rU , rR ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rV , 1.0 ) ) ; } vec3 sf ( in vec3 rY , in vec4 rZ , in vec4 r_ , in float sa ) { vec4 sb ; vec3 sc , sd , se ; sc = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rY , 0.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],
group:{type:"group",b:[{type:"textline",a:"sb = rL ( rZ , r_ , sa ) ; sd = i ( sb , sc ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"se = i ( rZ , sc ) ; sc = i ( r_ , sc ) ; sd = mix ( se , sc , sa ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sd , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vec3 rX ( in vec3 sg , in vec4 sh , in vec4 si ) { vec3 sj ; sj = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sg , 1.0 ) ) ; sj = i ( sh , sj ) ; sj = sj * si . w + si . xyz ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sj , 1.0 ) ) ; } vec3 sf ( in vec3 sk , in vec4 sl ) { vec3 sm ; sm = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sk , 0.0 ) ) ; sm = i ( sl , sm ) ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sm , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",a:"void sB ( inout vec3 sn , inout vec3 so , inout vec3 sp , inout vec3 sq ) { int sr , ss ; vec4 st ; vec3 su , sv , sw , sx ; float sy , sz ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:["sy","=","u_frame_factor",";"]}]}}]},{type:"textline",a:"if ( a_influence . y > 0.0 ) { su = vec3 ( 0.0 , 0.0 , 0.0 ) ; sv = vec3 ( 0.0 , 0.0 , 0.0 ) ; sw = vec3 ( 0.0 , 0.0 , 0.0 ) ; sx = vec3 ( 0.0 , 0.0 , 0.0 ) ; st = a_influence ; for ( int sA = 0 ; sA < 4 ; sA ++ ) { sr = int ( st [ sA ] ) ; sz = fract ( st [ sA ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"su += sz * rX ( sn , u_quatsb [ sr ] , u_quatsa [ sr ] , u_transb [ sr ] , u_transa [ sr ] , sy ) ; sv += sz * sf ( so , u_quatsb [ sr ] , u_quatsa [ sr ] , sy ) ; sw += sz * sf ( sp , u_quatsb [ sr ] , u_quatsa [ sr ] , sy ) ; sx += sz * sf ( sq , u_quatsb [ sr ] , u_quatsa [ sr ] , sy ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"su += sz * rX ( sn , u_quatsb [ sr ] , u_transb [ sr ] ) ; sx += sz * sf ( sq , u_quatsb [ sr ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"sv += sz * sf ( so , u_quatsb [ sr ] ) ; sw += sz * sf ( sp , u_quatsb [ sr ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"} sn = su ; sq = sx ;".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"so = sv ; sp = sw ;".split(" ")}]}}]},{type:"textline",a:"} if ( ! ( a_influence . y > 0.0 ) ) { ss = int ( a_influence [ 0 ] - 1.0 ) ; if ( ss > - 1 ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"sn = rX ( sn , u_quatsb [ ss ] , u_quatsa [ ss ] , u_transb [ ss ] , u_transa [ ss ] , sy ) ; so = sf ( so , u_quatsb [ ss ] , u_quatsa [ ss ] , sy ) ; sp = sf ( sp , u_quatsb [ ss ] , u_quatsa [ ss ] , sy ) ; sq = sf ( sq , u_quatsb [ ss ] , u_quatsa [ ss ] , sy ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sn = rX ( sn , u_quatsb [ ss ] , u_transb [ ss ] ) ; sq = sf ( sq , u_quatsb [ ss ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"so = sf ( so , u_quatsb [ ss ] ) ; sp = sf ( sp , u_quatsb [ ss ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"void sM ( inout vec3 sC , in vec3 sD , in float sE , in float sF , in float sG , in vec3 sH , in float sI ) { vec3 sJ ; float sK , sL ; sK = length ( sD ) ; sL = sF * ( 1.0 + 0.1 * fract ( sK ) ) ; sK = sE * sI * ( 1.0 + sin ( 2.0 * 3.14 * sG * sL + sK ) ) ; sL = ( sC . y - sD . y ) * abs ( sK ) ; sL += 1.0 ; sL *= sL ; sL = sL * sL - sL ; sJ = sC ; sJ . xz += sH . xz * sL * sign ( sK ) ; sJ = sJ - sD ; if ( all ( equal ( sJ , vec3 ( 0.0 ) ) ) ) sC = sD ; else { sK = length ( sC - sD ) ; sC = sD + normalize ( sJ ) * sK ; } }".split(" ")},
{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"vec4 sO ( vec4 sN ) { return sN * sN * ( 3.0 - 2.0 * sN ) ; } vec4 sQ ( vec4 sP ) { return abs ( fract ( sP + 0.5 ) * 2.0 - 1.0 ) ; } vec4 sS ( vec4 sR ) { return sO ( sQ ( sR ) ) ; } void ti ( inout vec3 sT , in float sU , in vec3 sV , in vec3 sW , in vec3 sX , in float sY , in float sZ , in float s_ , in vec3 ta ) { vec3 tb ; vec4 tc ; vec2 td , te ; float tf , tg , th ; tf = dot ( sX , vec3 ( 1.0 ) ) ; tg = tf + ta . g ; th = dot ( sT , vec3 ( ta . g ) ) ; td = ( sU + vec2 ( th , tg ) ) ; tc = ( ( fract ( ( td . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( sW ) * sY ; tc = sS ( tc ) ; te = tc . xz + tc . yw ; te . y = 0.5 - te . y ; tb = te . xyx * ta . rbr * vec3 ( sZ * sV . x , s_ , sZ * sV . z ) ; sT += tb ; }".split(" ")}]}}]},
{type:"textline",a:"void tp ( inout vec3 tj , inout vec3 tk , in vec3 tl ) { vec3 tm , tn , to ; tm = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tn = tk ; to = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tn = tj ; to = tk ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"ti ( tn , u_time , tl , tm , to , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",a:"sM ( tn , to , au_wind_bending_amp , au_wind_bending_freq , u_time , tm , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sM ( tn , to , au_wind_bending_amp , au_wind_bending_freq , u_time , tm , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tj += tn - tk ; tk = tn ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tj = tn ; tk = to ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2},"PARTICLE_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"attribute vec3 a_orco_tex_coord ; varying vec3 eg ;".split(" ")}]}}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eG","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",h:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eF",
qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eF","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",name:"UVMAP",h:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eH","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ez",qualifier:["varying",
"vec2"],c:!1}],f:[{type:"textline",a:["ez","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_param",name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tq",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tq","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"],c:!1},{type:"node_param",
name:"tr",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:["tr","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ts",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["ts","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",
qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tt",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tt","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{type:"nodes_global"},{type:"textline",a:["void","tu","(",")","{"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["eg","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/halo_color.glslf"]=
{type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"textline",a:"float tz ( float ty ) { return ty - floor ( ty * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"void tH ( inout float tA , in float tB ) { float tC , tD , tE , tF ; for ( int tG = 0 ; tG < NUM_RINGS ; tG ++ ) { tC = 40.0 * fract ( tx / float ( tG + 1 ) ) - 1.0 ; tD = 300.0 * ( tz ( tC ) - 0.005 ) ; tE = tC ; tF = abs ( tE * ( u_halo_size * tD - tB ) ) ; tA += 1.0 - min ( tF , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"void tP ( inout float tI , in float tJ ) { float tK , tL , tM , tN ; for ( int tO = 0 ; tO < NUM_LINES ; tO ++ ) { tK = fract ( tx / float ( tO + 1 ) ) - 1.0 ; tL = tK ; tM = 1000.0 * ( tz ( tK ) - 0.005 ) ; tN = 20.0 * abs ( tL * bM . x + tM * bM . y ) ; tI += 1.0 - min ( tN , 1.0 ) ; } tI *= tJ ; }".split(" ")}]}}]},{type:"textline",a:"void tW ( inout float tQ , in vec2 tR ) { float tS , tT , tU , tV ; tT = atan ( tR . y , tR . x ) ; tT *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; tU = cos ( tT ) ; tV = sin ( tT ) ; tT = ( tU * tR . x + tV * tR . y ) * ( tU * tR . y - tV * tR . x ) ; tS = abs ( tT ) ; if ( tS < 1.0 ) { tS = ( 0.01 * u_halo_size ) / ( tS ) ; tQ *= sqrt ( min ( tS , 1.0 ) ) ; } } vec4 uc ( ) { vec4 tX ; vec3 tY ; float tZ , t_ , ua , ub ; tZ = ( bM . x * bM . x + bM . y * bM . y ) ; t_ = sqrt ( tZ ) ; tZ = max ( 1.0 - tZ , 0.0 ) ; tZ = pow ( tZ , u_halo_hardness ) ; ua = u_diffuse_color . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"ub = 0.0 ; tH ( ub , t_ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"t_ = 0.0 ; tP ( t_ , tZ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_STARS"],group:{type:"group",b:[{type:"textline",a:"tW ( tZ , bM ) ;".split(" ")}]}}]},{type:"textline",a:"tZ *= ua ; tY = u_diffuse_color . rgb ;".split(" ")},{type:"condition",b:[{type:"if",
d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"ub *= tZ ; tY += u_halo_rings_color * ub ; tZ += ub ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"t_ *= ua ; tY += u_halo_lines_color * t_ ; tZ += t_ ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"tZ *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS",
"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"t_ = u_halo_stars_blend * ( tw . y - u_halo_stars_height ) ; tZ *= clamp ( t_ , 0.0 , 1.0 ) ; tZ *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"tX = vec4 ( tY , tZ ) ; return tX ; }".split(" ")}]};a["include/fog.glslf"]={type:"group",b:[{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"condition",b:[{type:"if",d:["USE_FOG"],
group:{type:"group",b:[{type:"textline",a:"void uj ( inout vec3 ud , in float ue , in float uf , in vec4 ug ) { float uh , ui ; uh = clamp ( ( ue - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOG_TYPE","QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uh","*=","uh",";"]}]}},{type:"elif",d:["FOG_TYPE","LINEAR",{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"uh = sqrt ( uh ) ;".split(" ")}]}}]},{type:"textline",a:"if ( u_fog_params . w > 0.0 ) { if ( uf > u_fog_params . w ) uh = 0.0 ; else if ( uf > 0.0 ) { ui = ( u_fog_params . w - uf ) / u_fog_params . w ; uh *= ui * ui ; } } ug . a = 1.0 - ( 1.0 - uh ) * ( 1.0 - u_fog_params . x ) ; ud = mix ( ud , ug . rgb , ug . a ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"vec3 up ( in mat4 uk , in vec3 ul ) { vec3 um , un , uo ; um = mix ( uk [ 0 ] . rgb , uk [ 1 ] . rgb , max ( sign ( ul . x ) , 0.0 ) ) ; un = mix ( uk [ 2 ] . rgb , uk [ 3 ] . rgb , max ( sign ( ul . z ) , 0.0 ) ) ; uo = vec3 ( uk [ 0 ] . a , uk [ 1 ] . a , uk [ 2 ] . a ) ; un = mix ( um , un , abs ( ul . z ) ) ; un = mix ( un , uo , abs ( ul . y ) ) ; br ( un ) ; return un ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void ur ( inout float uq ) { uq -= 0.5 ; uq = 4.0 * ( uq * uq * uq ) + 0.5 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void uC ( inout vec3 us , in float ut , in vec3 uu , in float uv , in vec4 uw , in float ux ) { vec3 uy , uz ; float uA , uB ; uA = max ( uu . y , 0.0 ) ; uB = max ( ut - max ( uv / uA , 0.0 ) , 0.0 ) ; uB = uw . w * uB ; uy = vec3 ( 0.0 , 0.02 , 0.05 ) ; uz = uw . rgb ; uB = min ( uB , 1.0 ) ; ur ( uB ) ; uB *= clamp ( 2.0 - ux , 0.0 , 1.0 ) ; uy = mix ( uz , uy , min ( uA , 1.0 ) ) ; uv = clamp ( - uv * 0.03 , 0.0 , 0.8 ) ; uy *= 1.0 - uv ; us = mix ( us , uy , uB ) ; }".split(" ")}]}}]}]}}]},
{type:"textline",a:"void uJ ( inout vec3 uD , float uE , vec3 uF , float uG ) { vec4 uH ; vec3 uI ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"uI = up ( u_cube_fog , uF ) ; uH = vec4 ( uI , u_fog_color_density . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uH","=","u_fog_color_density",";"]}]}}]},{type:"textline",a:"uj ( uD , uE , bC . y , uH ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uC ( uD , uE , uF , u_cam_water_depth , u_underwater_fog_color_density , uG ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"vec2 uQ ( vec3 uM , float uN , vec2 uO ) { vec2 uP ; uP = vec2 ( ( uM . x - uO . x ) / uN , - ( uM . z - uO . y ) / uN ) ; return fract ( uP ) ; } vec2 uU ( vec2 uR , float uS , vec2 uT ) { return vec2 ( uR . x * uS , - uR . y * uS ) + uT ; } c uV ( ) { return c ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } c vq ( vec3 uW , vec3 uX , vec3 uY , vec3 uZ , vec3 u_ , PRECISION sampler2D va , sampler2D vb , vec3 vc , float vd , vec3 ve , vec4 vf , mat4 vg ) { mat4 vh ; vec4 vi ; vec2 vj , vk , vl ; float vm , vn ; vec3 vo ; vo = i ( vf , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; vm = - vo . x ; vn = - vo . z ; vj = vec2 ( ve . x + vd * ( - 1.0 - vm ) / 2.0 , ve . z + vd * ( 1.0 - vn ) / 2.0 ) ; vk = uQ ( u_ , vd , vj ) ; vn = vd / 2.0 ; vl = abs ( uU ( vk - vec2 ( 0.5 ) , vd , vec2 ( 0.0 ) ) ) ; vn = vn * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( vl ) > vn ) return uV ( ) ; vn = vd / vc . z ; vl = ( vk - vec2 ( 0.5 ) ) * vn + vec2 ( 0.5 ) ; vo = vo * ( vd / vc . z - 1.0 ) / 2.0 ; vl . x += vo . x ; vl . y -= vo . z ; vi = texture2D ( vb , vl ) ; vn = vi . r ; if ( vn < u_scale_threshold ) return uV ( ) ; vm = vc . y - vc . x ; vm = vc . y - texture2D ( va , vl ) . r * vm ; vl = uW . xz - u_ . xz ; u_ . xz = uU ( vk , vd , vj ) ; u_ . y = vm ; uW . xz = u_ . xz + vl ; uW . y *= vn ; uW . y += vm ; vo = vi . gba ;".split(" ")},
{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"uW -= u_ ; vh = ro ( ve , u_ , vg ) ; c vp = rB ( uW , u_ , uX , uY , uZ , vh ) ; vp . b = u_ ; vp . f = vo ; return E ( vp ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return E ( c ( uW , u_ , uX , uY , uZ , vo ) ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",b:[{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"condition",b:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 vx ( mat4 vr , vec4 vs , mat4 vt ) { vec4 vu ; float vv ; vec2 vw ; vw = ( vr * vt [ 3 ] ) . xy ; vv = SHADOW_TEX_RES / 2.0 ; vw = floor ( vw * vv + 0.5 ) / vv - vw ; vu = vr * vs ; vu . xy += vw ; vu . xyz = 0.5 * ( vu . xyz + vu . w ) ; return vu ; } void vC ( vec3 vy , vec3 vz ) { vec4 vA ; mat4 vB ;".split(" ")},
{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vB = O ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vB = O ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vA = vB * vec4 ( vy + u_normal_offset * vz , 1.0 ) ; bI = vx ( u_p_light_matrix0 , vA , vB ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vB = O ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vB = O ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vA = vB * vec4 ( vy + u_normal_offset * vz , 1.0 ) ; bJ = vx ( u_p_light_matrix1 , vA , vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],
group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vB = O ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vB = O ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vA = vB * vec4 ( vy + u_normal_offset * vz , 1.0 ) ; bK = vx ( u_p_light_matrix2 , vA , vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",
e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vB = O ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vB = O ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vA = vB * vec4 ( vy + u_normal_offset * vz , 1.0 ) ; bL = vx ( u_p_light_matrix3 , vA , vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],
group:{type:"group",b:[{type:"textline",a:"bJ = vx ( u_p_light_matrix1 , vA , vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"bK = vx ( u_p_light_matrix2 , vA , vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"bL = vx ( u_p_light_matrix3 , vA , vB ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/lighting_nodes.glslf"]={type:"group",b:[{type:"var",
name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float vD = 0.5 ;".split(" ")},{type:"node",name:"LIGHTING_BEGIN",h:[{type:"node_out",
name:"wa",qualifier:["vec3"],c:!1},{type:"node_out",name:"wb",qualifier:["vec3"],c:!1},{type:"node_out",name:"wc",qualifier:["vec3"],c:!1},{type:"node_out",name:"wd",qualifier:["vec3"],c:!0},{type:"node_out",name:"we",qualifier:["vec3"],c:!0},{type:"node_out",name:"wf",qualifier:["vec2"],c:!0},{type:"node_out",name:"wg",qualifier:["vec2"],c:!0},{type:"node_out",name:"wh",qualifier:["vec4"],c:!0},{type:"node_out",name:"wi",qualifier:["float"],c:!0},{type:"node_out",name:"wj",qualifier:["vec4"],c:!0}],
f:[{type:"textline",a:"wa = vE ; wb = vF ; wc = vG ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wd"],f:[{type:"textline",a:["wd","=","vH",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_we"],f:[{type:"textline",a:["we","=","vJ",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wg"],f:[{type:"textline",a:["wg","=","vL",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wf"],f:[{type:"textline",a:["wf","=","vM",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_wh"],f:[{type:"textline",a:["wh","=","vN",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wi"],f:[{type:"textline",a:["wi","=","vO",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wj"],f:[{type:"textline",a:["wj","=","vP",";"]}]}]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"wk",qualifier:["vec3"],c:!1},{type:"node_in",name:"wl",qualifier:["vec3"],c:!1},{type:"node_in",name:"wm",qualifier:["vec3"],c:!1},{type:"node_out",
name:"wn",qualifier:["vec4"],c:!1},{type:"node_out",name:"wo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"wn = vec4 ( wk + wm * wl , ZERO_VALUE_NODES ) ; wo = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"wp",qualifier:["vec4"],c:!1},{type:"node_out",name:"wq",qualifier:["vec3"],c:!1},{type:"node_out",name:"wr",qualifier:["vec2"],c:!1},{type:"node_out",name:"ws",qualifier:["vec3"],c:!1},{type:"node_out",name:"wt",qualifier:["float"],c:!1}],
f:[{type:"textline",a:"wr = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",a:["wt","=","vD",";"]}]},{type:"node_else",f:[{type:"textline",a:["wt","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"ws = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",
e:2}],f:[{type:"textline",a:"ws *= wp [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"vZ = u_light_positions [ LAMP_IND ] ; wq = vZ - vI ;".split(" ")},{type:"textline",a:"vS = length ( wq ) ; ws *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + vS * vS ) ; wq = normalize ( wq ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"vZ = u_light_directions [ LAMP_IND ] ; vS = dot ( wq , vZ ) ; vS *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( vS - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; ws *= vS ;".split(" ")}]}]}]},{type:"node_else",f:[{type:"textline",a:"wq = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"wu",qualifier:["vec3"],c:!1},{type:"node_in",name:"wv",qualifier:["vec2"],c:!1},
{type:"node_in",name:"ww",qualifier:["vec3"],c:!1},{type:"node_in",name:"wx",qualifier:["float"],c:!1},{type:"node_in",name:"wy",qualifier:["vec2"],c:!1},{type:"node_out",name:"wz",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wz = ZERO_VALUE_NODES ; if ( wv . r != ZERO_VALUE_NODES ) { vS = ( UNITY_VALUE_NODES - wx ) * dot ( ww , wu ) + wx ; if ( wy [ 0 ] == ZERO_VALUE_NODES ) { wz = UNITY_VALUE_NODES ; } else { vS = UNITY_VALUE_NODES + abs ( vS ) ; vS = wy [ 1 ] + ( UNITY_VALUE_NODES - wy [ 1 ] ) * pow ( vS , wy [ 0 ] ) ; wz = clamp ( vS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } wz = max ( wz , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"wA",qualifier:["vec3"],c:!1},{type:"node_in",name:"wB",qualifier:["vec2"],c:!1},{type:"node_in",name:"wC",qualifier:["vec3"],c:!1},{type:"node_in",name:"wD",qualifier:["float"],c:!1},{type:"node_out",name:"wE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wE = ZERO_VALUE_NODES ; if ( wB . r != ZERO_VALUE_NODES ) { vS = ( UNITY_VALUE_NODES - wD ) * dot ( wC , wA ) + wD ; wE = max ( vS , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"wF",qualifier:["vec3"],c:!1},{type:"node_in",name:"wG",qualifier:["vec2"],c:!1},{type:"node_in",name:"wH",qualifier:["vec3"],c:!1},{type:"node_in",name:"wI",qualifier:["float"],c:!1},{type:"node_in",name:"wJ",qualifier:["vec2"],c:!1},{type:"node_out",name:"wK",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wK = ZERO_VALUE_NODES ; if ( wG . r != ZERO_VALUE_NODES ) { vS = ( UNITY_VALUE_NODES - wI ) * dot ( wH , wF ) + wI ; if ( wJ [ 0 ] > ZERO_VALUE_NODES ) { vT = max ( dot ( wH , vK ) , ZERO_VALUE_NODES ) ; vU = wJ [ 0 ] * wJ [ 0 ] ; vV = UNITY_VALUE_NODES - vD * ( vU / ( vU + 0.33 ) ) ; vZ = wF - vS * wH ; v_ = vK - vT * wH ;".split(" ")},
{type:"textline",a:"if ( length ( vZ ) == ZERO_VALUE_NODES || length ( v_ ) == ZERO_VALUE_NODES || abs ( vS ) > UNITY_VALUE_NODES || abs ( vT ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"wK = vS * vV ; else { vW = acos ( vS ) ; vT = acos ( vT ) ; vZ = normalize ( vZ ) ; v_ = normalize ( v_ ) ; vX = max ( vW , vT ) ; vY = min ( vW , vT ) ; vY *= 0.95 ; vT = max ( dot ( vZ , v_ ) , ZERO_VALUE_NODES ) ; vU = 0.45 * ( vU / ( vU + 0.09 ) ) ; wK = vS * ( vV + ( vU * vT * sin ( vX ) * tan ( vY ) ) ) ; } } else wK = vS ; wK = max ( wK , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"wL",qualifier:["vec3"],c:!1},{type:"node_in",name:"wM",qualifier:["vec2"],c:!1},{type:"node_in",name:"wN",qualifier:["vec3"],c:!1},{type:"node_in",name:"wO",qualifier:["float"],c:!1},{type:"node_in",name:"wP",qualifier:["vec2"],c:!1},{type:"node_out",name:"wQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wQ = ZERO_VALUE_NODES ; if ( wM . r != ZERO_VALUE_NODES ) { vS = ( UNITY_VALUE_NODES - wO ) * dot ( wN , wL ) + wO ; vY = max ( dot ( wN , vK ) , ZERO_VALUE_NODES ) ; if ( wP [ 0 ] <= UNITY_VALUE_NODES ) wQ = vS * pow ( max ( vY * vS , 0.1 ) , wP [ 0 ] - UNITY_VALUE_NODES ) ; else wQ = vS * pow ( 1.0001 - vY , wP [ 0 ] - UNITY_VALUE_NODES ) ; wQ = max ( wQ , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"wR",qualifier:["vec3"],c:!1},{type:"node_in",name:"wS",qualifier:["vec2"],c:!1},{type:"node_in",name:"wT",qualifier:["vec3"],c:!1},{type:"node_in",name:"wU",qualifier:["float"],c:!1},{type:"node_in",name:"wV",qualifier:["vec2"],c:!1},{type:"node_out",name:"wW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wW = ZERO_VALUE_NODES ; if ( wS . r != ZERO_VALUE_NODES ) { vY = ( UNITY_VALUE_NODES - wU ) * dot ( wT , wR ) + wU ; vY = acos ( vY ) ; if ( vY < wV [ 0 ] ) wW = UNITY_VALUE_NODES ; else if ( vY > ( wV [ 0 ] + wV [ 1 ] ) || wV [ 1 ] == ZERO_VALUE_NODES ) wW = ZERO_VALUE_NODES ; else wW = UNITY_VALUE_NODES - ( ( vY - wV [ 0 ] ) / wV [ 1 ] ) ; wW = max ( wW , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"wX",qualifier:["vec3"],c:!1},{type:"node_in",name:"wY",qualifier:["vec2"],c:!1},{type:"node_in",name:"wZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"w_",qualifier:["float"],c:!1},{type:"node_in",name:"xa",qualifier:["vec2"],c:!1},{type:"node_out",name:"xb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xb = ZERO_VALUE_NODES ; if ( wY . g != ZERO_VALUE_NODES ) { v_ = normalize ( wX + vK ) ; xb = ( UNITY_VALUE_NODES - w_ ) * max ( dot ( wZ , v_ ) , ZERO_VALUE_NODES ) + w_ ; xb = pow ( xb , xa [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"xc",qualifier:["vec3"],c:!1},{type:"node_in",name:"xd",qualifier:["vec2"],c:!1},{type:"node_in",name:"xe",qualifier:["vec3"],c:!1},{type:"node_in",name:"xf",qualifier:["vec2"],c:!1},{type:"node_out",name:"xg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xg = ZERO_VALUE_NODES ; if ( xd . g != ZERO_VALUE_NODES ) { v_ = normalize ( xc + vK ) ; vY = max ( dot ( xe , v_ ) , 0.001 ) ;".split(" ")},{type:"textline",a:"vS = max ( dot ( xe , vK ) , 0.01 ) ; vX = max ( dot ( xe , xc ) , 0.01 ) ; vY = tan ( acos ( vY ) ) ; vT = max ( xf [ 0 ] , 0.001 ) ; xg = vX * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * vT * vT ) ) * ( exp ( - ( vY * vY ) / ( vT * vT ) ) / ( sqrt ( vS * vX ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"xh",qualifier:["vec3"],c:!1},{type:"node_in",name:"xi",qualifier:["vec2"],c:!1},{type:"node_in",name:"xj",qualifier:["vec3"],c:!1},{type:"node_in",name:"xk",qualifier:["vec2"],c:!1},{type:"node_out",name:"xl",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xl = ZERO_VALUE_NODES ; if ( xi . g != ZERO_VALUE_NODES ) { v_ = normalize ( xh + vK ) ; vX = acos ( dot ( v_ , xj ) ) ; if ( vX < xk [ 0 ] ) xl = UNITY_VALUE_NODES ; else if ( vX >= xk [ 0 ] + xk [ 1 ] || xk [ 1 ] == ZERO_VALUE_NODES ) xl = ZERO_VALUE_NODES ; else xl = UNITY_VALUE_NODES - ( vX - xk [ 0 ] ) / xk [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"xm",qualifier:["vec3"],c:!1},{type:"node_in",name:"xn",qualifier:["vec2"],c:!1},{type:"node_in",name:"xo",qualifier:["vec3"],c:!1},{type:"node_in",name:"xp",qualifier:["float"],c:!1},{type:"node_in",name:"xq",qualifier:["vec2"],c:!1},{type:"node_out",name:"xr",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xr = ZERO_VALUE_NODES ; if ( xn . g != ZERO_VALUE_NODES ) { if ( xq [ 0 ] < 1.0 || xq [ 1 ] == ZERO_VALUE_NODES ) xr = ZERO_VALUE_NODES ; else { if ( xq [ 1 ] < 100.0 ) xq [ 1 ] = sqrt ( 1.0 / xq [ 1 ] ) ; else xq [ 1 ] = 10.0 / xq [ 1 ] ; v_ = normalize ( vK + xm ) ; vX = ( UNITY_VALUE_NODES - xp ) * max ( dot ( xo , v_ ) , ZERO_VALUE_NODES ) + xp ; if ( vX < ZERO_VALUE_NODES ) xr = ZERO_VALUE_NODES ; else { vS = max ( dot ( xo , vK ) , 0.01 ) ; vT = dot ( xo , xm ) ; if ( vT <= 0.01 ) xr = ZERO_VALUE_NODES ; else { vY = max ( dot ( vK , v_ ) , 0.01 ) ; vU = UNITY_VALUE_NODES ; vS = ( 2.0 * vX * vS ) / vY ; vT = ( 2.0 * vX * vT ) / vY ; vT = min ( min ( vU , vS ) , vT ) ; vS = sqrt ( pow ( xq [ 0 ] , 2.0 ) + pow ( vY , 2.0 ) - UNITY_VALUE_NODES ) ; vY = pow ( vS - vY , 2.0 ) / pow ( vS + vY , 2.0 ) * ( UNITY_VALUE_NODES + pow ( vY * ( vS + vY ) - UNITY_VALUE_NODES , 2.0 ) / pow ( vY * ( vS - vY ) + UNITY_VALUE_NODES , 2.0 ) ) ; vX = acos ( vX ) ; xr = max ( vY * vT * exp ( - pow ( vX , 2.0 ) / ( 2.0 * pow ( xq [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"xs",qualifier:["vec4"],c:!1},{type:"node_in",name:"xt",qualifier:["vec3"],c:!1},{type:"node_in",name:"xu",qualifier:["float"],c:!1},{type:"node_in",name:"xv",qualifier:["float"],c:!1},{type:"node_in",name:"xw",qualifier:["vec3"],c:!1},{type:"node_in",name:"xx",qualifier:["vec3"],c:!1},{type:"node_in",name:"xy",qualifier:["vec4"],c:!1},{type:"node_in",name:"xz",qualifier:["vec3"],c:!1},{type:"node_in",name:"xA",qualifier:["vec3"],c:!1},{type:"node_in",
name:"xB",qualifier:["vec3"],c:!1},{type:"node_in",name:"xC",qualifier:["float"],c:!1},{type:"node_out",name:"xD",qualifier:["vec4"],c:!1},{type:"node_out",name:"xE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"xE = xt + xB * xA * xv ; xD = xs + vec4 ( xB * xz * xu , xv ) ;".split(" ")}]},{type:"node",name:"LIGHTING_END",h:[{type:"node_in",name:"xF",qualifier:["vec4"],c:!1},{type:"node_in",name:"xG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"vQ = xF . rgb ; vR = xG ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",a:"void xH ( vec3 vE , vec3 vF , vec3 vG , vec3 vH , vec3 vI , vec3 vJ , vec3 vK , vec2 vL , vec2 vM , vec4 vN , float vO , vec4 vP , out vec3 vQ , out vec3 vR ) { float vS , vT , vU , vV , vW , vX , vY ; vec3 vZ , v_ ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles_nodes.glslf"]={type:"group",b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",
a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float xI = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR",
"USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 xN ( vec3 xJ ) { float xK , xL ; vec4 xM ; xM = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; xM = mix ( vec4 ( xJ . bg , xM . wz ) , vec4 ( xJ . gb , xM . xy ) , step ( xJ . b , xJ . g ) ) ; xM = mix ( vec4 ( xM . xyw , xJ . r ) , vec4 ( xJ . r , xM . yzx ) , step ( xM . x , xJ . r ) ) ; xK = xM . x - min ( xM . w , xM . y ) ; xL = 1.0e-10 ; return vec3 ( abs ( xM . z + ( xM . w - xM . y ) / ( 6.0 * xK + xL ) ) , xK / ( xM . x + xL ) , xM . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 xR ( vec3 xO ) { vec3 xP ; vec4 xQ ; xQ = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; xP = abs ( fract ( vec3 ( xO . r , xO . r , xO . r ) + xQ . xyz ) * 6.0 - xQ . www ) ; return xO . b * mix ( xQ . xxx , clamp ( xP - xQ . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , xO . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 xT ( vec2 xS ) { return vec3 ( xS * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 xV ( vec3 xU ) { return vec2 ( xU . xy * xI + vec2 ( xI , xI ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"yF",qualifier:["vec3"],c:!0},{type:"node_out",name:"yG",qualifier:["float"],c:!0},{type:"node_out",name:"yH",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yF"],f:[{type:"textline",a:"yF = normalize ( yw . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yG"],f:[{type:"textline",a:"yG = abs ( yw . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yH"],
f:[{type:"textline",a:"yH = length ( yw . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"yI",qualifier:["float"],c:!1},{type:"node_in",name:"yJ",qualifier:["float"],c:!1},{type:"node_in",name:"yK",qualifier:["float"],c:!1},{type:"node_out",name:"yL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yL = vec3 ( yI , yJ , yK ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"yM",qualifier:["float"],c:!1},{type:"node_in",name:"yN",qualifier:["float"],
c:!1},{type:"node_in",name:"yO",qualifier:["float"],c:!1},{type:"node_out",name:"yP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yP = xR ( vec3 ( yM , yN , yO ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"yQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yQ = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"yR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yR = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"yS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yS = xT ( bM ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"yT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yT = 2.0 * vec3 ( bM , ZERO_VALUE_NODES ) - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"yU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yU = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"yV",qualifier:["float"],c:!1}],f:[{type:"textline",a:["yV","=","UNITY_VALUE_NODES",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"yW",qualifier:["float"],c:!1},{type:"node_out",name:"yX",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yW = UNITY_VALUE_NODES ; yX = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"yY",qualifier:["float"],c:!1},{type:"node_out",name:"yZ",qualifier:["float"],
c:!1},{type:"node_out",name:"y_",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yY = UNITY_VALUE_NODES ; yZ = UNITY_VALUE_NODES ; y_ = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",name:"za",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["za","=","yz",";"]}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"zb",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",a:"zb = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"zb = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",name:"zc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["zc","=","ye",";"]}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"zd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zd [ 0 ] = yw [ 0 ] ; zd [ 1 ] = yw [ 1 ] ; zd [ 2 ] = yw [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",
name:"ze",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ze = vec3 ( yA . r , - yA . b , yA . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"zf",qualifier:["vec3"],c:!1},{type:"node_out",name:"zg",qualifier:["vec3"],c:!1},{type:"node_out",name:"zh",qualifier:["vec3"],c:!1},{type:"node_out",name:"zi",qualifier:["vec3"],c:!1},{type:"node_out",name:"zj",qualifier:["vec3"],c:!1},{type:"node_out",name:"zk",qualifier:["vec3"],c:!1},{type:"node_out",name:"zl",qualifier:["float"],
c:!1},{type:"node_out",name:"zm",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zf = vec3 ( ZERO_VALUE_NODES ) ; zg = vec3 ( ZERO_VALUE_NODES ) ; zh = vec3 ( ZERO_VALUE_NODES ) ; zi = vec3 ( ZERO_VALUE_NODES ) ; zj = vec3 ( ZERO_VALUE_NODES ) ; zk = vec3 ( ZERO_VALUE_NODES ) ; zl = ZERO_VALUE_NODES ; zm = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"zn",qualifier:["float"],c:!1},{type:"node_in",name:"zo",qualifier:["float"],c:!1},{type:"node_in",name:"zp",
qualifier:["float"],c:!1},{type:"node_in",name:"zq",qualifier:["float"],c:!1},{type:"node_in",name:"zr",qualifier:["vec3"],c:!1},{type:"node_out",name:"zs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yC = xN ( zr ) ; yC [ 0 ] += ( zn - xI ) ; if ( yC [ 0 ] > UNITY_VALUE_NODES ) yC [ 0 ] -= UNITY_VALUE_NODES ; else if ( yC [ 0 ] < ZERO_VALUE_NODES ) yC [ 0 ] += UNITY_VALUE_NODES ; yC *= vec3 ( UNITY_VALUE_NODES , zo , zp ) ; yC = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , yC , step ( vec3 ( ZERO_VALUE_NODES ) , yC ) ) , step ( yC , vec3 ( UNITY_VALUE_NODES ) ) ) ; zs = mix ( zr , xR ( yC ) , zq ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"zt",qualifier:["float"],c:!1},{type:"node_in",name:"zu",qualifier:["vec3"],c:!1},{type:"node_out",name:"zv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zv = mix ( zu , vec3 ( UNITY_VALUE_NODES ) - zu , zt ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"zw",qualifier:["vec3"],c:!0},{type:"node_out",name:"zx",qualifier:["vec3"],c:!1},{type:"node_out",name:"zy",qualifier:["float"],c:!1},{type:"node_out",name:"zz",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zw"],f:[{type:"textline",a:"zw = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"yx = u_lamp_light_factors [ LAMP_INDEX ] ; yC = u_lamp_light_directions [ LAMP_INDEX ] ; yD = u_lamp_light_positions [ LAMP_INDEX ] ; yp = yx . z ; if ( yp != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"zx = yD - bC ; zy = length ( zx ) ; zx = normalize ( zx ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_zz"],f:[{type:"textline",a:"zz = yp / ( yp + zy * zy ) ; yp = yx . x ; yq = yx . y ; if ( yp > - UNITY_VALUE_NODES ) { yr = dot ( zx , yC ) ; yr *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yr - yp ) / yq ) ; zz *= yr ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zx"],f:[{type:"textline",a:["zx","=","yC",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zy"],f:[{type:"textline",a:"zy = length ( yD - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zz"],f:[{type:"textline",a:["zz","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"zA",qualifier:["vec3"],c:!1},{type:"node_out",name:"zB",qualifier:["vec3"],c:!0},{type:"node_out",name:"zC",qualifier:["float"],c:!0},{type:"node_param",name:"xW",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zB"],f:[{type:"textline",a:["zB","=","xW",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_zC"],f:[{type:"textline",a:"zC = - dot ( zA , xW ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"zD",qualifier:["vec3"],c:!1},{type:"node_out",name:"zE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zE = - ( yf * vec4 ( zD , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"zF",qualifier:["vec3"],c:!1},{type:"node_in",name:"zG",qualifier:["float"],c:!1},{type:"node_in",name:"zH",
qualifier:["float"],c:!1},{type:"node_in",name:"zI",qualifier:["float"],c:!1},{type:"node_in",name:"zJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"zK",qualifier:["vec3"],c:!1},{type:"node_out",name:"zL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["zL","=","zF",";"]},{type:"textline",a:"zG ; zH ; zI ; zJ ; zK ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"zM",qualifier:["vec3"],c:!1},{type:"node_in",name:"zN",qualifier:["float"],c:!1},{type:"node_in",name:"zO",
qualifier:["vec3"],c:!1},{type:"node_out",name:"zP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["zP","=","zM",";"]},{type:"textline",a:["zN",";","zO",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"zQ",qualifier:["vec3"],c:!1},{type:"node_in",name:"zR",qualifier:["float"],c:!1},{type:"node_in",name:"zS",qualifier:["float"],c:!1},{type:"node_in",name:"zT",qualifier:["vec3"],c:!1},{type:"node_out",name:"zU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["zU","=","zQ",";"]},{type:"textline",
a:"zR ; zS ; zT ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"zV",qualifier:["vec3"],c:!1},{type:"node_in",name:"zW",qualifier:["float"],c:!1},{type:"node_in",name:"zX",qualifier:["vec3"],c:!1},{type:"node_out",name:"zY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["zY","=","zV",";"]},{type:"textline",a:["zW",";","zX",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"zZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"z_",qualifier:["float"],c:!1},{type:"node_in",
name:"Aa",qualifier:["float"],c:!1},{type:"node_in",name:"Ab",qualifier:["float"],c:!1},{type:"node_out",name:"Ac",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ac","=","zZ",";"]},{type:"textline",a:"z_ ; Aa ; Ab ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"Ad",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ae",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ae","=","Ad",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"Af",qualifier:["vec3"],
c:!1},{type:"node_in",name:"Ag",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ah",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ah","=","Af",";"]},{type:"textline",a:["Ag",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"Ai",qualifier:["vec3"],c:!1},{type:"node_in",name:"Aj",qualifier:["float"],c:!1},{type:"node_in",name:"Ak",qualifier:["float"],c:!1},{type:"node_in",name:"Al",qualifier:["vec3"],c:!1},{type:"node_out",name:"Am",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"Am [ 0 ] = Am [ 1 ] = Am [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ai ; Aj ; Ak ; Al ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"An",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ao",qualifier:["float"],c:!1},{type:"node_in",name:"Ap",qualifier:["float"],c:!1},{type:"node_in",name:"Aq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ar",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ar","=","An",";"]},{type:"textline",a:"Ao ; Ap ; Aq ;".split(" ")}]},
{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"As",qualifier:["vec3"],c:!1},{type:"node_in",name:"At",qualifier:["float"],c:!1},{type:"node_in",name:"Au",qualifier:["vec3"],c:!1},{type:"node_out",name:"Av",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Av","=","As",";"]},{type:"textline",a:["At",";","Au",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",h:[{type:"node_in",name:"Aw",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ax",qualifier:["float"],c:!1},{type:"node_in",name:"Ay",
qualifier:["vec3"],c:!1},{type:"node_in",name:"Az",qualifier:["float"],c:!1},{type:"node_in",name:"AA",qualifier:["float"],c:!1},{type:"node_in",name:"AB",qualifier:["vec3"],c:!1},{type:"node_out",name:"AC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AC [ 0 ] = AC [ 1 ] = AC [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Aw ; Ay ; Az ; AA ; AB ; Ax ;".split(" ")}]},{type:"node",name:"EMISSION",h:[{type:"node_in",name:"AD",qualifier:["vec3"],c:!1},{type:"node_in",name:"AE",qualifier:["float"],
c:!1},{type:"node_out",name:"AF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AF","=","AD",";"]},{type:"textline",a:["AE",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"AG",qualifier:["vec3"],c:!1},{type:"node_out",name:"AH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AH [ 0 ] = AH [ 1 ] = AH [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["AG",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"AI",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"AI [ 0 ] = AI [ 1 ] = AI [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"AJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"AK",qualifier:["float"],c:!1},{type:"node_out",name:"AL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AL [ 0 ] = AL [ 1 ] = AL [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["AJ",";","AK",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"AM",qualifier:["vec3"],c:!1},{type:"node_in",
name:"AN",qualifier:["float"],c:!1},{type:"node_in",name:"AO",qualifier:["float"],c:!1},{type:"node_out",name:"AP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AP [ 0 ] = AP [ 1 ] = AP [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"AM ; AN ; AO ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"AQ",qualifier:["float"],c:!1},{type:"node_in",name:"AR",qualifier:["float"],c:!1},{type:"node_in",name:"AS",qualifier:["float"],c:!1},{type:"node_in",name:"AT",qualifier:["vec3"],
c:!1},{type:"node_out",name:"AU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AU","=","AT",";"]},{type:"textline",a:"AQ ; AR ; AS ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"AV",qualifier:["float"],c:!1},{type:"node_in",name:"AW",qualifier:["vec3"],c:!1},{type:"node_out",name:"AX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AX","=","AW",";"]},{type:"textline",a:["AV",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"AY",qualifier:["vec3"],
c:!1},{type:"node_out",name:"AZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AZ [ 0 ] = AZ [ 1 ] = AZ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["AY",";"]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"A_",qualifier:["float"],c:!1},{type:"node_out",name:"Ba",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Ba [ 0 ] = Ba [ 1 ] = Ba [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["A_",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"Bb",qualifier:["float"],
c:!1},{type:"node_out",name:"Bc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bc [ 0 ] = Bc [ 1 ] = Bc [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Bb",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"Bd",qualifier:["vec3"],c:!1},{type:"node_out",name:"Be",qualifier:["float"],c:!1},{type:"node_out",name:"Bf",qualifier:["float"],c:!1},{type:"node_out",name:"Bg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Be = Bd [ 0 ] ; Bf = Bd [ 1 ] ; Bg = Bd [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"Bh",qualifier:["float"],c:!1},{type:"node_in",name:"Bi",qualifier:["float"],c:!1},{type:"node_in",name:"Bj",qualifier:["float"],c:!1},{type:"node_out",name:"Bk",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bk [ 0 ] = Bh ; Bk [ 1 ] = Bi ; Bk [ 2 ] = Bj ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"Bl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Bm",qualifier:["float"],c:!1},{type:"node_in",name:"Bn",qualifier:["float"],
c:!1},{type:"node_out",name:"Bo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yr = Bm - Bn * xI ; Bo = max ( ( UNITY_VALUE_NODES + Bn ) * Bl + yr , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"Bp",qualifier:["float"],c:!1},{type:"node_in",name:"Bq",qualifier:["float"],c:!1},{type:"node_out",name:"Br",qualifier:["float"],c:!1},{type:"node_out",name:"Bs",qualifier:["float"],c:!1},{type:"node_out",name:"Bt",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"Br = Bs = Bt = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Bp",";","Bq",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"Bu",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Bv [ 0 ] = Bv [ 1 ] = Bv [ 2 ] = ZERO_VALUE_NODES ; Bw = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Bu",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"Bx",qualifier:["vec3"],
c:!1},{type:"node_out",name:"By",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"By [ 0 ] = By [ 1 ] = By [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Bx",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"Bz",qualifier:["vec3"],c:!1},{type:"node_out",name:"BA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BA [ 0 ] = BA [ 1 ] = BA [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Bz",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"BB",qualifier:["vec3"],
c:!1},{type:"node_in",name:"BC",qualifier:["float"],c:!1},{type:"node_in",name:"BD",qualifier:["float"],c:!1},{type:"node_in",name:"BE",qualifier:["float"],c:!1},{type:"node_out",name:"BF",qualifier:["vec3"],c:!1},{type:"node_out",name:"BG",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BF [ 0 ] = BF [ 1 ] = BF [ 2 ] = ZERO_VALUE_NODES ; BG = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"BB ; BC ; BD ; BE ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"BH",qualifier:["vec3"],
c:!1},{type:"node_in",name:"BI",qualifier:["float"],c:!1},{type:"node_in",name:"BJ",qualifier:["float"],c:!1},{type:"node_in",name:"BK",qualifier:["float"],c:!1},{type:"node_in",name:"BL",qualifier:["float"],c:!1},{type:"node_out",name:"BM",qualifier:["vec3"],c:!1},{type:"node_out",name:"BN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BM [ 0 ] = BM [ 1 ] = BM [ 2 ] = ZERO_VALUE_NODES ; BN = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"BH ; BI ; BJ ; BK ; BL ;".split(" ")}]},{type:"node",
name:"TEX_VORONOI",h:[{type:"node_in",name:"BO",qualifier:["vec3"],c:!1},{type:"node_in",name:"BP",qualifier:["float"],c:!1},{type:"node_out",name:"BQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"BR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BQ [ 0 ] = BQ [ 1 ] = BQ [ 2 ] = ZERO_VALUE_NODES ; BR = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["BO",";","BP",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",name:"BS",qualifier:["vec3"],c:!1},{type:"node_in",name:"BT",qualifier:["float"],
c:!1},{type:"node_in",name:"BU",qualifier:["float"],c:!1},{type:"node_in",name:"BV",qualifier:["float"],c:!1},{type:"node_in",name:"BW",qualifier:["float"],c:!1},{type:"node_in",name:"BX",qualifier:["float"],c:!1},{type:"node_in",name:"BY",qualifier:["float"],c:!1},{type:"node_out",name:"BZ",qualifier:["vec3"],c:!1},{type:"node_out",name:"B_",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BZ [ 0 ] = BZ [ 1 ] = BZ [ 2 ] = ZERO_VALUE_NODES ; B_ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"BS ; BT ; BU ; BV ; BW ; BX ; BY ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"Ca",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cb",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cc",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cb [ 0 ] = Cb [ 1 ] = Cb [ 2 ] = ZERO_VALUE_NODES ; Cc = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Ca",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"Cd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ce",
qualifier:["float"],c:!1},{type:"node_in",name:"Cf",qualifier:["float"],c:!1},{type:"node_out",name:"Cg",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ch",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cg [ 0 ] = Cg [ 1 ] = Cg [ 2 ] = ZERO_VALUE_NODES ; Ch = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Cd ; Ce ; Cf ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"Ci",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cj",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ck",
qualifier:["vec3"],c:!1},{type:"node_in",name:"Cl",qualifier:["float"],c:!1},{type:"node_out",name:"Cm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cn",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cm [ 0 ] = Cm [ 1 ] = Cm [ 2 ] = ZERO_VALUE_NODES ; Cn = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ci ; Cj ; Ck ; Cl ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"Co",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cp",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Cq",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cr",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cs",qualifier:["float"],c:!1},{type:"node_in",name:"Ct",qualifier:["float"],c:!1},{type:"node_in",name:"Cu",qualifier:["float"],c:!1},{type:"node_in",name:"Cv",qualifier:["float"],c:!1},{type:"node_in",name:"Cw",qualifier:["float"],c:!1},{type:"node_out",name:"Cx",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cy",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cx [ 0 ] = Cx [ 1 ] = Cx [ 2 ] = ZERO_VALUE_NODES ; Cy = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"Co ; Cp ; Cq ; Cr ; Cs ; Ct ; Cu ; Cv ; Cw ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"Cz",qualifier:["vec3"],c:!1},{type:"node_in",name:"CA",qualifier:["vec3"],c:!1},{type:"node_out",name:"CB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CB = clamp ( Cz + CA , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"CC",qualifier:["float"],c:!1},{type:"node_in",name:"CD",
qualifier:["vec3"],c:!1},{type:"node_in",name:"CE",qualifier:["vec3"],c:!1},{type:"node_out",name:"CF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yr = clamp ( CC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; CF = yr * CD + ( UNITY_VALUE_NODES - yr ) * CE ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"CG",qualifier:["vec3"],c:!1},{type:"node_out",name:"CH",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CG"],f:[{type:"textline",a:"CG = xT ( bM ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CH"],f:[{type:"textline",a:"CH = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"CI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CI = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",name:"CJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["CJ","=","yB",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"CK",
qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CK = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"CL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CL [ 0 ] = CL [ 1 ] = CL [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"CM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CM [ 0 ] = yw [ 0 ] ; CM [ 1 ] = yw [ 1 ] ; CM [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",
h:[{type:"node_out",name:"CN",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CN [ 0 ] = CN [ 1 ] = CN [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"CO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CO [ 0 ] = CO [ 1 ] = CO [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"CP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CP = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",
h:[{type:"node_out",name:"CQ",qualifier:["float"],c:!1},{type:"node_out",name:"CR",qualifier:["float"],c:!1},{type:"node_out",name:"CS",qualifier:["float"],c:!1},{type:"node_out",name:"CT",qualifier:["vec3"],c:!1},{type:"node_out",name:"CU",qualifier:["float"],c:!1},{type:"node_out",name:"CV",qualifier:["vec3"],c:!1},{type:"node_out",name:"CW",qualifier:["vec3"],c:!1},{type:"node_param",name:"xX",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"xY",qualifier:["varying","vec3"],c:!0},{type:"node_param",
name:"xZ",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"x_",qualifier:["varying","vec3"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["PARTICLE_BATCH"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CQ"],f:[{type:"textline",a:"CQ = xX [ 0 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CR"],f:[{type:"textline",a:"CR = xX [ 1 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CS"],f:[{type:"textline",a:"CS = xX [ 2 ] ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CT"],f:[{type:"textline",a:"CT = vec3 ( xY . r , - xY . b , xY . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CU"],f:[{type:"textline",a:"CU = xX [ 3 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CV"],f:[{type:"textline",a:"CV = vec3 ( xZ . r , - xZ . b , xZ . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CW"],f:[{type:"textline",a:"CW = vec3 ( x_ . r , - x_ . b , x_ . g ) ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"CQ = ZERO_VALUE_NODES ; CR = ZERO_VALUE_NODES ; CS = ZERO_VALUE_NODES ; CT = vec3 ( ZERO_VALUE_NODES ) ; CU = ZERO_VALUE_NODES ; CV = CT ; CW = CT ;".split(" ")}]}]}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"CX",qualifier:["float"],c:!1},{type:"node_out",name:"CY",qualifier:["float"],c:!1},{type:"node_out",name:"CZ",qualifier:["float"],c:!1},{type:"node_out",name:"C_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CX = ZERO_VALUE_NODES ; CY = ZERO_VALUE_NODES ; CZ = ZERO_VALUE_NODES ; C_ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"Da",qualifier:["vec3"],c:!1},{type:"node_out",name:"Db",qualifier:["float"],c:!1},{type:"node_out",name:"Dc",qualifier:["float"],c:!1},{type:"node_out",name:"Dd",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Db = ZERO_VALUE_NODES ; Dc = ZERO_VALUE_NODES ; Dd = ZERO_VALUE_NODES ; Da = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"De",qualifier:["float"],c:!1},{type:"node_out",name:"Df",
qualifier:["float"],c:!1}],f:[{type:"textline",a:["Df","=","De",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"Dg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dg = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"Dh",qualifier:["float"],c:!1},{type:"node_in",name:"Di",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dj",qualifier:["float"],c:!1},{type:"node_out",name:"Dk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dj = Dk = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["Di",";","Dh",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"Dl",qualifier:["float"],c:!1},{type:"node_out",name:"Dm",qualifier:["float"],c:!1},{type:"node_out",name:"Dn",qualifier:["float"],c:!1},{type:"node_out",name:"Do",qualifier:["float"],c:!1},{type:"node_out",name:"Dp",qualifier:["float"],c:!1},{type:"node_out",name:"Dq",qualifier:["float"],c:!1},{type:"node_out",name:"Dr",qualifier:["float"],c:!1},{type:"node_out",name:"Ds",qualifier:["float"],c:!1},{type:"node_out",
name:"Dt",qualifier:["float"],c:!1},{type:"node_out",name:"Du",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dl = Dm = Dn = ZERO_VALUE_NODES ; Do = Dp = Dq = ZERO_VALUE_NODES ; Dr = Dr = Dt = Du = ZERO_VALUE_NODES ; Ds = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"Dv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dw",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dv = Dw = vec3 ( ZERO_VALUE_NODES ) ; Dx = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"Dy",qualifier:["float"],c:!1},{type:"node_in",name:"Dz",qualifier:["vec3"],c:!1},{type:"node_out",name:"DA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DA","=","Dz",";"]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DA . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * Dz . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["READ_G"],f:[{type:"textline",a:"DA . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * Dz . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DA . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * Dz . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"textline",a:"DA = mix ( Dz , DA , Dy ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"DB",qualifier:["float"],
c:!1},{type:"node_in",name:"DC",qualifier:["vec3"],c:!1},{type:"node_out",name:"DD",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"yr = texture2D ( u_nodes_texture , vec2 ( DC . r , NODE_TEX_ROW ) ) . a ; yq = texture2D ( u_nodes_texture , vec2 ( DC . g , NODE_TEX_ROW ) ) . a ; yp = texture2D ( u_nodes_texture , vec2 ( DC . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"yr = DC . r ; yq = DC . g ; yp = DC . b ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DD . r = texture2D ( u_nodes_texture , vec2 ( yr , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DD . r = yr ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"DD . g = texture2D ( u_nodes_texture , vec2 ( yq , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DD . g = yq ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DD . b = texture2D ( u_nodes_texture , vec2 ( yp , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DD . b = yp ;".split(" ")}]}]},{type:"textline",a:"DD = mix ( DC , DD , DB ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"DE",qualifier:["float"],c:!1},{type:"node_out",name:"DF",qualifier:["vec3"],c:!1},{type:"node_out",name:"DG",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yx = texture2D ( u_nodes_texture , vec2 ( DE , NODE_TEX_ROW ) ) ; DF = yx . rgb ; DG = yx . a ;".split(" ")}]},
{type:"node",name:"MAPPING",h:[{type:"node_in",name:"DH",qualifier:["vec3"],c:!1},{type:"node_out",name:"DI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DI","=","DH",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"DI = ( MAPPING_TRS_MATRIX * vec4 ( DI , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"DI = DI * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"DI = DI + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"DI = max ( DI , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",a:"DI = min ( DI , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"DI = normalize ( DI ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"DJ",qualifier:["float"],c:!1},{type:"node_in",name:"DK",qualifier:["float"],c:!1},{type:"node_out",name:"DL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DL = DJ + DK ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"DL = clamp ( DL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"DM",qualifier:["float"],c:!1},{type:"node_in",
name:"DN",qualifier:["float"],c:!1},{type:"node_out",name:"DO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DO = DM - DN ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"DO = clamp ( DO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",h:[{type:"node_in",name:"DP",qualifier:["float"],c:!1},{type:"node_in",name:"DQ",qualifier:["float"],c:!1},{type:"node_out",name:"DR",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"DR = DP * DQ ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"DR = clamp ( DR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"DS",qualifier:["float"],c:!1},{type:"node_in",name:"DT",qualifier:["float"],c:!1},{type:"node_out",name:"DU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DU = ( DT != ZERO_VALUE_NODES ) ? DS / DT : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"DU = clamp ( DU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"DV",qualifier:["float"],c:!1},{type:"node_in",name:"DW",qualifier:["float"],c:!1},{type:"node_out",name:"DX",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DX = sin ( DV ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"DX = clamp ( DX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["DW",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"DY",qualifier:["float"],c:!1},{type:"node_in",name:"DZ",qualifier:["float"],c:!1},{type:"node_out",name:"D_",qualifier:["float"],c:!1}],f:[{type:"textline",a:"D_ = cos ( DY ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"D_ = clamp ( D_ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["DZ",";"]}]},{type:"node",name:"MATH_TANGENT",
h:[{type:"node_in",name:"Ea",qualifier:["float"],c:!1},{type:"node_in",name:"Eb",qualifier:["float"],c:!1},{type:"node_out",name:"Ec",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ec = tan ( Ea ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ec = clamp ( Ec , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eb",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"Ed",qualifier:["float"],c:!1},{type:"node_in",
name:"Ee",qualifier:["float"],c:!1},{type:"node_out",name:"Ef",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ef = ( Ed <= UNITY_VALUE_NODES && Ed >= - UNITY_VALUE_NODES ) ? asin ( Ed ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ef = clamp ( Ef , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Ee",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"Eg",qualifier:["float"],
c:!1},{type:"node_in",name:"Eh",qualifier:["float"],c:!1},{type:"node_out",name:"Ei",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ei = ( Eg <= UNITY_VALUE_NODES && Eg >= - UNITY_VALUE_NODES ) ? acos ( Eg ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ei = clamp ( Ei , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eh",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"Ej",
qualifier:["float"],c:!1},{type:"node_in",name:"Ek",qualifier:["float"],c:!1},{type:"node_out",name:"El",qualifier:["float"],c:!1}],f:[{type:"textline",a:"El = atan ( Ej ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"El = clamp ( El , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Ek",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"Em",qualifier:["float"],c:!1},{type:"node_in",name:"En",qualifier:["float"],
c:!1},{type:"node_out",name:"Eo",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( Em < ZERO_VALUE_NODES && En != floor ( En ) ) Eo = ZERO_VALUE_NODES ; else if ( En == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"Eo = UNITY_VALUE_NODES ; else if ( Em < ZERO_VALUE_NODES ) Eo = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - En , 2.0 ) ) ) * pow ( - Em , En ) ; else if ( Em == ZERO_VALUE_NODES ) Eo = ZERO_VALUE_NODES ; else Eo = pow ( Em , En ) ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Eo = clamp ( Eo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"Ep",qualifier:["float"],c:!1},{type:"node_in",name:"Eq",qualifier:["float"],c:!1},{type:"node_out",name:"Er",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Er = ( Ep > ZERO_VALUE_NODES && Eq > ZERO_VALUE_NODES ) ? log2 ( Ep ) / log2 ( Eq ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Er = clamp ( Er , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"Es",qualifier:["float"],c:!1},{type:"node_in",name:"Et",qualifier:["float"],c:!1},{type:"node_out",name:"Eu",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Eu = min ( Es , Et ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Eu = clamp ( Eu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"Ev",qualifier:["float"],c:!1},{type:"node_in",name:"Ew",qualifier:["float"],c:!1},{type:"node_out",name:"Ex",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ex = max ( Ev , Ew ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ex = clamp ( Ex , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"Ey",qualifier:["float"],c:!1},
{type:"node_in",name:"Ez",qualifier:["float"],c:!1},{type:"node_out",name:"EA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EA = floor ( Ey + xI ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EA = clamp ( EA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Ez",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"EB",qualifier:["float"],c:!1},{type:"node_in",name:"EC",qualifier:["float"],c:!1},
{type:"node_out",name:"ED",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ED = ( EB < EC ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ED = clamp ( ED , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"EE",qualifier:["float"],c:!1},{type:"node_in",name:"EF",qualifier:["float"],c:!1},{type:"node_out",name:"EG",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"EG = ( EE > EF ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EG = clamp ( EG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"EH",qualifier:["float"],c:!1},{type:"node_in",name:"EI",qualifier:["float"],c:!1},{type:"node_out",name:"EJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EJ = abs ( EI ) > 0.000001 ? mod ( EH , EI ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EJ = clamp ( EJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"EK",qualifier:["float"],c:!1},{type:"node_in",name:"EL",qualifier:["float"],c:!1},{type:"node_out",name:"EM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EM = abs ( EK ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EM = clamp ( EM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["EL",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"EN",qualifier:["float"],c:!1},{type:"node_in",name:"EO",qualifier:["vec3"],c:!1},{type:"node_in",name:"EP",qualifier:["vec3"],c:!1},{type:"node_out",name:"EQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( EN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; EQ = mix ( EO , EP , yp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"EQ = clamp ( EQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"ER",qualifier:["float"],c:!1},{type:"node_in",name:"ES",qualifier:["vec3"],c:!1},{type:"node_in",name:"ET",qualifier:["vec3"],c:!1},{type:"node_out",name:"EU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( ER , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; EU = mix ( ES , ES + ET , yp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"EU = clamp ( EU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"EV",qualifier:["float"],c:!1},{type:"node_in",name:"EW",qualifier:["vec3"],c:!1},{type:"node_in",name:"EX",qualifier:["vec3"],c:!1},{type:"node_out",name:"EY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( EV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; EY = mix ( EW , EW * EX , yp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"EY = clamp ( EY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"EZ",qualifier:["float"],c:!1},{type:"node_in",name:"E_",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fa",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fb",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( EZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fb = mix ( E_ , E_ - Fa , yp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fb = clamp ( Fb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"Fc",qualifier:["float"],c:!1},{type:"node_in",name:"Fd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fe",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ff",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = UNITY_VALUE_NODES - yp ; Ff = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( yq ) + yp * ( vec3 ( UNITY_VALUE_NODES ) - Fe ) ) * ( vec3 ( UNITY_VALUE_NODES ) - Fd ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ff = clamp ( Ff , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"Fg",qualifier:["float"],c:!1},{type:"node_in",name:"Fh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fi",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = UNITY_VALUE_NODES - yp ; Fi += step ( Fi , vec3 ( ZERO_VALUE_NODES ) ) ; Fj = yq * Fh + yp * Fh / Fi ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fj = clamp ( Fj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"Fk",qualifier:["float"],c:!1},{type:"node_in",name:"Fl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fn = mix ( Fl , abs ( Fl - Fm ) , yp ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fn = clamp ( Fn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"Fo",qualifier:["float"],c:!1},{type:"node_in",name:"Fp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fr",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fr = min ( Fp . rgb , Fq . rgb * yp ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fr = clamp ( Fr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"Fs",qualifier:["float"],c:!1},{type:"node_in",name:"Ft",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fu",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fs , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fv = max ( Ft . rgb , Fu . rgb * yp ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fv = clamp ( Fv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"Fw",qualifier:["float"],c:!1},{type:"node_in",name:"Fx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Fw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yD = vec3 ( UNITY_VALUE_NODES - yp ) ; Fz = mix ( Fx * ( yD + 2.0 * yp * Fy ) , vec3 ( UNITY_VALUE_NODES ) - ( yD + 2.0 * yp * ( vec3 ( UNITY_VALUE_NODES ) - Fy ) ) * ( vec3 ( UNITY_VALUE_NODES ) - Fx ) , step ( xI , Fx ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fz = clamp ( Fz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"FA",qualifier:["float"],c:!1},{type:"node_in",name:"FB",qualifier:["vec3"],c:!1},{type:"node_in",name:"FC",qualifier:["vec3"],c:!1},{type:"node_out",name:"FD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yD = vec3 ( UNITY_VALUE_NODES ) - yp * FC ; yC = clamp ( FB / yD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FD = mix ( mix ( yC , vec3 ( UNITY_VALUE_NODES ) , step ( yD , vec3 ( ZERO_VALUE_NODES ) ) ) , FB , step ( FB , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FD = clamp ( FD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"FE",qualifier:["float"],c:!1},{type:"node_in",name:"FF",qualifier:["vec3"],c:!1},{type:"node_in",name:"FG",qualifier:["vec3"],c:!1},{type:"node_out",name:"FH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yD = vec3 ( UNITY_VALUE_NODES - yp ) ; yD = yD + yp * FG ; yC = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - FF ) / yD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FH = mix ( yC , vec3 ( ZERO_VALUE_NODES ) , step ( yD , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FH = clamp ( FH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"FI",qualifier:["float"],c:!1},{type:"node_in",name:"FJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"FK",qualifier:["vec3"],c:!1},{type:"node_out",name:"FL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FL = FJ ; yC = xN ( FK ) ; if ( yC . y != ZERO_VALUE_NODES ) { yD = xN ( FL ) ; yD . x = yC . x ; yE = xR ( yD ) ; FL = mix ( FL , yE , yp ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FL = clamp ( FL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"FM",qualifier:["float"],c:!1},{type:"node_in",name:"FN",qualifier:["vec3"],c:!1},{type:"node_in",name:"FO",qualifier:["vec3"],c:!1},{type:"node_out",name:"FP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = UNITY_VALUE_NODES - yp ; FP = FN ; yE = xN ( FP ) ; if ( yE . y != ZERO_VALUE_NODES ) { yD = xN ( FO ) ; yE . y = yq * yE . y + yp * yD . y ; FP = xR ( yE ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FP = clamp ( FP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"FQ",qualifier:["float"],c:!1},{type:"node_in",name:"FR",qualifier:["vec3"],c:!1},{type:"node_in",name:"FS",qualifier:["vec3"],c:!1},{type:"node_out",name:"FT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = UNITY_VALUE_NODES - yp ; yE = xN ( FR ) ; yD = xN ( FS ) ; yE . z = yq * yE . z + yp * yD . z ; FT = xR ( yE ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FT = clamp ( FT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"FU",qualifier:["float"],c:!1},{type:"node_in",name:"FV",qualifier:["vec3"],c:!1},{type:"node_in",name:"FW",qualifier:["vec3"],c:!1},{type:"node_out",name:"FX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FX = FV ; yD = xN ( FW ) ; if ( yD . y != ZERO_VALUE_NODES ) { yE = xN ( FX ) ; yE . x = yD . x ; yE . y = yD . y ; yC = xR ( yE ) ; FX = mix ( FX , yC , yp ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FX = clamp ( FX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"FY",qualifier:["float"],c:!1},{type:"node_in",name:"FZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"F_",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ga",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( FY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = UNITY_VALUE_NODES - yp ; yC = F_ + FZ - F_ * FZ ; Ga = FZ * ( vec3 ( yq ) + vec3 ( yp ) * ( ( vec3 ( UNITY_VALUE_NODES ) - FZ ) * F_ + yC ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ga = clamp ( Ga , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"Gb",qualifier:["float"],c:!1},{type:"node_in",name:"Gc",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gd",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ge",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yp = clamp ( Gb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Ge = Gc + yp * ( 2.0 * Gd - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ge = clamp ( Ge , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"Gf",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yg = Gf ; yk = Gg ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"Gh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gi",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Gj",qualifier:["float"],c:!1},{type:"node_in",name:"Gk",qualifier:["vec3"],c:!0},{type:"node_in",name:"Gl",qualifier:["float"],c:!0},{type:"node_out",name:"Gm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gn",qualifier:["vec3"],c:!1},{type:"node_out",name:"Go",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gp",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gr",qualifier:["vec2"],c:!1},{type:"node_out",name:"Gs",qualifier:["vec2"],c:!1},
{type:"node_out",name:"Gt",qualifier:["vec4"],c:!1},{type:"node_param",name:"ya",qualifier:["const","vec2"],c:!0},{type:"node_param",name:"yb",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"Go = clamp ( Gh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"Gp = yb [ 0 ] * clamp ( Gi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"Gq = normalize ( Gk ) ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:["Gq","=","yB",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"Gm = Gl * Go ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"Gm = yn * Go ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:["Go","*=","Gj",";"]}]}]},{type:"textline",a:"Gn = yo * u_environment_energy * dS ( Gq ) ; Gt = vec4 ( 1.0 ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"Gr = vec2 ( ya [ 0 ] , ya [ 1 ] ) ;".split(" ")},{type:"textline",a:"Gs = vec2 ( yb [ 1 ] , yb [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["yj","=","Gt",";"]}]},{type:"node_else",f:[{type:"textline",a:"Gm = vec3 ( ZERO_VALUE_NODES ) ; Gn = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"Gu",qualifier:["vec4"],c:!1},{type:"node_in",name:"Gv",
qualifier:["vec3"],c:!1},{type:"node_in",name:"Gw",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gx",qualifier:["float"],c:!0},{type:"node_in",name:"Gy",qualifier:["float"],c:!0},{type:"node_in",name:"Gz",qualifier:["float"],c:!0},{type:"node_out",name:"GA",qualifier:["vec3"],c:!0},{type:"node_out",name:"GB",qualifier:["float"],c:!0},{type:"node_out",name:"GC",qualifier:["vec3"],c:!0},{type:"node_out",name:"GD",qualifier:["vec3"],c:!0},{type:"node_out",name:"GE",qualifier:["vec3"],c:!0},{type:"node_param",
name:"yc",qualifier:["float"],c:!1},{type:"node_param",name:"yd",qualifier:["float"],c:!1}],f:[{type:"textline",a:["Gx",";"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GA"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"GA = Gu . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"GA = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["GA","+=",
"Gv",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GC"],f:[{type:"textline",a:["GC","=","Gw",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GD"],f:[{type:"textline",a:"GD = Gu . rgb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GE"],f:[{type:"textline",a:["GE","=","Gv",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GB"],f:[{type:"textline",a:"GB = clamp ( Gz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"yp = max ( max ( Gv . r , Gv . g ) , Gv . b ) * Gy ; GB = clamp ( Gz * ( UNITY_VALUE_NODES - yp ) + yp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GB"],f:[{type:"textline",a:"GB = clamp ( yc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],
f:[{type:"textline",a:"yp = max ( max ( Gv . r , Gv . g ) , Gv . b ) * yd ; GB = yc * ( UNITY_VALUE_NODES - yp ) + yp ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["yh","=","Gv",";"]}]},{type:"node_else",f:[{type:"textline",a:"yh = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["yi","=","Gw",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"GF",qualifier:["vec3"],c:!1},{type:"node_in",name:"GG",
qualifier:["vec3"],c:!1},{type:"node_in",name:"GH",qualifier:["vec3"],c:!1},{type:"node_out",name:"GI",qualifier:["vec4"],c:!1},{type:"node_out",name:"GJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"GI = vec4 ( GF + GH * GG , ZERO_VALUE_NODES ) ; GJ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"GK",qualifier:["vec4"],c:!1},{type:"node_out",name:"GL",qualifier:["vec3"],c:!1},{type:"node_out",name:"GM",qualifier:["vec2"],c:!1},{type:"node_out",
name:"GN",qualifier:["vec3"],c:!1},{type:"node_out",name:"GO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"GM = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",a:["GO","=","xI",";"]}]},{type:"node_else",f:[{type:"textline",a:["GO","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"GN = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"GN *= GK [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"yC = u_light_positions [ LAMP_IND ] ; GL = yC - yA ;".split(" ")},{type:"textline",a:"yp = length ( GL ) ; GN *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + yp * yp ) ; GL = normalize ( GL ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"yC = u_light_directions [ LAMP_IND ] ; yp = dot ( GL , yC ) ; yp *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yp - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; GN *= yp ;".split(" ")}]}]}]},{type:"node_else",f:[{type:"textline",a:"GL = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"GP",qualifier:["vec3"],c:!1},{type:"node_in",
name:"GQ",qualifier:["vec2"],c:!1},{type:"node_in",name:"GR",qualifier:["vec3"],c:!1},{type:"node_in",name:"GS",qualifier:["float"],c:!1},{type:"node_in",name:"GT",qualifier:["vec2"],c:!1},{type:"node_out",name:"GU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"GU = ZERO_VALUE_NODES ; if ( GQ . r != ZERO_VALUE_NODES ) { yp = ( UNITY_VALUE_NODES - GS ) * dot ( GR , GP ) + GS ; if ( GT [ 0 ] == ZERO_VALUE_NODES ) { GU = UNITY_VALUE_NODES ; } else { yp = UNITY_VALUE_NODES + abs ( yp ) ; yp = GT [ 1 ] + ( UNITY_VALUE_NODES - GT [ 1 ] ) * pow ( yp , GT [ 0 ] ) ; GU = clamp ( yp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } GU = max ( GU , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"GV",qualifier:["vec3"],c:!1},{type:"node_in",name:"GW",qualifier:["vec2"],c:!1},{type:"node_in",name:"GX",qualifier:["vec3"],c:!1},{type:"node_in",name:"GY",qualifier:["float"],c:!1},{type:"node_out",name:"GZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"GZ = ZERO_VALUE_NODES ; if ( GW . r != ZERO_VALUE_NODES ) { yp = ( UNITY_VALUE_NODES - GY ) * dot ( GX , GV ) + GY ; GZ = max ( yp , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"G_",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ha",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hb",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hc",qualifier:["float"],c:!1},{type:"node_in",name:"Hd",qualifier:["vec2"],c:!1},{type:"node_out",name:"He",qualifier:["float"],c:!1}],f:[{type:"textline",a:"He = ZERO_VALUE_NODES ; if ( Ha . r != ZERO_VALUE_NODES ) { yp = ( UNITY_VALUE_NODES - Hc ) * dot ( Hb , G_ ) + Hc ; if ( Hd [ 0 ] > ZERO_VALUE_NODES ) { yq = max ( dot ( Hb , ye ) , ZERO_VALUE_NODES ) ; yr = Hd [ 0 ] * Hd [ 0 ] ; ys = UNITY_VALUE_NODES - xI * ( yr / ( yr + 0.33 ) ) ; yC = G_ - yp * Hb ; yE = ye - yq * Hb ;".split(" ")},
{type:"textline",a:"if ( length ( yC ) == ZERO_VALUE_NODES || length ( yE ) == ZERO_VALUE_NODES || abs ( yp ) > UNITY_VALUE_NODES || abs ( yq ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"He = yp * ys ; else { yt = acos ( yp ) ; yq = acos ( yq ) ; yC = normalize ( yC ) ; yE = normalize ( yE ) ; yu = max ( yt , yq ) ; yv = min ( yt , yq ) ; yv *= 0.95 ; yq = max ( dot ( yC , yE ) , ZERO_VALUE_NODES ) ; yr = 0.45 * ( yr / ( yr + 0.09 ) ) ; He = yp * ( ys + ( yr * yq * sin ( yu ) * tan ( yv ) ) ) ; } } else He = yp ; He = max ( He , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"Hf",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hg",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hi",qualifier:["float"],c:!1},{type:"node_in",name:"Hj",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hk = ZERO_VALUE_NODES ; if ( Hg . r != ZERO_VALUE_NODES ) { yp = ( UNITY_VALUE_NODES - Hi ) * dot ( Hh , Hf ) + Hi ; yv = max ( dot ( Hh , ye ) , ZERO_VALUE_NODES ) ; if ( Hj [ 0 ] <= UNITY_VALUE_NODES ) Hk = yp * pow ( max ( yv * yp , 0.1 ) , Hj [ 0 ] - UNITY_VALUE_NODES ) ; else Hk = yp * pow ( 1.0001 - yv , Hj [ 0 ] - UNITY_VALUE_NODES ) ; Hk = max ( Hk , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"Hl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hm",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hn",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ho",qualifier:["float"],c:!1},{type:"node_in",name:"Hp",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hq",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hq = ZERO_VALUE_NODES ; if ( Hm . r != ZERO_VALUE_NODES ) { yv = ( UNITY_VALUE_NODES - Ho ) * dot ( Hn , Hl ) + Ho ; yv = acos ( yv ) ; if ( yv < Hp [ 0 ] ) Hq = UNITY_VALUE_NODES ; else if ( yv > ( Hp [ 0 ] + Hp [ 1 ] ) || Hp [ 1 ] == ZERO_VALUE_NODES ) Hq = ZERO_VALUE_NODES ; else Hq = UNITY_VALUE_NODES - ( ( yv - Hp [ 0 ] ) / Hp [ 1 ] ) ; Hq = max ( Hq , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"Hr",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hs",qualifier:["vec2"],c:!1},{type:"node_in",name:"Ht",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hu",qualifier:["float"],c:!1},{type:"node_in",name:"Hv",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hw = ZERO_VALUE_NODES ; if ( Hs . g == UNITY_VALUE_NODES ) { yE = normalize ( Hr + ye ) ; Hw = ( UNITY_VALUE_NODES - Hu ) * max ( dot ( Ht , yE ) , ZERO_VALUE_NODES ) + Hu ; Hw = pow ( Hw , Hv [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"Hx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hy",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hz",qualifier:["vec3"],c:!1},{type:"node_in",name:"HA",qualifier:["vec2"],c:!1},{type:"node_out",name:"HB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HB = ZERO_VALUE_NODES ; if ( Hy . g == UNITY_VALUE_NODES ) { yE = normalize ( Hx + ye ) ; yv = max ( dot ( Hz , yE ) , 0.001 ) ;".split(" ")},{type:"textline",a:"yp = max ( dot ( Hz , ye ) , 0.01 ) ; yu = max ( dot ( Hz , Hx ) , 0.01 ) ; yv = tan ( acos ( yv ) ) ; yq = max ( HA [ 0 ] , 0.001 ) ; HB = yu * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * yq * yq ) ) * ( exp ( - ( yv * yv ) / ( yq * yq ) ) / ( sqrt ( yp * yu ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"HC",qualifier:["vec3"],c:!1},{type:"node_in",name:"HD",qualifier:["vec2"],c:!1},{type:"node_in",name:"HE",qualifier:["vec3"],c:!1},{type:"node_in",name:"HF",qualifier:["vec2"],c:!1},{type:"node_out",name:"HG",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HG = ZERO_VALUE_NODES ; if ( HD . g == UNITY_VALUE_NODES ) { yE = normalize ( HC + ye ) ; yu = acos ( dot ( yE , HE ) ) ; if ( yu < HF [ 0 ] ) HG = UNITY_VALUE_NODES ; else if ( yu >= HF [ 0 ] + HF [ 1 ] || HF [ 1 ] == ZERO_VALUE_NODES ) HG = ZERO_VALUE_NODES ; else HG = UNITY_VALUE_NODES - ( yu - HF [ 0 ] ) / HF [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"HH",qualifier:["vec3"],c:!1},{type:"node_in",name:"HI",qualifier:["vec2"],c:!1},{type:"node_in",name:"HJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"HK",qualifier:["float"],c:!1},{type:"node_in",name:"HL",qualifier:["vec2"],c:!1},{type:"node_out",name:"HM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HM = ZERO_VALUE_NODES ; if ( HI . g == UNITY_VALUE_NODES ) { if ( HL [ 0 ] < UNITY_VALUE_NODES || HL [ 1 ] == ZERO_VALUE_NODES ) HM = ZERO_VALUE_NODES ; else { if ( HL [ 1 ] < 100.0 ) HL [ 1 ] = sqrt ( UNITY_VALUE_NODES / HL [ 1 ] ) ; else HL [ 1 ] = 10.0 / HL [ 1 ] ; yE = normalize ( ye + HH ) ; yu = ( UNITY_VALUE_NODES - HK ) * max ( dot ( HJ , yE ) , ZERO_VALUE_NODES ) + HK ; if ( yu < ZERO_VALUE_NODES ) HM = ZERO_VALUE_NODES ; else { yp = max ( dot ( HJ , ye ) , 0.01 ) ; yq = dot ( HJ , HH ) ; if ( yq <= 0.01 ) HM = ZERO_VALUE_NODES ; else { yv = max ( dot ( ye , yE ) , 0.01 ) ; yr = UNITY_VALUE_NODES ; yp = ( 2.0 * yu * yp ) / yv ; yq = ( 2.0 * yu * yq ) / yv ; yq = min ( min ( yr , yp ) , yq ) ; yp = sqrt ( pow ( HL [ 0 ] , 2.0 ) + pow ( yv , 2.0 ) - UNITY_VALUE_NODES ) ; yv = pow ( yp - yv , 2.0 ) / pow ( yp + yv , 2.0 ) * ( UNITY_VALUE_NODES + pow ( yv * ( yp + yv ) - UNITY_VALUE_NODES , 2.0 ) / pow ( yv * ( yp - yv ) + UNITY_VALUE_NODES , 2.0 ) ) ; yu = acos ( yu ) ; HM = max ( yv * yq * exp ( - pow ( yu , 2.0 ) / ( 2.0 * pow ( HL [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"HN",qualifier:["vec4"],c:!1},{type:"node_in",name:"HO",qualifier:["vec3"],c:!1},{type:"node_in",name:"HP",qualifier:["float"],c:!1},{type:"node_in",name:"HQ",qualifier:["float"],c:!1},{type:"node_in",name:"HR",qualifier:["vec3"],c:!1},{type:"node_in",name:"HS",qualifier:["vec3"],c:!1},{type:"node_in",name:"HT",qualifier:["vec4"],c:!1},{type:"node_in",name:"HU",qualifier:["vec3"],c:!1},{type:"node_in",name:"HV",qualifier:["vec3"],c:!1},{type:"node_in",
name:"HW",qualifier:["vec3"],c:!1},{type:"node_in",name:"HX",qualifier:["float"],c:!1},{type:"node_out",name:"HY",qualifier:["vec4"],c:!1},{type:"node_out",name:"HZ",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( HR , HS ) * dot ( ye , HS ) < ZERO_VALUE_NODES ) { yu = HT . x ; yq = HT . y ; yv = HT . z ; yp = HT . w ;".split(" ")},{type:"textline",a:"yr = clamp ( abs ( dot ( HR , HS ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ys = clamp ( dot ( ye , - HR ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = pow ( ys , yq ) ;".split(" ")},
{type:"textline",a:"HY = HN + HX * vec4 ( HW * yr * pow ( HU , vec3 ( yu ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"HY += yv * mix ( vec4 ( HU , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , yp ) * HX * vec4 ( HW * yr * vec3 ( yq ) , UNITY_VALUE_NODES ) ; HZ = HO ; } else {".split(" ")},{type:"textline",a:"HZ = HO + HW * HV * HQ ; HY = HN + vec4 ( HW * HU * HP , HQ ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"HZ = HO + HW * HV * HQ ; HY = HN + vec4 ( HW * HU * HP , HQ ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"H_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"H_ = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"Ia",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ib",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ib = dot ( Ia , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"Ic",qualifier:["vec3"],c:!1},{type:"node_out",name:"Id",qualifier:["float"],c:!0},
{type:"node_out",name:"Ie",qualifier:["float"],c:!0},{type:"node_out",name:"If",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Id"],f:[{type:"textline",a:"Id = Ic . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ie"],f:[{type:"textline",a:"Ie = Ic . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_If"],f:[{type:"textline",a:"If = Ic . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"Ig",
qualifier:["vec3"],c:!1},{type:"node_out",name:"Ih",qualifier:["float"],c:!0},{type:"node_out",name:"Ii",qualifier:["float"],c:!0},{type:"node_out",name:"Ij",qualifier:["float"],c:!0}],f:[{type:"textline",a:"yE = xN ( Ig ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ih"],f:[{type:"textline",a:"Ih = yE . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ii"],f:[{type:"textline",a:"Ii = yE . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_Ij"],f:[{type:"textline",a:"Ij = yE . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"Ik",qualifier:["float"],c:!1},{type:"node_in",name:"Il",qualifier:["float"],c:!1},{type:"node_in",name:"Im",qualifier:["float"],c:!1},{type:"node_out",name:"In",qualifier:["float"],c:!1}],f:[{type:"textline",a:"In = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( Ik - Im ) * Il ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"Io",qualifier:["vec3"],
c:!1},{type:"node_in",name:"Ip",qualifier:["float"],c:!1},{type:"node_out",name:"Iq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Iq = Io ; if ( Iq . x > ZERO_VALUE_NODES ) Iq . x = pow ( Io . x , Ip ) ; if ( Iq . y > ZERO_VALUE_NODES ) Iq . y = pow ( Io . y , Ip ) ; if ( Iq . z > ZERO_VALUE_NODES ) Iq . z = pow ( Io . z , Ip ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"Ir",qualifier:["vec3"],c:!1},{type:"node_out",name:"Is",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"Is = max ( vec3 ( ZERO_VALUE_NODES ) , Ir ) ; Is = pow ( Is , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"It",qualifier:["vec3"],c:!1},{type:"node_out",name:"Iu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Iu = max ( vec3 ( ZERO_VALUE_NODES ) , It ) ; Iu = pow ( Iu , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"Iv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Iw",qualifier:["vec3"],
c:!1},{type:"node_out",name:"Ix",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ix"],f:[{type:"textline",a:"Iv [ 2 ] = Iv [ 1 ] = Iv [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ix"],f:[{type:"textline",a:"Iw [ 2 ] = Iw [ 1 ] = Iw [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ix"],f:[{type:"textline",a:["Ix","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"Iy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Iz",qualifier:["vec3"],c:!0},{type:"node_out",name:"IA",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"yx = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , Iy ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iz"],f:[{type:"textline",a:"Iz = yx . xyz ; br ( Iz ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_IA"],f:[{type:"textline",a:"IA = yx . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"IB",qualifier:["vec3"],c:!0},{type:"node_in",name:"IC",qualifier:["vec3"],c:!0},{type:"node_in",name:"ID",qualifier:["vec3"],c:!0},{type:"node_in",name:"IE",qualifier:["vec3"],c:!0},{type:"node_out",name:"IF",qualifier:["vec3"],c:!0},{type:"node_out",name:"IG",qualifier:["float"],c:!0},{type:"node_out",name:"IH",qualifier:["vec3"],c:!0},{type:"node_out",
name:"II",qualifier:["float"],c:!0},{type:"node_out",name:"IJ",qualifier:["vec3"],c:!0},{type:"node_out",name:"IK",qualifier:["float"],c:!0},{type:"node_out",name:"IL",qualifier:["vec3"],c:!0},{type:"node_out",name:"IM",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_COLOR_var_texture , xV ( IB ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IF"],
f:[{type:"textline",a:"IF = yx . xyz ; br ( IF ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IG"],f:[{type:"textline",a:"IG = yx . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_COLOR_var_texture , xV ( IC ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IH"],f:[{type:"textline",a:"IH = yx . xyz ; br ( IH ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_II"],f:[{type:"textline",a:"II = yx . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_COLOR_var_texture , xV ( ID ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IJ"],f:[{type:"textline",a:"IJ = yx . xyz ; br ( IJ ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IK"],f:[{type:"textline",a:"IK = yx . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_uv4"],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_COLOR_var_texture , xV ( IE ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IL"],f:[{type:"textline",a:"IL = yx . xyz ; br ( IL ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IM"],f:[{type:"textline",a:"IM = yx . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"IN",qualifier:["vec3"],c:!0},{type:"node_in",name:"IO",qualifier:["vec3"],c:!0},{type:"node_in",
name:"IP",qualifier:["vec3"],c:!0},{type:"node_in",name:"IQ",qualifier:["vec3"],c:!0},{type:"node_out",name:"IR",qualifier:["vec3"],c:!0},{type:"node_out",name:"IS",qualifier:["float"],c:!0},{type:"node_out",name:"IT",qualifier:["vec3"],c:!0},{type:"node_out",name:"IU",qualifier:["float"],c:!0},{type:"node_out",name:"IV",qualifier:["vec3"],c:!0},{type:"node_out",name:"IW",qualifier:["float"],c:!0},{type:"node_out",name:"IX",qualifier:["vec3"],c:!0},{type:"node_out",name:"IY",qualifier:["float"],c:!0},
{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_NORMAL_var_texture , xV ( IN ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IR"],f:[{type:"textline",a:"IR = normalize ( yy * ( yx . xyz - xI ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IS"],f:[{type:"textline",a:"IS = yx . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],
f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_NORMAL_var_texture , xV ( IO ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IT"],f:[{type:"textline",a:"IT = normalize ( yy * ( yx . xyz - xI ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IU"],f:[{type:"textline",a:"IU = yx . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_NORMAL_var_texture , xV ( IP ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IV"],f:[{type:"textline",a:"IV = normalize ( yy * ( yx . xyz - xI ) ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IW"],f:[{type:"textline",a:"IW = yx . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"yx = texture2D ( node_TEXTURE_NORMAL_var_texture , xV ( IQ ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IX"],f:[{type:"textline",a:"IX = normalize ( yy * ( yx . xyz - xI ) ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IY"],f:[{type:"textline",a:"IY = yx . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",name:"IZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"IZ = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"I_",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ja",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jb",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jc",qualifier:["float"],
c:!0}],f:[{type:"textline",a:"Jb = I_ + Ja ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jc"],f:[{type:"textline",a:"Jc = ( abs ( Jb [ 0 ] ) + abs ( Jb [ 1 ] ) + abs ( Jb [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"Jd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Je",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jf",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jg",qualifier:["float"],c:!0}],f:[{type:"textline",
a:"Jf = Jd - Je ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jg"],f:[{type:"textline",a:"Jg = ( abs ( Jf [ 0 ] ) + abs ( Jf [ 1 ] ) + abs ( Jf [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",h:[{type:"node_in",name:"Jh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ji",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jj",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jk",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jj = Jh + Ji ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jk"],f:[{type:"textline",a:"Jk = length ( Jj ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jj"],f:[{type:"textline",a:"Jj = normalize ( Jj ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"Jl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jn",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jo",qualifier:["float"],c:!0}],f:[{type:"textline",
a:"Jn = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jo"],f:[{type:"textline",a:"Jo = dot ( Jl , Jm ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",name:"Jp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jr",qualifier:["vec3"],c:!1},{type:"node_out",name:"Js",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jr = cross ( Jp , Jq ) ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_Js"],f:[{type:"textline",a:"Js = length ( Jr ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"Jt",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ju",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jw",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jv = normalize ( Jt ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jw"],f:[{type:"textline",a:"Jw = length ( Jt ) ;".split(" ")}]}]},
{type:"textline",a:["Ju",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"Jx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Jz = reflect ( - Jx , Jy ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"JA",qualifier:["vec3"],c:!1},{type:"node_in",name:"JB",qualifier:["float"],c:!1},{type:"node_in",name:"JC",qualifier:["const","float"],c:!1},{type:"node_in",
name:"JD",qualifier:["const","float"],c:!1},{type:"node_out",name:"JE",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yq = length ( yw ) ; if ( yq < JD ) { yl = xV ( JA ) ; yq = clamp ( xI * ( JD - yq ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yq = JB * yq ;".split(" ")},{type:"textline",a:"yE = normalize ( ye * yy ) ;".split(" ")},{type:"textline",a:"yr = UNITY_VALUE_NODES / JC ;".split(" ")},{type:"textline",
a:"ym = yE . xy * yq / ( JC * yE . z ) ; yq = UNITY_VALUE_NODES ; yp = texture2D ( node_B4W_PARALLAX_var_texture , yl ) . a ;".split(" ")},{type:"textline",a:"for ( float JF = 1.0 ; JF <= JC ; JF ++ ) { if ( yp < yq ) { yq -= yr ; yl -= ym ; yp = texture2D ( node_B4W_PARALLAX_var_texture , yl ) . a ; } }".split(" ")},{type:"textline",a:"ym = yl + ym ; yr = texture2D ( node_B4W_PARALLAX_var_texture , ym ) . a - ( yq + yr ) ; yq = yp - yq ; yr = yq / ( yq - yr ) ;".split(" ")},{type:"textline",a:"yl = yr * ym + ( UNITY_VALUE_NODES - yr ) * yl ; JE = xT ( yl ) ; } else JE = JA ;".split(" ")}]},
{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"JG",qualifier:["vec3"],c:!1},{type:"node_out",name:"JH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"JH = clamp ( JG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"JI",qualifier:["vec3"],c:!1},{type:"node_in",name:"JJ",qualifier:["float"],c:!1},{type:"node_out",name:"JK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"JK = JI ; JJ ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",
h:[{type:"node_in",name:"JL",qualifier:["float"],c:!1},{type:"node_in",name:"JM",qualifier:["float"],c:!1},{type:"node_in",name:"JN",qualifier:["float"],c:!1},{type:"node_in",name:"JO",qualifier:["float"],c:!1},{type:"node_in",name:"JP",qualifier:["float"],c:!1},{type:"node_out",name:"JQ",qualifier:["float"],c:!0},{type:"node_out",name:"JR",qualifier:["vec4"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JQ"],f:[{type:"textline",a:["JQ","=","JL",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_JR"],f:[{type:"textline",a:"JR = vec4 ( JM , JN , JO , JP ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"JS",qualifier:["float"],c:!1}],f:[{type:"textline",a:["JS","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"JT",qualifier:["float"],c:!1},{type:"node_in",name:"JU",qualifier:["float"],c:!1},{type:"node_in",name:"JV",qualifier:["float"],c:!1},{type:"node_out",name:"JW",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"JW = smoothstep ( JU , JV , JT ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"JX",qualifier:["vec3"],c:!1},{type:"node_in",name:"JY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yg = JX ; yk = JY ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"JZ",qualifier:["vec3"],c:!1},{type:"node_out",name:"J_",qualifier:["float"],c:!1}],f:[{type:"textline",a:"J_ = ( JZ . r + JZ . g + JZ . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",
h:[{type:"node_in",name:"Ka",qualifier:["float"],c:!1},{type:"node_out",name:"Kb",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Kb [ 0 ] = Ka ; Kb [ 1 ] = Ka ; Kb [ 2 ] = Ka ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void Kc ( in vec3 ye , in mat4 yf , out vec3 yg , out vec3 yh , out vec3 yi , out vec4 yj , out float yk ) { vec2 yl , ym ; float yn , yo , yp , yq , yr , ys , yt , yu , yv ; vec4 yw , yx ; mat3 yy ; vec3 yz , yA , yB , yC , yD , yE ; yg = vec3 ( ZERO_VALUE_NODES ) ; yh = vec3 ( ZERO_VALUE_NODES ) ; yi = vec3 ( ZERO_VALUE_NODES ) ; yj = vec4 ( ZERO_VALUE_NODES ) ; yk = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"yz = normalize ( bE ) ; yA = yz ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"yA = yA ; else yA = - yA ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["yB","=","yA",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yB","=","yz",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["yz","=",
"yA",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"yC = cross ( yA , bF . xyz ) * bF . w ; yy = mat3 ( bF . xyz , yC , yA ) ; yy = yy ;".split(" ")}]}}]},{type:"textline",a:"yA = bC ; yw = bD ; yn = u_emit ; yo = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"struct Ke { float a ; vec3 b ; float c ; vec3 d ; float e ; vec3 f ; vec3 g ; float h ; } ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Kk ( inout vec3 Kf , float Kg , vec4 Kh , vec4 Ki ) { float Kj ; Kj = Ki . x - Kh . x ; Kj = ( Kg - Kh . x ) / Kj ; Kf = mix ( Kf , Ki . yzw , clamp ( Kj , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 Kq ( float Kl , float Km , vec4 Kn [ COLOR_RAMP_LENGTH ] ) { vec3 Ko ; float Kp ; Kp = Kl / Km ; Ko = Kn [ 0 ] . yzw ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kk ( Ko , Kp , Kn [ 0 ] , Kn [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kk ( Ko , Kp , Kn [ 1 ] , Kn [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kk ( Ko , Kp , Kn [ 2 ] , Kn [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",a:["return","Ko",";","}"]}]}}]},{type:"textline",a:"float Ky ( float Kr , float Ks , float Kt , float Ku ) { float Kv , Kw , Kx ; Kv = max ( 0.01 , min ( Ks , Kt ) ) ; Kw = max ( 0.01 , min ( Ks , Ku ) ) ; Kx = Ks - Kw ; Kw = clamp ( Kr / Kv , 0.0 , 1.0 ) - step ( Kx , Kr ) * ( Kr - Kx ) / Kw ; return Kw ; } Ke KG ( ) { mat4 Kz ; vec3 KA , KB ; float KC , KD , KE ; Ke KF ; KD = a_p_data [ 0 ] ; KE = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { KC = mod ( u_p_time , u_p_length ) - KE ; if ( KC < 0.0 ) KC += u_p_length ; } if ( u_p_cyclic != 1 ) { KC = u_p_time - KE ; } if ( KC < 0.0 || KC >= KD ) { KF . a = 0.0001 ; KF . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( KC < 0.0 || KC >= KD ) ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["WORLD_SPACE"],group:{type:"group",b:[{type:"textline",a:"KA = a_position ; KB = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Kz = O ( u_model_tsr ) ; KA = ( Kz * vec4 ( a_position , 1.0 ) ) . xyz ; KB = ( Kz * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",a:"KB = u_p_nfactor * KB ; KB += a_p_vels . xyz ; KB . y -= u_p_gravity * KC / 2.0 ; KD = max ( u_p_mass , EPSILON ) ; KB += ( u_p_wind_fac * u_wind / KD ) * KC / 2.0 ; KF . h = KC ; KF . f = KB ; KF . g = a_normal * a_p_vels . w ; KF . b = KA + KB * KC ; KF . e = a_p_vels . w * KC ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:"KF . a = texture2D ( u_color_ramp_tex , vec2 ( KC / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KF . a = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KF . d = Kq ( KC , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"KF . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"KF . c = Ky ( KC , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return KF ; }".split(" ")}]};a["include/particles_nodes.glslv"]={type:"group",b:[{type:"node",name:"TEX_COORD_UV",h:[],f:[{type:"textline",a:"bM = KM + 0.5 ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[],f:[{type:"textline",a:"bM = KM + 0.5 ;".split(" ")}]},{type:"node",name:"UVMAP",h:[],f:[{type:"textline",a:"bM = KM + 0.5 ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[],f:[{type:"textline",a:"bM = KM + 0.5 ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_param",name:"xX",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"xY",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"xZ",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"x_",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"node_PARTICLE_INFO_var_a_p_indices",qualifier:["attribute","float"],c:!0}],f:[{type:"node_condition",
b:[{type:"node_if",d:["PART_INFO_SIZE"],f:[{type:"textline",a:"xX [ 3 ] = KL ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_AGE"],f:[{type:"textline",a:"xX [ 1 ] = KK ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LT"],f:[{type:"textline",a:"xX [ 2 ] = KN ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LOC"],f:[{type:"textline",a:["xY","=","KH",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_IND"],
f:[{type:"textline",a:"xX [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_VEL"],f:[{type:"textline",a:["xZ","=","KI",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_A_VEL"],f:[{type:"textline",a:["x_","=","KJ",";"]}]}]}]},{type:"nodes_global"},{type:"textline",a:"void KO ( in vec3 KH , in vec3 KI , in vec3 KJ , in float KK , in float KL , in vec2 KM , in float KN ) {".split(" ")},{type:"condition",b:[{type:"if",
d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = KM + 0.5 ;".split(" ")}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/blending.glslf"]={type:"group",b:[{type:"textline",a:"float KQ = 0.0 ; float KR = 1.0 ; vec3 KW ( vec3 KS ) { float KT , KU ; vec4 KV ; KV = vec4 ( KQ , - KR / 3.0 , 2.0 / 3.0 , - KR ) ; KV = mix ( vec4 ( KS . bg , KV . wz ) , vec4 ( KS . gb , KV . xy ) , step ( KS . b , KS . g ) ) ; KV = mix ( vec4 ( KV . xyw , KS . r ) , vec4 ( KS . r , KV . yzx ) , step ( KV . x , KS . r ) ) ; KT = KV . x - min ( KV . w , KV . y ) ; KU = 1.0e-10 ; return vec3 ( abs ( KV . z + ( KV . w - KV . y ) / ( 6.0 * KT + KU ) ) , KT / ( KV . x + KU ) , KV . x ) ; } vec3 K_ ( vec3 KX ) { vec3 KY ; vec4 KZ ; KZ = vec4 ( KR , 2.0 / 3.0 , KR / 3.0 , 3.0 ) ; KY = abs ( fract ( vec3 ( KX . r , KX . r , KX . r ) + KZ . xyz ) * 6.0 - KZ . www ) ; return KX . b * mix ( KZ . xxx , clamp ( KY - KZ . xxx , KQ , KR ) , KX . g ) ; } vec3 Ld ( vec3 La , vec3 Lb , float Lc ) { return mix ( La , Lb , Lc ) ; } vec3 Lh ( vec3 Le , vec3 Lf , float Lg ) { return Lg * Le + Lf ; } vec3 Ll ( vec3 Li , vec3 Lj , float Lk ) { return Lj - Lk * Li ; } vec3 Lq ( vec3 Lm , vec3 Ln , float Lo ) { float Lp ; Lp = KR - Lo ; return ( vec3 ( Lp ) + Lo * Lm ) * Ln ; } vec3 Lv ( vec3 Lr , vec3 Ls , float Lt ) { vec3 Lu ; Lu = vec3 ( KR - Lt ) ; return vec3 ( KR ) - ( Lu + Lt * ( vec3 ( KR ) - Lr ) ) * ( vec3 ( KR ) - Ls ) ; } vec3 LA ( vec3 Lw , vec3 Lx , float Ly ) { vec3 Lz ; Lz = vec3 ( KR - Ly ) ; return mix ( Lx * ( Lz + 2.0 * Ly * Lw ) , vec3 ( KR ) - ( Lz + 2.0 * Ly * ( vec3 ( KR ) - Lw ) ) * ( vec3 ( KR ) - Lx ) , step ( 0.5 , Lx ) ) ; } vec3 LE ( vec3 LB , vec3 LC , float LD ) { return mix ( LC , abs ( LB - LC ) , LD ) ; } vec3 LI ( vec3 LF , vec3 LG , float LH ) { return mix ( LG , LG / ( LF + step ( LF , vec3 ( KQ ) ) ) , LH ) ; } vec3 LM ( vec3 LJ , vec3 LK , float LL ) { return mix ( LK , min ( LJ , LK ) , LL ) ; } vec3 LQ ( vec3 LN , vec3 LO , float LP ) { return max ( LP * LN , LO ) ; } vec3 LW ( vec3 LR , vec3 LS , float LT ) { vec3 LU , LV ; LU = KW ( LS ) ; if ( LU . y != KQ ) { LV = KW ( LR ) ; LV = K_ ( vec3 ( LU . x , LV . yz ) ) ; return mix ( LR , LV , LT ) ; } return LR ; } vec3 Mb ( vec3 LX , vec3 LY , float LZ ) { vec3 L_ , Ma ; L_ = KW ( LX ) ; if ( L_ . y != KQ ) { Ma = KW ( LY ) ; return K_ ( vec3 ( L_ . x , mix ( L_ . y , Ma . y , LZ ) , L_ . z ) ) ; } return LX ; } vec3 Mh ( vec3 Mc , vec3 Md , float Me ) { vec3 Mf , Mg ; Mf = KW ( Mc ) ; Mg = KW ( Md ) ; return K_ ( vec3 ( Mf . xy , mix ( Mf . z , Mg . z , Me ) ) ) ; } vec3 Mn ( vec3 Mi , vec3 Mj , float Mk ) { vec3 Ml , Mm ; Ml = KW ( Mj ) ; if ( Ml . y != KQ ) { Mm = KW ( Mi ) ; Mm = K_ ( vec3 ( Ml . xy , Mm . z ) ) ; return mix ( Mi , Mm , Mk ) ; } return Mi ; } vec3 Ms ( vec3 Mo , vec3 Mp , float Mq ) { vec3 Mr ; Mr = vec3 ( KR ) - ( vec3 ( KR ) - Mp ) * ( vec3 ( KR ) - Mo ) ; return mix ( Mo , ( ( vec3 ( KR ) - Mo ) * Mp * Mo ) + Mo * Mr , Mq ) ; } vec3 Mw ( vec3 Mt , vec3 Mu , float Mv ) { return Mt + Mv * ( 2.0 * Mu - KR ) ; } float MC ( float Mx , float My , float Mz , float MA ) { float MB ; MB = KR - MA ; return ( MB + Mz * Mx ) * My ; } float MI ( float MD , float ME , float MF , float MG ) { float MH ; MH = KR - MG ; return KR - ( MH + MF * ( KR - MD ) ) * ( KR - ME ) ; } float MO ( float MJ , float MK , float ML , float MM ) { float MN ; MN = KR - MM ; return mix ( MK * ( MN + 2.0 * ML * MJ ) , KR - ( MN + 2.0 * ML * ( KR - MJ ) ) * ( KR - MK ) , step ( 0.5 , MK ) ) ; }".split(" ")}]};
a["include/fxaa.glslf"]={type:"group",b:[{type:"condition",b:[{type:"ifndef",name:"FXAA_PS3",group:{type:"group",b:[{type:"define",name:"FXAA_PS3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360",group:{type:"group",b:[{type:"define",name:"FXAA_360",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360_OPT",group:{type:"group",b:[{type:"define",name:"FXAA_360_OPT",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC",group:{type:"group",b:[{type:"define",name:"FXAA_PC",
a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC_CONSOLE",group:{type:"group",b:[{type:"define",name:"FXAA_PC_CONSOLE",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_120",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_120",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_130",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_130",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_3",group:{type:"group",b:[{type:"define",
name:"FXAA_HLSL_3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_4",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_4",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_5",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_5",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GREEN_AS_LUMA",group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_EARLY_EXIT",group:{type:"group",
b:[{type:"define",name:"FXAA_EARLY_EXIT",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_DISCARD",group:{type:"group",b:[{type:"define",name:"FXAA_DISCARD",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"condition",b:[{type:"ifdef",name:"GL_EXT_gpu_shader4",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",
name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FXAA_HLSL_5",1,{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["0"]}]}}]}]}}]},{type:"condition",
b:[{type:"ifndef",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["4.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["2.0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",
name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.125"]}]}},{type:"else",group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.25"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_QUALITY_PRESET",group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
10,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",11,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},
{type:"define",name:"FXAA_QUALITY_P2",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",12,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["12.0"]}]}}]},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",13,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
14,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
15,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["12.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",20,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",21,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",22,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P4",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",23,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",24,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",25,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",
a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",26,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["9"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",27,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["10"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",28,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["11"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",
a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
29,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",39,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P3",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"var",name:"FXAA_QUALITY_P12",a:["0.0"]},{type:"textline",a:"float Nk ( float Nj ) { return clamp ( Nj , 0.0 , 1.0 ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_BLEND4WEB",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 Nn ( sampler2D Nl , vec2 Nm ) { return texture2D ( Nl , Nm ) ; } vec4 Ns ( sampler2D No , vec2 Np , vec2 Nq , vec2 Nr ) { return texture2D ( No , Np + ( Nq * Nr ) ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 NZ ( vec2 Nt , sampler2D Nu , vec2 Nv , float Nw , float Nx , float Ny ) { bool Nz , NA , NB , NC , ND ; float NE , NF , NG , NH , NI , NJ , NK , NL , NM , NN , NO , NP , NQ , NR , NS ; vec4 NT ; vec2 NU , NV , NW , NX , NY ; NU . x = Nt . x ; NU . y = Nt . y ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",1,{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NT = Nn ( Nu , NU ) ; NE = bB ( NT ) ; NF = bB ( Ns ( Nu , NU , vec2 ( 0 , 1 ) , Nv . xy ) ) ; NG = bB ( Ns ( Nu , NU , vec2 ( 1 , 0 ) , Nv . xy ) ) ; NH = bB ( Ns ( Nu , NU , vec2 ( 0 , - 1 ) , Nv . xy ) ) ; NI = bB ( Ns ( Nu , NU , vec2 ( - 1 , 0 ) , Nv . xy ) ) ;".split(" ")}]}}]},{type:"textline",a:"NJ = max ( NF , NE ) ; NK = min ( NF , NE ) ; NJ = max ( NG , NJ ) ; NK = min ( NG , NK ) ; NL = max ( NH , NI ) ; NM = min ( NH , NI ) ; NJ = max ( NL , NJ ) ; NK = min ( NM , NK ) ; NM = NJ * Nx ; NK = NJ - NK ; NM = max ( Ny , NM ) ; Nz = NK < NM ; if ( Nz ) return NT ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NM = bB ( Ns ( Nu , NU , vec2 ( - 1 , - 1 ) , Nv . xy ) ) ; NJ = bB ( Ns ( Nu , NU , vec2 ( 1 , 1 ) , Nv . xy ) ) ; NL = bB ( Ns ( Nu , NU , vec2 ( 1 , - 1 ) , Nv . xy ) ) ; NN = bB ( Ns ( Nu , NU , vec2 ( - 1 , 1 ) , Nv . xy ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:"NO = NH + NF ; NP = NI + NG ; NK = 1.0 / NK ; NQ = NO + NP ; NO = ( - 2.0 * NE ) + NO ; NP = ( - 2.0 * NE ) + NP ; NR = NL + NJ ; NL = NM + NL ; NS = ( - 2.0 * NG ) + NR ; NL = ( - 2.0 * NH ) + NL ; NM = NM + NN ; NJ = NN + NJ ; NS = ( abs ( NO ) * 2.0 ) + abs ( NS ) ; NL = ( abs ( NP ) * 2.0 ) + abs ( NL ) ; NP = ( - 2.0 * NI ) + NM ; NJ = ( - 2.0 * NF ) + NJ ; NS = abs ( NP ) + NS ; NL = abs ( NJ ) + NL ; NR = NM + NR ; NM = Nv . x ; Nz = NS >= NL ; NR = NQ * 2.0 + NR ; if ( ! Nz ) NH = NI ; if ( ! Nz ) NF = NG ; if ( Nz ) NM = Nv . y ; NR = ( NR * ( 1.0 / 12.0 ) ) - NE ; NG = NH - NE ; NI = NF - NE ; NH = NH + NE ; NF = NF + NE ; NA = abs ( NG ) >= abs ( NI ) ; NI = max ( abs ( NG ) , abs ( NI ) ) ; if ( NA ) NM = - NM ; NK = Nk ( abs ( NR ) * NK ) ; NV . x = NU . x ; NV . y = NU . y ; NW . x = ( ! Nz ) ? 0.0 : Nv . x ; NW . y = ( Nz ) ? 0.0 : Nv . y ; if ( ! Nz ) NV . x += NM * 0.5 ; if ( Nz ) NV . y += NM * 0.5 ; NX . x = NV . x - NW . x * FXAA_QUALITY_P0 ; NX . y = NV . y - NW . y * FXAA_QUALITY_P0 ; NY . x = NV . x + NW . x * FXAA_QUALITY_P0 ; NY . y = NV . y + NW . y * FXAA_QUALITY_P0 ; NR = ( ( - 2.0 ) * NK ) + 3.0 ; NG = bB ( Nn ( Nu , NX ) ) ; NK = NK * NK ; NQ = bB ( Nn ( Nu , NY ) ) ; if ( ! NA ) NH = NF ; NI = NI * 1.0 / 4.0 ; NF = NE - NH * 0.5 ; NK = NR * NK ; NA = NF < 0.0 ; NG -= NH * 0.5 ; NQ -= NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P1 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P1 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P1 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P1 ; if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P2 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P2 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P2 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P2 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P3 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P3 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P3 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P3 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",4,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P4 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P4 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P4 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P4 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",5,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P5 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P5 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P5 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P5 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",6,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P6 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P6 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P6 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P6 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",7,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P7 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P7 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P7 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P7 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",8,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P8 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P8 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P8 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P8 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",9,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P9 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P9 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P9 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P9 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",10,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P10 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P10 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P10 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P10 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",11,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P11 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P11 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P11 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P11 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",12,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ND ) { if ( ! NB ) NG = bB ( Nn ( Nu , NX . xy ) ) ; if ( ! NC ) NQ = bB ( Nn ( Nu , NY . xy ) ) ; if ( ! NB ) NG = NG - NH * 0.5 ; if ( ! NC ) NQ = NQ - NH * 0.5 ; NB = abs ( NG ) >= NI ; NC = abs ( NQ ) >= NI ; if ( ! NB ) NX . x -= NW . x * FXAA_QUALITY_P12 ; if ( ! NB ) NX . y -= NW . y * FXAA_QUALITY_P12 ; ND = ( ! NB ) || ( ! NC ) ; if ( ! NC ) NY . x += NW . x * FXAA_QUALITY_P12 ; if ( ! NC ) NY . y += NW . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"} NI = NU . x - NX . x ; NH = NY . x - NU . x ; if ( ! Nz ) NI = NU . y - NX . y ; if ( ! Nz ) NH = NY . y - NU . y ; NC = ( NG < 0.0 ) != NA ; NG = ( NH + NI ) ; NA = ( NQ < 0.0 ) != NA ; NG = 1.0 / NG ; NB = NI < NH ; NH = min ( NI , NH ) ; NA = NB ? NC : NA ; NK = NK * NK ; NG = ( NH * ( - NG ) ) + 0.5 ; NK = NK * Nw ; NG = NA ? NG : 0.0 ; NK = max ( NG , NK ) ; if ( ! Nz ) NU . x += NK * NM ; if ( Nz ) NU . y += NK * NM ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_DISCARD",1,{type:"equal_expr",e:2},"FXAA_BLEND4WEB",1,{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Nn ( Nu , NU ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( Nn ( Nu , NU ) . xyz , NE ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/depth_fetch.glslf"]={type:"group",b:[{type:"textline",a:"float Of ( in sampler2D N_ , in vec2 Oa , in vec2 Ob ) { float Oc , Od , Oe ; Oc = texture2D ( N_ , Oa ) . r ; Od = Ob . x ; Oe = Ob . y ; Od = 2.0 * Od / ( Od + Oe - ( 2.0 * Oc - 1.0 ) * ( Oe - Od ) ) ; return Od ; }".split(" ")}]}};b4w.module.animation=function(a,p){var d=p("__animation"),b=p("__armature"),c=p("__obj_util"),n=p("__print"),g=p("__tsr");a.SLOT_0=d.SLOT_0;a.SLOT_1=d.SLOT_1;a.SLOT_2=d.SLOT_2;a.SLOT_3=d.SLOT_3;a.SLOT_4=d.SLOT_4;a.SLOT_5=d.SLOT_5;a.SLOT_6=d.SLOT_6;a.SLOT_7=d.SLOT_7;a.SLOT_ALL=d.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=d.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=d.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=d.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=d.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=d.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=d.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=d.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=d.AB_CYCLIC;a.AB_FINISH_RESET=d.AB_FINISH_RESET;a.AB_FINISH_STOP=d.AB_FINISH_STOP;var q=g.create();a.is_animated=function(a){return d.is_animated(a)};a.get_anim_names=function(a){return d.ww(a)?d.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.SD(a,b)};a.apply=function(a,b,c){if(c>d.SLOT_7)n.error("Can't apply animation to slot "+
c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||d.SLOT_0;if(d.is_animated(a)){var g=d.get_slot_num_by_anim(a,b);if(-1!=g&&g!=c){n.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}d.$I(a,b)?d.apply(a,b,c):n.error('No fcurves in action "'+b+'"')}};a.remove=function(a){d.remove(a)};a.remove_slot_animation=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.remove_slot_animation(a,b))};a.apply_def=function(a){d.apply_def(a)};
a.play=function(a,b,c){d.is_animated(a)?(c=c||d.SLOT_0,d.play(a,b,c),d.uI(a,0,c,!0)):n.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.stop(a,b))};a.is_play=function(a,b){if(!d.is_animated(a))return!1;b=b||d.SLOT_0;return d.is_play(a,b)};a.set_frame=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_frame(a,b,c))};a.set_first_frame=function(a,b){d.is_animated(a)&&d.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(d.is_animated(a)){b=
b||d.SLOT_0;var c=d.get_anim_start_frame(a,b),g=d.get_anim_length(a,b);d.set_frame(a,c+g-d.iz,b)}};a.get_frame=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return d.bv(a,b)};a.set_speed=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return a.M[b]?d.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.M[b])?d.get_anim_start_frame(a,b):-1};a.get_anim_length=
function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.M[b])?d.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,g){g=g||d.SLOT_0;d.is_animated(a)&&d.apply_smoothing(a,b,c,g)};a.frame_to_sec=function(a){return d.frame_to_sec(a)};a.get_bone_translation=function(a,d,e){n.Na("get_bone_translation","armature.get_bone_tsr");
if(!c.is_armature(a))return null;if(!b.uk(a,d))return n.error('There is no bone: "',d,'" in "',a.name,'".'),null;e||(e=new Float32Array(3));b.get_bone_tsr(a,d,!1,!1,q);e[0]=q[0];e[1]=q[1];e[2]=q[2];return e};a.get_first_armature_object=function(){n.bn("get_first_armature_object() deprecated");return null};a.get_slot_num_by_anim=function(a,b){return d.is_animated(a)&&b?d.get_slot_num_by_anim(a,b):null};a.get_anim_type=function(a,b){return d.is_animated(a)?d.get_anim_type(a,b):null};a.apply_to_first_empty_slot=
function(a,b){return d.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.g.Tf};a.set_skel_mix_factor=function(a,b,e){c.is_armature(a)?(b=Math.min(Math.max(b,0),1),a.g.Tf!=b&&d.set_skel_mix_factor(a,b,e||0)):n.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,p){var d=p("__anchors");p("__print");a.attach_move_cb=d.attach_move_cb;a.detach_move_cb=d.detach_move_cb;a.is_anchor=d.is_anchor;a.get_element_id=d.get_element_id};b4w.module.armature=function(a,p){var d=p("__armature"),b=p("__obj_util"),c=p("__transform"),n=p("__print");a.get_bone_tsr=function(a,c,l){if(!b.is_armature(a))return null;if(!d.uk(a,c))return n.error('There is no bone: "',c,'" in "',a.name,'".'),null;l||(l=new Float32Array(8));d.get_bone_tsr(a,c,!1,!1,l);return l};a.get_bone_tsr_rel=function(a,c,l){if(!b.is_armature(a))return null;if(!d.uk(a,c))return n.error('There is no bone: "',c,'" in "',a.name,'".'),null;l||(l=new Float32Array(8));d.get_bone_tsr(a,
c,!1,!0,l);return l};a.set_bone_tsr=function(a,q,l){b.is_armature(a)&&(d.uk(a,q)?(d.set_bone_tsr(a,q,l,!1),c.m(a)):n.error('There is no bone: "',q,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,q,l){b.is_armature(a)&&(d.uk(a,q)?(d.set_bone_tsr(a,q,l,!0),c.m(a)):n.error('There is no bone: "',q,'" in "',a.name,'".'))}};b4w.module.assets=function(a,p){var d=p("__assets");a.AT_ARRAYBUFFER=d.AT_ARRAYBUFFER;a.AT_JSON=d.AT_JSON;a.AT_TEXT=d.AT_TEXT;a.AT_AUDIOBUFFER=d.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=d.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=d.AT_AUDIO_ELEMENT;a.enqueue=function(a,c,n,g){if(a.length)if(a.id)d.enqueue(a,c,n,g);else{for(var q=[],l=0;l<a.length;l++){var t=a[l];q.push({id:t[0],type:t[1],url:t[2],Sc:t.Sc?t.Sc:"GET",sg:null,Cf:null,gb:t[3]})}d.enqueue(q,c,n,g)}}};b4w.module.camera=function(a,p){function d(a,c){t.Na("camera.set_pivot","camera.target_set_trans_pivot");b.is_target_camera(a)?(r.copy(c,a.g.pivot),e.m(a),l.sync_transform(a)):t.error("set_pivot(): Wrong object or camera move style")}var b=p("__camera");p("__config");var c=p("__constraints"),n=p("__container");p("__mat3");var g=p("__mat4"),q=p("__obj_util"),l=p("__physics"),t=p("__print"),e=p("__transform"),H=p("__tsr"),k=p("__util"),r=p("__vec3"),u=p("__vec4"),z=new Float32Array(2),D=new Float32Array(3),
y=new Float32Array(3);new Float32Array(4);new Float32Array(9);var C={},v={};a.MS_STATIC=b.MS_STATIC;a.MS_TARGET_CONTROLS=b.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=b.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=b.MS_HOVER_CONTROLS;a.static_setup=function(a,c){if(q.is_camera(a)){b.Qo(a);a.g.Ua=b.MS_STATIC;if(c){var d=c.pos||H.get_trans_view(a.g.i);c.look_at?b.set_look_at(a,d,c.look_at):e.set_translation(a,d)}e.m(a);l.sync_transform(a);b.gl(a)}else t.error("static_setup(): Wrong camera object")};a.static_set_look_at=
function(a,c,d){b.is_static_camera(a)?(c=c||H.get_trans_view(a.g.i),d?b.set_look_at(a,c,d):e.set_translation(a,c),e.m(a),l.sync_transform(a)):t.error("static_set_look_at(): Wrong camera object or camera move style")};a.static_set_rotation=function(a,c){b.is_static_camera(a)?(e.set_rotation(a,c),e.m(a),l.sync_transform(a)):t.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,c){if(!b.is_static_camera(a))return t.error("static_get_rotation(): Wrong camera object or camera move style"),
null;c=c||new Float32Array(4);return e.get_rotation(a,c)};a.eye_setup=function(a,c){if(q.is_camera(a))if(c&&c.horiz_rot_lim&&("number"!=typeof c.horiz_rot_lim.left||"number"!=typeof c.horiz_rot_lim.right))t.error("eye_setup(): Wrong horizontal limits object.");else if(c&&c.vert_rot_lim&&("number"!=typeof c.vert_rot_lim.down||"number"!=typeof c.vert_rot_lim.up))t.error("eye_setup(): Wrong vertical limits object.");else{b.Qo(a);a.g.Ua=b.MS_EYE_CONTROLS;if(c){var d=c.pos||H.get_trans_view(a.g.i);b.jH(a,
d,c.look_at,c.horiz_rot_lim,c.vert_rot_lim)}e.m(a);l.sync_transform(a);b.gl(a)}else t.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,d,g){b.is_eye_camera(a)?(d=d||H.get_trans_view(a.g.i),g?b.XG(a,d,g):e.set_translation(a,d),c.correct_up(a,a.g.ue,!0),e.m(a),l.sync_transform(a)):t.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,c,d,g,k){b.is_eye_camera(a)?(b.rotate_eye_camera(a,c,d,g||!1,k||!1),e.m(a),l.sync_transform(a)):t.error("eye_rotate(): Wrong camera object or camera move style")};
a.eye_set_vertical_limits=function(a,c){b.is_eye_camera(a)?!c||"number"==typeof c.down&&"number"==typeof c.up?(b.nx(a,c),e.m(a),l.sync_transform(a)):t.error("eye_set_vertical_limits(): Incorrect limits object."):t.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,c,d){if(!b.is_eye_camera(a))return t.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.ea?(c=c||{},d?(c.down=a.ea.Fi,c.up=a.ea.Xj):
(c.down=a.ea.down,c.up=a.ea.up),c.camera_space=d||!1,c):null};a.eye_set_horizontal_limits=function(a,c){b.is_eye_camera(a)?!c||"number"==typeof c.left&&"number"==typeof c.right?(b.ix(a,c),e.m(a),l.sync_transform(a)):t.error("eye_set_horizontal_limits(): Incorrect limits object."):t.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,c,d){if(!b.is_eye_camera(a))return t.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.g;return a.Ha?(c=c||{},d?(c.left=a.Ha.gj,c.right=a.Ha.zj):(c.left=a.Ha.left,c.right=a.Ha.right),c.camera_space=d||!1,c):null};a.target_setup=function(a,c){if(q.is_camera(a))if(!c.horiz_rot_lim||"number"==typeof c.horiz_rot_lim.left&&"number"==typeof c.horiz_rot_lim.right)if(!c.vert_rot_lim||"number"==typeof c.vert_rot_lim.down&&"number"==typeof c.vert_rot_lim.up){if(c.dist_lim){if("number"!=typeof c.dist_lim.min||"number"!=typeof c.dist_lim.max||c.dist_lim.min>c.dist_lim.max){t.error("target_setup(): Wrong distance limits object");
return}c.dist_lim.min=Math.max(c.dist_lim.min,0);c.dist_lim.max=Math.max(c.dist_lim.max,0)}if(c.yl&&("number"!=typeof c.yl.min_y||"number"!=typeof c.yl.max_y||c.yl.min_y>c.yl.max_y))t.error("target_setup(): Wrong pivot limits object");else{b.Qo(a);a.g.Ua=b.MS_TARGET_CONTROLS;var d=c.pos||H.get_trans_view(a.g.i);b.lH(a,d,c.pivot,c.horiz_rot_lim,c.vert_rot_lim,c.dist_lim,c.yl,c.use_panning||!1);e.m(a);l.sync_transform(a);b.gl(a)}}else t.error("target_setup(): Wrong vertical limits object");else t.error("target_setup(): Wrong horizontal limits object");
else t.error("target_setup(): Wrong camera object")};a.target_rotate=function(a,c,d,g,k){b.is_target_camera(a)?(b.rotate_target_camera(a,c,d,g||!1,k||!1),e.m(a),l.sync_transform(a)):t.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,c,d){b.is_target_camera(a)?(c=c||H.get_trans_view(a.g.i),d=d||a.g.pivot,b.set_trans_pivot(a,c,d),e.m(a),l.sync_transform(a)):t.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=
function(a,c){b.is_target_camera(a)?(b.bH(a,c),e.m(a),l.sync_transform(a)):t.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,c){if(b.is_target_camera(a)){var d=e.qj(a,a.g.pivot),g=Math.max(0,c);e.move_local(a,0,g-d,0);e.m(a);l.sync_transform(a)}else t.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return b.is_target_camera(a)?e.qj(a,a.g.pivot):(t.error("target_get_distance(): Wrong camera object or camera move style"),
0)};a.target_zoom_object=function(a,c){if(b.is_target_camera(a)){var d=e.get_object_center(c,!1,D),g=e.get_object_size(c),k=b.Xu(a)/2,g=g/Math.sin(k),k=e.qj(a,d);b.set_trans_pivot(a,H.get_trans_view(a.g.i),d);e.m(a);e.move_local(a,0,g-k,0);e.m(a);l.sync_transform(a)}else t.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,c){if(!b.is_target_camera(a))return t.error("target_get_pivot(): Wrong camera object or camera move style"),null;c=c||new Float32Array(3);
r.copy(a.g.pivot,c);return c};a.target_set_distance_limits=function(a,c){if(b.is_target_camera(a)){if(c){if("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max){t.error("target_set_distance_limits(): Wrong limits object");return}c.min=Math.max(c.min,0);c.max=Math.max(c.max,0)}b.IG(a,c);e.m(a);l.sync_transform(a)}else t.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,c){if(!b.is_target_camera(a))return t.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.g;return d.Ma?(c=c||{},c.min=d.Ma.min,c.max=d.Ma.max,c):null};a.target_set_vertical_limits=function(a,c){b.is_target_camera(a)?!c||"number"==typeof c.down&&"number"==typeof c.up?(b.nx(a,c),e.m(a),l.sync_transform(a)):t.error("target_set_vertical_limits(): Wrong limits object"):t.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,c,d){if(!b.is_target_camera(a))return t.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.g;return a.ea?(c=c||{},d?(c.down=a.ea.Fi,c.up=a.ea.Xj):(c.down=a.ea.down,c.up=a.ea.up),c.camera_space=d||!1,c):null};a.target_set_horizontal_limits=function(a,c){b.is_target_camera(a)?!c||"number"==typeof c.left&&"number"==typeof c.right?(b.ix(a,c),e.m(a),l.sync_transform(a)):t.error("target_set_horizontal_limits(): Wrong limits object"):t.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,c,d){if(!b.is_target_camera(a))return t.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.g;return a.Ha?(c=c||{},d?(c.left=a.Ha.gj,c.right=a.Ha.zj):(c.left=a.Ha.left,c.right=a.Ha.right),c.camera_space=d||!1,c):null};a.target_set_pivot_limits=function(a,c){b.is_target_camera(a)?c&&("number"!=typeof c.min_y||"number"!=typeof c.max_y||c.min_y>c.max_y)?t.error("target_set_pivot_limits(): Wrong limits object"):(b.$G(a,c),e.m(a),l.sync_transform(a)):t.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,c){if(!b.is_target_camera(a))return t.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var d=a.g;return d.Xd?(c=c||{},c.min_y=d.Xd.min_y,c.max_y=d.Xd.max_y,c):null};a.target_pan_pivot=function(a,c,d){if(b.is_target_camera(a)){var g=a.g;g.use_panning&&(D[0]=c,D[1]=0,D[2]=d,H.transform_dir_vec3(D,g.i,D),r.add(g.pivot,D,g.pivot),c=H.get_trans_view(g.i),r.add(c,D,c),e.m(a),l.sync_transform(a))}else t.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,c){if(!b.is_target_camera(a))return t.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.g.use_panning=c};a.hover_setup_rel=function(c,d){a.hover_setup(c,{pos:d.pos,pivot:d.pivot});var g="undefined"==typeof d.dist_interval?0:Math.max(d.dist_interval,0),r="undefined"==typeof d.angle_interval?0:Math.max(d.angle_interval,0),n="undefined"==typeof d.t?.5:k.clamp(d.t,0,1),q=a.hover_get_distance_limits(c,C);q.min=Math.max(q.min-n*g,0);q.max+=(1-n)*g;g=a.hover_get_vertical_limits(c,v);g.down=k.clamp(g.down+n*r,-Math.PI/2,0);g.up=k.clamp(g.up-(1-n)*r,-Math.PI/2,0);b.hover_set_distance_limits(c,
q);b.hover_set_vertical_limits(c,g);e.m(c);l.sync_transform(c);b.gl(c)};a.hover_setup=function(a,c){if(q.is_camera(a)){if(c.dist_lim){if("number"!=typeof c.dist_lim.min||"number"!=typeof c.dist_lim.max||c.dist_lim.min>c.dist_lim.max){t.error("hover_setup(): Wrong distance limits object");return}c.dist_lim.min=Math.max(c.dist_lim.min,0);c.dist_lim.max=Math.max(c.dist_lim.max,0)}if(c.hover_angle_lim&&("number"!=typeof c.hover_angle_lim.down||"number"!=typeof c.hover_angle_lim.up||c.hover_angle_lim.down<
c.hover_angle_lim.up))t.error("hover_setup(): Wrong hover angle limits object");else if(c.horiz_trans_lim&&("number"!=typeof c.horiz_trans_lim.min||"number"!=typeof c.horiz_trans_lim.max||c.horiz_trans_lim.min>c.horiz_trans_lim.max))t.error("hover_setup(): Wrong horizontal translation limits object");else if(c.vert_trans_lim&&("number"!=typeof c.vert_trans_lim.min||"number"!=typeof c.vert_trans_lim.max||c.vert_trans_lim.min>c.vert_trans_lim.max))t.error("hover_setup(): Wrong vertical translation limits object");
else{b.Qo(a);a.g.Ua=b.MS_HOVER_CONTROLS;var d=c.pos||H.get_trans_view(a.g.i);b.kH(a,d,c.pivot,c.dist_lim,c.hover_angle_lim,c.horiz_trans_lim,c.vert_trans_lim,c.enable_horiz_rot||!1);e.m(a);l.sync_transform(a);b.gl(a)}}else t.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,c,d,g,k){b.is_hover_camera(a)?(b.rotate_hover_camera(a,c,d,g||!1,k||!1),e.m(a),l.sync_transform(a)):t.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,
c){b.is_hover_camera(a)?(b.set_hover_pivot(a,c),e.m(a),l.sync_transform(a)):t.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_get_pivot(): Wrong camera object or camera move style"),null;c=c||new Float32Array(3);r.copy(a.g.fb,c);return c};a.hover_get_distance=function(a){return b.is_hover_camera(a)?e.qj(a,a.g.fb):(t.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.hover_set_vertical_limits=function(a,c){b.is_hover_camera(a)?"number"!=typeof c.down||"number"!=typeof c.up||c.down<c.up?t.error("hover_set_vertical_limits(): Wrong limits object"):(b.hover_set_vertical_limits(a,c),e.m(a),l.sync_transform(a)):t.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var d=a.g;
c=c||{};c.down=d.ea.down;c.up=d.ea.up;return c};a.hover_set_distance_limits=function(a,c){b.is_hover_camera(a)?"number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max?t.error("hover_set_distance_limits(): Wrong limits object"):(c.min=Math.max(c.min,0),c.max=Math.max(c.max,0),b.hover_set_distance_limits(a,c),e.m(a),l.sync_transform(a)):t.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.g;c=c||{};c.min=d.Ma.min;c.max=d.Ma.max;return c};a.hover_set_vert_trans_limits=function(a,c){b.is_hover_camera(a)?c&&("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max)?t.error("hover_set_vert_trans_limits(): Wrong limits object"):(b.eH(a,c),e.m(a),l.sync_transform(a)):t.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.g;return d.fc?(c=c||{},c.min=d.fc.min,c.max=d.fc.max,c):null};a.hover_set_horiz_trans_limits=function(a,c){b.is_hover_camera(a)?c&&("number"!=typeof c.min||"number"!=typeof c.max||c.min>c.max)?t.error("hover_set_horiz_trans_limits(): Wrong limits object"):(b.RG(a,c),e.m(a),l.sync_transform(a)):t.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.g;return d.ec?(c=c||{},c.min=d.ec.min,c.max=d.ec.max,c):null};a.hover_switch_horiz_rotation=function(a,c){if(!b.is_hover_camera(a))return t.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.g.Sk=c};a.is_static_camera=b.is_static_camera;a.is_target_camera=b.is_target_camera;a.is_eye_camera=b.is_eye_camera;a.is_hover_camera=b.is_hover_camera;a.set_move_style=function(a,c){if(!q.is_camera(a))return t.error("set_move_style(): Wrong camera object"),!1;
if(c!=b.MS_STATIC&&c!=b.MS_EYE_CONTROLS&&c!=b.MS_TARGET_CONTROLS&&c!=b.MS_HOVER_CONTROLS)return t.error("set_move_style(): Wrong move style"),!1;b.set_move_style(a,c);e.m(a);l.sync_transform(a);return!0};a.get_move_style=function(a){return q.is_camera(a)?b.get_move_style(a):(t.error("get_move_style(): Wrong camera object"),null)};a.set_translation=function(a,c){if(q.is_camera(a)){var d=a.g;if(b.is_target_camera(a)){var g=H.get_trans_view(d.i),g=r.subtract(c,g,D);r.add(g,d.pivot,d.pivot)}else b.is_hover_camera(a)&&
(g=H.get_trans_view(d.i),g=r.subtract(c,g,D),r.add(g,d.fb,d.fb));e.set_translation(a,c);e.m(a);l.sync_transform(a)}else t.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!q.is_camera(a))return t.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return e.get_translation(a,b)};a.rotate_camera=function(a,c,d,g,k){q.is_camera(a)?(g=g||!1,k=k||!1,b.is_target_camera(a)?b.rotate_target_camera(a,c,d,g,k):b.is_eye_camera(a)?b.rotate_eye_camera(a,
c,d,g,k):b.is_hover_camera(a)?b.rotate_hover_camera(a,c,d,g,k):b.is_static_camera(a)?t.warn("rotate_camera(): not supported for STATIC cameras"):t.error("rotate_camera(): Wrong camera move style"),e.m(a),l.sync_transform(a)):t.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(q.is_camera(a)){var c=a.g;"number"==typeof b.trans&&(c.bm=k.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.am=k.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.cm=k.clamp(b.zoom,0,.99))}else t.error("set_velocities(): Wrong camera object")};
a.get_velocities=function(a,b){if(!q.is_camera(a))return t.error("get_velocities(): Wrong camera object"),null;var c=a.g;b=b||{};b.trans=c.bm;b.rot=c.am;b.zoom=c.cm;return b};a.is_look_up=function(a){if(!q.is_camera(a))return t.error("is_look_up(): Wrong camera object"),!1;a=H.get_quat_view(a.g.i);return 0<=k.quat_to_dir(a,k.AXIS_MY,D)[1]};a.get_camera_angles=function(a,c){if(!q.is_camera(a))return t.error("get_camera_angles(): Wrong camera object"),null;c=c||new Float32Array(2);b.get_camera_angles(a,
c);return c};a.get_camera_angles_char=function(a,c){if(!q.is_camera(a))return t.error("get_camera_angles_char(): Wrong camera object"),null;c=c||new Float32Array(2);b.get_camera_angles_char(a,c);return c};a.set_stereo_distance=function(a,c){if(q.is_camera(a))for(var d=a.g.N,e=0;e<d.length;e++){var g=d[e];g.type!=b.Ab&&g.type!=b.Hb||b.lx(g,c,g.$d)}else t.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!q.is_camera(a))return t.error("get_stereo_distance(): Wrong camera object"),
0;a=a.g.N;for(var c=0;c<a.length;c++){var d=a[c];if(d.type==b.Ab||d.type==b.Hb)return d.Pj}return 0};a.set_eye_distance=function(a,c){if(q.is_camera(a))for(var d=a.g.N,e=0;e<d.length;e++){var g=d[e];g.type!=b.Ab&&g.type!=b.Hb&&g.type!=b.nc&&g.type!=b.oc||b.lx(g,g.Pj,c)}else t.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!q.is_camera(a))return t.error("get_eye_distance(): Wrong camera object"),0;a=a.g.N;for(var c=0;c<a.length;c++){var d=a[c];if(d.type==b.Ab||
d.type==b.Hb||d.type==b.nc||d.type==b.oc)return d.$d}return 0};a.set_vertical_axis=function(a,b){q.is_camera(a)?(r.copy(b,a.g.ue),e.m(a),l.sync_transform(a)):t.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(q.is_camera(a))return b||(b=r.create()),r.copy(a.g.ue,b),b;t.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,c,d,e){if(q.is_camera(a)){a=a.g.N;for(var k=0;k<a.length;k++){var l=a[k];l.$b||b.Ff(l,l.Xa);var r=D;r[0]=-c;r[1]=
-d;r[2]=0;g.translate(l.mb,r,l.mb);g.rotateZ(l.mb,e,l.mb);b.Bp(l);b.Im(l)}}else t.error("translate_view(): Wrong camera object")};a.get_view_vector=function(a,b){if(!q.is_camera(a))return t.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=H.get_quat_view(a.g.i);k.quat_to_dir(c,k.AXIS_MY,b);return b};a.get_fov=function(a){return q.is_camera(a)?k.vd(a.g.N[0].rb):(t.error("get_fov(): Wrong camera object"),0)};a.set_fov=function(a,c){if(q.is_camera(a))for(var d=a.g.N,
e=0;e<d.length;e++){var g=d[e];g.rb=k.LC(c);g.$b||b.Ff(g,g.Xa);b.Bp(g);b.Im(g)}else t.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(a,c,d){var e;if(e=!q.is_camera(a)){a:{if(q.is_camera(a)){e=a.g.N;for(var g=0;g<e.length;g++){var k=e[g];if(k.type==b.nc||k.type==b.oc){e=!0;break a}}}else t.error("is_hmd_camera(): Wrong camera object");e=!1}e=!e}if(e)t.error("set_hmd_fov(): Wrong camera object");else if(c&&d)for(a=a.g.N,e=0;e<a.length;e++)if(g=a[e],g.type==b.nc||g.type==b.oc)g.type==
b.nc&&u.copy(c,g.Lc),g.type==b.oc&&u.copy(d,g.Lc),g.$b||b.Ff(g),b.Bp(g),b.Im(g)};a.correct_up=function(a,b,d){q.is_camera(a)?(b=b||a.g.ue,c.correct_up(a,b,d||!1),e.m(a),l.sync_transform(a)):t.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,c){if(q.is_camera(a)&&b.is_ortho_camera(a)){var d=a.g;if(b.is_target_camera(a)){var e=H.get_trans_view(d.i),e=r.dist(e,d.pivot);d.bj=c/2*d.aj/e}else b.is_hover_camera(a)?(e=H.get_trans_view(d.i),e=r.distance(e,d.fb),d.bj=c/2*d.aj/e):a.g.N[0].top=
c/2;b.xI(a)}else t.error("set_ortho_scale(): Wrong camera object")};a.get_ortho_scale=function(a){return q.is_camera(a)&&b.is_ortho_camera(a)?2*a.g.N[0].top:(t.error("get_ortho_scale(): Wrong camera object"),0)};a.is_ortho_camera=function(a){return q.is_camera(a)?b.is_ortho_camera(a):(t.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,c,d,e){if(!q.is_camera(a))return t.error("calc_ray(): Wrong camera object"),null;e=e||new Float32Array(3);var g=a.g.N[0];switch(g.type){case b.pc:case b.$e:case b.Ab:case b.Hb:var k=
Math.tan(g.rb*Math.PI/360),l=k*g.Xa;c=n.Fp(c,d,z,g);D[0]=(2*c[0]/g.width-1)*l;D[1]=-1;D[2]=(2*c[1]/g.height-1)*k;H.transform_dir_vec3(D,a.g.i,D);e[0]=D[0];e[1]=D[1];e[2]=D[2];r.normalize(e,e);return e;default:return t.error("calc_ray(): Non-compatible camera"),e}};a.project_point=function(a,c,d){if(!q.is_camera(a))return t.error("project_point(): Wrong camera object"),null;d=d||new Float32Array(2);return b.project_point(a,c,d)};a.has_distance_limits=function(a){return(b.is_target_camera(a)||b.is_hover_camera(a))&&
null!==a.g.Ma};a.has_vertical_rot_limits=function(a){return(b.is_eye_camera(a)||b.is_target_camera(a)||b.is_hover_camera(a))&&null!==a.g.ea};a.has_vertical_limits=function(a){t.Na("has_vertical_limits","has_vertical_rot_limits");return b.is_target_camera(a)||b.is_eye_camera(a)?null!==a.g.ea:(t.error("has_vertical_limits(): Wrong camera object"),!1)};a.has_horizontal_rot_limits=function(a){return(b.is_target_camera(a)||b.is_eye_camera(a))&&null!==a.g.Ha};a.has_horizontal_limits=function(a){t.Na("has_horizontal_limits",
"has_horizontal_rot_limits");return b.is_target_camera(a)||b.is_eye_camera(a)?null!==a.g.Ha:(t.error("has_horizontal_limits(): Wrong camera object"),!1)};a.has_vertical_trans_limits=function(a){return b.is_hover_camera(a)&&null!==a.g.fc};a.has_horizontal_trans_limits=function(a){return b.is_hover_camera(a)&&null!==a.g.ec};a.move_pivot=function(a,c,d){t.Na("move_pivot","target_pan_pivot");if(b.is_target_camera(a)){var g=a.g;if(g.use_panning){var k=H.get_trans_view(g.i),n=r.subtract(k,g.pivot,y);D[0]=
c;D[1]=0;D[2]=d;r.scale(D,r.len(n),D);H.transform_dir_vec3(D,g.i,D);r.add(g.pivot,D,g.pivot);r.add(k,D,k);e.m(a);l.sync_transform(a)}}else t.error("move_pivot(): wrong object")};a.set_velocity_params=function(a,b){t.Na("set_velocity_params","set_velocities");if(q.is_camera(a)){var c=a.g;c.bm=k.clamp(b[0],0,Infinity);c.am=k.clamp(b[1],0,Infinity);c.cm=k.clamp(b[2],0,.99)}else t.error("set_velocity_params(): Wrong camera object")};a.get_velocity_params=function(a,b){t.Na("get_velocity_params","get_velocities");
if(!q.is_camera(a))return t.error("get_velocity_params(): Wrong camera object"),null;b=b||new Float32Array(3);var c=a.g;b[0]=c.bm;b[1]=c.am;b[2]=c.cm;return b};a.clear_horizontal_limits=function(a){t.bn('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');q.is_camera(a)?b.is_target_camera(a)||b.is_eye_camera(a)?a.g.Ha=null:b.is_hover_camera(a)&&
(a.g.ec=null):t.error("clear_horizontal_limits(): Wrong camera object")};a.clear_vertical_limits=function(a){t.bn('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');q.is_camera(a)?b.is_target_camera(a)||b.is_eye_camera(a)?a.g.ea=null:b.is_hover_camera(a)&&(a.g.fc=null):t.error("clear_vertical_limits(): Wrong camera object")};a.clear_hover_angle_limits=
function(){t.bn("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.set_look_at=function(a,d,g,k){t.Ie("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);k=k||a.g.ue;b.set_look_at(a,d,g);c.correct_up(a,k,!0);e.m(a);l.sync_transform(a)};a.rotate_eye_camera=function(a,c,d,g,k){t.Ie("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);b.is_eye_camera(a)?(b.rotate_eye_camera(a,c,d,g,k),e.m(a),l.sync_transform(a)):
t.error("rotate_eye_camera(): wrong object")};a.rotate_target_camera=function(a,c,d,g,k){t.Ie("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);b.is_target_camera(a)?(b.rotate_target_camera(a,c,d,g,k),e.m(a),l.sync_transform(a)):t.error("rotate_target_camera(): wrong object")};a.set_trans_pivot=function(a,c,d){t.Na("camera.set_trans_pivot","camera.target_set_trans_pivot");b.is_target_camera(a)?(b.set_trans_pivot(a,c,d),e.m(a),l.sync_transform(a)):t.error("set_trans_pivot(): Wrong object or camera move style")};
a.zoom_object=function(a,c){t.Na("camera.zoom_object","camera.target_zoom_object");if(b.is_target_camera(a)){e.get_object_center(c,!1,D);d(a,D);e.m(a);var g=e.get_object_size(c),k=b.Xu(a)/2,g=g/Math.sin(k),k=e.qj(a,D);e.move_local(a,0,g-k,0);e.m(a);l.sync_transform(a)}else t.error("zoom_object(): wrong object")};a.set_pivot=d;a.rotate_hover_camera=function(a,c,d,g,k){t.Na("camera.rotate_hover_camera","camera.hover_rotate");b.is_hover_camera(a)?(b.rotate_hover_camera(a,c,d,g,k),e.m(a),l.sync_transform(a)):
t.error("rotate_hover_camera(): wrong object")};a.get_hover_cam_pivot=function(a,c){t.Na("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!b.is_hover_camera(a))return t.error("get_hover_cam_pivot(): wrong object"),null;c||(c=new Float32Array(3));r.copy(a.g.fb,c);return c};a.get_eye=function(a,c){t.Na("camera.get_eye","camera.get_translation");return q.is_camera(a)?b.get_eye(a,c):(t.error("get_eye(): Wrong object"),null)};a.get_pivot=function(a,c){t.Na("camera.get_pivot","camera.target_get_pivot");
if(!b.is_target_camera(a))return t.error("get_pivot(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));r.copy(a.g.pivot,c);return c};a.hover_cam_set_translation=function(a,c){t.Na("camera.hover_cam_set_translation","camera.set_translation");if(b.is_hover_camera(a)){var d=a.g,g=H.get_trans_view(d.i),g=r.subtract(c,g,D);r.add(g,d.fb,d.fb);e.set_translation(a,c);e.m(a);l.sync_transform(a)}else t.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,c){t.Na("camera.set_hover_pivot",
"camera.hover_set_pivot_translation");b.is_hover_camera(a)?(b.set_hover_pivot(a,c),e.m(a),l.sync_transform(a)):t.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_angle_limits=function(a,c){t.Na("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!b.is_hover_camera(a))return t.error("get_hover_angle_limits(): wrong object"),null;c=c||new Float32Array(2);c[0]=a.g.ea.down;c[1]=a.g.ea.up;return c};a.get_cam_dist_limits=function(a,c){t.Ie("camera.get_cam_dist_limits",
["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!b.is_hover_camera(a)&&!b.is_target_camera(a))return t.error("get_cam_dist_limits(): wrong object"),null;if(a.g.Ma)c=c||new Float32Array(2),c[0]=a.g.Ma.max,c[1]=a.g.Ma.min;else return null;return c};a.apply_vertical_limits=function(c,d,g,k){t.Ie("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(b.is_target_camera(c)){var l=C;l.down=
d;l.up=g;l.camera_space=k==e.SPACE_LOCAL;a.target_set_vertical_limits(c,l)}else b.is_eye_camera(c)?(l=C,l.down=d,l.up=g,l.camera_space=k==e.SPACE_LOCAL,a.eye_set_vertical_limits(c,l)):b.is_hover_camera(c)?(l=C,l.min=d,l.max=g,a.hover_set_vert_trans_limits(c,l)):t.error("apply_vertical_limits(): wrong object")};a.apply_hover_angle_limits=function(b,c,d){t.Na("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");C.down=c;C.up=d;a.hover_set_vertical_limits(b,C)};a.apply_distance_limits=
function(c,d,e){t.Ie("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(b.is_target_camera(c)){var g=C;g.min=d;g.max=e;a.target_set_distance_limits(c,g)}else b.is_hover_camera(c)?(g=C,g.min=d,g.max=e,a.hover_set_distance_limits(c,g)):t.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(b){t.Na("camera.clear_distance_limits","camera.target_set_distance_limits");a.target_set_distance_limits(b,null)};a.get_vertical_limits=
function(a,c){t.Ie("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return t.error("get_vertical_limits(): wrong object"),null;var d=a.g;c=c||new Float32Array(2);if(b.is_eye_camera(a)||b.is_target_camera(a)){if(d.ea)return c[0]=d.ea.down,c[1]=d.ea.up,c}else if(b.is_hover_camera(a)&&d.fc)return c[0]=d.fc.min,c[1]=d.fc.max,c;return null};a.apply_horizontal_limits=
function(c,d,g,k){t.Ie("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(b.is_target_camera(c)){var l=C;l.left=d;l.right=g;l.camera_space=k==e.SPACE_LOCAL;a.target_set_horizontal_limits(c,l)}else b.is_eye_camera(c)?(l=C,l.left=d,l.right=g,l.camera_space=k==e.SPACE_LOCAL,a.eye_set_horizontal_limits(c,l)):b.is_hover_camera(c)?(l=C,l.min=d,l.max=g,a.hover_set_horiz_trans_limits(c,l)):t.error("apply_horizontal_limits(): wrong object")};
a.get_horizontal_limits=function(a,c){t.Ie("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return t.error("get_horizontal_limits(): wrong object"),null;var d=a.g;c=c||new Float32Array(2);if(b.is_eye_camera(a)||b.is_target_camera(a)){if(d.Ha)return c[0]=d.Ha.left,c[1]=d.Ha.right,c}else if(b.is_hover_camera(a)&&d.ec)return c[0]=d.ec.min,
c[1]=d.ec.max,c;return null}};b4w.module.config=function(a,p){var d=p("__config");a.P_LOW=d.P_LOW;a.P_HIGH=d.P_HIGH;a.P_ULTRA=d.P_ULTRA;a.P_CUSTOM=d.P_CUSTOM;a.set=d.set;a.get=d.get;a.reset=d.reset;a.get_std_assets_path=d.get_std_assets_path};b4w.module.controls=function(a,p){var d=p("__controls");p("__print");a.CT_POSITIVE=d.CT_POSITIVE;a.CT_CONTINUOUS=d.CT_CONTINUOUS;a.CT_TRIGGER=d.CT_TRIGGER;a.CT_SHOT=d.CT_SHOT;a.CT_LEVEL=d.CT_LEVEL;a.CT_CHANGE=d.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;
a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_DEC_POINT=110;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=
187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=d.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=d.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=d.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=d.PL_MULTITOUCH_MOVE_ROTATE;a.create_custom_sensor=d.create_custom_sensor;a.create_keyboard_sensor=d.create_keyboard_sensor;a.create_collision_sensor=
function(a,c,n){return d.create_collision_sensor(a,c||"ANY",n||!1)};a.create_collision_impulse_sensor=d.create_collision_impulse_sensor;a.create_ray_sensor=function(a,c,n,g,q,l,t){return d.create_ray_sensor(a,c,n,g||"ANY",q||!1,l||!1,t||!1)};a.create_mouse_click_sensor=d.create_mouse_click_sensor;a.create_mouse_wheel_sensor=d.create_mouse_wheel_sensor;a.create_mouse_move_sensor=d.create_mouse_move_sensor;a.create_touch_move_sensor=d.create_touch_move_sensor;a.create_touch_zoom_sensor=d.create_touch_zoom_sensor;
a.create_touch_rotate_sensor=d.create_touch_rotate_sensor;a.create_motion_sensor=d.create_motion_sensor;a.create_vertical_velocity_sensor=d.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=d.create_gyro_angles_sensor;a.create_gyro_quat_sensor=d.create_gyro_quat_sensor;a.create_gyro_delta_sensor=d.create_gyro_delta_sensor;a.create_timer_sensor=function(a,c){return d.create_timer_sensor(a,c||!1)};a.reset_timer_sensor=d.reset_timer_sensor;a.create_elapsed_sensor=d.create_elapsed_sensor;a.create_timeline_sensor=
d.create_timeline_sensor;a.create_selection_sensor=function(a,c){return d.create_selection_sensor(a,c||!1)};a.create_callback_sensor=function(a,c){return d.create_callback_sensor(a,c||0)};a.set_custom_sensor=function(a,c){d.EG(a,c)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=d.get_sensor_value;a.get_sensor_payload=d.get_sensor_payload;a.create_sensor_manifold=function(a,c,n,g,q,l,t){q=q||d.wu;d.create_sensor_manifold(a,c,n,g,q,l,void 0===t?null:t)};a.create_kb_sensor_manifold=
function(a,c,n,g,q,l){g=d.create_keyboard_sensor(g);d.create_sensor_manifold(a,c,n,[g],d.wu,q,void 0===l?null:l)};a.check_sensor_manifolds=function(a){return d.check_sensor_manifold(a,null)};a.check_sensor_manifold=d.check_sensor_manifold;a.remove_sensor_manifold=d.remove_sensor_manifold;a.reset=d.reset;a.register_keyboard_events=d.register_keyboard_events;a.register_mouse_events=function(a,c,n){d.register_mouse_events(a,c,!!n)};a.register_wheel_events=d.register_wheel_events;a.register_touch_events=
d.register_touch_events;a.register_device_orientation=d.register_device_orientation;a.unregister_keyboard_events=d.unregister_keyboard_events;a.unregister_mouse_events=d.unregister_mouse_events;a.unregister_wheel_events=d.unregister_wheel_events;a.unregister_touch_events=d.unregister_touch_events;a.unregister_device_orientation=d.unregister_device_orientation};b4w.module.constraints=function(a,p){var d=p("__camera"),b=p("__constraints"),c=p("__obj_util"),n=p("__physics"),g=p("__print"),q=p("__transform");a.append_stiff=function(a,c,d,g,k){k=k||1;c instanceof Array&&2==c.length?b.BA(a,c[0],c[1],d,g,k):b.Ct(a,c,d,g,k);q.m(a);n.sync_transform(a)};a.append_semi_stiff=function(a,c,d,g){b.AA(a,c,d,g);q.m(a);n.sync_transform(a)};a.append_semi_stiff_cam=function(a,c,e,p,k,r,u,z){d.is_eye_camera(a)?(k=k||-Math.PI/2,r=r||Math.PI/2,u=u||Math.PI/2,z=z||-Math.PI/2,
b.zA(a,c,e,p,k,r,u,z),q.m(a),n.sync_transform(a)):g.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,c,e,p){if(d.is_eye_camera(a)){if(!p||0>p)p=.25;b.yA(a,c,e,p);q.m(a);n.sync_transform(a)}else g.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,c,d){b.DA(a,c,d);q.m(a);n.sync_transform(a)};a.append_copy_trans=function(a,c,d){b.tA(a,c,d);q.m(a);
n.sync_transform(a)};a.append_stiff_trans_rot=function(a,c,d,g){b.EA(a,c,d,g);q.m(a);n.sync_transform(a)};a.append_track=function(a,c){3==c.length?b.IA(a,c):b.HA(a,c);q.m(a);n.sync_transform(a)};a.append_follow=function(a,c,d,g){3==c.length?b.vA(a,c,d,g):b.uA(a,c,d,g);q.m(a);n.sync_transform(a)};a.append_stiff_viewport=function(a,c,d){b.append_stiff_viewport(a,c,d);q.m(a);n.sync_transform(a)};a.remove=function(a){a.ib&&b.remove(a)};a.get_parent=function(a){g.Na("constraints.get_parent","objects.get_parent");
return c.get_parent(a)}};b4w.module.container=function(a,p){var d=p("__container"),b=p("__print");a.get_canvas=d.get_canvas;a.get_canvas_hud=d.get_canvas_hud;a.get_container=d.get_container;a.insert_to_container=function(a,n){2!=arguments.length?b.error("insert_to_container(): two arguments required"):a&&n&&d.insert_to_container(a,n)};a.set_canvas_offsets=d.set_canvas_offsets;a.update_canvas_offsets=d.update_canvas_offsets;a.client_to_canvas_coords=d.client_to_canvas_coords;a.force_offsets_updating=d.force_offsets_updating;
a.resize=function(a,n,g){a&&n||b.warn("Wrong canvas container dimensions: "+a+"x"+n+". Zero dimensions aren't allowed. Resized to: "+d.Vo+"x"+d.Uo+".");d.resize(a,n,g)}};b4w.module.data=function(a,p){var d=p("__data"),b=p("__loader");p("__print");p("__util");a.load=d.load;a.unload=function(a){d.unload(a|0)};a.set_debug_resources_root=d.set_debug_resources_root;a.is_primary_loaded=d.is_primary_loaded;a.is_idle=b.Ah;a.load_and_add_new=d.load;a.cleanup=a.unload;a.activate_media=d.activate_media};b4w.module.debug=function(a,p){function d(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];break;default:a+=b[e]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function b(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);
if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function c(a){a.sort(function(a,b){return b.wq.ALU_OPS-a.wq.ALU_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.wq,e=c.iJ,f=n(c.AC),f=f?"\t\t("+f.join(", ")+")":"\t\t(NA)";r.groupCollapsed("FRAG --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,"\t\tVERT --\x3e","ALU",e.ALU_OPS,"TEX",e.TEX_OPS,f);r.groupCollapsed("directives");for(var f=c.zb.bg,g=0;g<f.length;g++){var k=f[g];r.log(k[0],k[1])}r.groupEnd();r.groupCollapsed("vert src");
r.log(c.hJ);r.groupEnd();r.groupCollapsed("vert stats");for(var m in e)"ALU_OPS"!=m&&"TEX_OPS"!=m&&r.log(m,e[m]);r.groupEnd();r.groupCollapsed("frag src");r.log(c.BD);r.groupEnd();r.groupCollapsed("frag stats");for(m in d)"ALU_OPS"!=m&&"TEX_OPS"!=m&&r.log(m,d[m]);r.groupEnd();r.groupEnd()}}function n(a){for(var b=z.Pi(),c=0;c<b.length;c++)for(var d=b[c],f=e.Ga(d,"MESH",e.DATA_ID_ALL),g=0;g<f.length;g++){var k=H.Sa(f[g],d);if(k&&k.T.length)for(var k=k.T,m=0;m<k.length;m++){var l=k[m];if(l.gc==a&&l.pd.length)return l.pd}}return null}
p("__batch");p("__config");var g=p("__controls"),q=p("__debug"),l=p("__extensions"),t=p("__loader"),e=p("__objects"),H=p("__obj_util"),k=p("__physics"),r=p("__print"),u=p("__renderer"),z=p("__scenes"),D=p("__scenegraph"),y=p("__sfx"),C=p("__shaders"),v=p("__textures"),f=p("__util"),m=p("vec3");a.WM_NONE=q.WM_NONE;a.WM_OPAQUE_WIREFRAME=q.WM_OPAQUE_WIREFRAME;a.WM_TRANSPARENT_WIREFRAME=q.WM_TRANSPARENT_WIREFRAME;a.WM_FRONT_BACK_VIEW=q.WM_FRONT_BACK_VIEW;a.WM_DEBUG_SPHERES=q.WM_DEBUG_SPHERES;a.physics_stats=
function(){k.IC()};a.physics_id=function(a){r.log("O",k.lD(a));for(var b=k.QD().tb.s,c=0;c<b.length;c++){var d=b[c];d.o.A==a&&r.log("B",d)}};a.visible_objects=function(){for(var a=z.get_active(),b=e.Ga(a,"MESH",e.DATA_ID_ALL),a=[z.X(a,"MAIN_OPAQUE"),z.X(a,"MAIN_BLEND"),z.X(a,"MAIN_GLOW")],c=0;c<a.length;c++){var d=a[c],f=d.s;if(f.length){r.group(d.type,"DYNAMIC");for(var g=0;g<b.length;g++){var k=b[g],m=k.g;if("DYNAMIC"==m.type)for(var l=0;l<f.length;l++){var n=f[l];if(n.Jb&&n.ne==m){r.ir(k.name,
k);break}}}r.groupEnd();r.groupCollapsed(d.type,"STATIC");for(g=0;g<b.length;g++)if(k=b[g],m=k.g,"DYNAMIC"!=m.type)for(l=0;l<f.length;l++)if(n=f[l],n.Jb&&n.ne==m){r.ir(k.name,k);break}r.groupEnd()}}};a.object_info=function(a){for(var b=z.get_active(),c=e.Ga(b,"MESH",e.DATA_ID_ALL),d=0;d<c.length;d++){var f=c[d];if(f.name==a){r.log("Object",f);for(var g=z.Bq(b),k=0;k<g.length;k++){for(var m=g[k],l=m.s,n=[],q=0;q<l.length;q++)l[q].ne==f.g&&n.push(l[q]);r.log("Subscene "+m.type,n)}}}};a.objects_stat=
function(){var a=z.get_active();console.log("Armatures: "+e.Ga(a,"ARMATURE",e.DATA_ID_ALL).length);console.log("Cameras: "+e.Ga(a,"CAMERA",e.DATA_ID_ALL).length);console.log("Curves: "+e.Ga(a,"CURVE",e.DATA_ID_ALL).length);console.log("Empties: "+e.Ga(a,"EMPTY",e.DATA_ID_ALL).length);console.log("Lamps: "+e.Ga(a,"LAMP",e.DATA_ID_ALL).length);console.log("Meshes: "+e.Ga(a,"MESH",e.DATA_ID_ALL).length);console.log("Speakers: "+e.Ga(a,"SPEAKER",e.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=
0,b=z.get_active(),b=[z.X(b,"MAIN_OPAQUE"),z.X(b,"MAIN_BLEND"),z.X(b,"MAIN_GLOW")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.s,e=0;e<d.length;e++){var f=d[e].I;f&&(a+=f.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=z.get_active(),b=[z.X(b,"MAIN_OPAQUE"),z.X(b,"MAIN_BLEND"),z.X(b,"MAIN_GLOW")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.s,e=0;e<d.length;e++){var f=d[e].I;f&&(a+=f.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=z.get_active(),b=[z.X(a,"MAIN_OPAQUE"),
z.X(a,"MAIN_BLEND"),z.X(a,"MAIN_GLOW")],c=0,d=0;d<b.length;d++){var e=b[d];e&&(c+=e.s.length)}a=z.Kx(a,["MAIN_PLANE_REFLECT","MAIN_CUBE_REFLECT"]);for(d=0;d<a.length;d++)e=a[d],c="MAIN_PLANE_REFLECT"==e.type?c+e.s.length:c+6*e.s.length;return c};a.num_shaders=function(){return f.cl(C.av())};a.geometry_stats=function(){for(var a=z.get_active(),b=z.Bq(a),a={},c=0;c<b.length;c++){var d=b[c];if("SINK"!=d.type&&"WIREFRAME"!=d.type)for(var e=d.s,f=0;f<e.length;f++){var g=e[f].I,k=e[f].ne;g&&("COLOR_PICKING"!=
d.type&&"OUTLINE_MASK"!=d.type||k.Qn||k.Pn)&&(a[g.id]=g)}}var e=d=c=b=0,m;for(m in a)g=a[m],g=g.P,g.Um&&(d++,e+=g.Um/1048576),b++,c+=g.vu/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=z.get_active(),c=[z.X(c,"MAIN_OPAQUE"),z.X(c,"MAIN_BLEND"),z.X(c,"MAIN_GLOW")],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.s,f=0;f<e.length;f++){var g=e[f].I;if(g)for(var g=g.U,k=0;k<g.length;k++){var m=g[k];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===
m.source){var l=m.Qa;-1===a.indexOf(l)&&(a.push(l),m=m.width*m.height*4/1048576/m.Op,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=z.get_active(),c=z.Bq(c),d=0;d<c.length;d++){var e=c[d];if("SINK"!=e.type){var f=e.j,g=[f.Ib,f.Ld];g.push.apply(g,e.Ve);for(e=0;e<g.length;e++){var k=g[e];v.ej(k)&&-1==a.indexOf(k)&&(a.push(k),b+=f.width*f.height*v.qE(k))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=
z.get_active();(a=z.X(a,"MAIN_OPAQUE"))&&z.cw(a.j,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=z.get_active(),b=z.X(a,"MAIN_OPAQUE"),a=z.Kx(a,["SHADOW_CAST"]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}z.cw(d.j,b,e)}};a.scenegraph_to_dot=function(){for(var a=z.Pi(),b=0;b<a.length;b++)r.log("\n"+D.FC(z.dv(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){r.log("\n"+t.wE())};
a.controls_info=g.debug;a.object_distance=function(a,b){var c=m_tsr.get_trans_view(a.g.i),d=m_tsr.get_trans_view(b.g.i);return m.dist(c,d)};a.msg=q.msg;a.fbmsg=q.fbmsg;a.print_telemetry=q.print_telemetry;a.plot_telemetry=q.plot_telemetry;a.fbres=function(a,b){function c(){q.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),g=new Float32Array([-1,
0,0]),k=new Float32Array([0,-1,0]),m=new Float32Array([0,0,-1]);if(!f.Xf(a,f.ot))throw"Wrong VEC3_IDENT";if(!f.Xf(b,f.nt))throw"Wrong QUAT4_IDENT";if(!f.Xf(c,f.AXIS_X))throw"Wrong AXIS_X";if(!f.Xf(d,f.AXIS_Y))throw"Wrong AXIS_Y";if(!f.Xf(e,f.AXIS_Z))throw"Wrong AXIS_Z";if(!f.Xf(g,f.AXIS_MX))throw"Wrong AXIS_MX";if(!f.Xf(k,f.AXIS_MY))throw"Wrong AXIS_MY";if(!f.Xf(m,f.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=y.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==
y.Gq(c)&&y.mute(c,!0)}};a.check_finite=function(a){q.check_finite(a)};a.set_debug_params=function(a){var b=z.get_active();if(b=z.X(b,"WIREFRAME")){if("number"==typeof a.wireframe_mode)switch(a.wireframe_mode){case q.WM_NONE:case q.WM_OPAQUE_WIREFRAME:case q.WM_TRANSPARENT_WIREFRAME:case q.WM_FRONT_BACK_VIEW:case q.WM_DEBUG_SPHERES:z.hH(b,a.wireframe_mode);break;default:r.error("set_debug_params(): Wrong wireframe mode")}"object"==typeof a.wireframe_edge_color&&z.gH(b,a.wireframe_edge_color)}else throw"Wireframe subscene not found.";
};a.get_error_quantity=function(){return r.dE()};a.get_warning_quantity=function(){return r.uE()};a.clear_errors_warnings=function(){return r.clear_errors_warnings()};a.analyze_shaders=function(a){var e=C.av(),f=0,g;for(g in e)a&&-1===g.indexOf(a)||f++;var f="of "+f+" analyzing...",k={};for(g in e)if(!a||-1!==g.indexOf(a)){var m=e[g],n;var q=m.Us;n=m.Qu;var p=l.Cq();if(p){q=p.getTranslatedShaderSource(q);n=p.getTranslatedShaderSource(n);q=q.replace("#version","#version 400 //");n=n.replace("#version",
"#version 400 //");var p=b("/nvidia_vert",q),t=d(p),u=b("/nvidia_frag",n),v=d(u);n={hJ:q,mM:p,iJ:t,BD:n,LK:u,wq:v}}else r.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),n=void 0;p=m.zb;q=p.$j+" + "+p.Mi;n.AC=m;n.zb=p;m=k[q]=k[q]||[];m.push(n);r.log(f)}for(q in k)r.group("%c"+q,"color: #800"),m=k[q],c(m),r.groupEnd()};a.fake_load=q.fake_load;a.test_performance=function(a){if(l.hn()){var b=D.jC();z.Tu(b);for(var c=D.Fb(b,"PERFORMANCE"),b=0;10>b;b++)u.Gi(c);
window.setTimeout(function(){q.hG(c);a(c.Zf)},100)}else a(-1)}};b4w.module.geometry=function(a,p){var d=p("__batch"),b=p("__geometry"),c=p("__print"),n=p("__renderer");a.extract_vertex_array=function(a,n,l){if(!b.Zi(a))return c.error("Wrong object:",a.name),null;if(a=d.Fa(a,n,"MAIN")){if((n=a.P)&&n.xb&&n.xb[l])return b.eD(n,l);c.error("Attribute not found:"+l);return null}c.error("Wrong material:",n);return null};a.extract_index_array=function(a,n){if(!b.Zi(a))return c.error("Wrong object:",a.name),null;var l=d.Fa(a,n,"MAIN");if(l){if((l=l.P)&&l.xb)return l.eg;
c.error("Buffer data not found");return null}c.error("Wrong material:",n);return null};a.update_vertex_array=function(a,n,l,p){var e=["MAIN","SHADOW","COLOR_ID"];if(b.Zi(a))for(var H=0;H<e.length;H++){var k=d.Fa(a,n,e[H]);k&&(k=k.P)&&k.xb&&k.xb[l]&&b.Eo(k,l,0,p)}else c.error("Wrong object:",a.name)};a.override_geometry=function(a,q,l,p,e){var H=["MAIN","SHADOW","COLOR_ID"];if(b.Zi(a))if(l instanceof Uint16Array||l instanceof Uint32Array)if(p instanceof Float32Array)for(var k=0;k<H.length;k++){var r=
d.Fa(a,q,H[k]);if(r){var u=r.P;if(u){b.Zx(u,r.nf,l);var z=0,D;for(D in u.xb)var y=u.xb[D],z=z+p.length/3*y.Wd;u.zc=new Float32Array(z);var z=u.zc,C=0;for(D in u.xb)switch(y=u.xb[D],D){case "a_position":z.set(p,C);y.offset=C;y.length=p.length;C+=y.length;break;case "a_normal":var v;e&&(v=b.Rt(l,p,p));var f=b.Qt(l,p,v);z.set(f,C);y.offset=C;y.length=p.length;C+=y.length;break;case "a_tangent":y.offset=C;y.length=p.length/3*y.Wd;for(var f=new Float32Array(y.length),m=0;m<f.length;m+=4)f[m]=1,f[m+3]=
1;z.set(f,C);C+=y.length;break;default:y.offset=C,y.length=p.length/3*y.Wd,f=new Float32Array(y.length),z.set(f,C),C+=y.length}b.cy(u);n.ip(r);(r=d.ld(a,r))&&r.P&&(r.P=u)}}}else c.error("Wrong positions_array type");else c.error("Wrong ibo_array type");else c.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,d,l){b.check_shape_keys(a)?b.Kq(a,d)?b.Dt(a,d,parseFloat(l)):c.error("Wrong key name:",d):c.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return b.check_shape_keys(a)};
a.get_shape_keys_names=function(a){return b.check_shape_keys(a)?b.get_shape_keys_names(a):(c.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,d){return b.check_shape_keys(a)?b.Kq(a,d)?b.get_shape_key_value(a,d):(c.error("Wrong key name:",d),null):(c.error("Wrong object:",a.name),null)};a.draw_line=function(a,q,l){l=l||!1;if(q instanceof Float32Array){if(a=d.Fq(a))b.draw_line(a,q,l),n.ip(a)}else c.error("Wrong positions type")}};b4w.module.hud=function(a,p){var d=p("__hud");p("__print");a.draw_mixer_strip=d.draw_mixer_strip;a.plot_array=d.plot_array};b4w.module.lights=function(a,p){function d(a){for(var b=l.get_active(),d=n.Ga(b,"LAMP",n.DATA_ID_ALL),g=0;g<d.length;g++){var f=d[g];if("SUN"==f.Oa.type){var m=f;break}}if(!m)q.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){d=(90-a.vert_position)/180*Math.PI;g=m.g;t.set_rotation_euler(m,[d,(180-a.hor_position)/180*Math.PI,0]);a=new Float32Array(3);f=e.get_quat_view(g.i);H.quat_to_dir(f,H.AXIS_Y,a);g=e.get_trans_view(g.i);g=k.length(g);
k.copy(a,r);k.scale(r,g,r);t.set_translation(m,r);t.m(m);a=m.Oa;if(a.Fu){var h=b.world.light_settings.environment_energy,g=b.world.horizon_color,f=b.world.zenith_color,p=Math.cos(Math.abs(d)),d=Math.max(Math.min(3*p,1),0)*a.yu,h=Math.max(p,.1)*h;c.cs(a,d);l.set_environment_colors(b,h,g,f)}l.Fo(m,b)}}function b(a){if(g.is_lamp(a))return a.Oa.type;q.error("get_light_type(): Wrong object");return!1}var c=p("__lights"),n=p("__objects"),g=p("__obj_util"),q=p("__print"),l=p("__scenes"),t=p("__transform"),
e=p("__tsr"),H=p("__util"),k=p("__vec3"),r=new Float32Array(3),u,z=60;a.get_lamps=function(a){var b=l.get_active(),b=n.Ga(b,"LAMP",n.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.Oa.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=l.get_active(),a=n.Ga(a,"LAMP",n.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.Oa.type){b=d;break}}return b?(b=b.Oa.direction,a=180*Math.atan2(b[2],b[0])/Math.PI+90,180<a&&(a-=360),b=180*Math.atan2(b[1],Math.sqrt(b[0]*
b[0]+b[2]*b[2]))/Math.PI,c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=d;a.set_day_time=function(a){for(var b=l.get_active(),b=n.Ga(b,"LAMP",n.DATA_ID_ALL),c=0;c<b.length;c++){var e=b[c];if("SUN"==e.Oa.type){var f=e;break}}f?(f=-Math.cos(a/12*Math.PI)*z,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=f,d(b)):q.error("There is no sun on the scene")};a.set_date=function(a){(u=a.getDate())?1582==u&&10==a.GL&&4<a.EC&&15>a.EC&&q.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
q.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){z=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(g.is_lamp(a))var c=a.Oa;else return q.error("get_light_params(): Wrong object"),null;if(a=b(a))switch(a){case "SPOT":var d={light_type:a,light_color:c.color,light_energy:c.Md,light_spot_blend:c.Pl,light_spot_size:c.ci,light_distance:c.distance};break;case "POINT":d={light_type:a,light_color:c.color,light_energy:c.Md,light_distance:c.distance};break;default:d=
{light_type:a,light_color:c.color,light_energy:c.Md}}return d?d:null};a.get_light_type=b;a.set_light_params=function(a,b){if(g.is_lamp(a)){var d=a.Oa,e=l.get_active();"number"==typeof b.light_energy&&c.cs(d,b.light_energy);"object"==typeof b.light_color&&c.jx(d,b.light_color);"number"==typeof b.light_spot_blend&&c.UG(d,b.light_spot_blend);"number"==typeof b.light_spot_size&&c.VG(d,b.light_spot_size);"number"==typeof b.light_distance&&c.TG(d,b.light_distance);l.Fo(a,e);n.aI(e)}else q.error("set_light_params(): Wrong object")}};b4w.module.material=function(a,p){function d(a,b){for(var c=a.B[0].T,d=0;d<c.length;d++){var e=c[d];if(-1<e.pd.indexOf(b))return"MAIN"==e.type}return!1}function b(a,b){var c=n.Fa(a,b,"MAIN");return Boolean(c&&c.Wc[0])}function c(a,b){var c=n.Fa(a,b,"MAIN");return Boolean(c&&c.Wc[1])}var n=p("__batch"),g=p("__config"),q=p("__obj_util"),l=p("__print"),t=p("__shaders"),e=p("__util"),H=g.p;a.inherit_material=function(a,b,c,d){q.Vq(c)&&q.Vq(a)?n.inherit_material(a,b,c,d):l.error("Wrong or batched object(s)")};
a.get_materials_names=function(a){var b=[];a=a.B;for(var c=0;c<a.length;c++)for(var d=a[c].T,e=0;e<d.length;e++)for(var g=0;g<d[e].pd.length;g++)-1==b.indexOf(d[e].pd[g])&&b.push(d[e].pd[g]);return b};a.set_diffuse_color=function(a,b,c){var d=n.Fa(a,b,"MAIN");d?(d.vc.set(c),(a=n.ld(a,b,"MAIN"))&&a.vc.set(c)):l.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=n.Fa(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.vc);return d}l.error('Couldn\'t get property "diffuse_color"!')};
a.set_diffuse_intensity=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.ag=c,a=n.ld(a,b,"MAIN"))a.ag=c}else l.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=n.Fa(a,b,"MAIN");if(c)return c.ag;l.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=n.Fa(a,b,"MAIN");d?(d.Te.set(c),(a=n.ld(a,b,"MAIN"))&&a.Te.set(c)):l.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=n.Fa(a,
b,"MAIN");if(c){var d=Array(3);d[0]=c.Te[0];d[1]=c.Te[1];d[2]=c.Te[2];return d}l.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.bi=c,a=n.ld(a,b,"MAIN"))a.bi=c}else l.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=function(a,b){var c=n.Fa(a,b,"MAIN");if(c)return c.bi;l.error('Couldn\'t get property "specular_color_factor"!')};a.set_specular_intensity=function(a,c,d){b(a,c)||l.error('Property "specular_intensity" is missing!');
n.Fa(a,c,"MAIN").Wc[0]=d;(a=n.ld(a,c,"MAIN"))&&(a.Wc[0]=d)};a.get_specular_intensity=function(a,c){b(a,c)||l.error('Property "specular_intensity" is missing!');return n.Fa(a,c,"MAIN").Wc[0]};a.check_specular_intensity=b;a.set_specular_hardness=function(a,b,d){c(a,b)||l.error('Property "specular_hardness" is missing!');n.Fa(a,b,"MAIN").Wc[1]=d;(a=n.ld(a,b,"MAIN"))&&(a.Wc[1]=d)};a.get_specular_hardness=function(a,b){c(a,b)||l.error('Property "specular_hardness" is missing!');return n.Fa(a,b,"MAIN").Wc[1]};
a.check_specular_hardness=c;a.set_emit_factor=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.of=c,a=n.ld(a,b,"MAIN"))a.of=c}else l.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=n.Fa(a,b,"MAIN");if(c)return c.of;l.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.bf=c,a=n.ld(a,b,"MAIN"))a.bf=c}else l.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=
n.Fa(a,b,"MAIN");if(c)return c.bf;l.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.$f=c,a=n.ld(a,b,"MAIN"))a.$f=c}else l.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=n.Fa(a,b,"MAIN");if(c)return c.$f;l.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=n.Fa(a,b,"MAIN");if(d){if(d.Sf=c,a=n.ld(a,b,"MAIN"))a.Sf=c}else l.error('Couldn\'t set property "alpha_factor"!')};
a.get_alpha_factor=function(a,b){var c=n.Fa(a,b,"MAIN");if(c)return c.Sf;l.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return l.error("missing arguments in get_material_params"),null;if(!d(a,b))return null;var c=n.Fa(a,b,"MAIN");if(!c)return null;var e={};"MAIN"==c.type&&(e.reflect_factor=c.reflect_factor,e.fresnel=c.ke[2],e.fresnel_factor=5*(1-c.ke[3]),e.parallax_scale=c.parallax_scale,e.parallax_steps=n.dc(c,"PARALLAX_STEPS")[1]);return e};
a.get_water_material_params=function(a,b){if(!a||!b)return l.error("missing arguments in get_water_material_params"),null;if(!d(a,b))return null;var c=n.Fa(a,b,"MAIN");if(!c||!c.Ng)return null;if(!c)return l.error("material not found"),null;var e={};if("MAIN"==c.type){if(H.Dj){var g=e.shallow_water_col=Array(3);g[0]=c.shallow_water_col[0];g[1]=c.shallow_water_col[1];g[2]=c.shallow_water_col[2];g=e.shore_water_col=Array(3);g[0]=c.shore_water_col[0];g[1]=c.shore_water_col[1];g[2]=c.shore_water_col[2];
e.shallow_water_col_fac=c.shallow_water_col_fac;e.shore_water_col_fac=c.shore_water_col_fac}e.foam_factor=c.foam_factor;e.norm_uv_velocity=c.bk;e.absorb_factor=n.dc(c,"ABSORB")[1];e.sss_strength=n.dc(c,"SSS_STRENGTH")[1];e.sss_width=n.dc(c,"SSS_WIDTH")[1];e.dst_noise_scale0=n.dc(c,"DST_NOISE_SCALE_0")[1];e.dst_noise_scale1=n.dc(c,"DST_NOISE_SCALE_1")[1];e.dst_noise_freq0=n.dc(c,"DST_NOISE_FREQ_0")[1];e.dst_noise_freq1=n.dc(c,"DST_NOISE_FREQ_1")[1];e.dir_min_shore_fac=n.dc(c,"DIR_MIN_SHR_FAC")[1];
e.dir_freq=n.dc(c,"DIR_FREQ")[1];e.dir_noise_scale=n.dc(c,"DIR_NOISE_SCALE")[1];e.dir_noise_freq=n.dc(c,"DIR_NOISE_FREQ")[1];e.dir_min_noise_fac=n.dc(c,"DIR_MIN_NOISE_FAC")[1];e.dst_min_fac=n.dc(c,"DST_MIN_FAC")[1];e.waves_hor_fac=n.dc(c,"WAVES_HOR_FAC")[1]}return e};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=n.Fa(a,b,"MAIN");if(e){var g=[e];(e=n.ld(a,b,"MAIN"))&&g.push(e);for(a=0;a<g.length;a++)e=g[a],"number"==typeof c.material_reflectivity&&(e.reflect_factor=c.material_reflectivity),
"number"==typeof c.material_fresnel&&(e.ke[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(e.ke[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(e.parallax_scale=c.material_parallax_scale),"number"==typeof c.material_parallax_steps&&(b=t.q(parseFloat(c.material_parallax_steps)),n.va(e,"PARALLAX_STEPS",b),n.Sb(e,!0))}else l.error("material not found")}else l.error("setting material params is not possible");else l.error("missing arguments in set_material_params")};
a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=n.Fa(a,b,"MAIN");if(e){var g=[e];(e=n.ld(a,b,"MAIN"))&&g.push(e);for(a=0;a<g.length;a++)e=g[a],H.Dj&&("object"==typeof c.shallow_water_col&&e.shallow_water_col.set(c.shallow_water_col),"number"==typeof c.shallow_water_col_fac&&(e.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&e.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(e.shore_water_col_fac=c.shore_water_col_fac)),
H.shore_smoothing&&e.Po&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?n.va(e,"SHORE_SMOOTHING",1):n.va(e,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=t.q(parseFloat(c.absorb_factor)),n.va(e,"ABSORB",b))),"number"==typeof c.foam_factor&&H.Ki&&(e.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(e.bk=c.norm_uv_velocity),H.water_dynamic&&e.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?n.va(e,"DYNAMIC",1):n.va(e,"DYNAMIC",0)),"number"==typeof c.waves_height&&
(b=t.q(parseFloat(c.waves_height)),n.va(e,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=t.q(parseFloat(c.waves_length)),n.va(e,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=t.q(parseFloat(c.sss_strength)),n.va(e,"SSS_STRENGTH",b)),"number"==typeof c.sss_width&&(b=t.q(parseFloat(c.sss_width)),n.va(e,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=t.q(parseFloat(c.dst_noise_scale0)),n.va(e,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=t.q(parseFloat(c.dst_noise_scale1)),
n.va(e,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=t.q(parseFloat(c.dst_noise_freq0)),n.va(e,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=t.q(parseFloat(c.dst_noise_freq1)),n.va(e,"DST_NOISE_FREQ_1",b)),"number"==typeof c.dir_min_shore_fac&&(b=t.q(parseFloat(c.dir_min_shore_fac)),n.va(e,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=t.q(parseFloat(c.dir_freq)),n.va(e,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=t.q(parseFloat(c.dir_noise_scale)),
n.va(e,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=t.q(parseFloat(c.dir_noise_freq)),n.va(e,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=t.q(parseFloat(c.dir_min_noise_fac)),n.va(e,"DIR_MIN_NOISE_FAC",b)),"number"==typeof c.dst_min_fac&&(b=t.q(parseFloat(c.dst_min_fac)),n.va(e,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=t.q(parseFloat(c.waves_hor_fac)),n.va(e,"WAVES_HOR_FAC",b))),n.Sb(e,!0)}else l.error("material not found")}else l.error("setting water material params is not possible");
else l.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=n.Fq(a);c?(e.nd(b.color)&&c.vc.set(b.color),e.nd(b.width)&&(c.Cn=b.width)):l.error("Couldn't set line params!")};a.get_line_params=function(a){if(a=n.Fq(a))return{color:new Float32Array(a.vc),width:a.Cn};l.error("Couldn't get line params");return null}};b4w.module.particles=function(a,p){var d=p("__particles"),b=p("__print");a.set_size=function(a,n,g){d.pj(a)?d.set_size(a,n,g):b.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,n,g){d.pj(a)?d.set_normal_factor(a,n,g):b.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,n,g){d.pj(a)?(g=Math.min(g,1),g=Math.max(g,0),d.set_factor(a,n,g)):b.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,p){p("__config");var d=p("__ipc"),b=p("__physics"),c=p("__print"),n=p("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.R(a)?b.enable_simulation(a):c.error("No physics for object "+a.name)};a.disable_simulation=function(a){b.R(a)?b.disable_simulation(a):c.error("No physics for object "+a.name)};a.has_physics=function(a){return b.R(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,d){b.R(a)?b.set_gravity(a,d):c.error("No physics for object "+a.name)};a.set_damping=function(a,d,l){b.R(a)?b.C("set_damping",a.o.A,d,l):c.error("No physics for object "+a.name)};a.reset_damping=function(a){if(b.R(a)){var d=a.oe;b.C("set_damping",a.o.A,d.$p,d.Ur)}else c.error("No physics for object "+a.name)};a.set_transform=function(a,d,l){b.R(a)?b.set_transform.apply(this,arguments):c.error("No physics for object "+a.name)};a.sync_transform=
function(a){b.R(a)?b.sync_transform(a):c.error("No physics for object "+a.name)};a.apply_velocity=function(a){b.R(a)?b.apply_velocity.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_velocity_world=function(a){b.R(a)?b.apply_velocity_world.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_force=function(a,d,l,n){b.R(a)?b.apply_force.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_torque=function(a,d,l,n){b.R(a)?b.apply_torque.apply(this,
arguments):c.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,d){b.R(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_throttle(a,n.clamp(d,-1,1))):c.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,d,l){if(b.R(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");d=n.clamp(d,0,1);var p=a.l.Hi;-1==l||1==l?p=Math.max(-1,Math.min(p+l*d,1)):0==l&&0<=p?(p-=d,p=Math.max(0,p)):0==l&&0>p?(p+=d,p=Math.min(0,
p)):c.error("Wrong steering direction");b.vehicle_throttle(a,n.clamp(p,-1,1))}else c.error("No physics for object "+a.name)};a.vehicle_steer=function(a,d){b.R(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_steer(a,n.clamp(d,-1,1))):c.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,d,l){if(b.R(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");d=n.clamp(d,0,1);var p=a.l.Lj;-1==l||1==l?p=Math.max(-1,Math.min(p+l*d,
1)):0==l&&0<=p?(p-=d,p=Math.max(0,p)):0==l&&0>p?(p+=d,p=Math.min(0,p)):c.error("Wrong steering direction");b.vehicle_steer(a,n.clamp(p,-1,1))}else c.error("No physics for object "+a.name)};a.vehicle_brake=function(a,d){b.R(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_brake(a,n.clamp(d,0,1))):c.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,d){if(b.R(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");d=n.clamp(d,
-1,1);var l=a.l.nk;b.vehicle_brake(a,n.clamp(l+l*d,0,1))}else c.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.R(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.Zc.name;c.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.R(a))return c.error("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.Hi;c.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!b.R(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.Lj;c.error("Wrong object")};a.get_vehicle_brake=function(a){if(!b.R(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.nk;c.error("Wrong object")};a.get_vehicle_speed=
function(a){if(!b.R(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);c.error("Wrong object")};a.is_character=function(a){return b.is_character(a)};a.set_character_move_dir=function(a,d,l){b.R(a)?b.set_character_move_dir(a,d,l):c.error("No physics for object "+a.name)};a.set_character_move_type=function(a,d){b.R(a)?b.set_character_move_type(a,d):c.error("No physics for object "+a.name)};a.set_character_walk_velocity=
function(a,d){b.R(a)?b.set_character_walk_velocity(a,d):c.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,d){b.R(a)?b.set_character_run_velocity(a,d):c.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,d){b.R(a)?b.set_character_fly_velocity(a,d):c.error("No physics for object "+a.name)};a.character_jump=function(a){b.R(a)?b.character_jump(a):c.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,d,l){b.R(a)?b.character_rotation_inc(a,
d,l):c.error("No physics for object "+a.name)};a.set_character_rotation=function(a,d,l){b.R(a)?b.set_character_rotation(a,d,l):c.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,d){b.R(a)?b.set_character_rotation_v(a,d):c.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,d){b.R(a)?b.set_character_rotation_h(a,d):c.error("No physics for object "+a.name)};a.append_collision_test=function(a,d,l,n){b.R(a)?b.append_collision_test(a,d,l,n||!1):c.error("No physics for object "+
a.name)};a.remove_collision_test=function(a,d,l){b.R(a)?b.remove_collision_test(a,d||"ANY",l):c.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,d){b.R(a)?b.apply_collision_impulse_test(a,d):c.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.R(a)?b.clear_collision_impulse_test(a):c.error("No physics for object "+a.name)};a.append_ray_test=function(a,d,l,n,e,p){a=a||null;if(null==a||b.R(a))return b.append_ray_test(a,d,l,n,e,p||!1,
!1,!1,!1);c.error("No physics for object "+a.name)};a.append_ray_test_ext=function(a,d,l,n,e,p,k,r,u){a=a||null;if(null==a||b.R(a))return b.append_ray_test(a,d,l,n,e,p||!1,k||!1,r||!1,u||!1);c.error("No physics for object "+a.name)};a.remove_ray_test=function(a){b.Lv(a)?b.remove_ray_test(a):c.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,d,l){b.Lv(a)?b.change_ray_test_from_to(a,d,l):c.error("Wrong ray test ID")};a.apply_constraint=function(a,d,l,n,e,p,k,r,u,z){b.R(d)&&b.R(e)?b.apply_constraint(a,
d,l,n,e,p,k,r,u,z):c.error("Wrong objects")};a.clear_constraint=function(a){b.R(a)&&b.zE(a)?b.clear_constraint(a):c.error("Wrong object")};a.pull_to_constraint_pivot=function(a,d,l,n,e,p){b.R(a)&&b.R(n)?b.pull_to_constraint_pivot(a,d,l,n,e,p):c.error("Wrong objects")};a.get_worker_listeners=d.get_worker_listeners};b4w.module.rgb=function(a,p){p("__print");var d=p("__util"),b=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,b,d){var q=new Float32Array(3);q[0]=a;q[1]=b;q[2]=d;return q};a.set=function(a,b,d,q){q[0]=a;q[1]=b;q[2]=d;return q};a.css_to_rgb=function(a,b,g,q){q=q||new Float32Array(3);q[0]=a/255;q[1]=b/255;q[2]=g/255;d.Cx(q,q);return q};a.rgb_to_css=function(a){a=d.fr(a,b);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function n(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=d.fr(a,b);return"#"+n(a[0])+n(a[1])+n(a[2])}};
b4w.module.rgba=function(a,p){p("__print");var d=p("__util"),b=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,b,d,q){var l=new Float32Array(4);l[0]=a;l[1]=b;l[2]=d;l[3]=q;return l};a.set=function(a,b,d,q,l){l[0]=a;l[1]=b;l[2]=d;l[3]=q;return l};a.css_to_rgba=function(a,b,g,q,l){l=l||new Float32Array(4);l[0]=a/255;l[1]=b/255;l[2]=g/255;l[3]=q;d.Cx(l,l);return l};a.rgba_to_css=function(a){var n=d.fr(a,b);return[Math.round(255*n[0]),Math.round(255*
n[1]),Math.round(255*n[2]),a[3]]}};b4w.module.scenes=function(a,p){var d=p("__batch"),b=p("__camera"),c=p("__data"),n=p("__graph"),g=p("__objects"),q=p("__obj_util"),l=p("__physics"),t=p("__print"),e=p("__scenes"),H=p("__util");p("__vec4");a.DATA_ID_ALL=g.DATA_ID_ALL;a.set_active=function(a){var b=e.Pi();e.set_active(H.keysearch("name",a,b))};a.get_active=function(){return e.la()?e.get_active().name:""};a.get_scenes=function(){for(var a=e.Pi(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(e.la())return e.Qi(e.get_active());
t.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=g.Qb(g.Xo,a,b|0);if(c)return c;t.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=g.Qb(g.Wo,a,b,c|0))return a;t.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=g.Qb(g.hc,a,b|0);if(c)return c;t.error("get object "+a+": not found")};a.get_object_data_id=function(a){return e.get_object_data_id(a)};a.pick_object=g.pick_object;a.outlining_is_enabled=
function(a){return a&&a.g&&a.g.Kb};a.set_outline_intensity=function(a,b){a&&a.g&&a.g.Kb?a.g.pg=b:t.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.g&&a.g.Kb)return a.g.pg;t.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,d){a&&a.g&&a.g.Kb?g.apply_outline_anim(a,b,c,d):t.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.g&&a.g.Kb){var b=a.g.sj;g.apply_outline_anim(a,b.tj,b.uj,b.vj)}else t.error("apply_outline_anim_def(): wrong object")};
a.clear_outline_anim=function(a){a&&a.g&&a.g.Kb?g.clear_outline_anim(a):t.error("clear_outline_anim(): wrong object")};a.set_outline_color=e.set_outline_color;a.get_outline_color=function(a){var b=e.get_active();if(b=e.X(b,"OUTLINE"))return a=a||new Float32Array(3),a.set(b.Af),a};a.set_hmd_params=function(a){if(!e.la())t.error("No active scene");else if(a){var b=e.get_active();if(b=e.X(b,"STEREO"))a.distortion_coefs&&a.distortion_coefs instanceof Array&&(b.Ci[0]=a.distortion_coefs[0],b.Ci[1]=a.distortion_coefs[1],
b.ia=!0),a.chromatic_aberration_coefs&&a.chromatic_aberration_coefs instanceof Array&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.ia=!0),a.distortion_scale&&"number"==typeof a.distortion_scale&&(b.Ci[2]=a.distortion_scale,b.ia=!0),a.distortion_offset&&"number"==typeof a.distortion_offset&&
(b.Ci[3]=a.distortion_offset,b.ia=!0),a.enable_hmd_stereo&&"boolean"==typeof a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.ia=!0)}};a.get_shadow_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active(),b=e.X(a,"SHADOW_CAST");if(!b)return null;var c=a.k.kc,d=e.X(a,"MAIN_OPAQUE"),g=e.X(a,"SHADOW_RECEIVE"),l={};l.csm_resolution=c.csm_resolution;l.self_shadow_polygon_offset=b.self_shadow_polygon_offset;g&&(l.self_shadow_normal_offset=g.self_shadow_normal_offset);
l.enable_csm=c.enable_csm;l.csm_num=c.csm_num;l.csm_first_cascade_border=c.csm_first_cascade_border;l.first_cascade_blur_radius=c.first_cascade_blur_radius;l.csm_last_cascade_border=c.csm_last_cascade_border;l.last_cascade_blur_radius=c.last_cascade_blur_radius;l.fade_last_cascade=c.fade_last_cascade;l.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(l.csm_borders=e.aE(a,d.j),l.blur_radii=new Float32Array(c.csm_num),l.blur_radii.set(d.j.Vn.subarray(0,c.csm_num))):(l.csm_borders=null,
l.blur_radii=null);return l};a.set_shadow_params=function(a){if(e.la()){var c=e.get_active();"number"==typeof a.self_shadow_polygon_offset&&n.ba(c.k.jb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var g=e.X(c,"SHADOW_RECEIVE");g&&("number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius));var l=e.X(c,"MAIN_BLEND");l&&("number"==
typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius),l.ia=!0);l=c.k.kc;"number"==typeof a.csm_first_cascade_border&&(l.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(l.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(l.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&
(l.last_cascade_blur_radius=a.last_cascade_blur_radius);if(g){for(var q=g.s,p=0;p<q.length;p++){var C=q[p];C.ne.Vc&&(C=C.I,d.Et(C,l),d.Sb(C))}g.ia=!0}g=c.Tg.g.N;for(p=0;p<g.length;p++)b.Ms(g[p],l);e.Xr(c)}else t.error("No active scene")};a.get_environment_colors=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(e.la()){var d=e.get_active(),g=e.X(d,"MAIN_OPAQUE");e.set_environment_colors(d,
a||0==a?parseFloat(a):g.pf,b||0==b?b:g.Td,c||0==c?c:g.ce)}else t.error("No active scene")};a.get_fog_color_density=function(a){if(!e.la())return t.error("No active scene"),!1;var b=e.get_active();return e.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(e.la()){var b=e.get_active();e.set_fog_color_density(b,a)}else t.error("No active scene")};a.get_ssao_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.get_ssao_params(a)};a.set_ssao_params=
function(a){if(e.la()){var b=e.get_active();e.set_ssao_params(b,a)}else t.error("No active scene")};a.get_color_correction_params=function(){if(!e.la())return t.error("No active scene"),null;var a=e.get_active(),a=e.X(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(e.la()){var b=e.get_active();if(b=e.X(b,"COMPOSITING"))"number"==typeof a.brightness&&(b.brightness=
a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ia=!0}else t.error("No active scene")};a.get_sky_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.get_sky_params(a)};a.set_sky_params=function(a){if(e.la()){var b=e.get_active();e.set_sky_params(b,a)}else t.error("No active scene")};a.get_dof_params=function(){if(!e.la())return t.error("No active scene"),
!1;var a=e.get_active();return e.X(a,"DOF")?e.get_dof_params(a):null};a.set_dof_params=function(a){if(e.la()){var b=e.get_active();e.set_dof_params(b,a)}else t.error("No active scene")};a.get_god_rays_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.X(a,"GOD_RAYS")?e.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(e.la()){var b=e.get_active();e.set_god_rays_params(b,a)}else t.error("No active scene")};a.get_bloom_params=function(){if(!e.la())return t.error("No active scene"),
!1;var a=e.get_active();return e.X(a,"BLOOM")?e.get_bloom_params(a):null};a.set_bloom_params=function(a){if(e.la()){var b=e.get_active();e.set_bloom_params(b,a)}else t.error("No active scene")};a.get_glow_material_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.X(a,"GLOW_COMBINE")?e.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(e.la()){var b=e.get_active();e.set_glow_material_params(b,a)}else t.error("No active scene")};
a.get_wind_params=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.get_wind_params(a)};a.set_wind_params=function(a){if(e.la()){var b=e.get_active();g.set_wind_params(b,a)}else t.error("No active scene")};a.get_water_surface_level=function(a,b){if(!e.la())return t.error("No active scene"),0;var c=e.get_active();return c.k.Tb?e.get_water_surface_level(c,a,b):(t.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(e.la()){var b=
e.get_active();e.set_water_params(b,a)}else t.error("No active scene")};a.get_water_mat_params=function(a){if(e.la()){var b=e.get_active();e.get_water_mat_params(b,a)}else t.error("No active scene")};a.update_scene_materials_params=function(){if(e.la()){var a=e.get_active();e.fy(a)}else t.error("No active scene")};a.hide_object=function(a,b){b=b||!1;!q.is_mesh(a)&&!q.is_empty(a)||q.ma(a)?b?e.tk(a,!0):e.Xt(a,!0):t.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,
b){b=b||!1;!q.is_mesh(a)&&!q.is_empty(a)||q.ma(a)?b?e.tk(a,!1):e.Xt(a,!1):t.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(q.Vq(a)||q.is_empty(a)||q.is_lamp(a))return e.is_hidden(a);t.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=function(a){return a.g.is_visible};a.check_object=function(a){t.Na("scenes.check_object","scenes.check_object_by_name");return e.la()?g.QF(a,e.get_active()):(t.error("No active scene"),
!1)};a.check_object_by_name=function(a,b){return g.Qb(g.Xo,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return g.Qb(g.Wo,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return g.Qb(g.hc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=e.get_active();a||(a="ALL");b||0===b||(b=g.DATA_ID_ALL);return g.Ga(c,a,b)};a.get_object_name=function(a){return a?a.Nh:(t.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return t.error("Wrong object name"),
null;for(var b=[];a;)b.push(a.Nh),a=q.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(t.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){t.Na("scenes.get_object_dg_parent","objects.get_dg_parent");return q.get_dg_parent(a)};a.get_object_children=function(a){return a.fe.slice(0)};a.get_first_character=function(){for(var a=g.Ga(e.get_active(),"MESH",g.DATA_ID_ALL),b=0;b<a.length;b++){var c=a[b];if(l.is_character(c))return c}return null};
a.get_shore_dist=function(a,b){b||0===b||(b=1);if(!e.la())return t.error("No active scene"),!1;var c=e.get_active();return e.get_shore_dist(c,a,b)};a.get_cam_water_depth=function(){return e.get_cam_water_depth()};a.get_type_mesh_object=function(a){return q.is_mesh(a)?a.g.type:null};a.get_meta_tags=function(){if(!e.la())return t.error("No active scene"),!1;var a=e.get_active();return e.get_meta_tags(a)};a.append_object=function(a,b){if(a.g.Cv){if(b)var c=e.Pi(),c=H.keysearch("name",b,c);else c=e.get_active();
e.append_object(c,a,!0)}else t.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){if((q.is_mesh(a)||q.is_empty(a))&&q.ma(a)){for(var b=a.B,d=0;d<b.length;d++)c.eG(b[d].wa,a,!1);g.remove_object(a)}else t.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=e.get_active();if(b.timeline_markers&&a in b.timeline_markers)return e.marker_frame(b,a);t.error('"'+a+'" marker not found.');return 0};
a.get_mb_params=function(){var a=e.get_active();return(a=e.X(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=e.get_active();(b=e.X(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):t.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=e.get_active();return Boolean(e.X(a,"COLOR_PICKING"))}};b4w.module.sfx=function(a,p){var d=p("__obj_util"),b=p("__scenes"),c=p("__sfx"),n=p("__print");a.play=function(a,b,d){c.play(a,b||0,d||0)};a.play_def=function(a){c.play_def(a)};a.is_play=function(a){return c.is_playing(a)};a.is_playing=function(a){return c.is_playing(a)};a.stop=function(a){c.stop(a)};a.pause=function(a){c.wH(a)};a.resume=function(a){c.yH(a)};a.playrate=function(a,b){c.playrate(a,b)};a.get_playrate=function(a){return c.get_playrate(a)};a.cyclic=function(a,b){c.cyclic(a,b)};a.is_cyclic=
function(a){return c.is_cyclic(a)};a.listener_reset_speed=function(a,b){c.listener_reset_speed(a,b)};a.speaker_reset_speed=function(a,b,d){c.speaker_reset_speed(a,b,d)};a.get_volume=function(a){return a&&"object"===typeof a?c.get_volume(a):c.jE()};a.set_volume=function(a,b){a&&"object"===typeof a?c.set_volume(a,b):c.YG(b)};a.mute=function(a,b){a&&"object"===typeof a?c.mute(a,b):c.KF(b)};a.is_muted=function(a){return a&&"object"===typeof a?c.is_muted(a):c.PE()};a.get_speaker_objects=function(){return c.get_speaker_objects().slice(0)};
a.check_active_speakers=c.check_active_speakers;a.set_compressor_params=function(a){c.set_compressor_params(b.get_active(),a)};a.get_compressor_params=function(){return c.get_compressor_params(b.get_active())};a.duck=function(a,b,d){a&&"object"===typeof a?c.duck(a,b,d):c.UC(b,d)};a.unduck=function(a){a&&"object"===typeof a?c.unduck(a):c.$H()};a.apply_playlist=c.apply_playlist;a.clear_playlist=c.clear_playlist;a.detect_audio_container=c.detect_audio_container;a.detect_video_container=c.detect_video_container;
a.set_positional_params=c.set_positional_params;a.get_positional_params=c.get_positional_params;a.set_filter_params=c.set_filter_params;a.get_filter_params=c.get_filter_params;a.get_filter_freq_response=c.get_filter_freq_response;a.get_duration=function(a){if(a&&d.is_speaker(a))return c.get_duration(a);n.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,p){var d=p("__print"),b=p("__scenes"),c=p("__textures"),n=p("__obj_util");a.get_canvas_texture_context=function(a,b){d.Na("get_canvas_texture_context","get_canvas_ctx");b||(b=0);var l=c.XD(a,b);if(l)return l;d.error('Canvas texture with ID "'+a+'" not found!')};a.update_canvas_texture_context=function(a,b){d.Na("update_canvas_texture_context","update_canvas_ctx");b||(b=0);c.mI(a,b)||d.error('Canvas texture with ID "'+a+'" not found!')};a.play_video=function(a,n){n||
(n=0);b.get_active().b4w_use_nla&&c.Ts(a,n)?d.error("NLA texture can't be controlled directly through API."):c.play_video(a,n)||d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,n){n||(n=0);b.get_active().b4w_use_nla&&c.Ts(a,n)?d.error("NLA texture can't be controlled directly through API."):c.pause_video(a,n)||d.error('Texture with name "'+a+'" not found!')};a.reset_video=function(a,n){n||(n=0);b.get_active().b4w_use_nla&&c.Ts(a,n)?d.error("NLA texture can't be controlled directly through API."):
c.reset_video(a,n)||d.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,b){if(n.is_mesh(a)){var l=c.YD(a,b);if(l)return l;d.error("Couldn't find canvas texture with this name: "+b)}else d.error("Object must be type of mesh.");return null};a.update_canvas_ctx=function(a,b){if(n.is_mesh(a)){if(c.nI(a,b))return!0;d.error("Couldn't find canvas texture with this name: "+b)}else d.error("Object must be type of mesh.");return!1}};b4w.module.time=function(a,p){var d=p("__time");a.set_timeout=d.set_timeout;a.clear_timeout=d.clear_timeout;a.get_timeline=d.get_timeline;a.animate=d.animate;a.clear_animation=d.clear_animation};b4w.module.transform=function(a,p){var d=p("__obj_util"),b=p("__physics"),c=p("__print"),n=p("__quat"),g=p("__transform"),q=p("__tsr"),l=p("__util"),t=new Float32Array(4),e=new Float32Array(3),H=new Float32Array(4);a.SPACE_LOCAL=g.SPACE_LOCAL;a.SPACE_WORLD=g.SPACE_WORLD;a.set_translation=function(a,l,n,q){d.ma(a)?(e[0]=l,e[1]=n,e[2]=q,g.set_translation(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,l,n,q){d.ma(a)?(e[0]=l,e[1]=
n,e[2]=q,g.set_translation_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){d.ma(a)?(g.set_translation(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,e){d.ma(a)?(g.set_translation_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,n,p,t,D){d.ma(a)?(e[0]=n,e[1]=p,e[2]=t,
n=q.get_trans_view(D.g.i),D=q.get_quat_view(D.g.i),l.transform_vec3(e,1,D,n,e),g.set_translation(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));g.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));g.get_translation_rel(a,b);return b};a.set_rotation=function(a,e,l,n,q){d.ma(a)?(H[0]=e,H[1]=l,H[2]=n,H[3]=q,g.set_rotation(a,H),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_rotation_rel=function(a,e,l,n,q){d.ma(a)?(H[0]=e,H[1]=l,H[2]=n,H[3]=q,g.set_rotation_rel(a,H),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,e){d.ma(a)?(g.set_rotation(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,e){d.ma(a)?(g.set_rotation_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.get_rotation=function(a,b){b||(b=new Float32Array(4));g.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));g.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,l,n,q){d.ma(a)?(e[0]=l,e[1]=n,e[2]=q,g.set_rotation_euler(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel=function(a,l,n,q){d.ma(a)?(e[0]=l,e[1]=n,e[2]=q,g.set_rotation_euler_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){d.ma(a)?(g.set_rotation_euler(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,e){d.ma(a)?(g.set_rotation_euler_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,b){d.ma(a)?(g.set_scale(a,b),g.m(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,b){d.ma(a)?(g.set_scale_rel(a,
b),g.m(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return g.get_scale(a)};a.get_scale_rel=function(a){return g.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)c.error("Wrong object: "+a.name);else{for(var e=0;e<a.fe.length;e++)if(!d.ma(a.fe[e])){c.error('Wrong object: "'+a.fe[e].name+'" is not dynamic.');return}g.set_translation(a,[0,0,0]);g.set_rotation(a,[0,0,0,1]);g.set_scale(a,1);g.m(a);b.sync_transform(a)}};a.get_object_size=function(a){return d.is_mesh(a)?
g.get_object_size(a):(c.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,b,e){return d.is_mesh(a)?g.get_object_center(a,b,e):(c.error("Wrong object: "+a.name),null)};a.move_local=function(a,e,l,n){d.ma(a)?(g.move_local(a,e,l,n),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,e){if(d.ma(a)){var q=n.setAxisAngle(l.AXIS_X,e,H);g.Tr(a,q);g.m(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.rotate_y_local=function(a,e){if(d.ma(a)){var q=n.setAxisAngle(l.AXIS_Y,e,H);g.Tr(a,q);g.m(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,e){if(d.ma(a)){var q=n.setAxisAngle(l.AXIS_Z,e,H);g.Tr(a,q);g.m(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return g.get_object_bounding_box(a)};a.set_tsr=function(a,e){d.ma(a)?(g.set_tsr(a,e),g.m(a),b.sync_transform(a)):
c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,e){d.ma(a)?(g.set_tsr_rel(a,e),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));g.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));g.get_tsr_rel(a,b);return b};a.distance=function(a,b){return g.distance(a,b)};a.set_matrix=function(a,e){d.ma(a)?(q.from_mat4(e,t),g.set_tsr(a,t),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,e){d.ma(a)?(q.from_mat4(e,t),g.set_tsr_rel(a,t),g.m(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));g.get_tsr(a,t);q.to_mat4(t,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));g.get_tsr_rel(a,t);q.to_mat4(t,b);return b}};b4w.module.tsr=function(a,p){function d(a,b,c,p){p||(p=n.create());d(a,b,c,p);return p}p("__mat3");var b=p("__mat4"),c=p("__print"),n=p("__tsr");a.create=n.create;a.from_values=n.from_values;a.copy=n.copy;a.identity=n.identity;a.create_sep=function(a,b,l,n){c.Na("create_sep","set_sep");return d(a,b,l,n)};a.set_sep=n.set_sep;a.set_trans=n.set_trans;a.set_scale=n.set_scale;a.set_transcale=n.set_transcale;a.set_quat=n.set_quat;a.get_trans_view=n.get_trans_view;a.get_scale=n.get_scale;a.get_quat_view=
n.get_quat_view;a.invert=n.invert;a.to_mat4=function(a,c){c||(c=b.create());n.to_mat4(a,c);return c};a.from_mat4=n.from_mat4;a.multiply=n.multiply;a.transform_vec3=n.transform_vec3;a.transform_vec3_inv=n.transform_vec3_inv;a.transform_vectors=n.transform_vectors;a.transform_dir_vectors=n.transform_dir_vectors;a.transform_dir_vec3=n.transform_dir_vec3;a.transform_tangents=n.transform_tangents;a.translate=n.translate;a.interpolate=function(a,b,c,d){d||(d=n.create());n.interpolate(a,b,c,d);return d}};b4w.module.util=function(a,p){var d=p("__obj_util"),b=p("__print"),c=p("__quat"),n=p("__util"),g=p("__vec3");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=n.XYX;a.YZY=n.YZY;a.ZXZ=n.ZXZ;a.XZX=n.XZX;a.YXY=n.YXY;a.ZYZ=n.ZYZ;a.XYZ=n.XYZ;a.YZX=n.YZX;a.ZXY=n.ZXY;a.XZY=n.XZY;a.YXZ=n.YXZ;a.ZYX=n.ZYX;a.f32=function(a){return new Float32Array(a||
0)};a.assert=n.assert;a.keyfind=n.keyfind;a.keysearch=n.keysearch;a.matrix_to_quat=function(a){return n.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return n.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,b,d){d||(d=c.create());return n.ordered_angles_to_quat(a,b,d)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return n.quat_to_euler(a,b)};a.sign=n.sign;a.clamp=n.clamp;a.quat_to_dir=n.quat_to_dir;a.ground_project_quat=function(a,b){return n.quat_project(a,
n.AXIS_MY,n.AXIS_Y,n.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return n.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,c,d,e,p){return 0!=g.dot(d,e)?(b.error("Wrong in-plane direction"),null):n.quat_project(a,c,d,e,p)};a.hash_code=n.hash_code;a.smooth=n.smooth;a.smooth_v=n.smooth_v;a.is_vector=n.is_vector;a.correct_cam_quat_up=n.correct_cam_quat_up;a.quat_to_angle_axis=n.quat_to_angle_axis;a.random_from_array=n.random_from_array;a.xz_direction=n.xz_direction;a.line_plane_intersect=
n.line_plane_intersect;a.is_mesh=function(a){b.Na("util.is_mesh","objects.is_mesh");return d.is_mesh(a)};a.is_armature=function(a){b.Na("util.is_armature","objects.is_armature");return d.is_armature(a)};a.angle_wrap_0_2pi=n.angle_wrap_0_2pi;a.angle_wrap_periodic=n.angle_wrap_periodic;a.smooth_step=n.smooth_step;a.lerp=n.lerp};"object"==typeof module&&module.nq&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,p){p("__print");var d=p("__version");a.version=d.version;a.version_str=d.version_str;a.type=d.type;a.date=d.date;a.date_str=d.date_str};"object"==typeof module&&module.nq&&b4w.module.version(exports);b4w.module.objects=function(a,p){var d=p("__geometry"),b=p("__objects"),c=p("__obj_util"),n=p("__print"),g=p("__scenes");p("__util");a.get_meta_tags=function(a){if(a)return b.get_meta_tags(a)};a.copy=function(a,l,p){return c.is_mesh(a)?c.ma(a)?d.Zi(a)||d.check_shape_keys(a)||!p?-1==b.Ga(g.get_active(),"MESH",b.DATA_ID_ALL).indexOf(a)?(n.error('object "'+a.name+'" does not belong to the active scene.'),!1):b.copy(a,l||"",p):(n.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(n.error('object "'+a.name+'" is not dynamic.'),!1):(n.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,d,g){c.is_mesh(a)?b.set_nodemat_value(a,d,g):n.error('The type of the object "'+a.name+'" is not "MESH".')};a.set_nodemat_rgb=function(a,d,g,e,p){c.is_mesh(a)?b.set_nodemat_rgb(a,d,g,e,p):n.error('The type of the object "'+a.name+'" is not "MESH".')};a.update_boundings=function(a){c.is_mesh(a)?d.Zi(a)||d.check_shape_keys(a)?b.update_boundings(a):n.error('object "'+
a.name+'" has not dynamic geometry.'):n.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=c.get_parent;a.get_dg_parent=c.get_dg_parent;a.is_mesh=c.is_mesh;a.is_armature=c.is_armature;a.is_speaker=c.is_speaker;a.is_camera=c.is_camera;a.is_lamp=c.is_lamp;a.is_empty=c.is_empty;a.is_line=c.is_line;a.is_world=c.is_world;a.get_selectable_objects=function(){return b.get_selectable_objects()};a.get_outlining_objects=function(){return b.get_outlining_objects()}};b4w.module.main=function(a,p){function d(){}function b(){}function c(){}function n(){window.performance||(T.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(T.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});R.mx(0)}function g(a,b){for(var c=null,d=b?J:ya,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,oa)}catch(g){}if(c)break}c&&y.OC(c);return c}function q(a,c,d){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();T.error("WebGL context lost");t()},!1);h.yd(d);var e=h.iv();e&&T.log("%cRENDERER INFO:","color: #00a",d.getParameter(e.UNMASKED_VENDOR_WEBGL)+", "+d.getParameter(e.UNMASKED_RENDERER_WEBGL));O.yd(d);x.yd(d);F.yd(d);M.yd(d);m.yd(d);C.yd(d);f.iH(a);C.init(a,c);B.ox(a.width,a.height,1);G.init();b=k();H()}function l(){d=function(){}}function t(){e()||(ea=performance.now()/1E3,G.pause(),I.pause(),F.pause(),r.pause())}function e(){return qa<ea}function H(){V(H);var a=performance.now()/
1E3;E||(E=a);var c=a-E;if(!(c<1/fa.me)){for(var g=R.get_timeline(),h=0;h<la.length;h++)la[h](g,c);e()||(qa>E&&(c-=qa-Math.max(ea,E)),g+=c,R.mx(g),m.update(),z.update(),f.update(),h=c,f.is_primary_loaded()&&(L.reset(),S.update(h),A.update(g,h),P.update(g,h),G.update(g,h),h&&u.update(h),f.is_primary_loaded()&&(I.update(g,h),f.is_primary_loaded()&&(v.update(g,h),f.is_primary_loaded()&&(r.update(),w.update(g,h),d(h,g),f.is_primary_loaded()&&(B.update(g,h),r.iy(),ia&&(ia(na.toDataURL()),ia=null)))))),
b(c));E=a}}function k(){var a=60,b=0,d=fa.Ou,e=fa.tD;return function(f){f<1/fa.me||(a=ha.smooth(1/f,a,f,d),f=I.fE(),b=(b+1)%e,0==b&&c(Math.round(a),f))}}var r=p("__anchors"),u=p("__animation"),z=p("__assets"),D=p("__config"),y=p("__compat"),C=p("__container"),v=p("__controls"),f=p("__data"),m=p("__debug"),h=p("__extensions"),x=p("__geometry"),L=p("__hud"),P=p("__nla"),A=p("__logic_nodes"),w=p("__objects"),I=p("__physics"),T=p("__print"),O=p("__renderer"),B=p("__scenes"),G=p("__sfx"),M=p("__shaders"),
F=p("__textures"),R=p("__time"),S=p("__transform");p("__armature");var ha=p("__util"),N=p("__version"),oa=D.context,fa=D.p,na=null,ba=null,E=0,ea=0,qa=0,la=[],ia=null,ya=["webgl","experimental-webgl"],J=["webgl2","experimental-webgl2"],V=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/fa.me)}}();a.init=function(a,b){D.ZG();T.dH(fa.console_verbose);
var c=N.version_str()+" "+N.type()+" ("+N.date_str()+")";T.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;n();na=a;b?(L.init(b),ba=b):(D.p.show_hud_debug_info=!1,D.H.Kn=!1);y.LA();y.FB("Chrome")||(fa.Gc=!1);c=g(a,fa.Gc);!c&&fa.Gc&&(fa.Gc=!1,c=g(a,!1));if(!c)return null;T.log("%cINIT WEBGL "+(fa.Gc?"2":"1"),"color: #00a");window.jL=c;q(na,ba,c);D.NA();y.QG(c);M.lF();fa.Nq&&(a.style["touch-action"]="none");T.log("%cSET PRECISION:","color: #00a",fa.precision);return c};
a.set_check_gl_errors=function(a){m.set_check_gl_errors(a)};a.resize=function(a,b,c){T.Na("main.resize","container.resize");C.resize(a,b,c)};a.set_fps_callback=function(a){c=a};a.clear_fps_callback=function(){c=function(){}};a.set_render_callback=function(a){d=a};a.clear_render_callback=function(){l()};a.global_timeline=function(){T.Na("main.global_timeline","time.get_timeline");return R.get_timeline()};a.pause=t;a.resume=function(){e()&&(qa=performance.now()/1E3,G.resume(),I.resume(),F.play(!0),
r.resume())};a.is_paused=e;a.reset=function(){f.unload(0);ba=na=null;qa=ea=E=0;c=function(){};b=function(){};d=function(){};la.length=0;R.reset()};a.canvas_data_url=function(a){ia=a};a.get_canvas_elem=function(){T.Na("main.get_canvas_elem","container.get_canvas");return na};a.detect_mobile=function(){return y.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<la.length;b++)if(la[b]==a)return;la.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<la.length;b++)if(la[b]==a){la.splice(b,1);
break}}};b4w.module.nla=function(a,p){var d=p("__nla"),b=p("__time"),c=p("__print"),n=p("__util");a.set_frame=function(a){a=n.clamp(a,d.get_frame_start(),d.get_frame_end());d.check_logic_nodes()?c.error("The active scene is using NLA script."):d.set_frame(a,b.get_timeline())};a.get_frame=function(){return d.get_frame(b.get_timeline())};a.stop=function(){d.check_logic_nodes()?c.error("The active scene is using NLA script."):d.vs()};a.play=function(a){d.check_logic_nodes()?c.error("The active scene is using NLA script."):
d.Iw(a)};a.is_play=function(){return d.is_play()};a.get_frame_start=function(){return d.get_frame_start()};a.get_frame_end=function(){return d.get_frame_end()};a.check_nla=function(){return d.check_nla()};a.check_nla_scripts=function(){return d.check_logic_nodes()};a.check_logic_nodes=function(){return d.check_logic_nodes()};a.set_range=function(a,b){d.check_logic_nodes()?c.error("The active scene is using NLA script."):(b=parseFloat(b)||d.get_frame_end(),a=parseFloat(a)||d.get_frame_end(),b=n.clamp(b,
d.get_frame_start(),d.get_frame_end()),a=n.clamp(a,d.get_frame_start(),b),d.set_range(a,b))};a.reset_range=function(){d.check_logic_nodes()?c.error("The active scene is using NLA script."):d.reset_range()};a.set_cyclic=function(a){d.check_logic_nodes()?c.error("The active scene is using NLA script."):d.set_cyclic(a)};a.clear_callback=function(){d.check_logic_nodes()?c.error("The active scene is using NLA script."):d.clear_callback()}};b4w.module.app=function(a,p){function d(){var a=A.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=A.is_paused(),A.pause()):a||A.resume()},!1)}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(b=document.createElement("canvas"),
b.style.position="absolute",e.style.left=0,e.style.top=0,b.style.pointerEvents="none"):b=null;f||(I.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(e);if(!A.init(e,b))return c&&y("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/troubleshooting",d),!1;b&&h.insert_to_container(b,"LAST");return!0}function c(a,b){a?(b&&(document.getElementById(b).style.display="block"),F=document.getElementById(a)):(F=document.createElement("div"),
F.innerHTML=0,F.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",h.insert_to_container(F,"JUST_AFTER_CANVAS"))}function n(a,b){var c=String(a);b&&(c+="/"+String(b));F.innerHTML=c}function g(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function q(){var a=h.get_container();h.resize(a.clientWidth,a.clientHeight,!0)}function l(a,b,c){var d=Math.max(v.hover_get_distance(a),1),e=O.get_rotation(a,
ba);b=B.quat_to_dir(e,b,fa);b[1]=0;G.normalize(b,b);G.scale(b,d*c,b);c=O.get_translation(a,na);G.add(c,b,c);v.set_translation(a,c)}function t(a,b){var c=v.hover_get_vertical_limits(a,ea);if(c.up!=c.down){var d=v.get_camera_angles(a,oa)[1],c=(c.down-d)/(c.down-c.up),d=v.hover_get_distance_limits(a,ea),c=Math.max(c,2/d.max);v.hover_rotate(a,0,c*b)}}function e(a,b,c,d){O.move_local(a,5*b,5*c,5*d)}function H(a,b,c){var d=v.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));O.move_local(a,
0,0>b?.001<d?-d*c:0:c/(1-c)*d,0)}function k(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function r(a,b,c,d,e){e?(e=v.target_get_pivot(a,fa),a=v.get_translation(a),a=G.dist(e,a)+d,d=0<b?k(b,-c,a,d):k(-b,c/(1-c),a,d)):d-=2*b*c;return d}function u(a,b,c){function d(a,b,c,e){if(1==c){v.get_velocities(a,u);var f=p?.003*u.trans:.003*u.rot;c=x.get_sensor_value(a,b,0);x.get_sensor_payload(a,b,0)===x.PL_SINGLE_TOUCH_MOVE?(wa+="X"==e?-c*f:0,Da+="Y"==e?-c*f:0):x.get_sensor_payload(a,b,0)===x.PL_MULTITOUCH_MOVE_PAN&&
(a=p?.003*u.rot:7.5E-4*u.trans,mb+="X"==e?-c*a:0,Ac+="Y"==e?-c*a:0)}}function f(a,b,c,d){if(1==c){c=x.get_sensor_value(a,b,1);v.get_velocities(a,u);if(p)e=.003*u.trans,g=7.5E-4*u.rot;else var e=.003*u.rot,g=7.5E-4*u.trans;if(1===x.get_sensor_payload(a,b,0))Ja+="X"==d?-c*e:0,X+="Y"==d?-c*e:0;else if(2===x.get_sensor_payload(a,b,0)||3===x.get_sensor_payload(a,b,0))Ca+="X"==d?-c*g:0,ka+="Y"==d?-c*g:0}}function g(a){return a[0]&&(a[1]||a[2])}function h(a,b,c){if(1==c)switch(c=x.get_sensor_value(a,b,0),
v.get_velocities(a,u),b){case "FORWARD":q?I[0]=1:p?(b=v.get_camera_angles(a,oa)[1],b=Math.abs(b)>=Math.PI/4?B.AXIS_MZ:B.AXIS_MY,l(a,b,.5*u.trans*c)):n?H(a,-u.zoom,c):e(a,0,-u.trans*c,0);break;case "BACKWARD":q?I[0]=-1:p?(b=v.get_camera_angles(a,oa)[1],b=Math.abs(b)>=Math.PI/4?B.AXIS_Z:B.AXIS_Y,l(a,b,.5*u.trans*c)):n?H(a,u.zoom,c):e(a,0,u.trans*c,0);break;case "UP":p?t(a,30*-u.zoom*c):q||e(a,0,0,-u.trans*c);break;case "DOWN":p?t(a,30*u.zoom*c):q||e(a,0,0,u.trans*c);break;case "LEFT":q?I[1]=1:p?l(a,
B.AXIS_MX,.5*u.trans*c):e(a,-u.trans*c,0,0);break;case "RIGHT":q?I[1]=-1:p?l(a,B.AXIS_X,.5*u.trans*c):e(a,u.trans*c,0,0);break;case "ROT_LEFT":n?v.target_rotate(a,2*-u.rot*c,0):v.eye_rotate(a,2*u.rot*c,0);break;case "ROT_RIGHT":n?v.target_rotate(a,2*u.rot*c,0):v.eye_rotate(a,2*-u.rot*c,0);break;case "ROT_UP":n?v.target_rotate(a,0,2*-u.rot*c):v.eye_rotate(a,0,2*u.rot*c);break;case "ROT_DOWN":n?v.target_rotate(a,0,2*u.rot*c):v.eye_rotate(a,0,2*-u.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":q&&
(I[0]=0);break;case "LEFT":case "RIGHT":q&&(I[1]=0)}q&&(w.set_character_move_dir(q,I[0],I[1]),a=v.get_camera_angles_char(a,N),w.set_character_rotation(q,a[0],a[1]))}R=a;S=b;ha=c;var k=T.get_active_camera();z(k);var n=!1,q=null,p=!1;switch(v.get_move_style(k)){case v.MS_TARGET_CONTROLS:n=!a;break;case v.MS_EYE_CONTROLS:q=T.get_first_character();break;case v.MS_STATIC:return;case v.MS_HOVER_CONTROLS:p=!0}var u=v.get_velocities(k,E);a=x.create_elapsed_sensor();if(w.has_simulated_physics(k)){var y=x.create_collision_sensor(k,
null,!0);x.create_sensor_manifold(k,"CAMERA_COLLISION",x.CT_POSITIVE,[y],null,function(a,b){var c=x.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=x.get_sensor_payload(a,b,0).coll_norm,e=fa;G.scale(d,-.25*c,e);c=O.get_translation(a,na);G.add(c,e,c);O.set_translation_v(a,c)}})}if(q){var y=O.get_translation(k),A=O.get_rotation(k),A=B.cam_quat_to_mesh_quat(A);y[1]-=.5;w.set_transform(q,y,A);m.append_stiff_trans(k,q,[0,.5,0]);var I=new Float32Array(2),F=!0;w.set_character_move_type(q,w.CM_FLY);x.create_kb_sensor_manifold(k,
"TOGGLE_CHAR_MOVE_TYPE",x.CT_SHOT,x.KEY_C,function(){F=!F;w.set_character_move_type(q,F?w.CM_FLY:w.CM_WALK)})}if(b)b=y=A=C=D=K=x.create_custom_sensor(0);else{b=x.create_keyboard_sensor(x.KEY_W);var y=x.create_keyboard_sensor(x.KEY_S),A=x.create_keyboard_sensor(x.KEY_A),C=x.create_keyboard_sensor(x.KEY_D),D=x.create_keyboard_sensor(x.KEY_R),K=x.create_keyboard_sensor(x.KEY_F)}var L=x.create_keyboard_sensor(x.KEY_UP),P=x.create_keyboard_sensor(x.KEY_DOWN),ba=x.create_keyboard_sensor(x.KEY_LEFT),ea=
x.create_keyboard_sensor(x.KEY_RIGHT);p||(x.create_sensor_manifold(k,"FORWARD",x.CT_CONTINUOUS,[a,b],null,h),x.create_sensor_manifold(k,"BACKWARD",x.CT_CONTINUOUS,[a,y],null,h));n?(x.create_sensor_manifold(k,"ROT_UP",x.CT_CONTINUOUS,[a,L,D],g,h),x.create_sensor_manifold(k,"ROT_DOWN",x.CT_CONTINUOUS,[a,P,K],g,h),x.create_sensor_manifold(k,"ROT_LEFT",x.CT_CONTINUOUS,[a,ba,A],g,h),x.create_sensor_manifold(k,"ROT_RIGHT",x.CT_CONTINUOUS,[a,ea,C],g,h)):p?(x.create_sensor_manifold(k,"LEFT",x.CT_CONTINUOUS,
[a,ba,A],g,h),x.create_sensor_manifold(k,"RIGHT",x.CT_CONTINUOUS,[a,ea,C],g,h),x.create_sensor_manifold(k,"FORWARD",x.CT_CONTINUOUS,[a,L,b],g,h),x.create_sensor_manifold(k,"BACKWARD",x.CT_CONTINUOUS,[a,P,y],g,h),x.create_sensor_manifold(k,"UP",x.CT_CONTINUOUS,[a,K],g,h),x.create_sensor_manifold(k,"DOWN",x.CT_CONTINUOUS,[a,D],g,h)):(x.create_sensor_manifold(k,"UP",x.CT_CONTINUOUS,[a,D],g,h),x.create_sensor_manifold(k,"DOWN",x.CT_CONTINUOUS,[a,K],g,h),x.create_sensor_manifold(k,"LEFT",x.CT_CONTINUOUS,
[a,A],g,h),x.create_sensor_manifold(k,"RIGHT",x.CT_CONTINUOUS,[a,C],g,h),x.create_sensor_manifold(k,"ROT_UP",x.CT_CONTINUOUS,[a,L],g,h),x.create_sensor_manifold(k,"ROT_DOWN",x.CT_CONTINUOUS,[a,P],g,h),x.create_sensor_manifold(k,"ROT_LEFT",x.CT_CONTINUOUS,[a,ba],g,h),x.create_sensor_manifold(k,"ROT_RIGHT",x.CT_CONTINUOUS,[a,ea],g,h));if(!c){var aa=0;c=x.create_mouse_wheel_sensor();var pa=0;b=x.create_touch_zoom_sensor();x.create_sensor_manifold(k,"MOUSE_WHEEL",x.CT_LEVEL,[c],null,function(a,b,c){1==
c&&(b=x.get_sensor_value(a,b,0),v.get_velocities(a,u),n||p?aa=r(a,b,u.zoom,aa,n):(u.trans*=1+b*u.zoom,v.set_velocities(a,u)))});x.create_sensor_manifold(k,"TOUCH_ZOOM",x.CT_LEVEL,[b],null,function(a,b,c){1==c&&(c=x.get_sensor_value(a,b,0),v.get_velocities(a,u),x.get_sensor_payload(a,b,0)===x.PL_MULTITOUCH_MOVE_ZOOM&&(pa=r(a,c,.03*u.zoom,pa,n)))});x.create_sensor_manifold(k,"ZOOM_INTERPOL",x.CT_POSITIVE,[a],null,function(a,b){if(n||p)if(1E-5<Math.abs(aa)||1E-5<Math.abs(pa)){var c=x.get_sensor_value(a,
b,0),d=B.smooth(aa,0,c,.1*M);aa-=d;c=B.smooth(pa,0,c,.15*M);pa-=c;p?t(a,-(d+c)):(d=v.target_get_distance(a)+d+c,d=Math.max(d,.001),v.target_set_distance(a,d))}else pa=aa=0})}var Ja=0,X=0,Ca=0,ka=0;c=x.create_mouse_move_sensor("X");b=x.create_mouse_move_sensor("Y");y=x.create_mouse_click_sensor();x.create_sensor_manifold(k,"MOUSE_X",x.CT_LEVEL,[y,c],null,f,"X");x.create_sensor_manifold(k,"MOUSE_Y",x.CT_LEVEL,[y,b],null,f,"Y");var wa=0,Da=0,mb=0,Ac=0;c=x.create_touch_move_sensor("X");b=x.create_touch_move_sensor("Y");
x.create_sensor_manifold(k,"TOUCH_X",x.CT_LEVEL,[c],null,d,"X");x.create_sensor_manifold(k,"TOUCH_Y",x.CT_LEVEL,[b],null,d,"Y");x.create_sensor_manifold(k,"ROT_TRANS_INTERPOL",x.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(Ja)||1E-5<Math.abs(X)||1E-5<Math.abs(wa)||1E-5<Math.abs(Da)||1E-5<Math.abs(Ca)||1E-5<Math.abs(ka)||1E-5<Math.abs(mb)||1E-5<Math.abs(Ac)){var c=x.get_sensor_value(a,b,0),d=B.smooth(Ja,0,c,.08*M),e=B.smooth(X,0,c,.08*M);Ja-=d;X-=e;var f=B.smooth(wa,0,c,.12*M),g=B.smooth(Da,
0,c,.12*M);wa-=f;Da-=g;var h=B.smooth(Ca,0,c,.08*M),k=B.smooth(ka,0,c,.08*M);Ca-=h;ka-=k;var m=B.smooth(mb,0,c,.12*M),c=B.smooth(Ac,0,c,.12*M);mb-=m;Ac-=c;n?(v.target_rotate(a,d+f,e+g),e=v.target_get_distance(a),v.target_pan_pivot(a,e*(h+m),e*(k+c))):p?(d+f&&l(a,B.AXIS_X,.2*(d+f)),e+g&&(k=v.get_camera_angles(a,oa)[1],l(a,Math.abs(k)>Math.PI/4?B.AXIS_Z:B.AXIS_Y,.2*(e+g))),v.hover_rotate(a,h+m,0)):(v.eye_rotate(a,.5*(d+f),.5*(e+g)),q&&(h=v.get_camera_angles_char(a,N),w.set_character_rotation(q,h[0],
h[1])))}});x.create_kb_sensor_manifold(k,"DEC_STEREO_DIST",x.CT_SHOT,x.KEY_LEFT_SQ_BRACKET,function(a){var b=v.get_stereo_distance(a);v.set_stereo_distance(a,.9*b)});x.create_kb_sensor_manifold(k,"INC_STEREO_DIST",x.CT_SHOT,x.KEY_RIGHT_SQ_BRACKET,function(a){var b=v.get_stereo_distance(a);v.set_stereo_distance(a,1.1*b)})}function z(a){var b=v.get_move_style(a),c=x.create_callback_sensor(function(){var c=v.get_move_style(a),d=c!=b;b=c;return d});x.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",x.CT_POSITIVE,
[c],null,function(){D();u(R,S,ha)})}function D(){for(var a=T.get_active_camera(),b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE".split(" "),c=0;c<b.length;c++)x.remove_sensor_manifold(a,b[c]);v.get_move_style(a)==v.MS_EYE_CONTROLS&&T.get_first_character()&&m.remove(a)}function y(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");
if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function C(a,
b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&A.remove_loop_cb(f)}var g=performance.now();A.append_loop_cb(f)}p("animation");var v=p("camera"),f=p("config"),m=p("constraints"),h=p("container"),x=p("controls"),L=p("data"),P=p("debug"),A=p("main"),w=p("physics"),I=p("print"),T=p("scenes"),O=p("transform"),B=p("util"),G=p("vec3"),M=1,F=null,R=!1,S=!1,ha=!1,N=new Float32Array(2),oa=new Float32Array(2),fa=new Float32Array(3),na=new Float32Array(3);new Float32Array(3);
var ba=new Float32Array(4),E={},ea={};a.init=function(a){function e(){var a=b(l,D,B,p),f=h.get_canvas();if(a){var g=h.get_container();q();A.set_check_gl_errors(w);G&&(c(r,u),A.set_fps_callback(n));y&&d();t&&A.append_loop_cb(function(){g.style.height=g.clientWidth/t+"px"});m&&A.append_loop_cb(function(){var a=g.clientWidth,b=g.clientHeight;a==f.clientWidth&&b==f.clientHeight||h.resize(a,b,!0)});F&&A.append_loop_cb(function(){h.force_offsets_updating()});k(f,!0)}else k(f,!1)}function g(a){a.keyCode==
x.KEY_P&&(A.is_paused()?A.resume():A.pause())}function k(){}a=a||{};var m=!1,l=null,p=null,r=null,t=0,u=null,w=!1,v=!0,y=!0,B=!0,z=!1,G=!1,I=!1,F=!1,C;for(C in a)switch(C){case "canvas_container_id":l=a.canvas_container_id;break;case "callback":k=a.callback;break;case "autoresize":m=a.autoresize;break;case "do_not_use_onload":break;case "gl_debug":w=a.gl_debug;break;case "show_hud_debug_info":I=a.show_hud_debug_info;break;case "sfx_mix_mode":z=a.sfx_mix_mode;break;case "show_fps":G=a.show_fps;break;
case "track_container_position":F=a.track_container_position;break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":r=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":B=a.report_init_failure;break;case "pause_invisible":y=a.pause_invisible;break;case "key_pause_enabled":v=a.key_pause_enabled;break;case "force_container_ratio":t=a.force_container_ratio;break;default:f.set(C,a[C])}v&&document.addEventListener("keydown",g,!1);
f.set("show_hud_debug_info",I);f.set("sfx_mix_mode",z);var D=I||z||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){L.cleanup()},!1)};a.resize_to_container=q;a.set_onclick=function(a,b){var c=g(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=g(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=
g(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=u;a.disable_camera_controls=D;a.set_camera_move_style=function(a){I.Ie("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=T.get_active_camera();v.set_move_style(b,a)};a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=x.get_sensor_value(a,b,0),b){case "FORWARD":d?
w.vehicle_throttle(a,1):O.move_local(a,0,0,1*e);break;case "BACKWARD":d?w.vehicle_throttle(a,-1):O.move_local(a,0,0,-1*e);break;case "LEFT":d?w.vehicle_steer(a,-1):O.move_local(a,1*e,0,0);break;case "RIGHT":d?w.vehicle_steer(a,1):O.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&w.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&w.vehicle_steer(a,0)}}var d=w.is_vehicle_chassis(a)||w.is_vehicle_hull(a),e=x.create_elapsed_sensor(),f=x.create_keyboard_sensor(x.KEY_W),g=
x.create_keyboard_sensor(x.KEY_S),h=x.create_keyboard_sensor(x.KEY_A),k=x.create_keyboard_sensor(x.KEY_D),m=x.create_keyboard_sensor(x.KEY_UP),l=x.create_keyboard_sensor(x.KEY_DOWN),n=x.create_keyboard_sensor(x.KEY_LEFT),q=x.create_keyboard_sensor(x.KEY_RIGHT);x.create_sensor_manifold(a,"FORWARD",x.CT_CONTINUOUS,[e,f,m],b,c);x.create_sensor_manifold(a,"BACKWARD",x.CT_CONTINUOUS,[e,g,l],b,c);x.create_sensor_manifold(a,"LEFT",x.CT_CONTINUOUS,[e,h,n],b,c);x.create_sensor_manifold(a,"RIGHT",x.CT_CONTINUOUS,
[e,k,q],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)x.remove_sensor_manifold(a,b[c])};a.enable_controls=function(a){var b=h.get_container();a=a||!1;x.register_keyboard_events(document,!1);x.register_mouse_events(b,!0,a);x.register_wheel_events(b,!0);x.register_touch_events(b,!0);x.register_device_orientation()};a.disable_controls=function(){var a=h.get_container();x.unregister_keyboard_events(document);x.unregister_mouse_events(a);
x.unregister_wheel_events(a);x.unregister_touch_events(a);x.unregister_device_orientation()};a.enable_debug_controls=function(){x.create_kb_sensor_manifold(null,"CAMERA_SHOT",x.CT_SHOT,x.KEY_K,function(){P.make_camera_frustum_shot()});x.create_kb_sensor_manifold(null,"LIGHT_SHOT",x.CT_SHOT,x.KEY_L,function(){P.make_light_frustum_shot()});x.create_kb_sensor_manifold(null,"TELEMETRY",x.CT_SHOT,x.KEY_T,function(){P.plot_telemetry()})};a.request_fullscreen=function(a,b,c,d){function e(){document.fullscreenElement===
a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",e,!1),document.removeEventListener("webkitfullscreenchange",e,!1),document.removeEventListener("mozfullscreenchange",e,!1),document.removeEventListener("MSFullscreenChange",e,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",e,!1);document.addEventListener("webkitfullscreenchange",
e,!1);document.addEventListener("mozfullscreenchange",e,!1);document.addEventListener("MSFullscreenChange",e,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;var g=null;d&&a.requestFullScreen!=a.mozRequestFullScreen&&(g={vrDisplay:d,vrDistortion:f.get("use_browser_distortion_cor")});a.requestFullScreen(g)};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
if("function"!=typeof a)throw"B4W App: exit fullscreen method is not supported";a.apply(document)};a.check_fullscreen=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.report_app_error=y;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=
b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){function k(e){a&&(m[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(m[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var m=a.style,l=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==m[b])if(void 0!=m["webkit"+l])b="webkit"+l;else if(void 0!=m["ms"+l])b="ms"+l;else if(void 0!=m["moz"+l])b="moz"+l;else return;
C(a,c,d,e,k)}};a.attr_animate=function(a,b,c,d,e,f){function g(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},C(a,c,d,e,g))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,m=c.opt_suffix,l=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,m,l):"attr"==c.type&&a.attr_animate(d,e,f,g,h,l)}};a.set_camera_smooth_factor=
function(a){M=a};a.get_camera_smooth_factor=function(){return M}};b4w.module.camera_anim=function(a,p){function d(a,c,d,f,g){d=e.angle_wrap_0_2pi(c-d);d=Math.min(d,2*Math.PI-d);c=e.angle_wrap_0_2pi(f-c);c=Math.min(c,2*Math.PI-c);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(c)||1E-6>2*Math.PI-Math.abs(c))c=0;b.is_eye_camera(a)?(g[0]=c,g[1]=d):(g[0]=d,g[1]=c);return g}var b=p("camera"),c=p("controls"),n=p("print"),g=p("scenes"),q=p("time"),l=p("transform"),t=p("tsr"),e=p("util"),H=p("vec3"),k=p("quat"),r=new Float32Array(2),u=new Float32Array(2),
z=new Float32Array(3),D=new Float32Array(3),y=new Float32Array(3),C=new Float32Array(4),v=t.create(),f=t.create(),m=t.create(),h={},x=!1,L=!1,P=!1,A=!1;a.track_to_target=function(a,d,f,g,h,m,q,p){if(!b.is_eye_camera(a))n.error("track_to_target(): wrong object");else if(a&&d){if(e.is_vector(d))var t=d;else t=y,l.get_object_center(d,!1,t);d=f||1;f=g||2;var u=h||1;h=m||1;D[0]=0;D[1]=-1;D[2]=0;var v=l.get_rotation(a);m=e.quat_to_dir(v,D);g=b.get_camera_angles(a,r);var x=l.get_translation(a);H.subtract(t,
x,z);H.normalize(z,z);var A=k.rotationTo(m,z,k.create());k.multiply(A,v,C);e.correct_cam_quat_up(C,!1);H.subtract(t,x,D);var L=H.length(D)*(1-1/f),t=Math.asin(z[1]);f=Math.acos(-z[2]/Math.abs(Math.cos(t)));0<z[0]&&(f=2*Math.PI-f);var P=f-g[0],ba=t-g[1];y[0]=0;y[1]=0;y[2]=-1;f=l.get_rotation(a);0>e.quat_to_dir(f,y)[1]?(ba=0<m[1]?t-Math.PI+g[1]:t+Math.PI+g[1],P=0<P?-Math.PI+P:Math.PI+P):Math.abs(P)>Math.PI&&(P=0<P?P-2*Math.PI:P+2*Math.PI);var E=0,t=c.create_elapsed_sensor();m=Math.abs(P/d);d=Math.abs(ba/
d);var ea=m>d?m:d,qa=ea+u,la=qa+h,ia=la+u,ya=P,J=ba,V=L,W=function(){c.remove_sensor_manifold(a,"TRACK_TO_TARGET");q&&q()};c.create_sensor_manifold(a,"TRACK_TO_TARGET",c.CT_CONTINUOUS,[t],null,function(a,d,e){if(e)if(b.is_eye_camera(a))if(e=c.get_sensor_value(a,d,0),E+=e,E<ea){var f=P/ea*e;e*=ba/ea;d=E/ea;d=6*d*(1-d);f*=d;e*=d;ya-=f;J-=e;b.eye_rotate(a,f,e)}else E<qa?(ya&&(b.eye_rotate(a,ya,J),ya=0,p&&p()),d=(E-ea)/u,e=-L*e/u,V-=f,l.move_local(a,0,6*e*d*(1-d),0)):E<la?V&&(l.move_local(a,0,V,0),V=
0):E<ia?(d=(E-la)/u,e=L*e/u,e=6*e*d*(1-d),l.move_local(a,0,e,0)):(l.set_translation_v(a,x),W());else W()})}};a.auto_rotate=function(a,f,k){function m(f,g,k){if(1==k)if(k=b.get_move_style(f),k==b.MS_STATIC)l();else if(k!=b.MS_TARGET_CONTROLS&&k!=b.MS_EYE_CONTROLS||!b.has_horizontal_rot_limits(f))p=null,g=c.get_sensor_value(f,g,0),b.rotate_camera(f,g*a,0);else{k=k==b.MS_EYE_CONTROLS?b.eye_get_horizontal_limits(f,h):b.target_get_horizontal_limits(f,h);if(null===p||k.left!=p.left||k.right!=p.right){p=
p||{};p.left=k.left;p.right=k.right;t=Math.min(.2,e.angle_wrap_0_2pi(p.right-p.left)/2);k=q;var n=p,x=b.get_camera_angles(k,r)[0];k=d(k,x,n.left,n.right,u);v=a*Math.min(1,k[0]/.2,k[1]/.2)}g=c.get_sensor_value(f,g,0);k=b.get_camera_angles(f,r)[0];k=d(f,k,p.left,p.right,u);k[1]>t&&k[0]>t?v=e.sign(v)*a:k[1]<t?v-=Math.pow(a,2)/.4*g:k[0]<t&&(v+=Math.pow(a,2)/.4*g);b.rotate_camera(f,g*v,0)}}function l(){c.remove_sensor_manifold(q,"AUTO_ROTATE");c.remove_sensor_manifold(q,"DISABLE_AUTO_ROTATE");f()}f=f||
function(){};var q=g.get_active_camera();if(b.is_static_camera(q))n.error("auto_rotate(): Wrong camera move style");else{var p={},t=0,v=0;if(c.check_sensor_manifold(q,"AUTO_ROTATE"))l();else{var x=c.create_mouse_move_sensor("X"),y=c.create_mouse_move_sensor("Y"),A=c.create_mouse_click_sensor(),z=c.create_touch_move_sensor(),C=c.create_touch_zoom_sensor(),D=c.create_elapsed_sensor();k=k?c.create_mouse_wheel_sensor():c.create_custom_sensor(0);c.create_sensor_manifold(q,"DISABLE_AUTO_ROTATE",c.CT_LEVEL,
[x,y,A,z,C,k],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},l);c.create_sensor_manifold(q,"AUTO_ROTATE",c.CT_CONTINUOUS,[D],function(a){return a[0]},m)}}};a.is_auto_rotate=function(){var a=g.get_active_camera();return c.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=g.get_active_camera();return b.get_move_style(a)==b.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,c,d,g,h){if(b.get_move_style(a)!=b.MS_STATIC)n.error("move_camera_to_point(): wrong camera type");
else if(!x)if(a)if(c){d=d||1;g=g||.01;var k=e.is_vector(a)?a:l.get_tsr(a,v),p=e.is_vector(c)?c:l.get_tsr(c,f);c=H.distance(t.get_trans_view(k),t.get_trans_view(p))/d;d=e.quat_to_dir(t.get_quat_view(k),e.AXIS_MY,z);var r=e.quat_to_dir(t.get_quat_view(p),e.AXIS_MY,D);d=Math.min(Math.abs(H.dot(d,r)),1);g=1E3*Math.max(c,Math.acos(d)/g);x=!0;var u=q.animate(0,1,g,function(b){var c=t.interpolate(k,p,e.smooth_step(b),m);P?(q.clear_animation(u),x=P=!1):(l.set_tsr(a,c),1==b&&(x=!1,h&&h()))})}else n.error("move_camera_to_point(): you must specify the point object");
else n.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,c,d,e,f){if(b.get_move_style(a)==b.MS_STATIC)n.error("rotate_camera(): not supported for STATIC cameras");else if(!L)if(a)if(c||d){L=!0;var g=0,h=0,k=0!=c?c:d,m=q.animate(0,k,e||1E3,function(e){A?(q.clear_animation(m),L=A=!1):(g-=e,h-=e,d&&c?b.rotate_camera(a,g,h):d?b.rotate_camera(a,0,h):c&&b.rotate_camera(a,g,0),h=g=e,e==k&&(L=!1,f&&f()))})}else n.error("rotate_camera(): you must specify the rotation angle");
else n.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){P=!0};a.stop_cam_rotating=function(){A=!0};a.is_moving=function(){return x};a.is_rotating=function(){return L}};b4w.module.gyroscope=function(a,p){function d(a){var d=c.create_gyro_angles_sensor(),n=c.create_gyro_quat_sensor(),p=!0;c.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",c.CT_CONTINUOUS,[d,n],null,function(a,d,h){if(0<h)if(b.is_eye_camera(a))d=c.get_sensor_payload(a,d,1),h=l.transformQuat(q.AXIS_Z,d,H),b.set_vertical_axis(a,h),g.set_rotation_v(a,d);else{e=c.get_sensor_payload(a,d,0);p&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],p=!1);h=d=0;0==window.orientation&&(d=e[1]-t[1],h=e[0]-t[0],e[1]>r&&e[1]<k&&(h=0));
if(180==window.orientation){d=e[1]-t[1];0>e[1]&&(d=-d);h=t[0]-e[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;e[1]>-k&&e[1]<-r&&(h=0)}if(-90==window.orientation){d=e[0]-t[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;h=t[1]-e[1];if(e[0]>u||e[0]<z)h=0}if(90==window.orientation){d=t[0]-e[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;h=e[1]-t[1];if(e[0]>u||e[0]<z)h=0}b.rotate_camera(a,h,d);t[0]=e[0];t[1]=e[1];t[2]=e[2]}})}var b=p("camera"),c=p("controls"),n=p("scenes"),g=p("transform"),q=p("util"),l=p("vec3"),t=new Float32Array(3),
e=new Float32Array(3),H=l.create(),k=110*Math.PI/180,r=70*Math.PI/180,u=70*Math.PI/180,z=70*-Math.PI/180;a.enable_camera_rotation=function(){var a=n.get_active_camera();d(a)};a.disable_camera_rotation=function(){var a=n.get_active_camera();c.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd=function(a,p){function d(a){var c=a.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=a.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));b(d,c)}function b(a,b){if(a||H.get("is_mobile_device")){var d=m={Ys:null,Ey:null,fJ:"",distortion_coefs:new Float32Array(2),distortion_scale:1,chromatic_aberration_coefs:new Float32Array(4),Vk:new Float32Array(4),
Wk:new Float32Array(4),hl:0,kk:0,wg:0,CK:"",ck:0,wh:0,$g:0,SL:null},e="default",f="default";if(a)d.Ys=a,d.Ey=b,-1!==a.deviceName.toLowerCase().indexOf("oculus")&&(e="oculus");else{for(var g in M)if(navigator.userAgent.match(M[g].oq)){f=g;break}g=M[f];d.ck=g.ck;d.wh=g.wh;d.$g=g.$g;e="cardboard_2"}if(e&&(d.fJ=e,e=G[e],d.distortion_coefs[0]=e.distortion_coefs[0],d.distortion_coefs[1]=e.distortion_coefs[1],d.chromatic_aberration_coefs[0]=e.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1]=
e.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2]=e.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]=e.chromatic_aberration_coefs[3],d.distortion_scale=e.distortion_scale,!d.Ys)){g=M[f];var h=e.kk-g.$g,f=g.wh-h;g=d.distortion_coefs;var h=180*Math.atan(c(g,h/e.wg))/Math.PI,k=180*Math.atan(c(g,f/e.wg))/Math.PI,l=180*Math.atan(c(g,f/e.wg))/Math.PI,f=180*Math.atan(c(g,f/e.wg))/Math.PI;d.Vk[0]=Math.min(k,e.rb);d.Vk[1]=Math.min(l,e.rb);d.Vk[2]=Math.min(h,e.rb);d.Vk[3]=Math.min(f,
e.rb);d.Wk[0]=Math.min(k,e.rb);d.Wk[1]=Math.min(f,e.rb);d.Wk[2]=Math.min(h,e.rb);d.Wk[3]=Math.min(l,e.rb);d.hl=e.hl;d.kk=e.kk;d.wg=e.wg}}else z.warn("Head-mounted display is not found.")}function c(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function n(){return m&&m.Ys}function g(){return m&&m.Ey}function q(a,b){var c=n();c?(c=c.getEyeParameters(a))&&c.currentFieldOfView&&(b||(b=f.create()),b[0]=c.currentFieldOfView.upDegrees,b[1]=c.currentFieldOfView.rightDegrees,b[2]=c.currentFieldOfView.downDegrees,
b[3]=c.currentFieldOfView.leftDegrees):m&&(c="left"==a?m.Vk:m.Wk,b||(b=f.create()),f.copy(c,b));return b}function l(){var a=g();if(a)for(var b=0;b<a.length;b++)a[b].resetSensor()}function t(a){if(m){var b=k.create_elapsed_sensor(),c=n()?k.create_custom_sensor(1):k.create_gyro_quat_sensor(),d=!1;k.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",k.CT_CONTINUOUS,[b,c],null,function(b,c,f){var p=D.get_active_camera();if(p&&0<f){if(!d){f=q("left",w);var t=q("right",I);f&&f&&e.set_hmd_fov(p,f,t);(f=n())?
(t=f.getEyeParameters("left"),f=f.getEyeParameters("right").eyeTranslation.x-t.eyeTranslation.x):f=m?m.hl:void 0;f&&e.set_eye_distance(p,f);f={};f.distortion_coefs=[m.distortion_coefs[0],m.distortion_coefs[1]];f.chromatic_aberration_coefs=[m.chromatic_aberration_coefs[0],m.chromatic_aberration_coefs[1],m.chromatic_aberration_coefs[2],m.chromatic_aberration_coefs[3]];f.distortion_scale=m.distortion_scale;f.distortion_offset=0;f.enable_hmd_stereo=!0;D.set_hmd_params(f);f=r.get_container();r.resize(f.clientWidth,
f.clientHeight,!0);d=!0;h=y.get_rotation(p,h);l()}if(e.is_eye_camera(p)){if(n()){b=T;if(c=g())for(f=0;f<c.length;f++)t=c[f].getState(),t.orientation&&(b||(b=u.create()),b[0]=t.orientation.x,b[1]=t.orientation.y,b[2]=t.orientation.z,b[3]=t.orientation.w);c=u.setAxisAngle(C.AXIS_X,Math.PI/2,O);b=u.multiply(b,c,T)}else b=k.get_sensor_payload(b,c,1);if(b)if(1==a){var z=v.transformQuat(C.AXIS_Z,b,L);e.set_vertical_axis(p,z);y.set_rotation_v(p,b)}else if(2==a||3==a)c=y.get_rotation(p,O),c=u.invert(c,O),
f=u.multiply(h,c,O),c=e.get_vertical_axis(p,L),Math.abs(c[2])<Math.PI/4?z=v.cross(c,C.AXIS_Z,P):Math.abs(c[1])<Math.PI/4&&(z=v.cross(c,C.AXIS_Y,P)),v.normalize(z,z),f=v.transformQuat(z,f,A),t=v.dot(c,f),f=v.scaleAndAdd(f,c,-t,A),v.normalize(f,f),c=v.cross(c,z,L),z=Math.acos(C.clamp(v.dot(z,f),0,1)),c=C.sign(v.dot(f,c)),x+=z*c,z=u.setAxisAngle(C.AXIS_Y,-x,O),3!=a&&(c=C.quat_project(b,C.AXIS_MY,C.AXIS_Y,C.AXIS_MZ,B),c=u.invert(c,B),b=u.multiply(c,b,B)),b=u.multiply(z,b,T),z=v.transformQuat(C.AXIS_Z,
b,L),e.set_vertical_axis(p,z),y.set_rotation_v(p,b),u.copy(b,h)}}})}}var e=p("camera"),H=p("config"),k=p("controls"),r=p("container"),u=p("quat"),z=p("print"),D=p("scenes"),y=p("transform"),C=p("util"),v=p("vec3"),f=p("vec4"),m=null,h=u.create(),x=0,L=v.create(),P=v.create(),A=v.create(),w=f.create(),I=f.create(),T=u.create(),O=u.create(),B=u.create(),G={oculus:{distortion_coefs:[.22,.28],distortion_scale:.66,chromatic_aberration_coefs:[-.015,.02,.025,.02]},cardboard_1:{rb:40,hl:.06,kk:.035,wg:.042,
distortion_scale:1,distortion_coefs:[.441,.156],chromatic_aberration_coefs:[0,0,0,0]},cardboard_2:{rb:60,hl:.064,kk:.035,wg:.039,distortion_scale:1,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0]},"default":{distortion_coefs:[0,0],distortion_scale:1,chromatic_aberration_coefs:[0,0,0,0]}},M={Nexus6:{oq:/Nexus 6 /,ck:.132,wh:.074,$g:.004},GalaxyNote4:{oq:/SM-N910C/,ck:.121,wh:.071,$g:.004},YotaPhone2:{oq:/YD201/,ck:.11,wh:.062,$g:.004},"default":{ck:.11,wh:.062,$g:.004}};a.HMD_NONE_MOUSE_ALL_AXES=
0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=3;a.enable_hmd=function(a){navigator.getVRDevices&&navigator.getVRDevices().then(function(b){d(b);t(a)})};a.check_browser_support=function(){return Boolean(navigator.getVRDevices)};a.get_hmd_device=n;a.get_sensor_devices=g;a.reset=l;a.disable_hmd=function(){k.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");D.set_hmd_params({enable_hmd_stereo:!1});var a=r.get_container();r.resize(a.clientWidth,a.clientHeight,!0);a=
D.get_active_camera();e.set_vertical_axis(a,C.AXIS_Y);var b=y.get_rotation(a,T);y.set_rotation_v(a,b)}};b4w.module.mixer=function(a,p){function d(){y=D.length=0;C=b();v=new Float32Array(C.length);f=new Float32Array(C.length);var a=u.get_speaker_objects();if(a.length){D.push(c());for(var d=0;d<a.length;d++)D.push(g(a[d]));D.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function b(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function c(){var a=n("MASTER");a.r.push(["VOLUME",u.get_volume(null),0,1,50,!1]);var b=u.get_compressor_params();b&&(a.r.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.r.push(["KNEE",b.knee,0,40,40,!1]),a.r.push(["RATIO",b.ratio,1,20,20,!1]),a.r.push(["ATTACK",b.attack,0,1,1E3,!1]),a.r.push(["RELEASE",b.release,0,1,1E3,!1]));a.mute=u.is_muted(null)?1:0;a.Zd=-1;return a}function n(a){return{id:a,r:[],Vg:0,mute:-1,Zd:-1,$a:null}}function g(a){var b=n(r.get_object_name(a));b.mute=u.is_muted(a)?
1:0;b.Zd=0;b.$a=a;return b}function q(a){if(a.$a){a.r.length=0;a.r.push(["VOLUME",u.get_volume(a.$a),0,1,50,!1]);var b=u.get_positional_params(a.$a);b&&(a.r.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.r.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.r.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=u.get_filter_params(a.$a))a.r.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.r.push(["EQ_Q",b.Q,0,10,100,!1]),a.r.push(["EQ_GAIN",b.gain,-70,30,100,!1]);z.clamp(a.Vg,0,a.r.length-1)}}function l(a){for(var b=
0;b<D.length;b++){var c=D[b];if(c!=a&&1==c.Zd)return!0}return!1}function t(a){for(var b=0;b<D.length;b++){var c=D[b];c!=a&&0==c.mute&&0==c.Zd&&u.mute(c.$a,!1)}}function e(){if(0==D.length)return[0,-1];var a=8*Math.floor(y/8),b=a+7,a=z.clamp(a,0,D.length-1),b=z.clamp(b,0,D.length-1);return[a,b]}var H=p("controls");p("debug");var k=p("hud"),r=p("scenes"),u=p("sfx"),z=p("util"),D=[],y=0,C=null,v=null,f=null;a.enable_mixer_controls=function(){function a(b,c,d){if(1==d){var e=Boolean(H.get_sensor_value(b,
c,2))?-1:1,f=D[y];if(f)switch(d=f.r[f.Vg],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=z.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=f.id?u.set_volume(f.$a,d[1]):u.set_volume(null,d[1]);break;case "DIST_REF":e=u.get_positional_params(f.$a);e.dist_ref=d[1];u.set_positional_params(f.$a,e);break;case "ATTENUATION":e=u.get_positional_params(f.$a);e.attenuation=d[1];u.set_positional_params(f.$a,e);break;case "DIST_MAX":e=u.get_positional_params(f.$a);e.dist_max=d[1];u.set_positional_params(f.$a,
e);break;case "EQ_FREQ":e=u.get_filter_params(f.$a);e.freq=d[1];u.set_filter_params(f.$a,e);break;case "EQ_Q":e=u.get_filter_params(f.$a);e.Q=d[1];u.set_filter_params(f.$a,e);break;case "EQ_GAIN":e=u.get_filter_params(f.$a);e.gain=d[1];u.set_filter_params(f.$a,e);break;case "THRESHOLD":f=u.get_compressor_params();f.threshold=d[1];u.set_compressor_params(f);break;case "KNEE":f=u.get_compressor_params();f.knee=d[1];u.set_compressor_params(f);break;case "RATIO":f=u.get_compressor_params();f.ratio=d[1];
u.set_compressor_params(f);break;case "ATTACK":f=u.get_compressor_params();f.attack=d[1];u.set_compressor_params(f);break;case "RELEASE":f=u.get_compressor_params();f.release=d[1];u.set_compressor_params(f);break;default:throw"Unknown strip param";}"INC_DEC"==c?H.reset_timer_sensor(b,c,6,.35):H.reset_timer_sensor(b,c,6,.05)}else H.reset_timer_sensor(b,c,6,10)}function b(a,c,d){if(1==d){d=Boolean(H.get_sensor_value(a,c,0))?-1:1;if(D.length){1==d&&y<D.length-1?y++:-1==d&&0<y&&y--;d=e();for(var f=d[0];f<=
d[1];f++)q(D[f])}"SWITCH_STRIP"==c?H.reset_timer_sensor(a,c,5,.15+.3):H.reset_timer_sensor(a,c,5,.15)}else H.reset_timer_sensor(a,c,5,10)}d();var c=H.create_keyboard_sensor(H.KEY_LEFT_SQ_BRACKET),g=H.create_keyboard_sensor(H.KEY_RIGHT_SQ_BRACKET),n=H.create_keyboard_sensor(H.KEY_SEMI_COLON),p=H.create_keyboard_sensor(H.KEY_SINGLE_QUOTE),r=H.create_keyboard_sensor(H.KEY_SHIFT),I=H.create_timer_sensor(.15,!0),T=H.create_timer_sensor(.05,!0),c=[c,g,n,p,r,I,T];H.create_sensor_manifold(null,"SWITCH_STRIP",
H.CT_TRIGGER,c,function(a){return(a[0]||a[1])&&!a[4]},b);H.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",H.CT_SHOT,c,function(a){return(a[0]||a[1])&&!a[4]&&a[5]},b);H.create_sensor_manifold(null,"SWITCH_PARAM",H.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[4]},function(a,b){var c=Boolean(H.get_sensor_value(a,b,0))?-1:1,d=D[y];d&&(1==c&&d.Vg<d.r.length-1?d.Vg++:-1==c&&0<d.Vg&&d.Vg--)});H.create_sensor_manifold(null,"INC_DEC",H.CT_TRIGGER,c,function(a){return(a[2]||a[3])&&!a[4]},a);H.create_sensor_manifold(null,
"INC_DEC_HOLD",H.CT_SHOT,c,function(a){return(a[2]||a[3])&&!a[4]&&a[6]},a);H.create_sensor_manifold(null,"MUTE_SOLO",H.CT_SHOT,c,function(a){return(a[2]||a[3])&&a[4]},function(a,b){if(Boolean(H.get_sensor_value(a,b,2))){var c=D[y];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,u.mute(c.$a,!0),1==c.Zd&&(c.Zd=0,l(c)||t(c))):(c.mute=0,l(c)||u.mute(c.$a,!1)):0==c.mute?(c.mute=1,u.mute(null,!0)):(c.mute=0,u.mute(null,!1)))}else if((c=D[y])&&0<=c.Zd)if(0==c.Zd){c.Zd=1;u.mute(c.$a,!1);1==c.mute&&(c.mute=
0);for(var d=0;d<D.length;d++){var e=D[d];e!=c&&0==e.mute&&0==e.Zd&&u.mute(e.$a,!0)}}else c.Zd=0,l(c)?u.mute(c.$a,!0):t(c)});c=H.create_elapsed_sensor();H.create_sensor_manifold(null,"MIXER_DRAW",H.CT_CONTINUOUS,[c],null,function(){if(D[y])for(var a=e(),b=a[0];b<=a[1];b++){var c=D[b];k.draw_mixer_strip(c.id,b==y,b%8,c.r,c.Vg,c.mute,c.Zd);if(c.$a&&u.get_filter_params(c.$a)){u.get_filter_freq_response(c.$a,C,v,f);for(c=0;c<v.length;c++)v[c]=20*Math.log(v[c])/Math.LN10;k.plot_array("EQ",b%8,v,20,2E4,
-10,10)}}});c=H.create_timer_sensor(1,!0);H.create_sensor_manifold(null,"MIXER_UPDATE",H.CT_TRIGGER,[c],null,function(){for(var a=e(),b=a[0];b<=a[1];b++)q(D[b])})}};b4w.module.npc_ai=function(a,p){function d(a,b){var c=b.destination,d=y;r.get_translation(b.empty,d);var g=C;r.get_translation(b.collider,g);var k=0;b.dk?k=b.dk:b.Of&&(k=b.Of,b.type==L&&(k*=.5),b.type==A&&(k*=a));switch(b.type){case L:if(b.random&&b.ug){c[0]=(12*Math.random()-6)*b.speed+d[0];c[2]=(12*Math.random()-6)*b.speed+d[2];var n=h,d=v,p=b.speed,t=b.rot_speed;r.get_rotation(b.collider,n);z.transformQuat(u.AXIS_Z,n,d);d[1]=0;z.normalize(d,d);n=.5*p/Math.sin(t/2);p=z.dist(c,g);p<2*n&&z.scaleAndAdd(c,
d,2*n-p,c);b.ug=!1}c[1]=g[1];k&&(c[1]+=k);break;case P:case A:b.random&&b.ug&&(b.type==A?(b.speed=Math.random()+.1,n=b.BF-b.HF):n=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=g[1]+(Math.random()*n-.5*n),c[2]=10*Math.random()-5+d[2],b.ug=!1),k&&(c[1]=g[1]+k)}var c=y,d=C,p=v,g=x,D=b.rig,n=b.collider,k=b.destination,H=b.speed,N=b.actions,oa=l.get_current_anim_name(D);if(!l.is_play(D)||!N.fl||-1==N.fl.indexOf(oa)){r.get_translation(n,c);var t=k[0]-c[0],fa=k[2]-c[2],t=Math.sqrt(t*t+fa*fa);
if(t>2*H*a)b.state=20,u.xz_direction(k,c,p),N=b.rig,l.is_animated(N)&&(D=b.speed,H=l.get_frame(N),N=l.get_anim_length(N),D*=N/24*(1-H/N),.9>t/D&&z.scaleAndAdd(k,p,D-t,k)),t=h,D=f,r.get_rotation(b.collider,t),z.transformQuat(u.AXIS_Z,t,d),D[0]=d[0],D[1]=0,D[2]=d[2],z.normalize(D,D),H=z.dot(D,p),N=a/(Math.abs(Math.acos(H))/Math.PI)*b.rot_speed*b.Vr,e.rotationTo(D,p,g),e.rotationTo(u.AXIS_Z,D,t),1<=Math.abs(H)?e.copy(t,g):(e.multiply(g,t,g),e.slerp(t,g,Math.min(N,1),g)),p=a,b.type!=P&&(p=Math.max(p,
1/60),t=m,D=h,e.setAxisAngle(u.AXIS_X,-Math.asin(d[1]),D),e.setAxisAngle(u.AXIS_X,-Math.atan(b.Of/(b.speed*p)),t),e.slerp(D,t,p,t),e.multiply(g,t,g)),r.set_rotation_v(n,g),d=v,n=f,u.quat_to_dir(g,u.AXIS_Z,d),z.scale(d,b.speed*a,n),z.add(n,c,n),n[1]=b.type!=L?(k[1]-c[1])*a*.1+c[1]:k[1],r.set_translation_v(b.collider,n);else if(b.type==L)N.move?oa&&-1!=N.move.indexOf(oa)&&l.is_play(D)?b.state=20:(b.state=10,b.ug=!0):(b.state=10,b.ug=!0);else if(b.type==A||b.type==P)b.ug=!0;if(q(b)&&(c=b.rig,!l.is_play(c))){g=
null;switch(b.state){case 10:g=b.actions;g=g.fl?u.random_from_array(g.fl):null;break;case 20:g=l.get_current_anim_name(b.rig),d=k=b.actions,d.zf&&-1==d.zf.indexOf(g)&&d.move&&-1!=d.move.indexOf(g)&&.33<Math.random()?(k=b.actions,g=k.zf[k.move.indexOf(g)]):(d=b.actions,d.move&&(-1!=d.move.indexOf(g)||!d.zf&&!d.kg||!d.kg&&!g||d.zf&&-1!=d.zf.indexOf(g)||d.kg&&-1!=d.kg.indexOf(g))?(k=b.actions,k.zf?(d=k.zf.indexOf(g),-1!=d?(g=d+1,g=g<k.move.length?g:0,g=k.move[g]):g=-1!=k.move.indexOf(g)?g:u.random_from_array(k.move)):
g=u.random_from_array(k.move)):(d=b.actions,g=d.kg&&-1==d.kg.indexOf(g)&&d.move&&-1==d.move.indexOf(g)?u.random_from_array(k.kg):null))}g&&(l.apply(c,g),l.set_behavior(c,l.AB_FINISH_RESET),l.set_frame(c,0),l.play(c))}}}function b(a,b,c,d){if(d)if(1==c)switch(d.type){case P:a:{for(c=0;3>c;c++){var e=t.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}a=100*b;d.Of=a<d.min_height?10:a>d.max_height?-10:0;break;case L:a=t.get_sensor_payload(a,b,0).hit_fract;d.Of=d.Lw==a?0:1-100*a;d.Lw=a;
break;case A:a=t.get_sensor_payload(a,b,0).hit_fract,"CLOSE_GROUND"==b?(d.Of=100*a-1,d.Of=.1>d.Of?.05:0):"CLOSE_WATER"==b&&(d.dk=100*a,d.dk=d.dk<d.HF?-.02:d.dk>d.BF?.02:0)}else d.Of=0}function c(){for(var a=0;a<D.length;a++){var b=D[a];n(b);g(b);b.rig&&l.get_current_anim_name(b.rig)&&l.play(b.rig)}}function n(a){var c=z.create(),d=a.collider;switch(a.type){case P:var e=t.create_ray_sensor(d,c,[0,-100,0],"TERRAIN",!0),f=t.create_ray_sensor(d,c,[0,-100,0],"STONE",!0),c=t.create_ray_sensor(d,c,[0,-100,
0],"WATER",!0),e=[e,f,c];t.create_sensor_manifold(d,"CLOSE_GROUND",t.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},b,a);break;case L:e=t.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0);e=[e];t.create_sensor_manifold(d,"CLOSE_GROUND",t.CT_CONTINUOUS,e,null,b,a);break;case A:e=t.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0),c=t.create_ray_sensor(d,c,[0,100,0],"WATER",!0),e=[e],t.create_sensor_manifold(d,"CLOSE_WATER",t.CT_CONTINUOUS,[c],null,b,a),t.create_sensor_manifold(d,"CLOSE_GROUND",
t.CT_CONTINUOUS,e,null,b,a)}}function g(a){function b(c,d,e){1==e?(r.get_translation(a.empty,a.destination),a.Vr=4):a.Vr=1}var c=a.collider;if(a.type==L){var d=t.create_collision_sensor(c,"CONSTRUCTION",!1);t.create_sensor_manifold(c,"CONSTRUCTION_COLL",t.CT_CONTINUOUS,[d],null,b)}}function q(a){var b=a.rig;if(!l.is_play(b))return!0;b=l.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.fl)return!1;if(-1==c.fl.indexOf(b))break;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||
c.kg&&-1!=c.kg.indexOf(b)||c.zf&&-1!=c.zf.indexOf(b))return!1;break;default:return!1}return!0}var l=p("animation"),t=p("controls"),e=p("quat"),H=p("scenes"),k=p("time"),r=p("transform"),u=p("util"),z=p("vec3"),D=[];new Float32Array(9);var y=new Float32Array(3),C=new Float32Array(3),v=new Float32Array(3),f=new Float32Array(3),m=new Float32Array(4),h=new Float32Array(4),x=new Float32Array(4),L=a.NT_WALKING=10,P=a.NT_FLYING=20,A=a.NT_SWIMMING=30;a.new_event_track=function(a){a.destination=new Float32Array(3);
a.start=[];a.ended=[];a.en=[];a.Of=null;a.Lw=null;a.dk=null;a.ug=!0;a.Vr=1;if(!a.random)for(var b=0;b<a.path.length;b++)a.start[b]=-1,a.ended[b]=!1,a.en[b]=!1;D.push(a)};a.enable_animation=function(){if(D.length){c();var a=t.create_elapsed_sensor();t.create_sensor_manifold(D[0].collider,"ELAPSED",t.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=t.get_sensor_value(a,b,0),b=0;b<D.length;b++){c=D[b];var e=a;if(H.is_visible(c.obj))if(c.random)d(e,c);else{for(var f=k.get_timeline(),
g=0;g<c.path.length;g++)if(!c.ended[g]){c.en[g]||(c.en[g]=!0,c.destination[0]=c.path[g][0],c.destination[1]=c.path[g][1],c.destination[2]=c.path[g][2],c.start[g]=f+c.delay[g]);if(f<c.start[g])break;d(e,c);c.ended[g]=c.ug;break}a:{for(e=0;e<c.path.length;e++)if(0==c.ended[e]){e=!1;break a}e=!0}if(e)for(e=0;e<c.path.length;e++)c.en[e]=!1,c.ended[e]=!1}}})}};a.disable_animation=function(){if(!(0>=D.length))for(var a=0;a<D.length;a++){var b=D[a];t.check_sensor_manifolds(b.collider)&&t.remove_sensor_manifold(b.collider);
l.is_play(b.rig)&&l.stop(b.rig)}}};b4w.module.mouse=function(a,p){function d(){1==P&&(P=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);k.remove_sensor_manifold(z.get_active_camera(),"SMOOTH_PL")}function b(a){2==P&&(P=0);a.removeEventListener("mousedown",n,!1);a.removeEventListener("mouseup",g,!1);a.removeEventListener("mousemove",c,!1);k.remove_sensor_manifold(z.get_active_camera(),"SMOOTH_DRAG")}function c(a){x()&&(m[0]+=2*(a.clientX-v),m[1]+=
2*(a.clientY-f),v=a.clientX,f=a.clientY);a.preventDefault()}function n(a){v=a.clientX;f=a.clientY;a.currentTarget.addEventListener("mousemove",c,!1);a.preventDefault()}function g(a){a.currentTarget.removeEventListener("mousemove",c,!1);a.preventDefault()}function q(a,b,c,d){if(.01<Math.abs(m[0])||.01<Math.abs(m[1]))b=k.get_sensor_value(a,b,0),a=D.smooth(m[0],0,b,.1*C),b=D.smooth(m[1],0,b,.1*C),m[0]-=a,m[1]-=b,d(4E-4*-a,4E-4*-b)}function l(a,b){var c=z.get_first_character(),d=z.get_active_camera();
e.eye_rotate(d,a,b);c&&(d=e.get_camera_angles_char(d,h),r.set_character_rotation(c,d[0],d[1]))}function t(a){a=H.client_to_canvas_coords(a.clientX,a.clientY,h);(a=z.pick_object(a[0],a[1]))?(z.outlining_is_enabled(a)&&z.set_outline_intensity(a,1),z.outlining_is_enabled(L)&&a!=L&&z.set_outline_intensity(L,0)):z.outlining_is_enabled(L)&&z.set_outline_intensity(L,0);L=a}var e=p("camera"),H=p("container"),k=p("controls"),r=p("physics"),u=p("print"),z=p("scenes"),D=p("util"),y=p("main"),C=1,v=0,f=0,m=new Float32Array(2),
h=new Float32Array(2),x=null,L=null,P=0;a.request_pointerlock=function(a,c,d,e,f,g){function h(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){b(a);a.addEventListener("mousemove",e,!1);var f=z.get_active_camera();if(!k.check_sensor_manifold(f,"SMOOTH_PL")){var l=k.create_elapsed_sensor();k.create_sensor_manifold(f,"SMOOTH_PL",k.CT_CONTINUOUS,[l],null,q,g)}c()}else a.removeEventListener("mousemove",e,!1),P=0,document.removeEventListener("pointerlockchange",
h,!1),document.removeEventListener("webkitpointerlockchange",h,!1),document.removeEventListener("mozpointerlockchange",h,!1),d()}if(1!=P){P=1;c=c||function(){};d=d||function(){};g=g||l;f=f||function(){return!0};e=e||function(a){if(f()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;m[0]+=b;m[1]+=a}};document.addEventListener("pointerlockchange",
h,!1);document.addEventListener("webkitpointerlockchange",h,!1);document.addEventListener("mozpointerlockchange",h,!1);var n=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof n?n.apply(a):u.error("Pointer lock is not available")}};a.exit_pointerlock=d;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c){2!=P&&(P=2,d(),x=b||function(){return!0},
c=c||l,a.addEventListener("mousedown",n,!1),a.addEventListener("mouseup",g,!1),a=z.get_active_camera(),k.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=k.create_elapsed_sensor(),k.create_sensor_manifold(a,"SMOOTH_DRAG",k.CT_CONTINUOUS,[b],null,q,c)))};a.exit_mouse_drag=b;a.enable_mouse_hover_outline=function(){y.detect_mobile()||H.get_canvas().addEventListener("mousemove",t)};a.disable_mouse_hover_outline=function(){y.detect_mobile()||(H.get_canvas().removeEventListener("mousemove",t),L&&z.set_outline_intensity(L,
0))};a.get_coords_x=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in c[0]?c[0].clientX:-1};a.get_coords_y=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.set_plock_smooth_factor=function(a){C=a};a.get_plock_smooth_factor=function(){return C}};b4w.module.preloader=function(a,p){var d=p("app"),b,c,n,g,q,l,t,e,H,k=null;a.create_simple_preloader=function(a){var d=null,e=null,p="#bf9221",t="#000",C;for(C in a)switch(C){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":t=a.bg_color;break;case "bar_color":p=a.bar_color;break;case "preloader_fadeout":b=a.preloader_fadeout}a=document.createElement("div");C=document.createElement("div");a.id="simple_preloader_container";
var v=document.createElement("div"),f=document.createElement("div"),e=document.getElementById(e);k=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+t+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";C.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";v.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+
p+";border-radius: 0px;";f.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+C.appendChild(v);C.appendChild(f);a.appendChild(C);document.body.appendChild(a);c="SIMPLE";n=a;g=v;q=f;l=e};a.create_rotation_preloader=function(a){var b=null,d=null,e="rgba(0,0,0,0)",g="",p="",v="rgba(0,0,0,0)",f;for(f in a)switch(f){case "canvas_container_id":b=a.canvas_container_id;
break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":e=a.frame_bg_color;break;case "bg_color":v=a.bg_color;break;case "frame_class":g=a.frame_class;break;case "anim_elem_class":p=a.anim_elem_class}a=document.createElement("div");f=document.createElement("div");var m=document.createElement("div"),h=document.createElement("div"),d=document.getElementById(d);k=document.getElementById(b);a.style.cssText="z-index: 4;background-color: "+v+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";
f.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+e+";";m.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";h.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";m.className=p;f.appendChild(m);f.className=g;f.appendChild(h);
a.appendChild(f);k.appendChild(a);c="ROTATION";n=a;t=m;q=h;l=d};a.create_advanced_preloader=function(a){var b=a.preloader_width,b=b/(b-a.img_width),d=document.getElementById(a.preloader_bar_id),p=document.getElementById(a.fill_band_id),t=document.getElementById(a.preloader_caption_id),C=document.getElementById(a.preloader_container_id),v=document.getElementById(a.background_container_id);k=document.getElementById(a.canvas_container_id);c="ADVANCED";g=d;e=p;H=b;q=t;n=C;l=v};a.update_preloader=function(a){q.innerHTML=
a+"%";"SIMPLE"==c&&(g.style.width=a+"%");"ADVANCED"==c&&(g.style.width=a/H+"%",e.style.width=100-a+"%");"ROTATION"==c&&(t.style.transform="rotate("+a+"deg)");100==a&&(b?(d.css_animate(l,"opacity",1,0,1500,null,null,function(){l.parentNode.removeChild(l)}),d.css_animate(n,"opacity",1,0,1E3,null,null,function(){n.parentNode.removeChild(n)})):(n.parentNode.removeChild(n),l&&l.parentNode.removeChild(l)))}};b4w.module.storage=function(a,p){function d(a){n=a;if(!g){try{g=window.localStorage;try{g.tmp=null,delete g.tmp}catch(b){c.warn("localStorage quota is limited. Disabling localStorage"),g=null}}catch(d){c.warn("Applying chrome localStorage bug workaround"),g=null}g||(c.warn("localStorage is not available, initializing temporary storage"),g={})}}function b(){return g[n]?JSON.parse(g[n]):{}}var c=p("__print"),n="",g=null;a.init=d;a.set=function(a,c){var d=b();d[a]=String(c);g[n]=JSON.stringify(d)};a.cleanup=
function(){delete g[n]};a.get=function(a){var c=b();return c[a]?c[a]:""};a.debug=function(){c.log(b())};d("b4w")};b4w.module.screenshooter=function(a,p){var d=p("main");a.shot=function(){d.canvas_data_url(function(a){var c=window.document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=a;c.download="screenshot.png";c.click();document.body.removeChild(c)})}};
